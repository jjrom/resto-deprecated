/*
 New BSD License <http://creativecommons.org/licenses/BSD/>
 New BSD License <http://creativecommons.org/licenses/BSD/>
 Public Domain
 @author Benjamin Arthur Lupton <contact@balupton.com>
 @author James Padolsey <https://gist.github.com/527683>
 Public Domain
 @author Benjamin Arthur Lupton <contact@balupton.com>
 New BSD License <http://creativecommons.org/licenses/BSD/>
*/
(function(a,b){function c(a){var b=a.length,c=k.type(a);return k.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||"function"!==c&&(0===b||"number"==typeof b&&0<b&&b-1 in a)}function d(a,c,d,e){if(k.acceptData(a)){var f,h,j=k.expando,g=a.nodeType,n=g?k.cache:a,p=g?a[j]:a[j]&&j;if(p&&n[p]&&(e||n[p].data)||d!==b||"string"!=typeof c)return p||(p=g?a[j]=Ka.pop()||k.guid++:j),n[p]||(n[p]=g?{}:{toJSON:k.noop}),("object"==typeof c||"function"==typeof c)&&(e?n[p]=k.extend(n[p],c):n[p].data=k.extend(n[p].data,
c)),h=n[p],e||(h.data||(h.data={}),h=h.data),d!==b&&(h[k.camelCase(c)]=d),"string"==typeof c?(f=h[c],null==f&&(f=h[k.camelCase(c)])):f=h,f}}function e(a,b,c){if(k.acceptData(a)){var d,e,f=a.nodeType,h=f?k.cache:a,j=f?a[k.expando]:k.expando;if(h[j]){if(b&&(d=c?h[j]:h[j].data)){k.isArray(b)?b=b.concat(k.map(b,k.camelCase)):b in d?b=[b]:(b=k.camelCase(b),b=b in d?[b]:b.split(" "));for(e=b.length;e--;)delete d[b[e]];if(c?!g(d):!k.isEmptyObject(d))return}(c||(delete h[j].data,g(h[j])))&&(f?k.cleanData([a],
!0):k.support.deleteExpando||h!=h.window?delete h[j]:h[j]=null)}}}function f(a,c,d){if(d===b&&1===a.nodeType){var e="data-"+c.replace(Ec,"-$1").toLowerCase();if(d=a.getAttribute(e),"string"==typeof d){try{d="true"===d?!0:"false"===d?!1:"null"===d?null:+d+""===d?+d:Fc.test(d)?k.parseJSON(d):d}catch(f){}k.data(a,c,d)}else d=b}return d}function g(a){for(var b in a)if(("data"!==b||!k.isEmptyObject(a[b]))&&"toJSON"!==b)return!1;return!0}function h(){return!0}function j(){return!1}function n(){try{return z.activeElement}catch(a){}}
function p(a,b){do a=a[b];while(a&&1!==a.nodeType);return a}function q(a,b,c){if(k.isFunction(b))return k.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return k.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(Gc.test(b))return k.filter(b,a,c);b=k.filter(b,a)}return k.grep(a,function(a){return 0<=k.inArray(a,b)!==c})}function m(a){var b=Rb.split("|"),a=a.createDocumentFragment();if(a.createElement)for(;b.length;)a.createElement(b.pop());return a}function r(a,b){return k.nodeName(a,
"table")&&k.nodeName(1===b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function s(a){return a.type=(null!==k.find.attr(a,"type"))+"/"+a.type,a}function t(a){var b=Hc.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function v(a,b){for(var c,d=0;null!=(c=a[d]);d++)k._data(c,"globalEval",!b||k._data(b[d],"globalEval"))}function u(a,b){if(1===b.nodeType&&k.hasData(a)){var c,d,e;d=k._data(a);var f=k._data(b,d),
h=d.events;if(h)for(c in delete f.handle,f.events={},h){d=0;for(e=h[c].length;e>d;d++)k.event.add(b,c,h[c][d])}f.data&&(f.data=k.extend({},f.data))}}function w(a,c){var d,e,f=0,h=typeof a.getElementsByTagName!==E?a.getElementsByTagName(c||"*"):typeof a.querySelectorAll!==E?a.querySelectorAll(c||"*"):b;if(!h){h=[];for(d=a.childNodes||a;null!=(e=d[f]);f++)!c||k.nodeName(e,c)?h.push(e):k.merge(h,w(e,c))}return c===b||c&&k.nodeName(a,c)?k.merge([a],h):h}function y(a){ob.test(a.type)&&(a.defaultChecked=
a.checked)}function A(a,b){if(b in a)return b;for(var c=b.charAt(0).toUpperCase()+b.slice(1),d=b,e=Sb.length;e--;)if(b=Sb[e]+c,b in a)return b;return d}function B(a,b){return a=b||a,"none"===k.css(a,"display")||!k.contains(a.ownerDocument,a)}function x(a,b){for(var c,d,e,f=[],h=0,j=a.length;j>h;h++)d=a[h],d.style&&(f[h]=k._data(d,"olddisplay"),c=d.style.display,b?(f[h]||"none"!==c||(d.style.display=""),""===d.style.display&&B(d)&&(f[h]=k._data(d,"olddisplay",U(d.nodeName)))):f[h]||(e=B(d),(c&&"none"!==
c||!e)&&k._data(d,"olddisplay",e?c:k.css(d,"display"))));for(h=0;j>h;h++)d=a[h],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[h]||"":"none"));return a}function K(a,b,c){return(a=Ic.exec(b))?Math.max(0,a[1]-(c||0))+(a[2]||"px"):b}function L(a,b,c,d,e){for(var b=c===(d?"border":"content")?4:"width"===b?1:0,f=0;4>b;b+=2)"margin"===c&&(f+=k.css(a,c+ya[b],!0,e)),d?("content"===c&&(f-=k.css(a,"padding"+ya[b],!0,e)),"margin"!==c&&(f-=k.css(a,"border"+ya[b]+"Width",!0,
e))):(f+=k.css(a,"padding"+ya[b],!0,e),"padding"!==c&&(f+=k.css(a,"border"+ya[b]+"Width",!0,e)));return f}function N(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=za(a),h=k.support.boxSizing&&"border-box"===k.css(a,"boxSizing",!1,f);if(0>=e||null==e){if(e=Aa(a,b,f),(0>e||null==e)&&(e=a.style[b]),Xa.test(e))return e;d=h&&(k.support.boxSizingReliable||e===a.style[b]);e=parseFloat(e)||0}return e+L(a,b,c||(h?"border":"content"),d,f)+"px"}function U(a){var b=z,c=Tb[a];return c||(c=aa(a,
b),"none"!==c&&c||(Ra=(Ra||k("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(b.documentElement),b=(Ra[0].contentWindow||Ra[0].contentDocument).document,b.write("<!doctype html><html><body>"),b.close(),c=aa(a,b),Ra.detach()),Tb[a]=c),c}function aa(a,b){var c=k(b.createElement(a)).appendTo(b.body),d=k.css(c[0],"display");return c.remove(),d}function Ba(a,b,c,d){var e;if(k.isArray(b))k.each(b,function(b,e){c||Jc.test(a)?d(a,e):Ba(a+"["+("object"==
typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==k.type(b))d(a,b);else for(e in b)Ba(a+"["+e+"]",b[e],c,d)}function pa(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(la)||[];if(k.isFunction(c))for(;d=f[e++];)"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function Q(a,c,d,e){function f(g){var n;return h[g]=!0,k.each(a[g]||[],function(a,I){var g=I(c,d,e);return"string"!=typeof g||j||h[g]?j?!(n=g):b:(c.dataTypes.unshift(g),
f(g),!1)}),n}var h={},j=a===pb;return f(c.dataTypes[0])||!h["*"]&&f("*")}function ba(a,c){var d,e,f=k.ajaxSettings.flatOptions||{};for(e in c)c[e]!==b&&((f[e]?a:d||(d={}))[e]=c[e]);return d&&k.extend(!0,a,d),a}function X(){try{return new a.XMLHttpRequest}catch(b){}}function qa(){return setTimeout(function(){La=b}),La=k.now()}function Sa(a,b,c){for(var d,e=(Ta[b]||[]).concat(Ta["*"]),f=0,h=e.length;h>f;f++)if(d=e[f].call(c,b,a))return d}function R(a,b,c){var d,e,f=0,h=Ya.length,j=k.Deferred().always(function(){delete g.elem}),
g=function(){if(e)return!1;for(var b=La||qa(),b=Math.max(0,n.startTime+n.duration-b),c=1-(b/n.duration||0),d=0,f=n.tweens.length;f>d;d++)n.tweens[d].run(c);return j.notifyWith(a,[n,c,b]),1>c&&f?b:(j.resolveWith(a,[n]),!1)},n=j.promise({elem:a,props:k.extend({},b),opts:k.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:La||qa(),duration:c.duration,tweens:[],createTween:function(b,c){var d=k.Tween(a,n.opts,b,c,n.opts.specialEasing[b]||n.opts.easing);return n.tweens.push(d),
d},stop:function(b){var c=0,d=b?n.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)n.tweens[c].run(1);return b?j.resolveWith(a,[n,b]):j.rejectWith(a,[n,b]),this}}),b=n.props,c=n.opts.specialEasing,p,m,q,u;for(d in b)if(p=k.camelCase(d),m=c[p],q=b[d],k.isArray(q)&&(m=q[1],q=b[d]=q[0]),d!==p&&(b[p]=q,delete b[d]),u=k.cssHooks[p],u&&"expand"in u)for(d in q=u.expand(q),delete b[p],q)d in b||(b[d]=q[d],c[d]=m);else c[p]=m;for(;h>f;f++)if(d=Ya[f].call(n,a,b,n.opts))return d;return k.map(b,Sa,n),k.isFunction(n.opts.start)&&
n.opts.start.call(a,n),k.fx.timer(k.extend(g,{elem:a,anim:n,queue:n.opts.queue})),n.progress(n.opts.progress).done(n.opts.done,n.opts.complete).fail(n.opts.fail).always(n.opts.always)}function F(a,b,c,d,e){return new F.prototype.init(a,b,c,d,e)}function T(a,b){for(var c,d={height:a},e=0,b=b?1:0;4>e;e+=2-b)c=ya[e],d["margin"+c]=d["padding"+c]=a;return b&&(d.opacity=d.width=a),d}function O(a){return k.isWindow(a)?a:9===a.nodeType?a.defaultView||a.parentWindow:!1}var ma,ra,E=typeof b,ca=a.location,z=
a.document,Ub=z.documentElement,Lc=a.jQuery,Mc=a.$,Za={},Ka=[],Vb=Ka.concat,qb=Ka.push,Ca=Ka.slice,Wb=Ka.indexOf,Nc=Za.toString,Ma=Za.hasOwnProperty,rb="1.10.2".trim,k=function(a,b){return new k.fn.init(a,b,ra)},$a=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,la=/\S+/g,Oc=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,Pc=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,Xb=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,Qc=/^[\],:{}\s]*$/,Rc=/(?:^|:|,)(?:\s*\[)+/g,Sc=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,Tc=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,
Uc=/^-ms-/,Vc=/-([\da-z])/gi,Wc=function(a,b){return b.toUpperCase()},sa=function(a){(z.addEventListener||"load"===a.type||"complete"===z.readyState)&&(Yb(),k.ready())},Yb=function(){z.addEventListener?(z.removeEventListener("DOMContentLoaded",sa,!1),a.removeEventListener("load",sa,!1)):(z.detachEvent("onreadystatechange",sa),a.detachEvent("onload",sa))};k.fn=k.prototype={jquery:"1.10.2",constructor:k,init:function(a,c,d){var e,f;if(!a)return this;if("string"==typeof a){if(e="<"===a.charAt(0)&&">"===
a.charAt(a.length-1)&&3<=a.length?[null,a,null]:Pc.exec(a),!e||!e[1]&&c)return!c||c.jquery?(c||d).find(a):this.constructor(c).find(a);if(e[1]){if(c=c instanceof k?c[0]:c,k.merge(this,k.parseHTML(e[1],c&&c.nodeType?c.ownerDocument||c:z,!0)),Xb.test(e[1])&&k.isPlainObject(c))for(e in c)k.isFunction(this[e])?this[e](c[e]):this.attr(e,c[e]);return this}if(f=z.getElementById(e[2]),f&&f.parentNode){if(f.id!==e[2])return d.find(a);this.length=1;this[0]=f}return this.context=z,this.selector=a,this}return a.nodeType?
(this.context=this[0]=a,this.length=1,this):k.isFunction(a)?d.ready(a):(a.selector!==b&&(this.selector=a.selector,this.context=a.context),k.makeArray(a,this))},selector:"",length:0,toArray:function(){return Ca.call(this)},get:function(a){return null==a?this.toArray():0>a?this[this.length+a]:this[a]},pushStack:function(a){a=k.merge(this.constructor(),a);return a.prevObject=this,a.context=this.context,a},each:function(a,b){return k.each(this,a,b)},ready:function(a){return k.ready.promise().done(a),
this},slice:function(){return this.pushStack(Ca.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,a=+a+(0>a?b:0);return this.pushStack(0<=a&&b>a?[this[a]]:[])},map:function(a){return this.pushStack(k.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:qb,sort:[].sort,splice:[].splice};k.fn.init.prototype=k.fn;k.extend=k.fn.extend=function(){var a,c,d,e,f,h,
j=arguments[0]||{},g=1,n=arguments.length,p=!1;"boolean"==typeof j&&(p=j,j=arguments[1]||{},g=2);"object"==typeof j||k.isFunction(j)||(j={});for(n===g&&(j=this,--g);n>g;g++)if(null!=(f=arguments[g]))for(e in f)a=j[e],d=f[e],j!==d&&(p&&d&&(k.isPlainObject(d)||(c=k.isArray(d)))?(c?(c=!1,h=a&&k.isArray(a)?a:[]):h=a&&k.isPlainObject(a)?a:{},j[e]=k.extend(p,h,d)):d!==b&&(j[e]=d));return j};k.extend({expando:"jQuery"+("1.10.2"+Math.random()).replace(/\D/g,""),noConflict:function(b){return a.$===k&&(a.$=
Mc),b&&a.jQuery===k&&(a.jQuery=Lc),k},isReady:!1,readyWait:1,holdReady:function(a){a?k.readyWait++:k.ready(!0)},ready:function(a){if(!0===a?!--k.readyWait:!k.isReady){if(!z.body)return setTimeout(k.ready);k.isReady=!0;!0!==a&&0<--k.readyWait||(ma.resolveWith(z,[k]),k.fn.trigger&&k(z).trigger("ready").off("ready"))}},isFunction:function(a){return"function"===k.type(a)},isArray:Array.isArray||function(a){return"array"===k.type(a)},isWindow:function(a){return null!=a&&a==a.window},isNumeric:function(a){return!isNaN(parseFloat(a))&&
isFinite(a)},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?Za[Nc.call(a)]||"object":typeof a},isPlainObject:function(a){var c;if(!a||"object"!==k.type(a)||a.nodeType||k.isWindow(a))return!1;try{if(a.constructor&&!Ma.call(a,"constructor")&&!Ma.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(d){return!1}if(k.support.ownLast)for(c in a)return Ma.call(a,c);for(c in a);return c===b||Ma.call(a,c)},isEmptyObject:function(a){for(var b in a)return!1;return!0},error:function(a){throw Error(a);
},parseHTML:function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1);var b=b||z,d=Xb.exec(a),c=!c&&[];return d?[b.createElement(d[1])]:(d=k.buildFragment([a],b,c),c&&k(c).remove(),k.merge([],d.childNodes))},parseJSON:function(c){return a.JSON&&a.JSON.parse?a.JSON.parse(c):null===c?c:"string"==typeof c&&(c=k.trim(c),c&&Qc.test(c.replace(Sc,"@").replace(Tc,"]").replace(Rc,"")))?Function("return "+c)():(k.error("Invalid JSON: "+c),b)},parseXML:function(c){var d,e;if(!c||
"string"!=typeof c)return null;try{a.DOMParser?(e=new DOMParser,d=e.parseFromString(c,"text/xml")):(d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(c))}catch(f){d=b}return d&&d.documentElement&&!d.getElementsByTagName("parsererror").length||k.error("Invalid XML: "+c),d},noop:function(){},globalEval:function(b){b&&k.trim(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(Uc,"ms-").replace(Vc,Wc)},nodeName:function(a,b){return a.nodeName&&
a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,d){var e,f=0,h=a.length,j=c(a);if(d)if(j)for(;h>f&&!(e=b.apply(a[f],d),!1===e);f++);else for(f in a){if(e=b.apply(a[f],d),!1===e)break}else if(j)for(;h>f&&!(e=b.call(a[f],f,a[f]),!1===e);f++);else for(f in a)if(e=b.call(a[f],f,a[f]),!1===e)break;return a},trim:rb&&!rb.call("\ufeff\u00a0")?function(a){return null==a?"":rb.call(a)}:function(a){return null==a?"":(a+"").replace(Oc,"")},makeArray:function(a,b){var d=b||[];return null!=a&&(c(Object(a))?
k.merge(d,"string"==typeof a?[a]:a):qb.call(d,a)),d},inArray:function(a,b,c){var d;if(b){if(Wb)return Wb.call(b,a,c);d=b.length;for(c=c?0>c?Math.max(0,d+c):c:0;d>c;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,c){var d=c.length,e=a.length,f=0;if("number"==typeof d)for(;d>f;f++)a[e++]=c[f];else for(;c[f]!==b;)a[e++]=c[f++];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,h=a.length,c=!!c;h>f;f++)d=!!b(a[f],f),c!==d&&e.push(a[f]);return e},map:function(a,b,d){var e,f=0,h=a.length,
j=[];if(c(a))for(;h>f;f++)e=b(a[f],f,d),null!=e&&(j[j.length]=e);else for(f in a)e=b(a[f],f,d),null!=e&&(j[j.length]=e);return Vb.apply([],j)},guid:1,proxy:function(a,c){var d,e,f;return"string"==typeof c&&(f=a[c],c=a,a=f),k.isFunction(a)?(d=Ca.call(arguments,2),e=function(){return a.apply(c||this,d.concat(Ca.call(arguments)))},e.guid=a.guid=a.guid||k.guid++,e):b},access:function(a,c,d,e,f,h,j){var g=0,n=a.length,p=null==d;if("object"===k.type(d))for(g in f=!0,d)k.access(a,c,g,d[g],!0,h,j);else if(e!==
b&&(f=!0,k.isFunction(e)||(j=!0),p&&(j?(c.call(a,e),c=null):(p=c,c=function(a,b,c){return p.call(k(a),c)})),c))for(;n>g;g++)c(a[g],d,j?e:e.call(a[g],g,c(a[g],d)));return f?a:p?c.call(a):n?c(a[0],d):h},now:function(){return(new Date).getTime()},swap:function(a,b,c,d){var e,f={};for(e in b)f[e]=a.style[e],a.style[e]=b[e];c=c.apply(a,d||[]);for(e in b)a.style[e]=f[e];return c}});k.ready.promise=function(b){if(!ma)if(ma=k.Deferred(),"complete"===z.readyState)setTimeout(k.ready);else if(z.addEventListener)z.addEventListener("DOMContentLoaded",
sa,!1),a.addEventListener("load",sa,!1);else{z.attachEvent("onreadystatechange",sa);a.attachEvent("onload",sa);var c=!1;try{c=null==a.frameElement&&z.documentElement}catch(d){}c&&c.doScroll&&function W(){if(!k.isReady){try{c.doScroll("left")}catch(a){return setTimeout(W,50)}Yb();k.ready()}}()}return ma.promise(b)};k.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){Za["[object "+b+"]"]=b.toLowerCase()});ra=k(z);var sb=a,H=function(a,b,c,d){var e,f,h,j,g;
if((b?b.ownerDocument||b:na)!==Y&&Da(b),b=b||Y,c=c||[],!a||"string"!=typeof a)return c;if(1!==(j=b.nodeType)&&9!==j)return[];if(ha&&!d){if(e=Xc.exec(a))if(h=e[1])if(9===j){if(f=b.getElementById(h),!f||!f.parentNode)return c;if(f.id===h)return c.push(f),c}else{if(b.ownerDocument&&(f=b.ownerDocument.getElementById(h))&&Ua(b,f)&&f.id===h)return c.push(f),c}else{if(e[2])return ta.apply(c,b.getElementsByTagName(a)),c;if((h=e[3])&&P.getElementsByClassName&&b.getElementsByClassName)return ta.apply(c,b.getElementsByClassName(h)),
c}if(P.qsa&&(!da||!da.test(a))){if(f=e=S,h=b,g=9===j&&a,1===j&&"object"!==b.nodeName.toLowerCase()){j=ab(a);(e=b.getAttribute("id"))?f=e.replace(Yc,"\\$&"):b.setAttribute("id",f);f="[id='"+f+"'] ";for(h=j.length;h--;)j[h]=f+bb(j[h]);h=tb.test(a)&&b.parentNode||b;g=j.join(",")}if(g)try{return ta.apply(c,h.querySelectorAll(g)),c}catch(n){}finally{e||b.removeAttribute("id")}}}var p;a:{var a=a.replace(cb,"$1"),m,k;f=ab(a);if(!d&&1===f.length){if(p=f[0]=f[0].slice(0),2<p.length&&"ID"===(m=p[0]).type&&
P.getById&&9===b.nodeType&&ha&&G.relative[p[1].type]){if(b=(G.find.ID(m.matches[0].replace(ua,va),b)||[])[0],!b){p=c;break a}a=a.slice(p.shift().value.length)}for(j=db.needsContext.test(a)?0:p.length;j--&&!(m=p[j],G.relative[e=m.type]);)if((k=G.find[e])&&(d=k(m.matches[0].replace(ua,va),tb.test(p[0].type)&&b.parentNode||b))){if(p.splice(j,1),a=d.length&&bb(p),!a){p=(ta.apply(c,d),c);break a}break}}p=(ub(a,f)(d,b,!ha,c,tb.test(a)),c)}return p},vb=function(){function a(c,d){return b.push(c+=" ")>G.cacheLength&&
delete a[b.shift()],a[c]=d}var b=[];return a},fa=function(a){return a[S]=!0,a},ga=function(a){var b=Y.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b)}},wb=function(a,b){for(var c=a.split("|"),d=a.length;d--;)G.attrHandle[c[d]]=b},$b=function(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||Zb)-(~a.sourceIndex||Zb);if(d)return d;if(c)for(;c=c.nextSibling;)if(c===b)return-1;return a?1:-1},Zc=function(a){return function(b){return"input"===
b.nodeName.toLowerCase()&&b.type===a}},$c=function(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}},Ea=function(a){return fa(function(b){return b=+b,fa(function(c,d){for(var e,f=a([],c.length,b),h=f.length;h--;)c[e=f[h]]&&(c[e]=!(d[e]=c[e]))})})},ac=function(){},ab=function(a,b){var c,d,e,f,h,j,g;if(h=bc[a+" "])return b?0:h.slice(0);h=a;j=[];for(g=G.preFilter;h;){(!c||(d=ad.exec(h)))&&(d&&(h=h.slice(d[0].length)||h),j.push(e=[]));c=!1;(d=bd.exec(h))&&
(c=d.shift(),e.push({value:c,type:d[0].replace(cb," ")}),h=h.slice(c.length));for(f in G.filter)!(d=db[f].exec(h))||g[f]&&!(d=g[f](d))||(c=d.shift(),e.push({value:c,type:f,matches:d}),h=h.slice(c.length));if(!c)break}return b?h.length:h?H.error(a):bc(a,j).slice(0)},bb=function(a){for(var b=0,c=a.length,d="";c>b;b++)d+=a[b].value;return d},xb=function(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=cd++;return b.first?function(b,c,f){for(;b=b[d];)if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,h){var j,
g,n,p=ia+" "+f;if(h)for(;b=b[d];){if((1===b.nodeType||e)&&a(b,c,h))return!0}else for(;b=b[d];)if(1===b.nodeType||e)if(n=b[S]||(b[S]={}),(g=n[d])&&g[0]===p){if(!0===(j=g[1])||j===eb)return!0===j}else if(g=n[d]=[p],g[1]=a(b,c,h)||eb,!0===g[1])return!0}},yb=function(a){return 1<a.length?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]},fb=function(a,b,c,d,e){for(var f,h=[],j=0,g=a.length,n=null!=b;g>j;j++)(f=a[j])&&(!c||c(f,d,e))&&(h.push(f),n&&b.push(j));return h},zb=
function(a,b,c,d,e,f){return d&&!d[S]&&(d=zb(d)),e&&!e[S]&&(e=zb(e,f)),fa(function(f,h,j,g){var n,p,m=[],k=[],q=h.length,u;if(!(u=f)){u=b||"*";for(var x=j.nodeType?[j]:j,w=[],r=0,Dc=x.length;Dc>r;r++)H(u,x[r],w);u=w}u=!a||!f&&b?u:fb(u,m,a,j,g);x=c?e||(f?a:q||d)?[]:h:u;if(c&&c(u,x,j,g),d){n=fb(x,k);d(n,[],j,g);for(j=n.length;j--;)(p=n[j])&&(x[k[j]]=!(u[k[j]]=p))}if(f){if(e||a){if(e){n=[];for(j=x.length;j--;)(p=x[j])&&n.push(u[j]=p);e(null,x=[],n,g)}for(j=x.length;j--;)(p=x[j])&&-1<(n=e?Fa.call(f,p):
m[j])&&(f[n]=!(h[n]=p))}}else x=fb(x===h?x.splice(q,x.length):x),e?e(null,h,x,g):ta.apply(h,x)})},Ab=function(a){var b,c,d,e=a.length,f=G.relative[a[0].type];c=f||G.relative[" "];for(var h=f?1:0,j=xb(function(a){return a===b},c,!0),g=xb(function(a){return-1<Fa.call(b,a)},c,!0),n=[function(a,c,d){return!f&&(d||c!==gb)||((b=c).nodeType?j(a,c,d):g(a,c,d))}];e>h;h++)if(c=G.relative[a[h].type])n=[xb(yb(n),c)];else{if(c=G.filter[a[h].type].apply(null,a[h].matches),c[S]){for(d=++h;e>d&&!G.relative[a[d].type];d++);
return zb(1<h&&yb(n),1<h&&bb(a.slice(0,h-1).concat({value:" "===a[h-2].type?"*":""})).replace(cb,"$1"),c,d>h&&Ab(a.slice(h,d)),e>d&&Ab(a=a.slice(d)),e>d&&bb(a))}n.push(c)}return yb(n)},Na,P,eb,G,hb,cc,ub,gb,Ga,Da,Y,ja,ha,da,Ha,ib,Ua,S="sizzle"+-new Date,na=sb.document,ia=0,cd=0,dc=vb(),bc=vb(),ec=vb(),Oa=!1,Bb=function(a,b){return a===b?(Oa=!0,0):0},Zb=-2147483648,dd={}.hasOwnProperty,wa=[],ed=wa.pop,fd=wa.push,ta=wa.push,fc=wa.slice,Fa=wa.indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]===
a)return b;return-1},gc="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w#"),hc="\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)[\\x20\\t\\r\\n\\f]*(?:([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+gc+")|)|)[\\x20\\t\\r\\n\\f]*\\]",Cb=":((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+hc.replace(3,8)+")*)|.*)\\)|)",cb=RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g"),ad=/^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,
bd=/^[\x20\t\r\n\f]*([>+~]|[\x20\t\r\n\f])[\x20\t\r\n\f]*/,tb=/[\x20\t\r\n\f]*[+~]/,gd=RegExp("=[\\x20\\t\\r\\n\\f]*([^\\]'\"]*)[\\x20\\t\\r\\n\\f]*\\]","g"),hd=RegExp(Cb),id=RegExp("^"+gc+"$"),db={ID:/^#((?:\\.|[\w-]|[^\x00-\xa0])+)/,CLASS:/^\.((?:\\.|[\w-]|[^\x00-\xa0])+)/,TAG:RegExp("^("+"(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w*")+")"),ATTR:RegExp("^"+hc),PSEUDO:RegExp("^"+Cb),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)",
"i"),bool:RegExp("^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$","i"),needsContext:RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)","i")},Db=/^[^{]+\{\s*\[native \w/,Xc=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,jd=/^(?:input|select|textarea|button)$/i,kd=/^h\d$/i,Yc=/'|\\/g,ua=RegExp("\\\\([\\da-f]{1,6}[\\x20\\t\\r\\n\\f]?|([\\x20\\t\\r\\n\\f])|.)",
"ig"),va=function(a,b,c){a="0x"+b-65536;return a!==a||c?b:0>a?String.fromCharCode(a+65536):String.fromCharCode(55296|a>>10,56320|1023&a)};try{ta.apply(wa=fc.call(na.childNodes),na.childNodes),wa[na.childNodes.length].nodeType}catch(Nd){ta={apply:wa.length?function(a,b){fd.apply(a,fc.call(b))}:function(a,b){for(var c=a.length,d=0;a[c++]=b[d++];);a.length=c-1}}}cc=H.isXML=function(a){return(a=a&&(a.ownerDocument||a).documentElement)?"HTML"!==a.nodeName:!1};P=H.support={};Da=H.setDocument=function(a){var b=
a?a.ownerDocument||a:na,a=b.defaultView;return b!==Y&&9===b.nodeType&&b.documentElement?(Y=b,ja=b.documentElement,ha=!cc(b),a&&a.attachEvent&&a!==a.top&&a.attachEvent("onbeforeunload",function(){Da()}),P.attributes=ga(function(a){return a.className="i",!a.getAttribute("className")}),P.getElementsByTagName=ga(function(a){return a.appendChild(b.createComment("")),!a.getElementsByTagName("*").length}),P.getElementsByClassName=ga(function(a){return a.innerHTML="<div class='a'></div><div class='a i'></div>",
a.firstChild.className="i",2===a.getElementsByClassName("i").length}),P.getById=ga(function(a){return ja.appendChild(a).id=S,!b.getElementsByName||!b.getElementsByName(S).length}),P.getById?(G.find.ID=function(a,b){if("undefined"!==typeof b.getElementById&&ha){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},G.filter.ID=function(a){var b=a.replace(ua,va);return function(a){return a.getAttribute("id")===b}}):(delete G.find.ID,G.filter.ID=function(a){var b=a.replace(ua,va);return function(a){return(a=
"undefined"!==typeof a.getAttributeNode&&a.getAttributeNode("id"))&&a.value===b}}),G.find.TAG=P.getElementsByTagName?function(a,b){return"undefined"!==typeof b.getElementsByTagName?b.getElementsByTagName(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){for(;c=f[e++];)1===c.nodeType&&d.push(c);return d}return f},G.find.CLASS=P.getElementsByClassName&&function(a,b){return"undefined"!==typeof b.getElementsByClassName&&ha?b.getElementsByClassName(a):void 0},Ha=[],da=[],
(P.qsa=Db.test(b.querySelectorAll))&&(ga(function(a){a.innerHTML="<select><option selected=''></option></select>";a.querySelectorAll("[selected]").length||da.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)");a.querySelectorAll(":checked").length||da.push(":checked")}),ga(function(a){var c=b.createElement("input");c.setAttribute("type","hidden");a.appendChild(c).setAttribute("t","");a.querySelectorAll("[t^='']").length&&
da.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")");a.querySelectorAll(":enabled").length||da.push(":enabled",":disabled");a.querySelectorAll("*,:x");da.push(",.*:")})),(P.matchesSelector=Db.test(ib=ja.webkitMatchesSelector||ja.mozMatchesSelector||ja.oMatchesSelector||ja.msMatchesSelector))&&ga(function(a){P.disconnectedMatch=ib.call(a,"div");ib.call(a,"[s!='']:x");Ha.push("!=",Cb)}),da=da.length&&RegExp(da.join("|")),Ha=Ha.length&&RegExp(Ha.join("|")),Ua=Db.test(ja.contains)||ja.compareDocumentPosition?
function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},Bb=ja.compareDocumentPosition?function(a,c){if(a===c)return Oa=!0,0;var d=c.compareDocumentPosition&&a.compareDocumentPosition&&a.compareDocumentPosition(c);return d?1&d||!P.sortDetached&&c.compareDocumentPosition(a)===d?a===b||Ua(na,a)?
-1:c===b||Ua(na,c)?1:Ga?Fa.call(Ga,a)-Fa.call(Ga,c):0:4&d?-1:1:a.compareDocumentPosition?-1:1}:function(a,c){var d,e=0;d=a.parentNode;var f=c.parentNode,h=[a],j=[c];if(a===c)return Oa=!0,0;if(!d||!f)return a===b?-1:c===b?1:d?-1:f?1:Ga?Fa.call(Ga,a)-Fa.call(Ga,c):0;if(d===f)return $b(a,c);for(d=a;d=d.parentNode;)h.unshift(d);for(d=c;d=d.parentNode;)j.unshift(d);for(;h[e]===j[e];)e++;return e?$b(h[e],j[e]):h[e]===na?-1:j[e]===na?1:0},b):Y};H.matches=function(a,b){return H(a,null,null,b)};H.matchesSelector=
function(a,b){if((a.ownerDocument||a)!==Y&&Da(a),b=b.replace(gd,"='$1']"),!(!P.matchesSelector||!ha||Ha&&Ha.test(b)||da&&da.test(b)))try{var c=ib.call(a,b);if(c||P.disconnectedMatch||a.document&&11!==a.document.nodeType)return c}catch(d){}return 0<H(b,Y,null,[a]).length};H.contains=function(a,b){return(a.ownerDocument||a)!==Y&&Da(a),Ua(a,b)};H.attr=function(a,b){(a.ownerDocument||a)!==Y&&Da(a);var c=G.attrHandle[b.toLowerCase()],c=c&&dd.call(G.attrHandle,b.toLowerCase())?c(a,b,!ha):void 0;return void 0===
c?P.attributes||!ha?a.getAttribute(b):(c=a.getAttributeNode(b))&&c.specified?c.value:null:c};H.error=function(a){throw Error("Syntax error, unrecognized expression: "+a);};H.uniqueSort=function(a){var b,c=[],d=0,e=0;if(Oa=!P.detectDuplicates,Ga=!P.sortStable&&a.slice(0),a.sort(Bb),Oa){for(;b=a[e++];)b===a[e]&&(d=c.push(e));for(;d--;)a.splice(c[d],1)}return a};hb=H.getText=function(a){var b,c="",d=0;if(b=a.nodeType)if(1===b||9===b||11===b){if("string"==typeof a.textContent)return a.textContent;for(a=
a.firstChild;a;a=a.nextSibling)c+=hb(a)}else{if(3===b||4===b)return a.nodeValue}else for(;b=a[d];d++)c+=hb(b);return c};G=H.selectors={cacheLength:50,createPseudo:fa,match:db,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(ua,va),a[3]=(a[4]||a[5]||"").replace(ua,va),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=
a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||H.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&H.error(a[0]),a},PSEUDO:function(a){var b,c=!a[5]&&a[2];return db.CHILD.test(a[0])?null:(a[3]&&void 0!==a[4]?a[2]=a[4]:c&&hd.test(c)&&(b=ab(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(ua,va).toLowerCase();return"*"===a?function(){return!0}:
function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=dc[a+" "];return b||(b=RegExp("(^|[\\x20\\t\\r\\n\\f])"+a+"([\\x20\\t\\r\\n\\f]|$)"))&&dc(a,function(a){return b.test("string"==typeof a.className&&a.className||"undefined"!==typeof a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,b,c){return function(d){d=H.attr(d,a);return null==d?"!="===b:b?(d+="","="===b?d===c:"!="===b?d!==c:"^="===b?c&&0===d.indexOf(c):"*="===b?c&&-1<d.indexOf(c):"$="===b?c&&
d.slice(-c.length)===c:"~="===b?-1<(" "+d+" ").indexOf(c):"|="===b?d===c||d.slice(0,c.length+1)===c+"-":!1):!0}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),h="last"!==a.slice(-4),j="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,g){var n,p,m,k,J,c=f!==h?"nextSibling":"previousSibling",V=b.parentNode,q=j&&b.nodeName.toLowerCase(),g=!g&&!j;if(V){if(f){for(;c;){for(p=b;p=p[c];)if(j?p.nodeName.toLowerCase()===q:1===p.nodeType)return!1;J=c="only"===a&&!J&&"nextSibling"}return!0}if(J=
[h?V.firstChild:V.lastChild],h&&g){g=V[S]||(V[S]={});n=g[a]||[];k=n[0]===ia&&n[1];m=n[0]===ia&&n[2];for(p=k&&V.childNodes[k];p=++k&&p&&p[c]||(m=k=0)||J.pop();)if(1===p.nodeType&&++m&&p===b){g[a]=[ia,k,m];break}}else if(g&&(n=(b[S]||(b[S]={}))[a])&&n[0]===ia)m=n[1];else for(;(p=++k&&p&&p[c]||(m=k=0)||J.pop())&&(!(j?p.nodeName.toLowerCase()===q:1===p.nodeType)||!++m||!(g&&((p[S]||(p[S]={}))[a]=[ia,m]),p===b)););return m-=e,m===d||0===m%d&&0<=m/d}}},PSEUDO:function(a,b){var c,d=G.pseudos[a]||G.setFilters[a.toLowerCase()]||
H.error("unsupported pseudo: "+a);return d[S]?d(b):1<d.length?(c=[a,a,"",b],G.setFilters.hasOwnProperty(a.toLowerCase())?fa(function(a,c){for(var e,f=d(a,b),h=f.length;h--;)e=Fa.call(a,f[h]),a[e]=!(c[e]=f[h])}):function(a){return d(a,0,c)}):d}},pseudos:{not:fa(function(a){var b=[],c=[],d=ub(a.replace(cb,"$1"));return d[S]?fa(function(a,b,c,e){for(var f,c=d(a,null,e,[]),e=a.length;e--;)(f=c[e])&&(a[e]=!(b[e]=f))}):function(a,e,f){return b[0]=a,d(b,null,f,c),!c.pop()}}),has:fa(function(a){return function(b){return 0<
H(a,b).length}}),contains:fa(function(a){return function(b){return-1<(b.textContent||b.innerText||hb(b)).indexOf(a)}}),lang:fa(function(a){return id.test(a||"")||H.error("unsupported lang: "+a),a=a.replace(ua,va).toLowerCase(),function(b){var c;do if(c=ha?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(a){var b=sb.location&&sb.location.hash;return b&&b.slice(1)===a.id},
root:function(a){return a===ja},focus:function(a){return a===Y.activeElement&&(!Y.hasFocus||Y.hasFocus())&&!(!a.type&&!a.href&&!~a.tabIndex)},enabled:function(a){return!1===a.disabled},disabled:function(a){return!0===a.disabled},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,!0===a.selected},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if("@"<a.nodeName||3===
a.nodeType||4===a.nodeType)return!1;return!0},parent:function(a){return!G.pseudos.empty(a)},header:function(a){return kd.test(a.nodeName)},input:function(a){return jd.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||b.toLowerCase()===a.type)},first:Ea(function(){return[0]}),last:Ea(function(a,b){return[b-1]}),eq:Ea(function(a,
b,c){return[0>c?c+b:c]}),even:Ea(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:Ea(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:Ea(function(a,b,c){for(b=0>c?c+b:c;0<=--b;)a.push(b);return a}),gt:Ea(function(a,b,c){for(c=0>c?c+b:c;b>++c;)a.push(c);return a})}};G.pseudos.nth=G.pseudos.eq;for(Na in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})G.pseudos[Na]=Zc(Na);for(Na in{submit:!0,reset:!0})G.pseudos[Na]=$c(Na);ac.prototype=G.filters=G.pseudos;G.setFilters=new ac;ub=
H.compile=function(a,b){var c,d=[],e=[],f=ec[a+" "];if(!f){b||(b=ab(a));for(c=b.length;c--;)f=Ab(b[c]),f[S]?d.push(f):e.push(f);var h=0,j=0<d.length,g=0<e.length;c=function(a,b,c,f,n){var I,p,m=[],k=0,J="0",q=a&&[],V=null!=n,u=gb,x=a||g&&G.find.TAG("*",n&&b.parentNode||b),r=ia+=null==u?1:Math.random()||0.1;for(V&&(gb=b!==Y&&b,eb=h);null!=(n=x[J]);J++){if(g&&n){for(I=0;p=e[I++];)if(p(n,b,c)){f.push(n);break}V&&(ia=r,eb=++h)}j&&((n=!p&&n)&&k--,a&&q.push(n))}if(k+=J,j&&J!==k){for(I=0;p=d[I++];)p(q,m,
b,c);if(a){if(0<k)for(;J--;)q[J]||m[J]||(m[J]=ed.call(f));m=fb(m)}ta.apply(f,m);V&&!a&&0<m.length&&1<k+d.length&&H.uniqueSort(f)}return V&&(ia=r,gb=u),q};c=j?fa(c):c;f=ec(a,c)}return f};P.sortStable=S.split("").sort(Bb).join("")===S;P.detectDuplicates=Oa;Da();P.sortDetached=ga(function(a){return 1&a.compareDocumentPosition(Y.createElement("div"))});ga(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||wb("type|href|height|width",function(a,b,c){return c?void 0:
a.getAttribute(b,"type"===b.toLowerCase()?1:2)});P.attributes&&ga(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||wb("value",function(a,b,c){return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue});ga(function(a){return null==a.getAttribute("disabled")})||wb("checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",function(a,b,c){var d;return c?
void 0:(d=a.getAttributeNode(b))&&d.specified?d.value:!0===a[b]?b.toLowerCase():null});k.find=H;k.expr=H.selectors;k.expr[":"]=k.expr.pseudos;k.unique=H.uniqueSort;k.text=H.getText;k.isXMLDoc=H.isXML;k.contains=H.contains;var ic={};k.Callbacks=function(a){var c;if("string"==typeof a){if(!(c=ic[a])){c=a;var d=ic[c]={};c=(k.each(c.match(la)||[],function(a,b){d[b]=!0}),d)}}else c=k.extend({},a);var a=c,e,f,h,j,g,n,p=[],m=!a.once&&[],q=function(b){f=a.memory&&b;h=!0;g=n||0;n=0;j=p.length;for(e=!0;p&&
j>g;g++)if(!1===p[g].apply(b[0],b[1])&&a.stopOnFalse){f=!1;break}e=!1;p&&(m?m.length&&q(m.shift()):f?p=[]:u.disable())},u={add:function(){if(p){var b=p.length;(function Kc(b){k.each(b,function(b,c){var d=k.type(c);"function"===d?a.unique&&u.has(c)||p.push(c):c&&c.length&&"string"!==d&&Kc(c)})})(arguments);e?j=p.length:f&&(n=b,q(f))}return this},remove:function(){return p&&k.each(arguments,function(a,b){for(var c;-1<(c=k.inArray(b,p,c));)p.splice(c,1),e&&(j>=c&&j--,g>=c&&g--)}),this},has:function(a){return a?
-1<k.inArray(a,p):!(!p||!p.length)},empty:function(){return p=[],j=0,this},disable:function(){return p=m=f=b,this},disabled:function(){return!p},lock:function(){return m=b,f||u.disable(),this},locked:function(){return!m},fireWith:function(a,b){return!p||h&&!m||(b=b||[],b=[a,b.slice?b.slice():b],e?m.push(b):q(b)),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!h}};return u};k.extend({Deferred:function(a){var b=[["resolve","done",k.Callbacks("once memory"),"resolved"],
["reject","fail",k.Callbacks("once memory"),"rejected"],["notify","progress",k.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return k.Deferred(function(c){k.each(b,function(b,f){var h=f[0],j=k.isFunction(a[b])&&a[b];e[f[1]](function(){var a=j&&j.apply(this,arguments);a&&k.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[h+"With"](this===d?c.promise():
this,j?[a]:arguments)})});a=null}).promise()},promise:function(a){return null!=a?k.extend(a,d):d}},e={};return d.pipe=d.then,k.each(b,function(a,f){var h=f[2],j=f[3];d[f[1]]=h.add;j&&h.add(function(){c=j},b[1^a][2].disable,b[2][2].lock);e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this};e[f[0]+"With"]=h.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b=0,c=Ca.call(arguments),d=c.length,e=1!==d||a&&k.isFunction(a.promise)?d:0,f=1===e?a:k.Deferred(),h=function(a,
b,c){return function(d){b[a]=this;c[a]=1<arguments.length?Ca.call(arguments):d;c===j?f.notifyWith(b,c):--e||f.resolveWith(b,c)}},j,g,n;if(1<d){j=Array(d);g=Array(d);for(n=Array(d);d>b;b++)c[b]&&k.isFunction(c[b].promise)?c[b].promise().done(h(b,n,c)).fail(f.reject).progress(h(b,g,j)):--e}return e||f.resolveWith(n,c),f.promise()}});var ld=k,Eb,C={},Fb,oa,Z,jb,kb,lb,Gb,jc,Va,D=z.createElement("div");if(D.setAttribute("className","t"),D.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",
Fb=D.getElementsByTagName("*")||[],oa=D.getElementsByTagName("a")[0],!oa||!oa.style||!Fb.length)Eb=C;else{jb=z.createElement("select");lb=jb.appendChild(z.createElement("option"));Z=D.getElementsByTagName("input")[0];oa.style.cssText="top:1px;float:left;opacity:.5";C.getSetAttribute="t"!==D.className;C.leadingWhitespace=3===D.firstChild.nodeType;C.tbody=!D.getElementsByTagName("tbody").length;C.htmlSerialize=!!D.getElementsByTagName("link").length;C.style=/top/.test(oa.getAttribute("style"));C.hrefNormalized=
"/a"===oa.getAttribute("href");C.opacity=/^0.5/.test(oa.style.opacity);C.cssFloat=!!oa.style.cssFloat;C.checkOn=!!Z.value;C.optSelected=lb.selected;C.enctype=!!z.createElement("form").enctype;C.html5Clone="<:nav></:nav>"!==z.createElement("nav").cloneNode(!0).outerHTML;C.inlineBlockNeedsLayout=!1;C.shrinkWrapBlocks=!1;C.pixelPosition=!1;C.deleteExpando=!0;C.noCloneEvent=!0;C.reliableMarginRight=!0;C.boxSizingReliable=!0;Z.checked=!0;C.noCloneChecked=Z.cloneNode(!0).checked;jb.disabled=!0;C.optDisabled=
!lb.disabled;try{delete D.test}catch(Od){C.deleteExpando=!1}Z=z.createElement("input");Z.setAttribute("value","");C.input=""===Z.getAttribute("value");Z.value="t";Z.setAttribute("type","radio");C.radioValue="t"===Z.value;Z.setAttribute("checked","t");Z.setAttribute("name","t");kb=z.createDocumentFragment();kb.appendChild(Z);C.appendChecked=Z.checked;C.checkClone=kb.cloneNode(!0).cloneNode(!0).lastChild.checked;D.attachEvent&&(D.attachEvent("onclick",function(){C.noCloneEvent=!1}),D.cloneNode(!0).click());
for(Va in{submit:!0,change:!0,focusin:!0})D.setAttribute(Gb="on"+Va,"t"),C[Va+"Bubbles"]=Gb in a||!1===D.attributes[Gb].expando;D.style.backgroundClip="content-box";D.cloneNode(!0).style.backgroundClip="";C.clearCloneStyle="content-box"===D.style.backgroundClip;for(Va in k(C))break;Eb=(C.ownLast="0"!==Va,k(function(){var b,c,d,e=z.getElementsByTagName("body")[0];e&&(b=z.createElement("div"),b.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",e.appendChild(b).appendChild(D),
D.innerHTML="<table><tr><td></td><td>t</td></tr></table>",d=D.getElementsByTagName("td"),d[0].style.cssText="padding:0;margin:0;border:0;display:none",jc=0===d[0].offsetHeight,d[0].style.display="",d[1].style.display="none",C.reliableHiddenOffsets=jc&&0===d[0].offsetHeight,D.innerHTML="",D.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",k.swap(e,null!=e.style.zoom?
{zoom:1}:{},function(){C.boxSizing=4===D.offsetWidth}),a.getComputedStyle&&(C.pixelPosition="1%"!==(a.getComputedStyle(D,null)||{}).top,C.boxSizingReliable="4px"===(a.getComputedStyle(D,null)||{width:"4px"}).width,c=D.appendChild(z.createElement("div")),c.style.cssText=D.style.cssText="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",c.style.marginRight=c.style.width="0",D.style.width="1px",C.reliableMarginRight=!parseFloat((a.getComputedStyle(c,
null)||{}).marginRight)),typeof D.style.zoom!==E&&(D.innerHTML="",D.style.cssText="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;width:1px;padding:1px;display:inline;zoom:1",C.inlineBlockNeedsLayout=3===D.offsetWidth,D.style.display="block",D.innerHTML="<div></div>",D.firstChild.style.width="5px",C.shrinkWrapBlocks=3!==D.offsetWidth,C.inlineBlockNeedsLayout&&(e.style.zoom=1)),e.removeChild(b),b=D=d=c=null)}),Fb=jb=kb=lb=
oa=Z=null,C)}ld.support=Eb;var Fc=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,Ec=/([A-Z])/g;k.extend({cache:{},noData:{applet:!0,embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(a){return a=a.nodeType?k.cache[a[k.expando]]:a[k.expando],!!a&&!g(a)},data:function(a,b,c){return d(a,b,c)},removeData:function(a,b){return e(a,b)},_data:function(a,b,c){return d(a,b,c,!0)},_removeData:function(a,b){return e(a,b,!0)},acceptData:function(a){if(a.nodeType&&1!==a.nodeType&&9!==a.nodeType)return!1;
var b=a.nodeName&&k.noData[a.nodeName.toLowerCase()];return!b||!0!==b&&a.getAttribute("classid")===b}});k.fn.extend({data:function(a,c){var d,e,h=null,j=0,g=this[0];if(a===b){if(this.length&&(h=k.data(g),1===g.nodeType&&!k._data(g,"parsedAttrs"))){for(d=g.attributes;d.length>j;j++)e=d[j].name,0===e.indexOf("data-")&&(e=k.camelCase(e.slice(5)),f(g,e,h[e]));k._data(g,"parsedAttrs",!0)}return h}return"object"==typeof a?this.each(function(){k.data(this,a)}):1<arguments.length?this.each(function(){k.data(this,
a,c)}):g?f(g,a,k.data(g,a)):null},removeData:function(a){return this.each(function(){k.removeData(this,a)})}});k.extend({queue:function(a,c,d){var e;return a?(c=(c||"fx")+"queue",e=k._data(a,c),d&&(!e||k.isArray(d)?e=k._data(a,c,k.makeArray(d)):e.push(d)),e||[]):b},dequeue:function(a,b){var b=b||"fx",c=k.queue(a,b),d=c.length,e=c.shift(),f=k._queueHooks(a,b),h=function(){k.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--);e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,h,f));!d&&f&&f.empty.fire()},
_queueHooks:function(a,b){var c=b+"queueHooks";return k._data(a,c)||k._data(a,c,{empty:k.Callbacks("once memory").add(function(){k._removeData(a,b+"queue");k._removeData(a,c)})})}});k.fn.extend({queue:function(a,c){var d=2;return"string"!=typeof a&&(c=a,a="fx",d--),d>arguments.length?k.queue(this[0],a):c===b?this:this.each(function(){var b=k.queue(this,a,c);k._queueHooks(this,a);"fx"===a&&"inprogress"!==b[0]&&k.dequeue(this,a)})},dequeue:function(a){return this.each(function(){k.dequeue(this,a)})},
delay:function(a,b){return a=k.fx?k.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){var d,e=1,f=k.Deferred(),h=this,j=this.length,g=function(){--e||f.resolveWith(h,[h])};"string"!=typeof a&&(c=a,a=b);for(a=a||"fx";j--;)(d=k._data(h[j],a+"queueHooks"))&&d.empty&&(e++,d.empty.add(g));return g(),f.promise(c)}});var Pa,kc,Hb=/[\t\r\n\f]/g,md=/\r/g,nd=/^(?:input|select|textarea|button|object)$/i,
od=/^(?:a|area)$/i,Ib=/^(?:checked|selected)$/i,Ia=k.support.getSetAttribute,mb=k.support.input;k.fn.extend({attr:function(a,b){return k.access(this,k.attr,a,b,1<arguments.length)},removeAttr:function(a){return this.each(function(){k.removeAttr(this,a)})},prop:function(a,b){return k.access(this,k.prop,a,b,1<arguments.length)},removeProp:function(a){return a=k.propFix[a]||a,this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){var b,c,d,e,f,h=0,j=this.length;b="string"==
typeof a&&a;if(k.isFunction(a))return this.each(function(b){k(this).addClass(a.call(this,b,this.className))});if(b)for(b=(a||"").match(la)||[];j>h;h++)if(c=this[h],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(Hb," "):" ")){for(f=0;e=b[f++];)0>d.indexOf(" "+e+" ")&&(d+=e+" ");c.className=k.trim(d)}return this},removeClass:function(a){var b,c,d,e,f,h=0,j=this.length;b=0===arguments.length||"string"==typeof a&&a;if(k.isFunction(a))return this.each(function(b){k(this).removeClass(a.call(this,
b,this.className))});if(b)for(b=(a||"").match(la)||[];j>h;h++)if(c=this[h],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(Hb," "):"")){for(f=0;e=b[f++];)for(;0<=d.indexOf(" "+e+" ");)d=d.replace(" "+e+" "," ");c.className=a?k.trim(d):""}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):k.isFunction(a)?this.each(function(c){k(this).toggleClass(a.call(this,c,this.className,b),b)}):this.each(function(){if("string"===
c)for(var b,d=0,e=k(this),f=a.match(la)||[];b=f[d++];)e.hasClass(b)?e.removeClass(b):e.addClass(b);else(c===E||"boolean"===c)&&(this.className&&k._data(this,"__className__",this.className),this.className=this.className||!1===a?"":k._data(this,"__className__")||"")})},hasClass:function(a){for(var a=" "+a+" ",b=0,c=this.length;c>b;b++)if(1===this[b].nodeType&&0<=(" "+this[b].className+" ").replace(Hb," ").indexOf(a))return!0;return!1},val:function(a){var c,d,e,f=this[0];if(arguments.length)return e=
k.isFunction(a),this.each(function(c){var f;1===this.nodeType&&(f=e?a.call(this,c,k(this).val()):a,null==f?f="":"number"==typeof f?f+="":k.isArray(f)&&(f=k.map(f,function(a){return null==a?"":a+""})),d=k.valHooks[this.type]||k.valHooks[this.nodeName.toLowerCase()],d&&"set"in d&&d.set(this,f,"value")!==b||(this.value=f))});if(f)return d=k.valHooks[f.type]||k.valHooks[f.nodeName.toLowerCase()],d&&"get"in d&&(c=d.get(f,"value"))!==b?c:(c=f.value,"string"==typeof c?c.replace(md,""):null==c?"":c)}});k.extend({valHooks:{option:{get:function(a){var b=
k.find.attr(a,"value");return null!=b?b:a.text}},select:{get:function(a){for(var b,c=a.options,d=a.selectedIndex,e="select-one"===a.type||0>d,f=e?null:[],h=e?d+1:c.length,j=0>d?h:e?d:0;h>j;j++)if(b=c[j],!(!b.selected&&j!==d||(k.support.optDisabled?b.disabled:null!==b.getAttribute("disabled"))||b.parentNode.disabled&&k.nodeName(b.parentNode,"optgroup"))){if(a=k(b).val(),e)return a;f.push(a)}return f},set:function(a,b){for(var c,d,e=a.options,f=k.makeArray(b),h=e.length;h--;)d=e[h],(d.selected=0<=k.inArray(k(d).val(),
f))&&(c=!0);return c||(a.selectedIndex=-1),f}}},attr:function(a,c,d){var e,f,h=a.nodeType;if(a&&3!==h&&8!==h&&2!==h)return typeof a.getAttribute===E?k.prop(a,c,d):(1===h&&k.isXMLDoc(a)||(c=c.toLowerCase(),e=k.attrHooks[c]||(k.expr.match.bool.test(c)?kc:Pa)),d===b?e&&"get"in e&&null!==(f=e.get(a,c))?f:(f=k.find.attr(a,c),null==f?b:f):null!==d?e&&"set"in e&&(f=e.set(a,d,c))!==b?f:(a.setAttribute(c,d+""),d):(k.removeAttr(a,c),b))},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(la);if(f&&1===a.nodeType)for(;c=
f[e++];)d=k.propFix[c]||c,k.expr.match.bool.test(c)?mb&&Ia||!Ib.test(c)?a[d]=!1:a[k.camelCase("default-"+c)]=a[d]=!1:k.attr(a,c,""),a.removeAttribute(Ia?c:d)},attrHooks:{type:{set:function(a,b){if(!k.support.radioValue&&"radio"===b&&k.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(a,c,d){var e,f,h,j=a.nodeType;if(a&&3!==j&&8!==j&&2!==j)return h=1!==j||!k.isXMLDoc(a),h&&(c=k.propFix[c]||c,f=k.propHooks[c]),
d!==b?f&&"set"in f&&(e=f.set(a,d,c))!==b?e:a[c]=d:f&&"get"in f&&null!==(e=f.get(a,c))?e:a[c]},propHooks:{tabIndex:{get:function(a){var b=k.find.attr(a,"tabindex");return b?parseInt(b,10):nd.test(a.nodeName)||od.test(a.nodeName)&&a.href?0:-1}}}});kc={set:function(a,b,c){return!1===b?k.removeAttr(a,c):mb&&Ia||!Ib.test(c)?a.setAttribute(!Ia&&k.propFix[c]||c,c):a[k.camelCase("default-"+c)]=a[c]=!0,c}};k.each(k.expr.match.bool.source.match(/\w+/g),function(a,c){var d=k.expr.attrHandle[c]||k.find.attr;
k.expr.attrHandle[c]=mb&&Ia||!Ib.test(c)?function(a,c,e){var f=k.expr.attrHandle[c],a=e?b:(k.expr.attrHandle[c]=b)!=d(a,c,e)?c.toLowerCase():null;return k.expr.attrHandle[c]=f,a}:function(a,c,d){return d?b:a[k.camelCase("default-"+c)]?c.toLowerCase():null}});mb&&Ia||(k.attrHooks.value={set:function(a,c,d){return k.nodeName(a,"input")?(a.defaultValue=c,b):Pa&&Pa.set(a,c,d)}});Ia||(Pa={set:function(a,c,d){var e=a.getAttributeNode(d);return e||a.setAttributeNode(e=a.ownerDocument.createAttribute(d)),
e.value=c+="","value"===d||c===a.getAttribute(d)?c:b}},k.expr.attrHandle.id=k.expr.attrHandle.name=k.expr.attrHandle.coords=function(a,c,d){var e;return d?b:(e=a.getAttributeNode(c))&&""!==e.value?e.value:null},k.valHooks.button={get:function(a,c){var d=a.getAttributeNode(c);return d&&d.specified?d.value:b},set:Pa.set},k.attrHooks.contenteditable={set:function(a,b,c){Pa.set(a,""===b?!1:b,c)}},k.each(["width","height"],function(a,c){k.attrHooks[c]={set:function(a,d){return""===d?(a.setAttribute(c,
"auto"),d):b}}}));k.support.hrefNormalized||k.each(["href","src"],function(a,b){k.propHooks[b]={get:function(a){return a.getAttribute(b,4)}}});k.support.style||(k.attrHooks.style={get:function(a){return a.style.cssText||b},set:function(a,b){return a.style.cssText=b+""}});k.support.optSelected||(k.propHooks.selected={get:function(a){a=a.parentNode;return a&&(a.selectedIndex,a.parentNode&&a.parentNode.selectedIndex),null}});k.each("tabIndex readOnly maxLength cellSpacing cellPadding rowSpan colSpan useMap frameBorder contentEditable".split(" "),
function(){k.propFix[this.toLowerCase()]=this});k.support.enctype||(k.propFix.enctype="encoding");k.each(["radio","checkbox"],function(){k.valHooks[this]={set:function(a,c){return k.isArray(c)?a.checked=0<=k.inArray(k(a).val(),c):b}};k.support.checkOn||(k.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});var Jb=/^(?:input|select|textarea)$/i,pd=/^key/,qd=/^(?:mouse|contextmenu)|click/,lc=/^(?:focusinfocus|focusoutblur)$/,mc=/^([^.]*)(?:\.(.+)|)$/;k.event={global:{},
add:function(a,c,d,e,f){var h,j,g,n,p,m,q,u,x,r;if(g=k._data(a)){d.handler&&(n=d,d=n.handler,f=n.selector);d.guid||(d.guid=k.guid++);(j=g.events)||(j=g.events={});(m=g.handle)||(m=g.handle=function(a){return typeof k===E||a&&k.event.triggered===a.type?b:k.event.dispatch.apply(m.elem,arguments)},m.elem=a);c=(c||"").match(la)||[""];for(g=c.length;g--;)h=mc.exec(c[g])||[],x=r=h[1],h=(h[2]||"").split(".").sort(),x&&(p=k.event.special[x]||{},x=(f?p.delegateType:p.bindType)||x,p=k.event.special[x]||{},
q=k.extend({type:x,origType:r,data:e,handler:d,guid:d.guid,selector:f,needsContext:f&&k.expr.match.needsContext.test(f),namespace:h.join(".")},n),(u=j[x])||(u=j[x]=[],u.delegateCount=0,p.setup&&!1!==p.setup.call(a,e,h,m)||(a.addEventListener?a.addEventListener(x,m,!1):a.attachEvent&&a.attachEvent("on"+x,m))),p.add&&(p.add.call(a,q),q.handler.guid||(q.handler.guid=d.guid)),f?u.splice(u.delegateCount++,0,q):u.push(q),k.event.global[x]=!0);a=null}},remove:function(a,b,c,d,e){var f,h,j,g,n,p,m,q,u,x,
r,w=k.hasData(a)&&k._data(a);if(w&&(p=w.events)){b=(b||"").match(la)||[""];for(n=b.length;n--;)if(j=mc.exec(b[n])||[],u=r=j[1],x=(j[2]||"").split(".").sort(),u){m=k.event.special[u]||{};u=(d?m.delegateType:m.bindType)||u;q=p[u]||[];j=j[2]&&RegExp("(^|\\.)"+x.join("\\.(?:.*\\.|)")+"(\\.|$)");for(g=f=q.length;f--;)h=q[f],!e&&r!==h.origType||c&&c.guid!==h.guid||j&&!j.test(h.namespace)||d&&d!==h.selector&&("**"!==d||!h.selector)||(q.splice(f,1),h.selector&&q.delegateCount--,m.remove&&m.remove.call(a,
h));g&&!q.length&&(m.teardown&&!1!==m.teardown.call(a,x,w.handle)||k.removeEvent(a,u,w.handle),delete p[u])}else for(u in p)k.event.remove(a,u+b[n],c,d,!0);k.isEmptyObject(p)&&(delete w.handle,k._removeData(a,"events"))}},trigger:function(c,d,e,f){var h,j,g,n,p,m,q=[e||z],u=Ma.call(c,"type")?c.type:c;m=Ma.call(c,"namespace")?c.namespace.split("."):[];if(g=h=e=e||z,3!==e.nodeType&&8!==e.nodeType&&!lc.test(u+k.event.triggered)&&(0<=u.indexOf(".")&&(m=u.split("."),u=m.shift(),m.sort()),j=0>u.indexOf(":")&&
"on"+u,c=c[k.expando]?c:new k.Event(u,"object"==typeof c&&c),c.isTrigger=f?2:3,c.namespace=m.join("."),c.namespace_re=c.namespace?RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,c.result=b,c.target||(c.target=e),d=null==d?[c]:k.makeArray(d,[c]),p=k.event.special[u]||{},f||!p.trigger||!1!==p.trigger.apply(e,d))){if(!f&&!p.noBubble&&!k.isWindow(e)){n=p.delegateType||u;for(lc.test(n+u)||(g=g.parentNode);g;g=g.parentNode)q.push(g),h=g;h===(e.ownerDocument||z)&&q.push(h.defaultView||h.parentWindow||
a)}for(m=0;(g=q[m++])&&!c.isPropagationStopped();)c.type=1<m?n:p.bindType||u,(h=(k._data(g,"events")||{})[c.type]&&k._data(g,"handle"))&&h.apply(g,d),(h=j&&g[j])&&k.acceptData(g)&&h.apply&&!1===h.apply(g,d)&&c.preventDefault();if(c.type=u,!f&&!c.isDefaultPrevented()&&(!p._default||!1===p._default.apply(q.pop(),d))&&k.acceptData(e)&&j&&e[u]&&!k.isWindow(e)){(h=e[j])&&(e[j]=null);k.event.triggered=u;try{e[u]()}catch(x){}k.event.triggered=b;h&&(e[j]=h)}return c.result}},dispatch:function(a){var a=k.event.fix(a),
c,d,e,f,h,j=[],g=Ca.call(arguments);c=(k._data(this,"events")||{})[a.type]||[];var n=k.event.special[a.type]||{};if(g[0]=a,a.delegateTarget=this,!n.preDispatch||!1!==n.preDispatch.call(this,a)){j=k.event.handlers.call(this,a,c);for(c=0;(f=j[c++])&&!a.isPropagationStopped();){a.currentTarget=f.elem;for(h=0;(e=f.handlers[h++])&&!a.isImmediatePropagationStopped();)(!a.namespace_re||a.namespace_re.test(e.namespace))&&(a.handleObj=e,a.data=e.data,d=((k.event.special[e.origType]||{}).handle||e.handler).apply(f.elem,
g),d!==b&&!1===(a.result=d)&&(a.preventDefault(),a.stopPropagation()))}return n.postDispatch&&n.postDispatch.call(this,a),a.result}},handlers:function(a,c){var d,e,f,h,j=[],g=c.delegateCount,n=a.target;if(g&&n.nodeType&&(!a.button||"click"!==a.type))for(;n!=this;n=n.parentNode||this)if(1===n.nodeType&&(!0!==n.disabled||"click"!==a.type)){f=[];for(h=0;g>h;h++)e=c[h],d=e.selector+" ",f[d]===b&&(f[d]=e.needsContext?0<=k(d,this).index(n):k.find(d,this,null,[n]).length),f[d]&&f.push(e);f.length&&j.push({elem:n,
handlers:f})}return c.length>g&&j.push({elem:this,handlers:c.slice(g)}),j},fix:function(a){if(a[k.expando])return a;var b,c,d;b=a.type;var e=a,f=this.fixHooks[b];f||(this.fixHooks[b]=f=qd.test(b)?this.mouseHooks:pd.test(b)?this.keyHooks:{});d=f.props?this.props.concat(f.props):this.props;a=new k.Event(e);for(b=d.length;b--;)c=d[b],a[c]=e[c];return a.target||(a.target=e.srcElement||z),3===a.target.nodeType&&(a.target=a.target.parentNode),a.metaKey=!!a.metaKey,f.filter?f.filter(a,e):a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),
fixHooks:{},keyHooks:{props:["char","charCode","key","keyCode"],filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,c){var d,e,f,h=c.button,j=c.fromElement;return null==a.pageX&&null!=c.clientX&&(e=a.target.ownerDocument||z,f=e.documentElement,d=e.body,a.pageX=c.clientX+(f&&f.scrollLeft||d&&d.scrollLeft||0)-(f&&
f.clientLeft||d&&d.clientLeft||0),a.pageY=c.clientY+(f&&f.scrollTop||d&&d.scrollTop||0)-(f&&f.clientTop||d&&d.clientTop||0)),!a.relatedTarget&&j&&(a.relatedTarget=j===a.target?c.toElement:j),a.which||h===b||(a.which=1&h?1:2&h?3:4&h?2:0),a}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==n()&&this.focus)try{return this.focus(),!1}catch(a){}},delegateType:"focusin"},blur:{trigger:function(){return this===n()&&this.blur?(this.blur(),!1):b},delegateType:"focusout"},click:{trigger:function(){return k.nodeName(this,
"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):b},_default:function(a){return k.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){a.result!==b&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){a=k.extend(new k.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?k.event.trigger(a,null,b):k.event.dispatch.call(b,a);a.isDefaultPrevented()&&c.preventDefault()}};k.removeEvent=z.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,
c,!1)}:function(a,b,c){b="on"+b;a.detachEvent&&(typeof a[b]===E&&(a[b]=null),a.detachEvent(b,c))};k.Event=function(a,c){return this instanceof k.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||!1===a.returnValue||a.getPreventDefault&&a.getPreventDefault()?h:j):this.type=a,c&&k.extend(this,c),this.timeStamp=a&&a.timeStamp||k.now(),this[k.expando]=!0,b):new k.Event(a,c)};k.Event.prototype={isDefaultPrevented:j,isPropagationStopped:j,isImmediatePropagationStopped:j,
preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=h;a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=h;a&&(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=h;this.stopPropagation()}};k.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){k.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,
d=a.relatedTarget,e=a.handleObj;return(!d||d!==this&&!k.contains(this,d))&&(a.type=e.origType,c=e.handler.apply(this,arguments),a.type=b),c}}});k.support.submitBubbles||(k.event.special.submit={setup:function(){return k.nodeName(this,"form")?!1:(k.event.add(this,"click._submit keypress._submit",function(a){a=a.target;(a=k.nodeName(a,"input")||k.nodeName(a,"button")?a.form:b)&&!k._data(a,"submitBubbles")&&(k.event.add(a,"submit._submit",function(a){a._submit_bubble=!0}),k._data(a,"submitBubbles",!0))}),
b)},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&k.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){return k.nodeName(this,"form")?!1:(k.event.remove(this,"._submit"),b)}});k.support.changeBubbles||(k.event.special.change={setup:function(){return Jb.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(k.event.add(this,"propertychange._change",function(a){"checked"===a.originalEvent.propertyName&&(this._just_changed=
!0)}),k.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1);k.event.simulate("change",this,a,!0)})),!1):(k.event.add(this,"beforeactivate._change",function(a){a=a.target;Jb.test(a.nodeName)&&!k._data(a,"changeBubbles")&&(k.event.add(a,"change._change",function(a){!this.parentNode||a.isSimulated||a.isTrigger||k.event.simulate("change",this.parentNode,a,!0)}),k._data(a,"changeBubbles",!0))}),b)},handle:function(a){var c=a.target;return this!==c||a.isSimulated||
a.isTrigger||"radio"!==c.type&&"checkbox"!==c.type?a.handleObj.handler.apply(this,arguments):b},teardown:function(){return k.event.remove(this,"._change"),!Jb.test(this.nodeName)}});k.support.focusinBubbles||k.each({focus:"focusin",blur:"focusout"},function(a,b){var c=0,d=function(a){k.event.simulate(b,a.target,k.event.fix(a),!0)};k.event.special[b]={setup:function(){0===c++&&z.addEventListener(a,d,!0)},teardown:function(){0===--c&&z.removeEventListener(a,d,!0)}}});k.fn.extend({on:function(a,c,d,
e,f){var h,g;if("object"==typeof a){"string"!=typeof c&&(d=d||c,c=b);for(h in a)this.on(h,c,d,a[h],f);return this}if(null==d&&null==e?(e=c,d=c=b):null==e&&("string"==typeof c?(e=d,d=b):(e=d,d=c,c=b)),!1===e)e=j;else if(!e)return this;return 1===f&&(g=e,e=function(a){return k().off(a),g.apply(this,arguments)},e.guid=g.guid||(g.guid=k.guid++)),this.each(function(){k.event.add(this,a,e,d,c)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,c,d){var e,f;if(a&&a.preventDefault&&a.handleObj)return e=
a.handleObj,k(a.delegateTarget).off(e.namespace?e.origType+"."+e.namespace:e.origType,e.selector,e.handler),this;if("object"==typeof a){for(f in a)this.off(f,c,a[f]);return this}return(!1===c||"function"==typeof c)&&(d=c,c=b),!1===d&&(d=j),this.each(function(){k.event.remove(this,a,d,c)})},trigger:function(a,b){return this.each(function(){k.event.trigger(a,b,this)})},triggerHandler:function(a,c){var d=this[0];return d?k.event.trigger(a,c,d,!0):b}});var Gc=/^.[^:#\[\.,]*$/,rd=/^(?:parents|prev(?:Until|All))/,
nc=k.expr.match.needsContext,sd={children:!0,contents:!0,next:!0,prev:!0};k.fn.extend({find:function(a){var b,c=[],d=this,e=d.length;if("string"!=typeof a)return this.pushStack(k(a).filter(function(){for(b=0;e>b;b++)if(k.contains(d[b],this))return!0}));for(b=0;e>b;b++)k.find(a,d[b],c);return c=this.pushStack(1<e?k.unique(c):c),c.selector=this.selector?this.selector+" "+a:a,c},has:function(a){var b,c=k(a,this),d=c.length;return this.filter(function(){for(b=0;d>b;b++)if(k.contains(this,c[b]))return!0})},
not:function(a){return this.pushStack(q(this,a||[],!0))},filter:function(a){return this.pushStack(q(this,a||[],!1))},is:function(a){return!!q(this,"string"==typeof a&&nc.test(a)?k(a):a||[],!1).length},closest:function(a,b){for(var c,d=0,e=this.length,f=[],h=nc.test(a)||"string"!=typeof a?k(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(11>c.nodeType&&(h?-1<h.index(c):1===c.nodeType&&k.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(1<f.length?k.unique(f):f)},
index:function(a){return a?"string"==typeof a?k.inArray(this[0],k(a)):k.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){var c="string"==typeof a?k(a,b):k.makeArray(a&&a.nodeType?[a]:a),c=k.merge(this.get(),c);return this.pushStack(k.unique(c))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});k.each({parent:function(a){return(a=a.parentNode)&&11!==a.nodeType?a:null},parents:function(a){return k.dir(a,
"parentNode")},parentsUntil:function(a,b,c){return k.dir(a,"parentNode",c)},next:function(a){return p(a,"nextSibling")},prev:function(a){return p(a,"previousSibling")},nextAll:function(a){return k.dir(a,"nextSibling")},prevAll:function(a){return k.dir(a,"previousSibling")},nextUntil:function(a,b,c){return k.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return k.dir(a,"previousSibling",c)},siblings:function(a){return k.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return k.sibling(a.firstChild)},
contents:function(a){return k.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:k.merge([],a.childNodes)}},function(a,b){k.fn[a]=function(c,d){var e=k.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=k.filter(d,e)),1<this.length&&(sd[a]||(e=k.unique(e)),rd.test(a)&&(e=e.reverse())),this.pushStack(e)}});k.extend({filter:function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?k.find.matchesSelector(d,a)?[d]:[]:k.find.matches(a,k.grep(b,
function(a){return 1===a.nodeType}))},dir:function(a,c,d){for(var e=[],a=a[c];a&&9!==a.nodeType&&(d===b||1!==a.nodeType||!k(a).is(d));)1===a.nodeType&&e.push(a),a=a[c];return e},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}});var Rb="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",td=/ jQuery\d+="(?:null|\d+)"/g,oc=RegExp("<(?:"+Rb+")[\\s/>]",
"i"),Kb=/^\s+/,pc=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,qc=/<([\w:]+)/,rc=/<tbody/i,ud=/<|&#?\w+;/,vd=/<(?:script|style|link)/i,ob=/^(?:checkbox|radio)$/i,wd=/checked\s*(?:[^=]|=\s*.checked.)/i,sc=/^$|\/(?:java|ecma)script/i,Hc=/^true\/(.*)/,xd=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ea={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],
tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:k.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},Lb=m(z).appendChild(z.createElement("div"));ea.optgroup=ea.option;ea.tbody=ea.tfoot=ea.colgroup=ea.caption=ea.thead;ea.th=ea.td;k.fn.extend({text:function(a){return k.access(this,function(a){return a===b?k.text(this):this.empty().append((this[0]&&this[0].ownerDocument||z).createTextNode(a))},
null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&r(this,a).appendChild(a)})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=r(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,
function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?k.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||k.cleanData(w(c)),c.parentNode&&(b&&k.contains(c.ownerDocument,c)&&v(w(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++){for(1===a.nodeType&&k.cleanData(w(a,!1));a.firstChild;)a.removeChild(a.firstChild);a.options&&k.nodeName(a,"select")&&(a.options.length=0)}return this},
clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return k.clone(this,a,b)})},html:function(a){return k.access(this,function(a){var c=this[0]||{},d=0,e=this.length;if(a===b)return 1===c.nodeType?c.innerHTML.replace(td,""):b;if(!("string"!=typeof a||vd.test(a)||!k.support.htmlSerialize&&oc.test(a)||!k.support.leadingWhitespace&&Kb.test(a)||ea[(qc.exec(a)||["",""])[1].toLowerCase()])){a=a.replace(pc,"<$1></$2>");try{for(;e>d;d++)c=this[d]||{},1===c.nodeType&&(k.cleanData(w(c,
!1)),c.innerHTML=a);c=0}catch(f){}}c&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=k.map(this,function(a){return[a.nextSibling,a.parentNode]}),b=0;return this.domManip(arguments,function(c){var d=a[b++],e=a[b++];e&&(d&&d.parentNode!==e&&(d=this.nextSibling),k(this).remove(),e.insertBefore(c,d))},!0),b?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b,c){var a=Vb.apply([],a),d,e,f,h,j=0,g=this.length,n=this,p=g-1,m=a[0],q=k.isFunction(m);
if(q||!(1>=g||"string"!=typeof m||k.support.checkClone)&&wd.test(m))return this.each(function(d){var e=n.eq(d);q&&(a[0]=m.call(this,d,e.html()));e.domManip(a,b,c)});if(g&&(h=k.buildFragment(a,this[0].ownerDocument,!1,!c&&this),d=h.firstChild,1===h.childNodes.length&&(h=d),d)){f=k.map(w(h,"script"),s);for(e=f.length;g>j;j++)d=h,j!==p&&(d=k.clone(d,!0,!0),e&&k.merge(f,w(d,"script"))),b.call(this[j],d,j);if(e){h=f[f.length-1].ownerDocument;k.map(f,t);for(j=0;e>j;j++)d=f[j],sc.test(d.type||"")&&!k._data(d,
"globalEval")&&k.contains(h,d)&&(d.src?k._evalUrl(d.src):k.globalEval((d.text||d.textContent||d.innerHTML||"").replace(xd,"")))}h=d=null}return this}});k.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){k.fn[a]=function(a){for(var c=0,d=[],e=k(a),f=e.length-1;f>=c;c++)a=c===f?this:this.clone(!0),k(e[c])[b](a),qb.apply(d,a.get());return this.pushStack(d)}});k.extend({clone:function(a,b,c){var d,e,f,h,j,g=k.contains(a.ownerDocument,
a);if(k.support.html5Clone||k.isXMLDoc(a)||!oc.test("<"+a.nodeName+">")?f=a.cloneNode(!0):(Lb.innerHTML=a.outerHTML,Lb.removeChild(f=Lb.firstChild)),!(k.support.noCloneEvent&&k.support.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||k.isXMLDoc(a))){d=w(f);j=w(a);for(h=0;null!=(e=j[h]);++h)if(d[h]){var n=d[h],p=void 0,m=void 0,q=void 0;if(1===n.nodeType){if(p=n.nodeName.toLowerCase(),!k.support.noCloneEvent&&n[k.expando]){q=k._data(n);for(m in q.events)k.removeEvent(n,m,q.handle);n.removeAttribute(k.expando)}"script"===
p&&n.text!==e.text?(s(n).text=e.text,t(n)):"object"===p?(n.parentNode&&(n.outerHTML=e.outerHTML),k.support.html5Clone&&e.innerHTML&&!k.trim(n.innerHTML)&&(n.innerHTML=e.innerHTML)):"input"===p&&ob.test(e.type)?(n.defaultChecked=n.checked=e.checked,n.value!==e.value&&(n.value=e.value)):"option"===p?n.defaultSelected=n.selected=e.defaultSelected:("input"===p||"textarea"===p)&&(n.defaultValue=e.defaultValue)}}}if(b)if(c){j=j||w(a);d=d||w(f);for(h=0;null!=(e=j[h]);h++)u(e,d[h])}else u(a,f);return d=w(f,
"script"),0<d.length&&v(d,!g&&w(a,"script")),f},buildFragment:function(a,b,c,d){for(var e,f,h,j,g,n,p,q=a.length,u=m(b),x=[],r=0;q>r;r++)if(f=a[r],f||0===f)if("object"===k.type(f))k.merge(x,f.nodeType?[f]:f);else if(ud.test(f)){j=j||u.appendChild(b.createElement("div"));g=(qc.exec(f)||["",""])[1].toLowerCase();p=ea[g]||ea._default;j.innerHTML=p[1]+f.replace(pc,"<$1></$2>")+p[2];for(e=p[0];e--;)j=j.lastChild;if(!k.support.leadingWhitespace&&Kb.test(f)&&x.push(b.createTextNode(Kb.exec(f)[0])),!k.support.tbody)for(e=
(f="table"!==g||rc.test(f)?"<table>"!==p[1]||rc.test(f)?0:j:j.firstChild)&&f.childNodes.length;e--;)k.nodeName(n=f.childNodes[e],"tbody")&&!n.childNodes.length&&f.removeChild(n);k.merge(x,j.childNodes);for(j.textContent="";j.firstChild;)j.removeChild(j.firstChild);j=u.lastChild}else x.push(b.createTextNode(f));j&&u.removeChild(j);k.support.appendChecked||k.grep(w(x,"input"),y);for(r=0;f=x[r++];)if((!d||-1===k.inArray(f,d))&&(h=k.contains(f.ownerDocument,f),j=w(u.appendChild(f),"script"),h&&v(j),c))for(e=
0;f=j[e++];)sc.test(f.type||"")&&c.push(f);return u},cleanData:function(a,b){for(var c,d,e,f,h=0,j=k.expando,g=k.cache,n=k.support.deleteExpando,p=k.event.special;null!=(c=a[h]);h++)if((b||k.acceptData(c))&&(e=c[j],f=e&&g[e])){if(f.events)for(d in f.events)p[d]?k.event.remove(c,d):k.removeEvent(c,d,f.handle);g[e]&&(delete g[e],n?delete c[j]:typeof c.removeAttribute!==E?c.removeAttribute(j):c[j]=null,Ka.push(e))}},_evalUrl:function(a){return k.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,
"throws":!0})}});k.fn.extend({wrapAll:function(a){if(k.isFunction(a))return this.each(function(b){k(this).wrapAll(a.call(this,b))});if(this[0]){var b=k(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]);b.map(function(){for(var a=this;a.firstChild&&1===a.firstChild.nodeType;)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return k.isFunction(a)?this.each(function(b){k(this).wrapInner(a.call(this,b))}):this.each(function(){var b=k(this),c=
b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=k.isFunction(a);return this.each(function(c){k(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){k.nodeName(this,"body")||k(this).replaceWith(this.childNodes)}).end()}});var Ra,za,Aa,Mb=/alpha\([^)]*\)/i,yd=/opacity\s*=\s*([^)]*)/,zd=/^(top|right|bottom|left)$/,Ad=/^(none|table(?!-c[ea]).+)/,tc=/^margin/,Ic=RegExp("^("+$a+")(.*)$","i"),Xa=RegExp("^("+$a+")(?!px)[a-z%]+$","i"),Bd=RegExp("^([+-])=("+
$a+")","i"),Tb={BODY:"block"},Cd={position:"absolute",visibility:"hidden",display:"block"},uc={letterSpacing:0,fontWeight:400},ya=["Top","Right","Bottom","Left"],Sb=["Webkit","O","Moz","ms"];k.fn.extend({css:function(a,c){return k.access(this,function(a,c,d){var e,f={},h=0;if(k.isArray(c)){e=za(a);for(d=c.length;d>h;h++)f[c[h]]=k.css(a,c[h],!1,e);return f}return d!==b?k.style(a,c,d):k.css(a,c)},a,c,1<arguments.length)},show:function(){return x(this,!0)},hide:function(){return x(this)},toggle:function(a){return"boolean"==
typeof a?a?this.show():this.hide():this.each(function(){B(this)?k(this).show():k(this).hide()})}});k.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=Aa(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":k.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var f,h,j,g=k.camelCase(c),n=a.style;if(c=
k.cssProps[g]||(k.cssProps[g]=A(n,g)),j=k.cssHooks[c]||k.cssHooks[g],d===b)return j&&"get"in j&&(f=j.get(a,!1,e))!==b?f:n[c];if(h=typeof d,"string"===h&&(f=Bd.exec(d))&&(d=(f[1]+1)*f[2]+parseFloat(k.css(a,c)),h="number"),!(null==d||"number"===h&&isNaN(d)||("number"!==h||k.cssNumber[g]||(d+="px"),k.support.clearCloneStyle||""!==d||0!==c.indexOf("background")||(n[c]="inherit"),j&&"set"in j&&(d=j.set(a,d,e))===b)))try{n[c]=d}catch(p){}}},css:function(a,c,d,e){var f,h,j,g=k.camelCase(c);return c=k.cssProps[g]||
(k.cssProps[g]=A(a.style,g)),j=k.cssHooks[c]||k.cssHooks[g],j&&"get"in j&&(h=j.get(a,!0,d)),h===b&&(h=Aa(a,c,e)),"normal"===h&&c in uc&&(h=uc[c]),""===d||d?(f=parseFloat(h),!0===d||k.isNumeric(f)?f||0:h):h}});a.getComputedStyle?(za=function(b){return a.getComputedStyle(b,null)},Aa=function(a,c,d){var e,f,h,j=(d=d||za(a))?d.getPropertyValue(c)||d[c]:b,g=a.style;return d&&(""!==j||k.contains(a.ownerDocument,a)||(j=k.style(a,c)),Xa.test(j)&&tc.test(c)&&(e=g.width,f=g.minWidth,h=g.maxWidth,g.minWidth=
g.maxWidth=g.width=j,j=d.width,g.width=e,g.minWidth=f,g.maxWidth=h)),j}):z.documentElement.currentStyle&&(za=function(a){return a.currentStyle},Aa=function(a,c,d){var e,f,h,d=(d=d||za(a))?d[c]:b,j=a.style;return null==d&&j&&j[c]&&(d=j[c]),Xa.test(d)&&!zd.test(c)&&(e=j.left,f=a.runtimeStyle,h=f&&f.left,h&&(f.left=a.currentStyle.left),j.left="fontSize"===c?"1em":d,d=j.pixelLeft+"px",j.left=e,h&&(f.left=h)),""===d?"auto":d});k.each(["height","width"],function(a,c){k.cssHooks[c]={get:function(a,d,e){return d?
0===a.offsetWidth&&Ad.test(k.css(a,"display"))?k.swap(a,Cd,function(){return N(a,c,e)}):N(a,c,e):b},set:function(a,b,d){var e=d&&za(a);return K(a,b,d?L(a,c,d,k.support.boxSizing&&"border-box"===k.css(a,"boxSizing",!1,e),e):0)}}});k.support.opacity||(k.cssHooks.opacity={get:function(a,b){return yd.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?0.01*parseFloat(RegExp.$1)+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=k.isNumeric(b)?"alpha(opacity="+100*b+")":"",
f=d&&d.filter||c.filter||"";c.zoom=1;(1<=b||""===b)&&""===k.trim(f.replace(Mb,""))&&c.removeAttribute&&(c.removeAttribute("filter"),""===b||d&&!d.filter)||(c.filter=Mb.test(f)?f.replace(Mb,e):f+" "+e)}});k(function(){k.support.reliableMarginRight||(k.cssHooks.marginRight={get:function(a,c){return c?k.swap(a,{display:"inline-block"},Aa,[a,"marginRight"]):b}});!k.support.pixelPosition&&k.fn.position&&k.each(["top","left"],function(a,c){k.cssHooks[c]={get:function(a,d){return d?(d=Aa(a,c),Xa.test(d)?
k(a).position()[c]+"px":d):b}}})});k.expr&&k.expr.filters&&(k.expr.filters.hidden=function(a){return 0>=a.offsetWidth&&0>=a.offsetHeight||!k.support.reliableHiddenOffsets&&"none"===(a.style&&a.style.display||k.css(a,"display"))},k.expr.filters.visible=function(a){return!k.expr.filters.hidden(a)});k.each({margin:"",padding:"",border:"Width"},function(a,b){k.cssHooks[a+b]={expand:function(c){for(var d=0,e={},c="string"==typeof c?c.split(" "):[c];4>d;d++)e[a+ya[d]+b]=c[d]||c[d-2]||c[0];return e}};tc.test(a)||
(k.cssHooks[a+b].set=K)});var Dd=/%20/g,Jc=/\[\]$/,vc=/\r?\n/g,Ed=/^(?:submit|button|image|reset|file)$/i,Fd=/^(?:input|select|textarea|keygen)/i;k.fn.extend({serialize:function(){return k.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=k.prop(this,"elements");return a?k.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!k(this).is(":disabled")&&Fd.test(this.nodeName)&&!Ed.test(a)&&(this.checked||!ob.test(a))}).map(function(a,b){var c=
k(this).val();return null==c?null:k.isArray(c)?k.map(c,function(a){return{name:b.name,value:a.replace(vc,"\r\n")}}):{name:b.name,value:c.replace(vc,"\r\n")}}).get()}});k.param=function(a,c){var d,e=[],f=function(a,b){b=k.isFunction(b)?b():null==b?"":b;e[e.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(c===b&&(c=k.ajaxSettings&&k.ajaxSettings.traditional),k.isArray(a)||a.jquery&&!k.isPlainObject(a))k.each(a,function(){f(this.name,this.value)});else for(d in a)Ba(d,a[d],c,f);return e.join("&").replace(Dd,
"+")};k.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){k.fn[b]=function(a,c){return 0<arguments.length?this.on(b,null,a,c):this.trigger(b)}});k.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},
delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var Ja,xa,Nb=k.now(),Ob=/\?/,Gd=/#.*$/,wc=/([?&])_=[^&]*/,Hd=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Id=/^(?:GET|HEAD)$/,Jd=/^\/\//,xc=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,yc=k.fn.load,zc={},pb={},Ac="*/".concat("*");try{xa=ca.href}catch(Pd){xa=z.createElement("a"),xa.href="",xa=xa.href}Ja=xc.exec(xa.toLowerCase())||[];k.fn.load=function(a,c,d){if("string"!=
typeof a&&yc)return yc.apply(this,arguments);var e,f,h,j=this,g=a.indexOf(" ");return 0<=g&&(e=a.slice(g,a.length),a=a.slice(0,g)),k.isFunction(c)?(d=c,c=b):c&&"object"==typeof c&&(h="POST"),0<j.length&&k.ajax({url:a,type:h,dataType:"html",data:c}).done(function(a){f=arguments;j.html(e?k("<div>").append(k.parseHTML(a)).find(e):a)}).complete(d&&function(a,b){j.each(d,f||[a.responseText,b,a])}),this};k.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){k.fn[b]=
function(a){return this.on(b,a)}});k.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:xa,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Ja[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ac,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",
json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":k.parseJSON,"text xml":k.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?ba(ba(a,k.ajaxSettings),b):ba(k.ajaxSettings,a)},ajaxPrefilter:pa(zc),ajaxTransport:pa(pb),ajax:function(a,c){function d(a,c,e,f){var m,K,I,y,L=c;if(2!==A){A=2;g&&clearTimeout(g);p=b;j=f||"";t.readyState=0<a?4:0;f=200<=a&&300>a||304===a;if(e){I=q;for(var N=t,J,B,U,v,V=I.contents,ka=I.dataTypes;"*"===ka[0];)ka.shift(),B===b&&
(B=I.mimeType||N.getResponseHeader("Content-Type"));if(B)for(v in V)if(V[v]&&V[v].test(B)){ka.unshift(v);break}if(ka[0]in e)U=ka[0];else{for(v in e){if(!ka[0]||I.converters[v+" "+ka[0]]){U=v;break}J||(J=v)}U=U||J}I=U?(U!==ka[0]&&ka.unshift(U),e[U]):b}var aa;a:{e=q;J=I;B=t;U=f;var W,Q,X;I={};N=e.dataTypes.slice();if(N[1])for(W in e.converters)I[W.toLowerCase()]=e.converters[W];for(v=N.shift();v;)if(e.responseFields[v]&&(B[e.responseFields[v]]=J),!X&&U&&e.dataFilter&&(J=e.dataFilter(J,e.dataType)),
X=v,v=N.shift())if("*"===v)v=X;else if("*"!==X&&X!==v){if(W=I[X+" "+v]||I["* "+v],!W)for(aa in I)if(Q=aa.split(" "),Q[1]===v&&(W=I[X+" "+Q[0]]||I["* "+Q[0]])){!0===W?W=I[aa]:!0!==I[aa]&&(v=Q[0],N.unshift(Q[1]));break}if(!0!==W)if(W&&e["throws"])J=W(J);else try{J=W(J)}catch(Ba){aa={state:"parsererror",error:W?Ba:"No conversion from "+X+" to "+v};break a}}aa={state:"success",data:J}}I=aa;f?(q.ifModified&&(y=t.getResponseHeader("Last-Modified"),y&&(k.lastModified[h]=y),y=t.getResponseHeader("etag"),
y&&(k.etag[h]=y)),204===a||"HEAD"===q.type?L="nocontent":304===a?L="notmodified":(L=I.state,m=I.data,K=I.error,f=!K)):(K=L,(a||!L)&&(L="error",0>a&&(a=0)));t.status=a;t.statusText=(c||L)+"";f?r.resolveWith(u,[m,L,t]):r.rejectWith(u,[t,L,K]);t.statusCode(s);s=b;n&&x.trigger(f?"ajaxSuccess":"ajaxError",[t,q,f?m:K]);w.fireWith(u,[t,L]);n&&(x.trigger("ajaxComplete",[t,q]),--k.active||k.event.trigger("ajaxStop"))}}"object"==typeof a&&(c=a,a=b);var c=c||{},e,f,h,j,g,n,p,m,q=k.ajaxSetup({},c),u=q.context||
q,x=q.context&&(u.nodeType||u.jquery)?k(u):k.event,r=k.Deferred(),w=k.Callbacks("once memory"),s=q.statusCode||{},K={},y={},A=0,L="canceled",t={readyState:0,getResponseHeader:function(a){var b;if(2===A){if(!m)for(m={};b=Hd.exec(j);)m[b[1].toLowerCase()]=b[2];b=m[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===A?j:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return A||(a=y[c]=y[c]||a,K[a]=b),this},overrideMimeType:function(a){return A||(q.mimeType=
a),this},statusCode:function(a){var b;if(a)if(2>A)for(b in a)s[b]=[s[b],a[b]];else t.always(a[t.status]);return this},abort:function(a){a=a||L;return p&&p.abort(a),d(0,a),this}};if(r.promise(t).complete=w.add,t.success=t.done,t.error=t.fail,q.url=((a||q.url||xa)+"").replace(Gd,"").replace(Jd,Ja[1]+"//"),q.type=c.method||c.type||q.method||q.type,q.dataTypes=k.trim(q.dataType||"*").toLowerCase().match(la)||[""],null==q.crossDomain&&(e=xc.exec(q.url.toLowerCase()),q.crossDomain=!(!e||e[1]===Ja[1]&&e[2]===
Ja[2]&&(e[3]||("http:"===e[1]?"80":"443"))===(Ja[3]||("http:"===Ja[1]?"80":"443")))),q.data&&q.processData&&"string"!=typeof q.data&&(q.data=k.param(q.data,q.traditional)),Q(zc,q,c,t),2===A)return t;(n=q.global)&&0===k.active++&&k.event.trigger("ajaxStart");q.type=q.type.toUpperCase();q.hasContent=!Id.test(q.type);h=q.url;q.hasContent||(q.data&&(h=q.url+=(Ob.test(h)?"&":"?")+q.data,delete q.data),!1===q.cache&&(q.url=wc.test(h)?h.replace(wc,"$1_="+Nb++):h+(Ob.test(h)?"&":"?")+"_="+Nb++));q.ifModified&&
(k.lastModified[h]&&t.setRequestHeader("If-Modified-Since",k.lastModified[h]),k.etag[h]&&t.setRequestHeader("If-None-Match",k.etag[h]));(q.data&&q.hasContent&&!1!==q.contentType||c.contentType)&&t.setRequestHeader("Content-Type",q.contentType);t.setRequestHeader("Accept",q.dataTypes[0]&&q.accepts[q.dataTypes[0]]?q.accepts[q.dataTypes[0]]+("*"!==q.dataTypes[0]?", "+Ac+"; q=0.01":""):q.accepts["*"]);for(f in q.headers)t.setRequestHeader(f,q.headers[f]);if(q.beforeSend&&(!1===q.beforeSend.call(u,t,q)||
2===A))return t.abort();L="abort";for(f in{success:1,error:1,complete:1})t[f](q[f]);if(p=Q(pb,q,c,t)){t.readyState=1;n&&x.trigger("ajaxSend",[t,q]);q.async&&0<q.timeout&&(g=setTimeout(function(){t.abort("timeout")},q.timeout));try{A=1,p.send(K,d)}catch(N){if(!(2>A))throw N;d(-1,N)}}else d(-1,"No Transport");return t},getJSON:function(a,b,c){return k.get(a,b,c,"json")},getScript:function(a,c){return k.get(a,b,c,"script")}});k.each(["get","post"],function(a,c){k[c]=function(a,d,e,f){return k.isFunction(d)&&
(f=f||e,e=d,d=b),k.ajax({url:a,type:c,dataType:f,data:d,success:e})}});k.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return k.globalEval(a),a}}});k.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1);a.crossDomain&&(a.type="GET",a.global=!1)});k.ajaxTransport("script",function(a){if(a.crossDomain){var c,d=z.head||k("head")[0]||z.documentElement;
return{send:function(b,e){c=z.createElement("script");c.async=!0;a.scriptCharset&&(c.charset=a.scriptCharset);c.src=a.url;c.onload=c.onreadystatechange=function(a,b){(b||!c.readyState||/loaded|complete/.test(c.readyState))&&(c.onload=c.onreadystatechange=null,c.parentNode&&c.parentNode.removeChild(c),c=null,b||e(200,"success"))};d.insertBefore(c,d.firstChild)},abort:function(){c&&c.onload(b,!0)}}}});var Bc=[],Pb=/(=)\?(?=&|$)|\?\?/;k.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=Bc.pop()||
k.expando+"_"+Nb++;return this[a]=!0,a}});k.ajaxPrefilter("json jsonp",function(c,d,e){var f,h,j,g=!1!==c.jsonp&&(Pb.test(c.url)?"url":"string"==typeof c.data&&!(c.contentType||"").indexOf("application/x-www-form-urlencoded")&&Pb.test(c.data)&&"data");return g||"jsonp"===c.dataTypes[0]?(f=c.jsonpCallback=k.isFunction(c.jsonpCallback)?c.jsonpCallback():c.jsonpCallback,g?c[g]=c[g].replace(Pb,"$1"+f):!1!==c.jsonp&&(c.url+=(Ob.test(c.url)?"&":"?")+c.jsonp+"="+f),c.converters["script json"]=function(){return j||
k.error(f+" was not called"),j[0]},c.dataTypes[0]="json",h=a[f],a[f]=function(){j=arguments},e.always(function(){a[f]=h;c[f]&&(c.jsonpCallback=d.jsonpCallback,Bc.push(f));j&&k.isFunction(h)&&h(j[0]);j=h=b}),"script"):b});var Qa,Wa,Kd=0,Qb=a.ActiveXObject&&function(){for(var a in Qa)Qa[a](b,!0)};k.ajaxSettings.xhr=a.ActiveXObject?function(){var b;if(!(b=!this.isLocal&&X()))a:{try{b=new a.ActiveXObject("Microsoft.XMLHTTP");break a}catch(c){}b=void 0}return b}:X;Wa=k.ajaxSettings.xhr();k.support.cors=
!!Wa&&"withCredentials"in Wa;(Wa=k.support.ajax=!!Wa)&&k.ajaxTransport(function(c){if(!c.crossDomain||k.support.cors){var d;return{send:function(e,f){var h,j,g=c.xhr();if(c.username?g.open(c.type,c.url,c.async,c.username,c.password):g.open(c.type,c.url,c.async),c.xhrFields)for(j in c.xhrFields)g[j]=c.xhrFields[j];c.mimeType&&g.overrideMimeType&&g.overrideMimeType(c.mimeType);c.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest");try{for(j in e)g.setRequestHeader(j,e[j])}catch(n){}g.send(c.hasContent&&
c.data||null);d=function(a,e){var j,n,p,m;try{if(d&&(e||4===g.readyState))if(d=b,h&&(g.onreadystatechange=k.noop,Qb&&delete Qa[h]),e)4!==g.readyState&&g.abort();else{m={};j=g.status;n=g.getAllResponseHeaders();"string"==typeof g.responseText&&(m.text=g.responseText);try{p=g.statusText}catch(q){p=""}j||!c.isLocal||c.crossDomain?1223===j&&(j=204):j=m.text?200:404}}catch(u){e||f(-1,u)}m&&f(j,p,m,n)};c.async?4===g.readyState?setTimeout(d):(h=++Kd,Qb&&(Qa||(Qa={},k(a).unload(Qb)),Qa[h]=d),g.onreadystatechange=
d):d()},abort:function(){d&&d(b,!0)}}}});var La,nb,Ld=/^(?:toggle|show|hide)$/,Cc=RegExp("^(?:([+-])=|)("+$a+")([a-z%]*)$","i"),Md=/queueHooks$/,Ya=[function(a,b,c){var d,e,f,h,j,g=this,n={},p=a.style,m=a.nodeType&&B(a),q=k._data(a,"fxshow");c.queue||(h=k._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,j=h.empty.fire,h.empty.fire=function(){h.unqueued||j()}),h.unqueued++,g.always(function(){g.always(function(){h.unqueued--;k.queue(a,"fx").length||h.empty.fire()})}));1===a.nodeType&&("height"in
b||"width"in b)&&(c.overflow=[p.overflow,p.overflowX,p.overflowY],"inline"===k.css(a,"display")&&"none"===k.css(a,"float")&&(k.support.inlineBlockNeedsLayout&&"inline"!==U(a.nodeName)?p.zoom=1:p.display="inline-block"));c.overflow&&(p.overflow="hidden",k.support.shrinkWrapBlocks||g.always(function(){p.overflow=c.overflow[0];p.overflowX=c.overflow[1];p.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],Ld.exec(e))if(!(delete b[d],f=f||"toggle"===e,e===(m?"hide":"show")))n[d]=q&&q[d]||k.style(a,d);if(!k.isEmptyObject(n))for(d in q?
"hidden"in q&&(m=q.hidden):q=k._data(a,"fxshow",{}),f&&(q.hidden=!m),m?k(a).show():g.done(function(){k(a).hide()}),g.done(function(){var b;k._removeData(a,"fxshow");for(b in n)k.style(a,b,n[b])}),n)b=Sa(m?q[d]:0,d,g),d in q||(q[d]=b.start,m&&(b.end=b.start,b.start="width"===d||"height"===d?1:0))}],Ta={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=Cc.exec(b),f=e&&e[3]||(k.cssNumber[a]?"":"px"),h=(k.cssNumber[a]||"px"!==f&&+d)&&Cc.exec(k.css(c.elem,a)),j=1,g=20;if(h&&h[3]!==f){f=f||h[3];
e=e||[];h=+d||1;do j=j||".5",h/=j,k.style(c.elem,a,h+f);while(j!==(j=c.cur()/d)&&1!==j&&--g)}return e&&(h=c.start=+h||+d||0,c.unit=f,c.end=e[1]?h+(e[1]+1)*e[2]:+e[2]),c}]};k.Animation=k.extend(R,{tweener:function(a,b){k.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;e>d;d++)c=a[d],Ta[c]=Ta[c]||[],Ta[c].unshift(b)},prefilter:function(a,b){b?Ya.unshift(a):Ya.push(a)}});k.Tween=F;F.prototype={constructor:F,init:function(a,b,c,d,e,f){this.elem=a;this.prop=c;this.easing=e||"swing";
this.options=b;this.start=this.now=this.cur();this.end=d;this.unit=f||(k.cssNumber[c]?"":"px")},cur:function(){var a=F.propHooks[this.prop];return a&&a.get?a.get(this):F.propHooks._default.get(this)},run:function(a){var b,c=F.propHooks[this.prop];return this.pos=b=this.options.duration?k.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):F.propHooks._default.set(this),
this}};F.prototype.init.prototype=F.prototype;F.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=k.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop]},set:function(a){k.fx.step[a.prop]?k.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[k.cssProps[a.prop]]||k.cssHooks[a.prop])?k.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}};F.propHooks.scrollTop=F.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&
(a.elem[a.prop]=a.now)}};k.each(["toggle","show","hide"],function(a,b){var c=k.fn[b];k.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(T(b,!0),a,d,e)}});k.fn.extend({fadeTo:function(a,b,c,d){return this.filter(B).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=k.isEmptyObject(a),f=k.speed(b,c,d),b=function(){var b=R(this,k.extend({},a),f);(e||k._data(this,"finish"))&&b.stop(!0)};return b.finish=b,e||!1===f.queue?
this.each(b):this.queue(f.queue,b)},stop:function(a,c,d){var e=function(a){var b=a.stop;delete a.stop;b(d)};return"string"!=typeof a&&(d=c,c=a,a=b),c&&!1!==a&&this.queue(a||"fx",[]),this.each(function(){var b=!0,c=null!=a&&a+"queueHooks",f=k.timers,h=k._data(this);if(c)h[c]&&h[c].stop&&e(h[c]);else for(c in h)h[c]&&h[c].stop&&Md.test(c)&&e(h[c]);for(c=f.length;c--;)f[c].elem!==this||null!=a&&f[c].queue!==a||(f[c].anim.stop(d),b=!1,f.splice(c,1));(b||!d)&&k.dequeue(this,a)})},finish:function(a){return!1!==
a&&(a=a||"fx"),this.each(function(){var b,c=k._data(this),d=c[a+"queue"];b=c[a+"queueHooks"];var e=k.timers,f=d?d.length:0;c.finish=!0;k.queue(this,a,[]);b&&b.stop&&b.stop.call(this,!0);for(b=e.length;b--;)e[b].elem===this&&e[b].queue===a&&(e[b].anim.stop(!0),e.splice(b,1));for(b=0;f>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}});k.each({slideDown:T("show"),slideUp:T("hide"),slideToggle:T("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},
function(a,b){k.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}});k.speed=function(a,b,c){var d=a&&"object"==typeof a?k.extend({},a):{complete:c||!c&&b||k.isFunction(a)&&a,duration:a,easing:c&&b||b&&!k.isFunction(b)&&b};return d.duration=k.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in k.fx.speeds?k.fx.speeds[d.duration]:k.fx.speeds._default,(null==d.queue||!0===d.queue)&&(d.queue="fx"),d.old=d.complete,d.complete=function(){k.isFunction(d.old)&&d.old.call(this);d.queue&&k.dequeue(this,
d.queue)},d};k.easing={linear:function(a){return a},swing:function(a){return 0.5-Math.cos(a*Math.PI)/2}};k.timers=[];k.fx=F.prototype.init;k.fx.tick=function(){var a,c=k.timers,d=0;for(La=k.now();c.length>d;d++)a=c[d],a()||c[d]!==a||c.splice(d--,1);c.length||k.fx.stop();La=b};k.fx.timer=function(a){a()&&k.timers.push(a)&&k.fx.start()};k.fx.interval=13;k.fx.start=function(){nb||(nb=setInterval(k.fx.tick,k.fx.interval))};k.fx.stop=function(){clearInterval(nb);nb=null};k.fx.speeds={slow:600,fast:200,
_default:400};k.fx.step={};k.expr&&k.expr.filters&&(k.expr.filters.animated=function(a){return k.grep(k.timers,function(b){return a===b.elem}).length});k.fn.offset=function(a){if(arguments.length)return a===b?this:this.each(function(b){k.offset.setOffset(this,a,b)});var c,d,e={top:0,left:0},f=this[0],h=f&&f.ownerDocument;if(h)return c=h.documentElement,k.contains(c,f)?(typeof f.getBoundingClientRect!==E&&(e=f.getBoundingClientRect()),d=O(h),{top:e.top+(d.pageYOffset||c.scrollTop)-(c.clientTop||0),
left:e.left+(d.pageXOffset||c.scrollLeft)-(c.clientLeft||0)}):e};k.offset={setOffset:function(a,b,c){var d=k.css(a,"position");"static"===d&&(a.style.position="relative");var e=k(a),f=e.offset(),h=k.css(a,"top"),j=k.css(a,"left"),g={},n={},p,m;("absolute"===d||"fixed"===d)&&-1<k.inArray("auto",[h,j])?(n=e.position(),p=n.top,m=n.left):(p=parseFloat(h)||0,m=parseFloat(j)||0);k.isFunction(b)&&(b=b.call(a,c,f));null!=b.top&&(g.top=b.top-f.top+p);null!=b.left&&(g.left=b.left-f.left+m);"using"in b?b.using.call(a,
g):e.css(g)}};k.fn.extend({position:function(){if(this[0]){var a,b,c={top:0,left:0},d=this[0];return"fixed"===k.css(d,"position")?b=d.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),k.nodeName(a[0],"html")||(c=a.offset()),c.top+=k.css(a[0],"borderTopWidth",!0),c.left+=k.css(a[0],"borderLeftWidth",!0)),{top:b.top-c.top-k.css(d,"marginTop",!0),left:b.left-c.left-k.css(d,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||Ub;a&&!k.nodeName(a,
"html")&&"static"===k.css(a,"position");)a=a.offsetParent;return a||Ub})}});k.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,c){var d=/Y/.test(c);k.fn[a]=function(e){return k.access(this,function(a,e,f){var h=O(a);return f===b?h?c in h?h[c]:h.document.documentElement[e]:a[e]:(h?h.scrollTo(d?k(h).scrollLeft():f,d?f:k(h).scrollTop()):a[e]=f,b)},a,e,arguments.length,null)}});k.each({Height:"height",Width:"width"},function(a,c){k.each({padding:"inner"+a,content:c,"":"outer"+a},function(d,
e){k.fn[e]=function(e,f){var h=arguments.length&&(d||"boolean"!=typeof e),j=d||(!0===e||!0===f?"margin":"border");return k.access(this,function(c,d,e){var f;return k.isWindow(c)?c.document.documentElement["client"+a]:9===c.nodeType?(f=c.documentElement,Math.max(c.body["scroll"+a],f["scroll"+a],c.body["offset"+a],f["offset"+a],f["client"+a])):e===b?k.css(c,d,j):k.style(c,d,e,j)},c,h?e:b,h,null)}})});k.fn.size=function(){return this.length};k.fn.andSelf=k.fn.addBack;"object"==typeof module&&module&&
"object"==typeof module.exports?module.exports=k:(a.jQuery=a.$=k,"function"==typeof define&&define.amd&&define("jquery",[],function(){return k}))})(window);
(function(a){function b(b){var c=b||window.event,d=[].slice.call(arguments,1),h=0,j=0,n=0;return b=a.event.fix(c),b.type="mousewheel",c.wheelDelta&&(h=c.wheelDelta/120),c.detail&&(h=-c.detail/3),n=h,void 0!==c.axis&&c.axis===c.HORIZONTAL_AXIS&&(n=0,j=-1*h),void 0!==c.wheelDeltaY&&(n=c.wheelDeltaY/120),void 0!==c.wheelDeltaX&&(j=-1*c.wheelDeltaX/120),d.unshift(b,h,j,n),(a.event.dispatch||a.event.handle).apply(this,d)}var c=["DOMMouseScroll","mousewheel"];if(a.event.fixHooks)for(var d=c.length;d;)a.event.fixHooks[c[--d]]=
a.event.mouseHooks;a.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var a=c.length;a;)this.addEventListener(c[--a],b,!1);else this.onmousewheel=b},teardown:function(){if(this.removeEventListener)for(var a=c.length;a;)this.removeEventListener(c[--a],b,!1);else this.onmousewheel=null}};a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})})(jQuery);
(function(a,b,c){var d,e,f,g;f={paneClass:"pane",sliderClass:"slider",contentClass:"content",iOSNativeScrolling:!1,preventPageScrolling:!1,disableResize:!1,alwaysVisible:!1,flashDelay:1500,sliderMinHeight:20,sliderMaxHeight:null};d="Microsoft Internet Explorer"===b.navigator.appName&&/msie 7./i.test(b.navigator.appVersion)&&b.ActiveXObject;e=null;g=function(){var a,b;a=c.createElement("div");b=a.style;b.position="absolute";b.width="100px";b.height="100px";b.overflow="scroll";b.top="-9999px";c.body.appendChild(a);
b=a.offsetWidth-a.clientWidth;c.body.removeChild(a);return b};var h=function(d,f){this.el=d;this.options=f;e||(e=g());this.$el=a(this.el);this.doc=a(c);this.win=a(b);this.generate();this.createEvents();this.addEvents();this.reset()};h.prototype.preventScrolling=function(a,b){this.isActive&&("DOMMouseScroll"===a.type?("down"===b&&0<a.originalEvent.detail||"up"===b&&0>a.originalEvent.detail)&&a.preventDefault():"mousewheel"===a.type&&a.originalEvent&&a.originalEvent.wheelDelta&&("down"===b&&0>a.originalEvent.wheelDelta||
"up"===b&&0<a.originalEvent.wheelDelta)&&a.preventDefault())};h.prototype.updateScrollValues=function(){var a;a=this.content;this.maxScrollTop=a.scrollHeight-a.clientHeight;this.contentScrollTop=a.scrollTop;this.maxSliderTop=this.paneHeight-this.sliderHeight;this.sliderTop=this.contentScrollTop*this.maxSliderTop/this.maxScrollTop};h.prototype.createEvents=function(){var a=this;this.events={down:function(b){a.isBeingDragged=!0;a.offsetY=b.pageY-a.slider.offset().top;a.pane.addClass("active");a.doc.bind("mousemove",
a.events.drag).bind("mouseup",a.events.up);return!1},drag:function(b){a.sliderY=b.pageY-a.$el.offset().top-a.offsetY;a.scroll();a.updateScrollValues();a.contentScrollTop>=a.maxScrollTop?a.$el.trigger("scrollend"):0===a.contentScrollTop&&a.$el.trigger("scrolltop");return!1},up:function(){a.isBeingDragged=!1;a.pane.removeClass("active");a.doc.unbind("mousemove",a.events.drag).unbind("mouseup",a.events.up);return!1},resize:function(){a.reset()},panedown:function(b){a.sliderY=(b.offsetY||b.originalEvent.layerY)-
0.5*a.sliderHeight;a.scroll();a.events.down(b);return!1},scroll:function(b){a.isBeingDragged||(a.updateScrollValues(),a.sliderY=a.sliderTop,a.slider.css({top:a.sliderTop}),null!=b&&(a.contentScrollTop>=a.maxScrollTop?(a.options.preventPageScrolling&&a.preventScrolling(b,"down"),a.$el.trigger("scrollend")):0===a.contentScrollTop&&(a.options.preventPageScrolling&&a.preventScrolling(b,"up"),a.$el.trigger("scrolltop"))))},wheel:function(b){if(null!=b)return a.sliderY+=-b.wheelDeltaY||-b.delta,a.scroll(),
!1}}};h.prototype.addEvents=function(){var a;this.removeEvents();a=this.events;this.options.disableResize||this.win.bind("resize",a.resize);this.slider.bind("mousedown",a.down);this.pane.bind("mousedown",a.panedown).bind("mousewheel DOMMouseScroll",a.wheel);this.$content.bind("scroll mousewheel DOMMouseScroll touchmove",a.scroll)};h.prototype.removeEvents=function(){var a;a=this.events;this.win.unbind("resize",a.resize);this.slider.unbind();this.pane.unbind();this.$content.unbind("scroll mousewheel DOMMouseScroll touchmove",
a.scroll)};h.prototype.generate=function(){var a,b,c,d,f;c=this.options;d=c.paneClass;f=c.sliderClass;a=c.contentClass;!this.$el.find(""+d).length&&!this.$el.find(""+f).length&&this.$el.append('<div class="'+d+'"><div class="'+f+'" /></div>');this.$content=this.$el.children("."+a);this.$content.attr("tabindex",0);this.content=this.$content[0];this.slider=this.$el.find("."+f);this.pane=this.$el.find("."+d);e&&(b="rtl"===this.$el.css("direction")?{left:-e}:{right:-e},this.$el.addClass("has-scrollbar"));
c.iOSNativeScrolling&&(b||(b={}),b.WebkitOverflowScrolling="touch");null!=b&&this.$content.css(b);return this};h.prototype.restore=function(){this.stopped=!1;this.pane.show();this.addEvents()};h.prototype.reset=function(){var a,b,c,f,h,g,s;this.$el.find("."+this.options.paneClass).length||this.generate().stop();this.stopped&&this.restore();a=this.content;c=a.style;f=c.overflowY;d&&this.$content.css({height:this.$content.height()});b=a.scrollHeight+e;g=this.pane.outerHeight();s=parseInt(this.pane.css("top"),
10);h=parseInt(this.pane.css("bottom"),10);h=g+s+h;s=Math.round(h/b*h);s<this.options.sliderMinHeight?s=this.options.sliderMinHeight:null!=this.options.sliderMaxHeight&&s>this.options.sliderMaxHeight&&(s=this.options.sliderMaxHeight);"scroll"===f&&"scroll"!==c.overflowX&&(s+=e);this.maxSliderTop=h-s;this.contentHeight=b;this.paneHeight=g;this.paneOuterHeight=h;this.sliderHeight=s;this.slider.height(s);this.events.scroll();this.pane.show();this.isActive=!0;a.scrollHeight===a.clientHeight||this.pane.outerHeight(!0)>=
a.scrollHeight&&"scroll"!==f?(this.pane.hide(),this.isActive=!1):this.el.clientHeight===a.scrollHeight&&"scroll"===f?this.slider.hide():this.slider.show();this.pane.css({opacity:this.options.alwaysVisible?1:"",visibility:this.options.alwaysVisible?"visible":""});return this};h.prototype.scroll=function(){if(this.isActive)return this.sliderY=Math.max(0,this.sliderY),this.sliderY=Math.min(this.maxSliderTop,this.sliderY),this.$content.scrollTop(-1*((this.paneHeight-this.contentHeight+e)*this.sliderY/
this.maxSliderTop)),this.slider.css({top:this.sliderY}),this};h.prototype.scrollBottom=function(a){if(this.isActive)return this.reset(),this.$content.scrollTop(this.contentHeight-this.$content.height()-a).trigger("mousewheel"),this};h.prototype.scrollTop=function(a){if(this.isActive)return this.reset(),this.$content.scrollTop(+a).trigger("mousewheel"),this};h.prototype.scrollTo=function(b){if(this.isActive)return this.reset(),this.scrollTop(a(b).get(0).offsetTop),this};h.prototype.stop=function(){this.stopped=
!0;this.removeEvents();this.pane.hide();return this};h.prototype.flash=function(){var a=this;if(this.isActive)return this.reset(),this.pane.addClass("flashed"),setTimeout(function(){a.pane.removeClass("flashed")},this.options.flashDelay),this};a.fn.nanoScroller=function(b){return this.each(function(){var c;if(!(c=this.nanoscroller))c=a.extend({},f,b),this.nanoscroller=c=new h(this,c);if(b&&"object"===typeof b){a.extend(c.options,b);if(b.scrollBottom)return c.scrollBottom(b.scrollBottom);if(b.scrollTop)return c.scrollTop(b.scrollTop);
if(b.scrollTo)return c.scrollTo(b.scrollTo);if("bottom"===b.scroll)return c.scrollBottom(0);if("top"===b.scroll)return c.scrollTop(0);if(b.scroll&&b.scroll instanceof a)return c.scrollTo(b.scroll);if(b.stop)return c.stop();if(b.flash)return c.flash()}return c.reset()})}})(jQuery,window,document);
(function(a,b){function c(b,c){var e,f,g,m=b.nodeName.toLowerCase();return"area"===m?(e=b.parentNode,f=e.name,!b.href||!f||"map"!==e.nodeName.toLowerCase()?!1:(g=a("img[usemap=#"+f+"]")[0],!!g&&d(g))):(/input|select|textarea|button|object/.test(m)?!b.disabled:"a"===m?b.href||c:c)&&d(b)}function d(b){return a.expr.filters.visible(b)&&!a(b).parents().andSelf().filter(function(){return"hidden"===a.css(this,"visibility")}).length}var e=0,f=/^ui-id-\d+$/;a.ui=a.ui||{};if(!a.ui.version){a.extend(a.ui,{version:"1.9.1",
keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}});a.fn.extend({_focus:a.fn.focus,focus:function(b,c){return"number"==typeof b?this.each(function(){var d=this;setTimeout(function(){a(d).focus();c&&c.call(d)},b)}):this._focus.apply(this,arguments)},scrollParent:function(){var b;return a.ui.ie&&
/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?b=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.css(this,"position"))&&/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0):b=this.parents().filter(function(){return/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(c){if(c!==
b)return this.css("zIndex",c);if(this.length)for(var c=a(this[0]),d;c.length&&c[0]!==document;){d=c.css("position");if("absolute"===d||"relative"===d||"fixed"===d)if(d=parseInt(c.css("zIndex"),10),!isNaN(d)&&0!==d)return d;c=c.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})},removeUniqueId:function(){return this.each(function(){f.test(this.id)&&a(this).removeAttr("id")})}});a("<a>").outerWidth(1).jquery||a.each(["Width","Height"],function(c,d){function e(b,
c,d,h){return a.each(f,function(){c-=parseFloat(a.css(b,"padding"+this))||0;d&&(c-=parseFloat(a.css(b,"border"+this+"Width"))||0);h&&(c-=parseFloat(a.css(b,"margin"+this))||0)}),c}var f="Width"===d?["Left","Right"]:["Top","Bottom"],g=d.toLowerCase(),m={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+d]=function(c){return c===b?m["inner"+d].call(this):this.each(function(){a(this).css(g,e(this,c)+"px")})};a.fn["outer"+d]=
function(b,c){return"number"!=typeof b?m["outer"+d].call(this,b):this.each(function(){a(this).css(g,e(this,b,!0,c)+"px")})}});a.extend(a.expr[":"],{data:a.expr.createPseudo?a.expr.createPseudo(function(b){return function(c){return!!a.data(c,b)}}):function(b,c,d){return!!a.data(b,d[3])},focusable:function(b){return c(b,!isNaN(a.attr(b,"tabindex")))},tabbable:function(b){var d=a.attr(b,"tabindex"),e=isNaN(d);return(e||0<=d)&&c(b,!e)}});a(function(){var b=document.body,c=b.appendChild(c=document.createElement("div"));
c.offsetHeight;a.extend(c.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});a.support.minHeight=100===c.offsetHeight;a.support.selectstart="onselectstart"in c;b.removeChild(c).style.display="none"});var g=/msie ([\w.]+)/.exec(navigator.userAgent.toLowerCase())||[];a.ui.ie=g.length?!0:!1;a.ui.ie6=6===parseFloat(g[1],10);a.fn.extend({disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},
enableSelection:function(){return this.unbind(".ui-disableSelection")}});a.extend(a.ui,{plugin:{add:function(b,c,d){var e,b=a.ui[b].prototype;for(e in d)b.plugins[e]=b.plugins[e]||[],b.plugins[e].push([c,d[e]])},call:function(a,b,c){var d=a.plugins[b];if(d&&a.element[0].parentNode&&11!==a.element[0].parentNode.nodeType)for(b=0;b<d.length;b++)a.options[d[b][0]]&&d[b][1].apply(a.element,c)}},contains:a.contains,hasScroll:function(b,c){if("hidden"===a(b).css("overflow"))return!1;var d=c&&"left"===c?
"scrollLeft":"scrollTop";return 0<b[d]?!0:(b[d]=1,b[d]=0,!1)},isOverAxis:function(a,b,c){return a>b&&a<b+c},isOver:function(b,c,d,e,f,g){return a.ui.isOverAxis(b,d,f)&&a.ui.isOverAxis(c,e,g)}})}})(jQuery);
(function(a,b){var c=0,d=Array.prototype.slice,e=a.cleanData;a.cleanData=function(b){for(var c=0,d;null!=(d=b[c]);c++)try{a(d).triggerHandler("remove")}catch(j){}e(b)};a.widget=function(b,c,d){var e,n,p,q,m=b.split(".")[0],b=b.split(".")[1];e=m+"-"+b;d||(d=c,c=a.Widget);a.expr[":"][e.toLowerCase()]=function(b){return!!a.data(b,e)};a[m]=a[m]||{};n=a[m][b];p=a[m][b]=function(a,b){if(!this._createWidget)return new p(a,b);arguments.length&&this._createWidget(a,b)};a.extend(p,n,{version:d.version,_proto:a.extend({},
d),_childConstructors:[]});q=new c;q.options=a.widget.extend({},q.options);a.each(d,function(b,e){if(a.isFunction(e)){var f=function(){return c.prototype[b].apply(this,arguments)},j=function(a){return c.prototype[b].apply(this,a)};d[b]=function(){var a=this._super,b=this._superApply,c;return this._super=f,this._superApply=j,c=e.apply(this,arguments),this._super=a,this._superApply=b,c}}});p.prototype=a.widget.extend(q,{widgetEventPrefix:q.widgetEventPrefix||b},d,{constructor:p,namespace:m,widgetName:b,
widgetBaseClass:e,widgetFullName:e});n?(a.each(n._childConstructors,function(b,c){var d=c.prototype;a.widget(d.namespace+"."+d.widgetName,p,c._proto)}),delete n._childConstructors):c._childConstructors.push(p);a.widget.bridge(b,p)};a.widget.extend=function(c){for(var e=d.call(arguments,1),h=0,j=e.length,n,p;h<j;h++)for(n in e[h])p=e[h][n],e[h].hasOwnProperty(n)&&p!==b&&(a.isPlainObject(p)?c[n]=a.isPlainObject(c[n])?a.widget.extend({},c[n],p):a.widget.extend({},p):c[n]=p);return c};a.widget.bridge=
function(c,e){var h=e.prototype.widgetFullName;a.fn[c]=function(j){var n="string"==typeof j,p=d.call(arguments,1),q=this;return j=!n&&p.length?a.widget.extend.apply(null,[j].concat(p)):j,n?this.each(function(){var d,e=a.data(this,h);if(!e)return a.error("cannot call methods on "+c+" prior to initialization; attempted to call method '"+j+"'");if(!a.isFunction(e[j])||"_"===j.charAt(0))return a.error("no such method '"+j+"' for "+c+" widget instance");d=e[j].apply(e,p);if(d!==e&&d!==b)return q=d&&d.jquery?
q.pushStack(d.get()):d,!1}):this.each(function(){var b=a.data(this,h);b?b.option(j||{})._init():new e(j,this)}),q}};a.Widget=function(){};a.Widget._childConstructors=[];a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(b,d){d=a(d||this.defaultElement||this)[0];this.element=a(d);this.uuid=c++;this.eventNamespace="."+this.widgetName+this.uuid;this.options=a.widget.extend({},this.options,this._getCreateOptions(),
b);this.bindings=a();this.hoverable=a();this.focusable=a();d!==this&&(a.data(d,this.widgetName,this),a.data(d,this.widgetFullName,this),this._on(this.element,{remove:function(a){a.target===d&&this.destroy()}}),this.document=a(d.style?d.ownerDocument:d.document||d),this.window=a(this.document[0].defaultView||this.document[0].parentWindow));this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:a.noop,_getCreateEventData:a.noop,_create:a.noop,_init:a.noop,
destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(a.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:a.noop,widget:function(){return this.element},
option:function(c,d){var e=c,j,n,p;if(0===arguments.length)return a.widget.extend({},this.options);if("string"==typeof c)if(e={},j=c.split("."),c=j.shift(),j.length){n=e[c]=a.widget.extend({},this.options[c]);for(p=0;p<j.length-1;p++)n[j[p]]=n[j[p]]||{},n=n[j[p]];c=j.pop();if(d===b)return n[c]===b?null:n[c];n[c]=d}else{if(d===b)return this.options[c]===b?null:this.options[c];e[c]=d}return this._setOptions(e),this},_setOptions:function(a){for(var b in a)this._setOption(b,a[b]);return this},_setOption:function(a,
b){return this.options[a]=b,"disabled"===a&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!b).attr("aria-disabled",b),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(b,c){var d,e=this;c?(b=d=a(b),this.bindings=this.bindings.add(b)):(c=b,b=this.element,d=this.widget());a.each(c,function(c,g){function q(){if(!(!0===
e.options.disabled||a(this).hasClass("ui-state-disabled")))return("string"==typeof g?e[g]:g).apply(e,arguments)}"string"!=typeof g&&(q.guid=g.guid=g.guid||q.guid||a.guid++);var m=c.match(/^(\w+)\s*(.*)$/),r=m[1]+e.eventNamespace;(m=m[2])?d.delegate(m,r,q):b.bind(r,q)})},_off:function(a,b){b=(b||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;a.unbind(b).undelegate(b)},_delay:function(a,b){var c=this;return setTimeout(function(){return("string"==typeof a?c[a]:a).apply(c,arguments)},
b||0)},_hoverable:function(b){this.hoverable=this.hoverable.add(b);this._on(b,{mouseenter:function(b){a(b.currentTarget).addClass("ui-state-hover")},mouseleave:function(b){a(b.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(b){this.focusable=this.focusable.add(b);this._on(b,{focusin:function(b){a(b.currentTarget).addClass("ui-state-focus")},focusout:function(b){a(b.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(b,c,d){var e,n=this.options[b],d=d||{},c=a.Event(c);
c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase();c.target=this.element[0];if(b=c.originalEvent)for(e in b)e in c||(c[e]=b[e]);return this.element.trigger(c,d),!(a.isFunction(n)&&!1===n.apply(this.element[0],[c].concat(d))||c.isDefaultPrevented())}};a.each({show:"fadeIn",hide:"fadeOut"},function(b,c){a.Widget.prototype["_"+b]=function(d,e,n){"string"==typeof e&&(e={effect:e});var p,q=e?!0===e||"number"==typeof e?c:e.effect||c:b,e=e||{};"number"==typeof e&&(e={duration:e});
p=!a.isEmptyObject(e);e.complete=n;e.delay&&d.delay(e.delay);p&&a.effects&&(a.effects.effect[q]||!1!==a.uiBackCompat&&a.effects[q])?d[b](e):q!==b&&d[q]?d[q](e.duration,e.easing,n):d.queue(function(c){a(this)[b]();n&&n.call(d[0]);c()})}});!1!==a.uiBackCompat&&(a.Widget.prototype._getCreateOptions=function(){return a.metadata&&a.metadata.get(this.element[0])[this.widgetName]})})(jQuery);
(function(a){var b=!1;a(document).mouseup(function(){b=!1});a.widget("ui.mouse",{version:"1.9.1",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(d){if(!0===a.data(d.target,b.widgetName+".preventClickEvent"))return a.removeData(d.target,b.widgetName+".preventClickEvent"),d.stopImmediatePropagation(),!1});this.started=!1},
_mouseDestroy:function(){this.element.unbind("."+this.widgetName);this._mouseMoveDelegate&&a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(c){if(!b){this._mouseStarted&&this._mouseUp(c);this._mouseDownEvent=c;var d=this,e=1===c.which,f="string"==typeof this.options.cancel&&c.target.nodeName?a(c.target).closest(this.options.cancel).length:!1;if(!e||f||!this._mouseCapture(c))return!0;(this.mouseDelayMet=
!this.options.delay)||(this._mouseDelayTimer=setTimeout(function(){d.mouseDelayMet=!0},this.options.delay));return this._mouseDistanceMet(c)&&this._mouseDelayMet(c)&&(this._mouseStarted=!1!==this._mouseStart(c),!this._mouseStarted)?(c.preventDefault(),!0):(!0===a.data(c.target,this.widgetName+".preventClickEvent")&&a.removeData(c.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return d._mouseMove(a)},this._mouseUpDelegate=function(a){return d._mouseUp(a)},a(document).bind("mousemove."+
this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),c.preventDefault(),b=!0,!0)}},_mouseMove:function(b){return!a.ui.ie||9<=document.documentMode||b.button?this._mouseStarted?(this._mouseDrag(b),b.preventDefault()):(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,b),this._mouseStarted?this._mouseDrag(b):this._mouseUp(b)),!this._mouseStarted):this._mouseUp(b)},_mouseUp:function(b){return a(document).unbind("mousemove."+
this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,b.target===this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b)),!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},
_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})})(jQuery);
(function(a,b){function c(a,b,c){return[parseInt(a[0],10)*(q.test(a[0])?b/100:1),parseInt(a[1],10)*(q.test(a[1])?c/100:1)]}a.ui=a.ui||{};var d,e=Math.max,f=Math.abs,g=Math.round,h=/left|center|right/,j=/top|center|bottom/,n=/[\+\-]\d+%?/,p=/^\w+/,q=/%$/,m=a.fn.position;a.position={scrollbarWidth:function(){if(d!==b)return d;var c,e,f=a("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),h=f.children()[0];return a("body").append(f),
c=h.offsetWidth,f.css("overflow","scroll"),e=h.offsetWidth,c===e&&(e=f[0].clientWidth),f.remove(),d=c-e},getScrollInfo:function(b){var c=b.isWindow?"":b.element.css("overflow-x"),d=b.isWindow?"":b.element.css("overflow-y"),d="scroll"===d||"auto"===d&&b.height<b.element[0].scrollHeight;return{width:"scroll"===c||"auto"===c&&b.width<b.element[0].scrollWidth?a.position.scrollbarWidth():0,height:d?a.position.scrollbarWidth():0}},getWithinInfo:function(b){var b=a(b||window),c=a.isWindow(b[0]);return{element:b,
isWindow:c,offset:b.offset()||{left:0,top:0},scrollLeft:b.scrollLeft(),scrollTop:b.scrollTop(),width:c?b.width():b.outerWidth(),height:c?b.height():b.outerHeight()}}};a.fn.position=function(b){if(!b||!b.of)return m.apply(this,arguments);var b=a.extend({},b),d,q,u,w,r,s=a(b.of),y=a.position.getWithinInfo(b.within),t=a.position.getScrollInfo(y),v=s[0],Q=(b.collision||"flip").split(" "),ba={};return 9===v.nodeType?(q=s.width(),u=s.height(),w={top:0,left:0}):a.isWindow(v)?(q=s.width(),u=s.height(),w=
{top:s.scrollTop(),left:s.scrollLeft()}):v.preventDefault?(b.at="left top",q=u=0,w={top:v.pageY,left:v.pageX}):(q=s.outerWidth(),u=s.outerHeight(),w=s.offset()),r=a.extend({},w),a.each(["my","at"],function(){var a=(b[this]||"").split(" "),c,d;1===a.length&&(a=h.test(a[0])?a.concat(["center"]):j.test(a[0])?["center"].concat(a):["center","center"]);a[0]=h.test(a[0])?a[0]:"center";a[1]=j.test(a[1])?a[1]:"center";c=n.exec(a[0]);d=n.exec(a[1]);ba[this]=[c?c[0]:0,d?d[0]:0];b[this]=[p.exec(a[0])[0],p.exec(a[1])[0]]}),
1===Q.length&&(Q[1]=Q[0]),"right"===b.at[0]?r.left+=q:"center"===b.at[0]&&(r.left+=q/2),"bottom"===b.at[1]?r.top+=u:"center"===b.at[1]&&(r.top+=u/2),d=c(ba.at,q,u),r.left+=d[0],r.top+=d[1],this.each(function(){var h,j,n=a(this),p=n.outerWidth(),m=n.outerHeight(),v=parseInt(a.css(this,"marginLeft"),10)||0,pa=parseInt(a.css(this,"marginTop"),10)||0,ma=p+v+(parseInt(a.css(this,"marginRight"),10)||0)+t.width,ra=m+pa+(parseInt(a.css(this,"marginBottom"),10)||0)+t.height,E=a.extend({},r),ca=c(ba.my,n.outerWidth(),
n.outerHeight());"right"===b.my[0]?E.left-=p:"center"===b.my[0]&&(E.left-=p/2);"bottom"===b.my[1]?E.top-=m:"center"===b.my[1]&&(E.top-=m/2);E.left+=ca[0];E.top+=ca[1];a.support.offsetFractions||(E.left=g(E.left),E.top=g(E.top));h={marginLeft:v,marginTop:pa};a.each(["left","top"],function(c,e){a.ui.position[Q[c]]&&a.ui.position[Q[c]][e](E,{targetWidth:q,targetHeight:u,elemWidth:p,elemHeight:m,collisionPosition:h,collisionWidth:ma,collisionHeight:ra,offset:[d[0]+ca[0],d[1]+ca[1]],my:b.my,at:b.at,within:y,
elem:n})});a.fn.bgiframe&&n.bgiframe();b.using&&(j=function(a){var c=w.left-E.left,d=c+q-p,h=w.top-E.top,g=h+u-m,j={target:{element:s,left:w.left,top:w.top,width:q,height:u},element:{element:n,left:E.left,top:E.top,width:p,height:m},horizontal:0>d?"left":0<c?"right":"center",vertical:0>g?"top":0<h?"bottom":"middle"};q<p&&f(c+d)<q&&(j.horizontal="center");u<m&&f(h+g)<u&&(j.vertical="middle");e(f(c),f(d))>e(f(h),f(g))?j.important="horizontal":j.important="vertical";b.using.call(this,a,j)});n.offset(a.extend(E,
{using:j}))})};a.ui.position={fit:{left:function(a,b){var c=b.within,d=c.isWindow?c.scrollLeft:c.offset.left,c=c.width,f=a.left-b.collisionPosition.marginLeft,h=d-f,g=f+b.collisionWidth-c-d,j;b.collisionWidth>c?0<h&&0>=g?(j=a.left+h+b.collisionWidth-c-d,a.left+=h-j):0<g&&0>=h?a.left=d:h>g?a.left=d+c-b.collisionWidth:a.left=d:0<h?a.left+=h:0<g?a.left-=g:a.left=e(a.left-f,a.left)},top:function(a,b){var c=b.within,c=c.isWindow?c.scrollTop:c.offset.top,d=b.within.height,f=a.top-b.collisionPosition.marginTop,
h=c-f,g=f+b.collisionHeight-d-c,j;b.collisionHeight>d?0<h&&0>=g?(j=a.top+h+b.collisionHeight-d-c,a.top+=h-j):0<g&&0>=h?a.top=c:h>g?a.top=c+d-b.collisionHeight:a.top=c:0<h?a.top+=h:0<g?a.top-=g:a.top=e(a.top-f,a.top)}},flip:{left:function(a,b){var c=b.within,d=c.offset.left+c.scrollLeft,e=c.width,h=c.isWindow?c.scrollLeft:c.offset.left,g=a.left-b.collisionPosition.marginLeft,c=g-h,j=g+b.collisionWidth-e-h,g="left"===b.my[0]?-b.elemWidth:"right"===b.my[0]?b.elemWidth:0,n="left"===b.at[0]?b.targetWidth:
"right"===b.at[0]?-b.targetWidth:0,p=-2*b.offset[0];if(0>c){if(d=a.left+g+n+p+b.collisionWidth-e-d,0>d||d<f(c))a.left+=g+n+p}else if(0<j&&(d=a.left-b.collisionPosition.marginLeft+g+n+p-h,0<d||f(d)<j))a.left+=g+n+p},top:function(a,b){var c=b.within,d=c.offset.top+c.scrollTop,e=c.height,c=c.isWindow?c.scrollTop:c.offset.top,h=a.top-b.collisionPosition.marginTop,g=h-c,h=h+b.collisionHeight-e-c,j="top"===b.my[1]?-b.elemHeight:"bottom"===b.my[1]?b.elemHeight:0,n="top"===b.at[1]?b.targetHeight:"bottom"===
b.at[1]?-b.targetHeight:0,p=-2*b.offset[1],m,q;0>g?(q=a.top+j+n+p+b.collisionHeight-e-d,a.top+j+n+p>g&&(0>q||q<f(g))&&(a.top+=j+n+p)):0<h&&(m=a.top-b.collisionPosition.marginTop+j+n+p-c,a.top+j+n+p>h&&(0<m||f(m)<h)&&(a.top+=j+n+p))}},flipfit:{left:function(){a.ui.position.flip.left.apply(this,arguments);a.ui.position.fit.left.apply(this,arguments)},top:function(){a.ui.position.flip.top.apply(this,arguments);a.ui.position.fit.top.apply(this,arguments)}}};var r,s,t,v,u=document.getElementsByTagName("body")[0];
t=document.createElement("div");r=document.createElement(u?"div":"body");s={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};u&&a.extend(s,{position:"absolute",left:"-1000px",top:"-1000px"});for(v in s)r.style[v]=s[v];r.appendChild(t);s=u||document.documentElement;s.insertBefore(r,s.firstChild);t.style.cssText="position: absolute; left: 10.7432222px;";t=a(t).offset().left;a.support.offsetFractions=10<t&&11>t;r.innerHTML="";s.removeChild(r);if(!1!==a.uiBackCompat){var w=jQuery,
y=w.fn.position;w.fn.position=function(a){if(!a||!a.offset)return y.call(this,a);var c=a.offset.split(" "),d=a.at.split(" ");return 1===c.length&&(c[1]=c[0]),/^\d/.test(c[0])&&(c[0]="+"+c[0]),/^\d/.test(c[1])&&(c[1]="+"+c[1]),1===d.length&&(/left|center|right/.test(d[0])?d[1]="center":(d[1]=d[0],d[0]="center")),y.call(this,w.extend(a,{at:d[0]+c[0]+" "+d[1]+c[1],offset:b}))}}})(jQuery);
(function(a){a.widget("ui.draggable",a.ui.mouse,{version:"1.9.1",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){"original"==this.options.helper&&!/^(?:r|a|f)/.test(this.element.css("position"))&&
(this.element[0].style.position="relative");this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy()},_mouseCapture:function(b){var c=this.options;return this.helper||c.disabled||a(b.target).is(".ui-resizable-handle")?!1:(this.handle=this._getHandle(b),this.handle?(a(!0===c.iframeFix?
"iframe":c.iframeFix).each(function(){a('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1E3}).css(a(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(b){var c=this.options;return this.helper=this._createHelper(b),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),a.ui.ddmanager&&(a.ui.ddmanager.current=this),this._cacheMargins(),
this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,
c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt),c.containment&&this._setContainment(),!1===this._trigger("start",b)?(this._clear(),!1):(this._cacheHelperProportions(),a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this._mouseDrag(b,!0),a.ui.ddmanager&&a.ui.ddmanager.dragStart(this,b),!0)},_mouseDrag:function(b,c){this.position=this._generatePosition(b);this.positionAbs=this._convertPositionTo("absolute");if(!c){var d=this._uiHash();if(!1===this._trigger("drag",b,d))return this._mouseUp({}),
!1;this.position=d.position}if(!this.options.axis||"y"!=this.options.axis)this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||"x"!=this.options.axis)this.helper[0].style.top=this.position.top+"px";return a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),!1},_mouseStop:function(b){var c=!1;a.ui.ddmanager&&!this.options.dropBehaviour&&(c=a.ui.ddmanager.drop(this,b));this.dropped&&(c=this.dropped,this.dropped=!1);for(var d=this.element[0],e=!1;d&&(d=d.parentNode);)d==document&&(e=!0);
if(!e&&"original"===this.options.helper)return!1;if("invalid"==this.options.revert&&!c||"valid"==this.options.revert&&c||!0===this.options.revert||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,c)){var f=this;a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==f._trigger("stop",b)&&f._clear()})}else!1!==this._trigger("stop",b)&&this._clear();return!1},_mouseUp:function(b){return a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),
a.ui.ddmanager&&a.ui.ddmanager.dragStop(this,b),a.ui.mouse.prototype._mouseUp.call(this,b)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(b){var c=!this.options.handle||!a(this.options.handle,this.element).length?!0:!1;return a(this.options.handle,this.element).find("*").andSelf().each(function(){this==b.target&&(c=!0)}),c},_createHelper:function(b){var c=this.options,b=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],
[b])):"clone"==c.helper?this.element.clone().removeAttr("id"):this.element;return b.parents("body").length||b.appendTo("parent"==c.appendTo?this.element[0].parentNode:c.appendTo),b[0]!=this.element[0]&&!/(fixed|absolute)/.test(b.css("position"))&&b.css("position","absolute"),b},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" "));a.isArray(b)&&(b={left:+b[0],top:+b[1]||0});"left"in b&&(this.offset.click.left=b.left+this.margins.left);"right"in b&&(this.offset.click.left=this.helperProportions.width-
b.right+this.margins.left);"top"in b&&(this.offset.click.top=b.top+this.margins.top);"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();"absolute"==this.cssPosition&&this.scrollParent[0]!=document&&a.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==
document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&a.ui.ie)b={top:0,left:0};return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var a=this.element.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||
0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b=this.options;"parent"==b.containment&&
(b.containment=this.helper[0].parentNode);if("document"==b.containment||"window"==b.containment)this.containment=["document"==b.containment?0:a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,"document"==b.containment?0:a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,("document"==b.containment?0:a(window).scrollLeft())+a("document"==b.containment?document:window).width()-this.helperProportions.width-this.margins.left,("document"==b.containment?0:a(window).scrollTop())+
(a("document"==b.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(b.containment)&&b.containment.constructor!=Array){var b=a(b.containment),c=b[0];if(c){b.offset();var d="hidden"!=a(c).css("overflow");this.containment=[(parseInt(a(c).css("borderLeftWidth"),10)||0)+(parseInt(a(c).css("paddingLeft"),10)||0),(parseInt(a(c).css("borderTopWidth"),10)||0)+(parseInt(a(c).css("paddingTop"),10)||
0),(d?Math.max(c.scrollWidth,c.offsetWidth):c.offsetWidth)-(parseInt(a(c).css("borderLeftWidth"),10)||0)-(parseInt(a(c).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(d?Math.max(c.scrollHeight,c.offsetHeight):c.offsetHeight)-(parseInt(a(c).css("borderTopWidth"),10)||0)-(parseInt(a(c).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];this.relative_container=b}}else b.containment.constructor==Array&&(this.containment=
b.containment)},_convertPositionTo:function(b,c){c||(c=this.position);var d="absolute"==b?1:-1,e="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,f=/(html|body)/i.test(e[0].tagName);return{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-("fixed"==this.cssPosition?-this.scrollParent.scrollTop():f?0:e.scrollTop())*d,left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-("fixed"==
this.cssPosition?-this.scrollParent.scrollLeft():f?0:e.scrollLeft())*d}},_generatePosition:function(b){var c=this.options,d="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,e=/(html|body)/i.test(d[0].tagName),f=b.pageX,g=b.pageY;if(this.originalPosition){var h;this.containment&&(this.relative_container?(h=this.relative_container.offset(),h=[this.containment[0]+h.left,this.containment[1]+h.top,this.containment[2]+
h.left,this.containment[3]+h.top]):h=this.containment,b.pageX-this.offset.click.left<h[0]&&(f=h[0]+this.offset.click.left),b.pageY-this.offset.click.top<h[1]&&(g=h[1]+this.offset.click.top),b.pageX-this.offset.click.left>h[2]&&(f=h[2]+this.offset.click.left),b.pageY-this.offset.click.top>h[3]&&(g=h[3]+this.offset.click.top));c.grid&&(g=c.grid[1]?this.originalPageY+Math.round((g-this.originalPageY)/c.grid[1])*c.grid[1]:this.originalPageY,g=h?g-this.offset.click.top<h[1]||g-this.offset.click.top>h[3]?
g-this.offset.click.top<h[1]?g+c.grid[1]:g-c.grid[1]:g:g,f=c.grid[0]?this.originalPageX+Math.round((f-this.originalPageX)/c.grid[0])*c.grid[0]:this.originalPageX,f=h?f-this.offset.click.left<h[0]||f-this.offset.click.left>h[2]?f-this.offset.click.left<h[0]?f+c.grid[0]:f-c.grid[0]:f:f)}return{top:g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"==this.cssPosition?-this.scrollParent.scrollTop():e?0:d.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-
this.offset.parent.left+("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():e?0:d.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove();this.helper=null;this.cancelHelperRemoval=!1},_trigger:function(b,c,d){return d=d||this._uiHash(),a.ui.plugin.call(this,b,[c,d]),"drag"==b&&(this.positionAbs=this._convertPositionTo("absolute")),a.Widget.prototype._trigger.call(this,b,c,d)},plugins:{},
_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});a.ui.plugin.add("draggable","connectToSortable",{start:function(b,c){var d=a(this).data("draggable"),e=d.options,f=a.extend({},c,{item:d.element});d.sortables=[];a(e.connectToSortable).each(function(){var c=a.data(this,"sortable");c&&!c.options.disabled&&(d.sortables.push({instance:c,shouldRevert:c.options.revert}),c.refreshPositions(),c._trigger("activate",b,f))})},
stop:function(b,c){var d=a(this).data("draggable"),e=a.extend({},c,{item:d.element});a.each(d.sortables,function(){this.instance.isOver?(this.instance.isOver=0,d.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(b),this.instance.options.helper=this.instance.options._helper,"original"==d.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",
b,e))})},drag:function(b,c){var d=a(this).data("draggable"),e=this;a.each(d.sortables,function(){var f=!1,g=this;this.instance.positionAbs=d.positionAbs;this.instance.helperProportions=d.helperProportions;this.instance.offset.click=d.offset.click;this.instance._intersectsWith(this.instance.containerCache)&&(f=!0,a.each(d.sortables,function(){return this.instance.positionAbs=d.positionAbs,this.instance.helperProportions=d.helperProportions,this.instance.offset.click=d.offset.click,this!=g&&this.instance._intersectsWith(this.instance.containerCache)&&
a.ui.contains(g.instance.element[0],this.instance.element[0])&&(f=!1),f}));f?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=a(e).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return c.helper[0]},b.target=this.instance.currentItem[0],this.instance._mouseCapture(b,!0),this.instance._mouseStart(b,!0,!0),this.instance.offset.click.top=d.offset.click.top,
this.instance.offset.click.left=d.offset.click.left,this.instance.offset.parent.left-=d.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=d.offset.parent.top-this.instance.offset.parent.top,d._trigger("toSortable",b),d.dropped=this.instance.element,d.currentItem=d.element,this.instance.fromOutside=d),this.instance.currentItem&&this.instance._mouseDrag(b)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=
!1,this.instance._trigger("out",b,this.instance._uiHash(this.instance)),this.instance._mouseStop(b,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),d._trigger("fromSortable",b),d.dropped=!1)})}});a.ui.plugin.add("draggable","cursor",{start:function(){var b=a("body"),c=a(this).data("draggable").options;b.css("cursor")&&(c._cursor=b.css("cursor"));b.css("cursor",c.cursor)},stop:function(){var b=
a(this).data("draggable").options;b._cursor&&a("body").css("cursor",b._cursor)}});a.ui.plugin.add("draggable","opacity",{start:function(b,c){var d=a(c.helper),e=a(this).data("draggable").options;d.css("opacity")&&(e._opacity=d.css("opacity"));d.css("opacity",e.opacity)},stop:function(b,c){var d=a(this).data("draggable").options;d._opacity&&a(c.helper).css("opacity",d._opacity)}});a.ui.plugin.add("draggable","scroll",{start:function(){var b=a(this).data("draggable");b.scrollParent[0]!=document&&"HTML"!=
b.scrollParent[0].tagName&&(b.overflowOffset=b.scrollParent.offset())},drag:function(b){var c=a(this).data("draggable"),d=c.options,e=!1;if(c.scrollParent[0]!=document&&"HTML"!=c.scrollParent[0].tagName){if(!d.axis||"x"!=d.axis)c.overflowOffset.top+c.scrollParent[0].offsetHeight-b.pageY<d.scrollSensitivity?c.scrollParent[0].scrollTop=e=c.scrollParent[0].scrollTop+d.scrollSpeed:b.pageY-c.overflowOffset.top<d.scrollSensitivity&&(c.scrollParent[0].scrollTop=e=c.scrollParent[0].scrollTop-d.scrollSpeed);
if(!d.axis||"y"!=d.axis)c.overflowOffset.left+c.scrollParent[0].offsetWidth-b.pageX<d.scrollSensitivity?c.scrollParent[0].scrollLeft=e=c.scrollParent[0].scrollLeft+d.scrollSpeed:b.pageX-c.overflowOffset.left<d.scrollSensitivity&&(c.scrollParent[0].scrollLeft=e=c.scrollParent[0].scrollLeft-d.scrollSpeed)}else{if(!d.axis||"x"!=d.axis)b.pageY-a(document).scrollTop()<d.scrollSensitivity?e=a(document).scrollTop(a(document).scrollTop()-d.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<
d.scrollSensitivity&&(e=a(document).scrollTop(a(document).scrollTop()+d.scrollSpeed));if(!d.axis||"y"!=d.axis)b.pageX-a(document).scrollLeft()<d.scrollSensitivity?e=a(document).scrollLeft(a(document).scrollLeft()-d.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<d.scrollSensitivity&&(e=a(document).scrollLeft(a(document).scrollLeft()+d.scrollSpeed))}!1!==e&&a.ui.ddmanager&&!d.dropBehaviour&&a.ui.ddmanager.prepareOffsets(c,b)}});a.ui.plugin.add("draggable","snap",{start:function(){var b=
a(this).data("draggable"),c=b.options;b.snapElements=[];a(c.snap.constructor!=String?c.snap.items||":data(draggable)":c.snap).each(function(){var c=a(this),e=c.offset();this!=b.element[0]&&b.snapElements.push({item:this,width:c.outerWidth(),height:c.outerHeight(),top:e.top,left:e.left})})},drag:function(b,c){for(var d=a(this).data("draggable"),e=d.options,f=e.snapTolerance,g=c.offset.left,h=g+d.helperProportions.width,j=c.offset.top,n=j+d.helperProportions.height,p=d.snapElements.length-1;0<=p;p--){var q=
d.snapElements[p].left,m=q+d.snapElements[p].width,r=d.snapElements[p].top,s=r+d.snapElements[p].height;if(q-f<g&&g<m+f&&r-f<j&&j<s+f||q-f<g&&g<m+f&&r-f<n&&n<s+f||q-f<h&&h<m+f&&r-f<j&&j<s+f||q-f<h&&h<m+f&&r-f<n&&n<s+f){if("inner"!=e.snapMode){var t=Math.abs(r-n)<=f,v=Math.abs(s-j)<=f,u=Math.abs(q-h)<=f,w=Math.abs(m-g)<=f;t&&(c.position.top=d._convertPositionTo("relative",{top:r-d.helperProportions.height,left:0}).top-d.margins.top);v&&(c.position.top=d._convertPositionTo("relative",{top:s,left:0}).top-
d.margins.top);u&&(c.position.left=d._convertPositionTo("relative",{top:0,left:q-d.helperProportions.width}).left-d.margins.left);w&&(c.position.left=d._convertPositionTo("relative",{top:0,left:m}).left-d.margins.left)}var y=t||v||u||w;"outer"!=e.snapMode&&(t=Math.abs(r-j)<=f,v=Math.abs(s-n)<=f,u=Math.abs(q-g)<=f,w=Math.abs(m-h)<=f,t&&(c.position.top=d._convertPositionTo("relative",{top:r,left:0}).top-d.margins.top),v&&(c.position.top=d._convertPositionTo("relative",{top:s-d.helperProportions.height,
left:0}).top-d.margins.top),u&&(c.position.left=d._convertPositionTo("relative",{top:0,left:q}).left-d.margins.left),w&&(c.position.left=d._convertPositionTo("relative",{top:0,left:m-d.helperProportions.width}).left-d.margins.left));!d.snapElements[p].snapping&&(t||v||u||w||y)&&d.options.snap.snap&&d.options.snap.snap.call(d.element,b,a.extend(d._uiHash(),{snapItem:d.snapElements[p].item}));d.snapElements[p].snapping=t||v||u||w||y}else d.snapElements[p].snapping&&d.options.snap.release&&d.options.snap.release.call(d.element,
b,a.extend(d._uiHash(),{snapItem:d.snapElements[p].item})),d.snapElements[p].snapping=!1}}});a.ui.plugin.add("draggable","stack",{start:function(){var b=a(this).data("draggable").options,b=a.makeArray(a(b.stack)).sort(function(b,c){return(parseInt(a(b).css("zIndex"),10)||0)-(parseInt(a(c).css("zIndex"),10)||0)});if(b.length){var c=parseInt(b[0].style.zIndex)||0;a(b).each(function(a){this.style.zIndex=c+a});this[0].style.zIndex=c+b.length}}});a.ui.plugin.add("draggable","zIndex",{start:function(b,
c){var d=a(c.helper),e=a(this).data("draggable").options;d.css("zIndex")&&(e._zIndex=d.css("zIndex"));d.css("zIndex",e.zIndex)},stop:function(b,c){var d=a(this).data("draggable").options;d._zIndex&&a(c.helper).css("zIndex",d._zIndex)}})})(jQuery);
(function(a){a.widget("ui.sortable",a.ui.mouse,{version:"1.9.1",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1E3},_create:function(){var a=this.options;this.containerCache={};this.element.addClass("ui-sortable");
this.refresh();this.floating=this.items.length?"x"===a.axis||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):!1;this.offset=this.element.offset();this._mouseInit();this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled");this._mouseDestroy();for(var a=this.items.length-1;0<=a;a--)this.items[a].item.removeData(this.widgetName+"-item");return this},_setOption:function(b,c){"disabled"===b?(this.options[b]=
c,this.widget().toggleClass("ui-sortable-disabled",!!c)):a.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(b,c){var d=this;if(this.reverting||this.options.disabled||"static"==this.options.type)return!1;this._refreshItems(b);var e=null;a(b.target).parents().each(function(){if(a.data(this,d.widgetName+"-item")==d)return e=a(this),!1});a.data(b.target,d.widgetName+"-item")==d&&(e=a(b.target));if(!e)return!1;if(this.options.handle&&!c){var f=!1;a(this.options.handle,e).find("*").andSelf().each(function(){this==
b.target&&(f=!0)});if(!f)return!1}return this.currentItem=e,this._removeCurrentsFromItems(),!0},_mouseStart:function(b,c,d){c=this.options;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(b);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};a.extend(this.offset,{click:{left:b.pageX-this.offset.left,
top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");this.originalPosition=this._generatePosition(b);this.originalPageX=b.pageX;this.originalPageY=b.pageY;c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt);this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};this.helper[0]!=this.currentItem[0]&&this.currentItem.hide();this._createPlaceholder();
c.containment&&this._setContainment();c.cursor&&(a("body").css("cursor")&&(this._storedCursor=a("body").css("cursor")),a("body").css("cursor",c.cursor));c.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",c.opacity));c.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",c.zIndex));this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset());
this._trigger("start",b,this._uiHash());this._preserveHelperProportions||this._cacheHelperProportions();if(!d)for(d=this.containers.length-1;0<=d;d--)this.containers[d]._trigger("activate",b,this._uiHash(this));return a.ui.ddmanager&&(a.ui.ddmanager.current=this),a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(b),!0},_mouseDrag:function(b){this.position=this._generatePosition(b);this.positionAbs=this._convertPositionTo("absolute");
this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs);if(this.options.scroll){var c=this.options,d=!1;this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-b.pageY<c.scrollSensitivity?this.scrollParent[0].scrollTop=d=this.scrollParent[0].scrollTop+c.scrollSpeed:b.pageY-this.overflowOffset.top<c.scrollSensitivity&&(this.scrollParent[0].scrollTop=d=this.scrollParent[0].scrollTop-c.scrollSpeed),this.overflowOffset.left+
this.scrollParent[0].offsetWidth-b.pageX<c.scrollSensitivity?this.scrollParent[0].scrollLeft=d=this.scrollParent[0].scrollLeft+c.scrollSpeed:b.pageX-this.overflowOffset.left<c.scrollSensitivity&&(this.scrollParent[0].scrollLeft=d=this.scrollParent[0].scrollLeft-c.scrollSpeed)):(b.pageY-a(document).scrollTop()<c.scrollSensitivity?d=a(document).scrollTop(a(document).scrollTop()-c.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<c.scrollSensitivity&&(d=a(document).scrollTop(a(document).scrollTop()+
c.scrollSpeed)),b.pageX-a(document).scrollLeft()<c.scrollSensitivity?d=a(document).scrollLeft(a(document).scrollLeft()-c.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<c.scrollSensitivity&&(d=a(document).scrollLeft(a(document).scrollLeft()+c.scrollSpeed)));!1!==d&&a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b)}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||"y"!=this.options.axis)this.helper[0].style.left=this.position.left+"px";
if(!this.options.axis||"x"!=this.options.axis)this.helper[0].style.top=this.position.top+"px";for(c=this.items.length-1;0<=c;c--){var d=this.items[c],e=d.item[0],f=this._intersectsWithPointer(d);if(f&&d.instance===this.currentContainer&&e!=this.currentItem[0]&&this.placeholder[1==f?"next":"prev"]()[0]!=e&&!a.contains(this.placeholder[0],e)&&("semi-dynamic"==this.options.type?!a.contains(this.element[0],e):1)){this.direction=1==f?"down":"up";if("pointer"!=this.options.tolerance&&!this._intersectsWithSides(d))break;
this._rearrange(b,d);this._trigger("change",b,this._uiHash());break}}return this._contactContainers(b),a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),this._trigger("sort",b,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(b,c){if(b){a.ui.ddmanager&&!this.options.dropBehaviour&&a.ui.ddmanager.drop(this,b);if(this.options.revert){var d=this,e=this.placeholder.offset();this.reverting=!0;a(this.helper).animate({left:e.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]==
document.body?0:this.offsetParent[0].scrollLeft),top:e.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){d._clear(b)})}else this._clear(b,c);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null});"original"==this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var b=this.containers.length-1;0<=b;b--)this.containers[b]._trigger("deactivate",
null,this._uiHash(this)),this.containers[b].containerCache.over&&(this.containers[b]._trigger("out",null,this._uiHash(this)),this.containers[b].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!=this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),a.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?a(this.domPosition.prev).after(this.currentItem):
a(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];return b=b||{},a(c).each(function(){var c=(a(b.item||this).attr(b.attribute||"id")||"").match(b.expression||/(.+)[-=_](.+)/);c&&d.push((b.key||c[1]+"[]")+"="+(b.key&&b.expression?c[1]:c[2]))}),!d.length&&b.key&&d.push(b.key+"="),d.join("&")},toArray:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];return b=b||{},c.each(function(){d.push(a(b.item||this).attr(b.attribute||
"id")||"")}),d},_intersectsWith:function(a){var c=this.positionAbs.left,d=c+this.helperProportions.width,e=this.positionAbs.top,f=e+this.helperProportions.height,g=a.left,h=g+a.width,j=a.top,n=j+a.height,p=this.offset.click.top,q=this.offset.click.left;return"pointer"==this.options.tolerance||this.options.forcePointerForContainers||"pointer"!=this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>a[this.floating?"width":"height"]?e+p>j&&e+p<n&&c+q>g&&c+q<h:g<c+this.helperProportions.width/
2&&d-this.helperProportions.width/2<h&&j<e+this.helperProportions.height/2&&f-this.helperProportions.height/2<n},_intersectsWithPointer:function(b){var c="x"===this.options.axis||a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,b.top,b.height),b="y"===this.options.axis||a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,b.left,b.width),c=c&&b,b=this._getDragVerticalDirection(),d=this._getDragHorizontalDirection();return c?this.floating?d&&"right"==d||"down"==b?2:1:b&&("down"==
b?2:1):!1},_intersectsWithSides:function(b){var c=a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,b.top+b.height/2,b.height),b=a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,b.left+b.width/2,b.width),d=this._getDragVerticalDirection(),e=this._getDragHorizontalDirection();return this.floating&&e?"right"==e&&b||"left"==e&&!b:d&&("down"==d&&c||"up"==d&&!c)},_getDragVerticalDirection:function(){var a=this.positionAbs.top-this.lastPositionAbs.top;return 0!=a&&(0<a?"down":"up")},
_getDragHorizontalDirection:function(){var a=this.positionAbs.left-this.lastPositionAbs.left;return 0!=a&&(0<a?"right":"left")},refresh:function(a){return this._refreshItems(a),this.refreshPositions(),this},_connectWith:function(){var a=this.options;return a.connectWith.constructor==String?[a.connectWith]:a.connectWith},_getItemsAsjQuery:function(b){var c=[],d=[],e=this._connectWith();if(e&&b)for(b=e.length-1;0<=b;b--)for(var f=a(e[b]),g=f.length-1;0<=g;g--){var h=a.data(f[g],this.widgetName);h&&
h!=this&&!h.options.disabled&&d.push([a.isFunction(h.options.items)?h.options.items.call(h.element):a(h.options.items,h.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),h])}d.push([a.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):a(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(b=d.length-1;0<=b;b--)d[b][0].each(function(){c.push(this)});return a(c)},_removeCurrentsFromItems:function(){var b=
this.currentItem.find(":data("+this.widgetName+"-item)");this.items=a.grep(this.items,function(a){for(var d=0;d<b.length;d++)if(b[d]==a.item[0])return!1;return!0})},_refreshItems:function(b){this.items=[];this.containers=[this];var c=this.items,d=[[a.isFunction(this.options.items)?this.options.items.call(this.element[0],b,{item:this.currentItem}):a(this.options.items,this.element),this]],e=this._connectWith();if(e&&this.ready)for(var f=e.length-1;0<=f;f--)for(var g=a(e[f]),h=g.length-1;0<=h;h--){var j=
a.data(g[h],this.widgetName);j&&j!=this&&!j.options.disabled&&(d.push([a.isFunction(j.options.items)?j.options.items.call(j.element[0],b,{item:this.currentItem}):a(j.options.items,j.element),j]),this.containers.push(j))}for(f=d.length-1;0<=f;f--){b=d[f][1];e=d[f][0];h=0;for(g=e.length;h<g;h++)j=a(e[h]),j.data(this.widgetName+"-item",b),c.push({item:j,instance:b,width:0,height:0,left:0,top:0})}},refreshPositions:function(b){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());
for(var c=this.items.length-1;0<=c;c--){var d=this.items[c];if(!(d.instance!=this.currentContainer&&this.currentContainer&&d.item[0]!=this.currentItem[0])){var e=this.options.toleranceElement?a(this.options.toleranceElement,d.item):d.item;b||(d.width=e.outerWidth(),d.height=e.outerHeight());e=e.offset();d.left=e.left;d.top=e.top}}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(c=this.containers.length-1;0<=c;c--)e=this.containers[c].element.offset(),
this.containers[c].containerCache.left=e.left,this.containers[c].containerCache.top=e.top,this.containers[c].containerCache.width=this.containers[c].element.outerWidth(),this.containers[c].containerCache.height=this.containers[c].element.outerHeight();return this},_createPlaceholder:function(b){var b=b||this,c=b.options;if(!c.placeholder||c.placeholder.constructor==String){var d=c.placeholder;c.placeholder={element:function(){var c=a(document.createElement(b.currentItem[0].nodeName)).addClass(d||
b.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];return d||(c.style.visibility="hidden"),c},update:function(a,f){if(!d||c.forcePlaceholderSize)f.height()||f.height(b.currentItem.innerHeight()-parseInt(b.currentItem.css("paddingTop")||0,10)-parseInt(b.currentItem.css("paddingBottom")||0,10)),f.width()||f.width(b.currentItem.innerWidth()-parseInt(b.currentItem.css("paddingLeft")||0,10)-parseInt(b.currentItem.css("paddingRight")||0,10))}}}b.placeholder=a(c.placeholder.element.call(b.element,
b.currentItem));b.currentItem.after(b.placeholder);c.placeholder.update(b,b.placeholder)},_contactContainers:function(b){for(var c=null,d=null,e=this.containers.length-1;0<=e;e--)if(!a.contains(this.currentItem[0],this.containers[e].element[0]))if(this._intersectsWith(this.containers[e].containerCache)){if(!c||!a.contains(this.containers[e].element[0],c.element[0]))c=this.containers[e],d=e}else this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",b,this._uiHash(this)),this.containers[e].containerCache.over=
0);if(c)if(1===this.containers.length)this.containers[d]._trigger("over",b,this._uiHash(this)),this.containers[d].containerCache.over=1;else{for(var c=1E4,e=null,f=this.containers[d].floating?"left":"top",g=this.containers[d].floating?"width":"height",h=this.positionAbs[f]+this.offset.click[f],j=this.items.length-1;0<=j;j--)if(a.contains(this.containers[d].element[0],this.items[j].item[0])&&this.items[j].item[0]!=this.currentItem[0]){var n=this.items[j].item.offset()[f],p=!1;Math.abs(n-h)>Math.abs(n+
this.items[j][g]-h)&&(p=!0,n+=this.items[j][g]);Math.abs(n-h)<c&&(c=Math.abs(n-h),e=this.items[j],this.direction=p?"up":"down")}if(e||this.options.dropOnEmpty)this.currentContainer=this.containers[d],e?this._rearrange(b,e,null,!0):this._rearrange(b,null,this.containers[d].element,!0),this._trigger("change",b,this._uiHash()),this.containers[d]._trigger("change",b,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[d]._trigger("over",b,this._uiHash(this)),
this.containers[d].containerCache.over=1}},_createHelper:function(b){var c=this.options,b=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b,this.currentItem])):"clone"==c.helper?this.currentItem.clone():this.currentItem;return b.parents("body").length||a("parent"!=c.appendTo?c.appendTo:this.currentItem[0].parentNode)[0].appendChild(b[0]),b[0]==this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),
top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(""==b[0].style.width||c.forceHelperSize)&&b.width(this.currentItem.width()),(""==b[0].style.height||c.forceHelperSize)&&b.height(this.currentItem.height()),b},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" "));a.isArray(b)&&(b={left:+b[0],top:+b[1]||0});"left"in b&&(this.offset.click.left=b.left+this.margins.left);"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left);"top"in
b&&(this.offset.click.top=b.top+this.margins.top);"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();"absolute"==this.cssPosition&&this.scrollParent[0]!=document&&a.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&
"html"==this.offsetParent[0].tagName.toLowerCase()&&a.ui.ie)b={top:0,left:0};return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var a=this.currentItem.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,
left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b=this.options;"parent"==b.containment&&(b.containment=this.helper[0].parentNode);if("document"==b.containment||"window"==b.containment)this.containment=[0-this.offset.relative.left-this.offset.parent.left,
0-this.offset.relative.top-this.offset.parent.top,a("document"==b.containment?document:window).width()-this.helperProportions.width-this.margins.left,(a("document"==b.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(b.containment)){var c=a(b.containment)[0],b=a(b.containment).offset(),d="hidden"!=a(c).css("overflow");this.containment=[b.left+(parseInt(a(c).css("borderLeftWidth"),10)||
0)+(parseInt(a(c).css("paddingLeft"),10)||0)-this.margins.left,b.top+(parseInt(a(c).css("borderTopWidth"),10)||0)+(parseInt(a(c).css("paddingTop"),10)||0)-this.margins.top,b.left+(d?Math.max(c.scrollWidth,c.offsetWidth):c.offsetWidth)-(parseInt(a(c).css("borderLeftWidth"),10)||0)-(parseInt(a(c).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,b.top+(d?Math.max(c.scrollHeight,c.offsetHeight):c.offsetHeight)-(parseInt(a(c).css("borderTopWidth"),10)||0)-(parseInt(a(c).css("paddingBottom"),
10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(b,c){c||(c=this.position);var d="absolute"==b?1:-1,e="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,f=/(html|body)/i.test(e[0].tagName);return{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-("fixed"==this.cssPosition?-this.scrollParent.scrollTop():f?0:e.scrollTop())*d,left:c.left+this.offset.relative.left*
d+this.offset.parent.left*d-("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():f?0:e.scrollLeft())*d}},_generatePosition:function(b){var c=this.options,d="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,e=/(html|body)/i.test(d[0].tagName);"relative"==this.cssPosition&&(this.scrollParent[0]==document||this.scrollParent[0]==this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset());
var f=b.pageX,g=b.pageY;this.originalPosition&&(this.containment&&(b.pageX-this.offset.click.left<this.containment[0]&&(f=this.containment[0]+this.offset.click.left),b.pageY-this.offset.click.top<this.containment[1]&&(g=this.containment[1]+this.offset.click.top),b.pageX-this.offset.click.left>this.containment[2]&&(f=this.containment[2]+this.offset.click.left),b.pageY-this.offset.click.top>this.containment[3]&&(g=this.containment[3]+this.offset.click.top)),c.grid&&(g=this.originalPageY+Math.round((g-
this.originalPageY)/c.grid[1])*c.grid[1],g=this.containment?g-this.offset.click.top<this.containment[1]||g-this.offset.click.top>this.containment[3]?g-this.offset.click.top<this.containment[1]?g+c.grid[1]:g-c.grid[1]:g:g,f=this.originalPageX+Math.round((f-this.originalPageX)/c.grid[0])*c.grid[0],f=this.containment?f-this.offset.click.left<this.containment[0]||f-this.offset.click.left>this.containment[2]?f-this.offset.click.left<this.containment[0]?f+c.grid[0]:f-c.grid[0]:f:f));return{top:g-this.offset.click.top-
this.offset.relative.top-this.offset.parent.top+("fixed"==this.cssPosition?-this.scrollParent.scrollTop():e?0:d.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():e?0:d.scrollLeft())}},_rearrange:function(a,c,d,e){d?d[0].appendChild(this.placeholder[0]):c.item[0].parentNode.insertBefore(this.placeholder[0],"down"==this.direction?c.item[0]:c.item[0].nextSibling);var f=this.counter=this.counter?++this.counter:
1;this._delay(function(){f==this.counter&&this.refreshPositions(!e)})},_clear:function(b,c){this.reverting=!1;var d=[];!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem);this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var e in this._storedCSS)if("auto"==this._storedCSS[e]||"static"==this._storedCSS[e])this._storedCSS[e]="";this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&
!c&&d.push(function(a){this._trigger("receive",a,this._uiHash(this.fromOutside))});(this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!c&&d.push(function(a){this._trigger("update",a,this._uiHash())});this!==this.currentContainer&&(c||(d.push(function(a){this._trigger("remove",a,this._uiHash())}),d.push(function(a){return function(b){a._trigger("receive",b,this._uiHash(this))}}.call(this,this.currentContainer)),
d.push(function(a){return function(b){a._trigger("update",b,this._uiHash(this))}}.call(this,this.currentContainer))));for(e=this.containers.length-1;0<=e;e--)c||d.push(function(a){return function(b){a._trigger("deactivate",b,this._uiHash(this))}}.call(this,this.containers[e])),this.containers[e].containerCache.over&&(d.push(function(a){return function(b){a._trigger("out",b,this._uiHash(this))}}.call(this,this.containers[e])),this.containers[e].containerCache.over=0);this._storedCursor&&a("body").css("cursor",
this._storedCursor);this._storedOpacity&&this.helper.css("opacity",this._storedOpacity);this._storedZIndex&&this.helper.css("zIndex","auto"==this._storedZIndex?"":this._storedZIndex);this.dragging=!1;if(this.cancelHelperRemoval){if(!c){this._trigger("beforeStop",b,this._uiHash());for(e=0;e<d.length;e++)d[e].call(this,b);this._trigger("stop",b,this._uiHash())}return this.fromOutside=!1,!1}c||this._trigger("beforeStop",b,this._uiHash());this.placeholder[0].parentNode.removeChild(this.placeholder[0]);
this.helper[0]!=this.currentItem[0]&&this.helper.remove();this.helper=null;if(!c){for(e=0;e<d.length;e++)d[e].call(this,b);this._trigger("stop",b,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){!1===a.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(b){var c=b||this;return{helper:c.helper,placeholder:c.placeholder||a([]),position:c.position,originalPosition:c.originalPosition,offset:c.positionAbs,item:c.currentItem,sender:b?b.element:null}}})})(jQuery);
(function(a,b){function c(){this.debug=!1;this._curInst=null;this._keyEvent=!1;this._disabledInputs=[];this._inDialog=this._datepickerShowing=!1;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass=
"ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:"January February March April May June July August September October November December".split(" "),monthNamesShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),dayNames:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),dayNamesShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),dayNamesMin:"Su Mo Tu We Th Fr Sa".split(" "),
weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,
beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1};a.extend(this._defaults,this.regional[""]);this.dpDiv=d(a('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}function d(b){return b.delegate("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a",
"mouseout",function(){a(this).removeClass("ui-state-hover");-1!=this.className.indexOf("ui-datepicker-prev")&&a(this).removeClass("ui-datepicker-prev-hover");-1!=this.className.indexOf("ui-datepicker-next")&&a(this).removeClass("ui-datepicker-next-hover")}).delegate("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a","mouseover",function(){a.datepicker._isDisabledDatepicker(g.inline?b.parent()[0]:g.input[0])||(a(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),
a(this).addClass("ui-state-hover"),-1!=this.className.indexOf("ui-datepicker-prev")&&a(this).addClass("ui-datepicker-prev-hover"),-1!=this.className.indexOf("ui-datepicker-next")&&a(this).addClass("ui-datepicker-next-hover"))})}function e(c,d){a.extend(c,d);for(var e in d)if(null==d[e]||d[e]==b)c[e]=d[e];return c}a.extend(a.ui,{datepicker:{version:"1.9.1"}});var f=(new Date).getTime(),g;a.extend(c.prototype,{markerClassName:"hasDatepicker",maxRows:4,log:function(){this.debug&&console.log.apply("",
arguments)},_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(a){return e(this._defaults,a||{}),this},_attachDatepicker:function(b,c){var d=null,e;for(e in this._defaults){var f=b.getAttribute("date:"+e);if(f){d=d||{};try{d[e]=eval(f)}catch(g){d[e]=f}}}e=b.nodeName.toLowerCase();f="div"==e||"span"==e;b.id||(this.uuid+=1,b.id="dp"+this.uuid);var r=this._newInst(a(b),f);r.settings=a.extend({},c||{},d||{});"input"==e?this._connectDatepicker(b,r):f&&this._inlineDatepicker(b,r)},_newInst:function(b,
c){return{id:b[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1"),input:b,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:c,dpDiv:c?d(a('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>')):this.dpDiv}},_connectDatepicker:function(b,c){var d=a(b);c.append=a([]);c.trigger=a([]);d.hasClass(this.markerClassName)||(this._attachments(d,c),d.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",
function(a,b,d){c.settings[b]=d}).bind("getData.datepicker",function(a,b){return this._get(c,b)}),this._autoSize(c),a.data(b,"datepicker",c),c.settings.disabled&&this._disableDatepicker(b))},_attachments:function(b,c){var d=this._get(c,"appendText"),e=this._get(c,"isRTL");c.append&&c.append.remove();d&&(c.append=a('<span class="'+this._appendClass+'">'+d+"</span>"),b[e?"before":"after"](c.append));b.unbind("focus",this._showDatepicker);c.trigger&&c.trigger.remove();d=this._get(c,"showOn");("focus"==
d||"both"==d)&&b.focus(this._showDatepicker);if("button"==d||"both"==d){var d=this._get(c,"buttonText"),f=this._get(c,"buttonImage");c.trigger=a(this._get(c,"buttonImageOnly")?a("<img/>").addClass(this._triggerClass).attr({src:f,alt:d,title:d}):a('<button type="button"></button>').addClass(this._triggerClass).html(""==f?d:a("<img/>").attr({src:f,alt:d,title:d})));b[e?"before":"after"](c.trigger);c.trigger.click(function(){return a.datepicker._datepickerShowing&&a.datepicker._lastInput==b[0]?a.datepicker._hideDatepicker():
a.datepicker._datepickerShowing&&a.datepicker._lastInput!=b[0]?(a.datepicker._hideDatepicker(),a.datepicker._showDatepicker(b[0])):a.datepicker._showDatepicker(b[0]),!1})}},_autoSize:function(a){if(this._get(a,"autoSize")&&!a.inline){var b=new Date(2009,11,20),c=this._get(a,"dateFormat");if(c.match(/[DM]/)){var d=function(a){for(var b=0,c=0,d=0;d<a.length;d++)a[d].length>b&&(b=a[d].length,c=d);return c};b.setMonth(d(this._get(a,c.match(/MM/)?"monthNames":"monthNamesShort")));b.setDate(d(this._get(a,
c.match(/DD/)?"dayNames":"dayNamesShort"))+20-b.getDay())}a.input.attr("size",this._formatDate(a,b).length)}},_inlineDatepicker:function(b,c){var d=a(b);d.hasClass(this.markerClassName)||(d.addClass(this.markerClassName).append(c.dpDiv).bind("setData.datepicker",function(a,b,d){c.settings[b]=d}).bind("getData.datepicker",function(a,b){return this._get(c,b)}),a.data(b,"datepicker",c),this._setDate(c,this._getDefaultDate(c),!0),this._updateDatepicker(c),this._updateAlternate(c),c.settings.disabled&&
this._disableDatepicker(b),c.dpDiv.css("display","block"))},_dialogDatepicker:function(b,c,d,f,g){(b=this._dialogInst)||(this.uuid+=1,this._dialogInput=a('<input type="text" id="dp'+this.uuid+'" style="position: absolute; top: -100px; width: 0px;"/>'),this._dialogInput.keydown(this._doKeyDown),a("body").append(this._dialogInput),b=this._dialogInst=this._newInst(this._dialogInput,!1),b.settings={},a.data(this._dialogInput[0],"datepicker",b));e(b.settings,f||{});c=c&&c.constructor==Date?this._formatDate(b,
c):c;this._dialogInput.val(c);(this._pos=g?g.length?g:[g.pageX,g.pageY]:null)||(this._pos=[document.documentElement.clientWidth/2-100+(document.documentElement.scrollLeft||document.body.scrollLeft),document.documentElement.clientHeight/2-150+(document.documentElement.scrollTop||document.body.scrollTop)]);return this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),b.settings.onSelect=d,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),
a.blockUI&&a.blockUI(this.dpDiv),a.data(this._dialogInput[0],"datepicker",b),this},_destroyDatepicker:function(b){var c=a(b),d=a.data(b,"datepicker");if(c.hasClass(this.markerClassName)){var e=b.nodeName.toLowerCase();a.removeData(b,"datepicker");"input"==e?(d.append.remove(),d.trigger.remove(),c.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"==e||"span"==e)&&c.removeClass(this.markerClassName).empty()}},
_enableDatepicker:function(b){var c=a(b),d=a.data(b,"datepicker");if(c.hasClass(this.markerClassName)){var e=b.nodeName.toLowerCase();if("input"==e)b.disabled=!1,d.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""});else if("div"==e||"span"==e)c=c.children("."+this._inlineClass),c.children().removeClass("ui-state-disabled"),c.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1);this._disabledInputs=a.map(this._disabledInputs,
function(a){return a==b?null:a})}},_disableDatepicker:function(b){var c=a(b),d=a.data(b,"datepicker");if(c.hasClass(this.markerClassName)){var e=b.nodeName.toLowerCase();if("input"==e)b.disabled=!0,d.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"});else if("div"==e||"span"==e)c=c.children("."+this._inlineClass),c.children().addClass("ui-state-disabled"),c.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",
!0);this._disabledInputs=a.map(this._disabledInputs,function(a){return a==b?null:a});this._disabledInputs[this._disabledInputs.length]=b}},_isDisabledDatepicker:function(a){if(!a)return!1;for(var b=0;b<this._disabledInputs.length;b++)if(this._disabledInputs[b]==a)return!0;return!1},_getInst:function(b){try{return a.data(b,"datepicker")}catch(c){throw"Missing instance data for this datepicker";}},_optionDatepicker:function(c,d,f){var g=this._getInst(c);if(2==arguments.length&&"string"==typeof d)return"defaults"==
d?a.extend({},a.datepicker._defaults):g?"all"==d?a.extend({},g.settings):this._get(g,d):null;var q=d||{};"string"==typeof d&&(q={},q[d]=f);if(g){this._curInst==g&&this._hideDatepicker();var m=this._getDateDatepicker(c,!0),r=this._getMinMaxDate(g,"min"),s=this._getMinMaxDate(g,"max");e(g.settings,q);null!==r&&q.dateFormat!==b&&q.minDate===b&&(g.settings.minDate=this._formatDate(g,r));null!==s&&q.dateFormat!==b&&q.maxDate===b&&(g.settings.maxDate=this._formatDate(g,s));this._attachments(a(c),g);this._autoSize(g);
this._setDate(g,m);this._updateAlternate(g);this._updateDatepicker(g)}},_changeDatepicker:function(a,b,c){this._optionDatepicker(a,b,c)},_refreshDatepicker:function(a){(a=this._getInst(a))&&this._updateDatepicker(a)},_setDateDatepicker:function(a,b){var c=this._getInst(a);c&&(this._setDate(c,b),this._updateDatepicker(c),this._updateAlternate(c))},_getDateDatepicker:function(a,b){var c=this._getInst(a);return c&&!c.inline&&this._setDateFromField(c,b),c?this._getDate(c):null},_doKeyDown:function(b){var c=
a.datepicker._getInst(b.target),d=!0,e=c.dpDiv.is(".ui-datepicker-rtl");c._keyEvent=!0;if(a.datepicker._datepickerShowing)switch(b.keyCode){case 9:a.datepicker._hideDatepicker();d=!1;break;case 13:return d=a("td."+a.datepicker._dayOverClass+":not(."+a.datepicker._currentClass+")",c.dpDiv),d[0]&&a.datepicker._selectDay(b.target,c.selectedMonth,c.selectedYear,d[0]),(b=a.datepicker._get(c,"onSelect"))?(d=a.datepicker._formatDate(c),b.apply(c.input?c.input[0]:null,[d,c])):a.datepicker._hideDatepicker(),
!1;case 27:a.datepicker._hideDatepicker();break;case 33:a.datepicker._adjustDate(b.target,b.ctrlKey?-a.datepicker._get(c,"stepBigMonths"):-a.datepicker._get(c,"stepMonths"),"M");break;case 34:a.datepicker._adjustDate(b.target,b.ctrlKey?+a.datepicker._get(c,"stepBigMonths"):+a.datepicker._get(c,"stepMonths"),"M");break;case 35:(b.ctrlKey||b.metaKey)&&a.datepicker._clearDate(b.target);d=b.ctrlKey||b.metaKey;break;case 36:(b.ctrlKey||b.metaKey)&&a.datepicker._gotoToday(b.target);d=b.ctrlKey||b.metaKey;
break;case 37:(b.ctrlKey||b.metaKey)&&a.datepicker._adjustDate(b.target,e?1:-1,"D");d=b.ctrlKey||b.metaKey;b.originalEvent.altKey&&a.datepicker._adjustDate(b.target,b.ctrlKey?-a.datepicker._get(c,"stepBigMonths"):-a.datepicker._get(c,"stepMonths"),"M");break;case 38:(b.ctrlKey||b.metaKey)&&a.datepicker._adjustDate(b.target,-7,"D");d=b.ctrlKey||b.metaKey;break;case 39:(b.ctrlKey||b.metaKey)&&a.datepicker._adjustDate(b.target,e?-1:1,"D");d=b.ctrlKey||b.metaKey;b.originalEvent.altKey&&a.datepicker._adjustDate(b.target,
b.ctrlKey?+a.datepicker._get(c,"stepBigMonths"):+a.datepicker._get(c,"stepMonths"),"M");break;case 40:(b.ctrlKey||b.metaKey)&&a.datepicker._adjustDate(b.target,7,"D");d=b.ctrlKey||b.metaKey;break;default:d=!1}else 36==b.keyCode&&b.ctrlKey?a.datepicker._showDatepicker(this):d=!1;d&&(b.preventDefault(),b.stopPropagation())},_doKeyPress:function(c){var d=a.datepicker._getInst(c.target);if(a.datepicker._get(d,"constrainInput")){var d=a.datepicker._possibleChars(a.datepicker._get(d,"dateFormat")),e=String.fromCharCode(c.charCode==
b?c.keyCode:c.charCode);return c.ctrlKey||c.metaKey||" ">e||!d||-1<d.indexOf(e)}},_doKeyUp:function(b){b=a.datepicker._getInst(b.target);if(b.input.val()!=b.lastVal)try{a.datepicker.parseDate(a.datepicker._get(b,"dateFormat"),b.input?b.input.val():null,a.datepicker._getFormatConfig(b))&&(a.datepicker._setDateFromField(b),a.datepicker._updateAlternate(b),a.datepicker._updateDatepicker(b))}catch(c){a.datepicker.log(c)}return!0},_showDatepicker:function(b){b=b.target||b;"input"!=b.nodeName.toLowerCase()&&
(b=a("input",b.parentNode)[0]);if(!(a.datepicker._isDisabledDatepicker(b)||a.datepicker._lastInput==b)){var c=a.datepicker._getInst(b);a.datepicker._curInst&&a.datepicker._curInst!=c&&(a.datepicker._curInst.dpDiv.stop(!0,!0),c&&a.datepicker._datepickerShowing&&a.datepicker._hideDatepicker(a.datepicker._curInst.input[0]));var d=a.datepicker._get(c,"beforeShow"),d=d?d.apply(b,[b,c]):{};if(!1!==d){e(c.settings,d);c.lastVal=null;a.datepicker._lastInput=b;a.datepicker._setDateFromField(c);a.datepicker._inDialog&&
(b.value="");a.datepicker._pos||(a.datepicker._pos=a.datepicker._findPos(b),a.datepicker._pos[1]+=b.offsetHeight);var f=!1;a(b).parents().each(function(){return f|="fixed"==a(this).css("position"),!f});d={left:a.datepicker._pos[0],top:a.datepicker._pos[1]};a.datepicker._pos=null;c.dpDiv.empty();c.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});a.datepicker._updateDatepicker(c);d=a.datepicker._checkOffset(c,d,f);c.dpDiv.css({position:a.datepicker._inDialog&&a.blockUI?"static":f?"fixed":
"absolute",display:"none",left:d.left+"px",top:d.top+"px"});if(!c.inline){var d=a.datepicker._get(c,"showAnim"),g=a.datepicker._get(c,"duration"),m=function(){var b=c.dpDiv.find("iframe.ui-datepicker-cover");if(b.length){var d=a.datepicker._getBorders(c.dpDiv);b.css({left:-d[0],top:-d[1],width:c.dpDiv.outerWidth(),height:c.dpDiv.outerHeight()})}};c.dpDiv.zIndex(a(b).zIndex()+1);a.datepicker._datepickerShowing=!0;a.effects&&(a.effects.effect[d]||a.effects[d])?c.dpDiv.show(d,a.datepicker._get(c,"showOptions"),
g,m):c.dpDiv[d||"show"](d?g:null,m);(!d||!g)&&m();c.input.is(":visible")&&!c.input.is(":disabled")&&c.input.focus();a.datepicker._curInst=c}}}},_updateDatepicker:function(b){this.maxRows=4;var c=a.datepicker._getBorders(b.dpDiv);g=b;b.dpDiv.empty().append(this._generateHTML(b));this._attachHandlers(b);var d=b.dpDiv.find("iframe.ui-datepicker-cover");!d.length||d.css({left:-c[0],top:-c[1],width:b.dpDiv.outerWidth(),height:b.dpDiv.outerHeight()});b.dpDiv.find("."+this._dayOverClass+" a").mouseover();
c=this._getNumberOfMonths(b);d=c[1];b.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");1<d&&b.dpDiv.addClass("ui-datepicker-multi-"+d).css("width",17*d+"em");b.dpDiv[(1!=c[0]||1!=c[1]?"add":"remove")+"Class"]("ui-datepicker-multi");b.dpDiv[(this._get(b,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");b==a.datepicker._curInst&&a.datepicker._datepickerShowing&&b.input&&b.input.is(":visible")&&!b.input.is(":disabled")&&b.input[0]!=document.activeElement&&
b.input.focus();if(b.yearshtml){var e=b.yearshtml;setTimeout(function(){e===b.yearshtml&&b.yearshtml&&b.dpDiv.find("select.ui-datepicker-year:first").replaceWith(b.yearshtml);e=b.yearshtml=null},0)}},_getBorders:function(a){var b=function(a){return{thin:1,medium:2,thick:3}[a]||a};return[parseFloat(b(a.css("border-left-width"))),parseFloat(b(a.css("border-top-width")))]},_checkOffset:function(b,c,d){var e=b.dpDiv.outerWidth(),f=b.dpDiv.outerHeight(),g=b.input?b.input.outerWidth():0,r=b.input?b.input.outerHeight():
0,s=document.documentElement.clientWidth+(d?0:a(document).scrollLeft()),t=document.documentElement.clientHeight+(d?0:a(document).scrollTop());return c.left-=this._get(b,"isRTL")?e-g:0,c.left-=d&&c.left==b.input.offset().left?a(document).scrollLeft():0,c.top-=d&&c.top==b.input.offset().top+r?a(document).scrollTop():0,c.left-=Math.min(c.left,c.left+e>s&&s>e?Math.abs(c.left+e-s):0),c.top-=Math.min(c.top,c.top+f>t&&t>f?Math.abs(f+r):0),c},_findPos:function(b){for(var c=this._getInst(b),c=this._get(c,
"isRTL");b&&("hidden"==b.type||1!=b.nodeType||a.expr.filters.hidden(b));)b=b[c?"previousSibling":"nextSibling"];b=a(b).offset();return[b.left,b.top]},_hideDatepicker:function(b){var c=this._curInst;if(c&&!(b&&c!=a.data(b,"datepicker"))&&this._datepickerShowing){var b=this._get(c,"showAnim"),d=this._get(c,"duration"),e=function(){a.datepicker._tidyDialog(c)};a.effects&&(a.effects.effect[b]||a.effects[b])?c.dpDiv.hide(b,a.datepicker._get(c,"showOptions"),d,e):c.dpDiv["slideDown"==b?"slideUp":"fadeIn"==
b?"fadeOut":"hide"](b?d:null,e);b||e();this._datepickerShowing=!1;(b=this._get(c,"onClose"))&&b.apply(c.input?c.input[0]:null,[c.input?c.input.val():"",c]);this._lastInput=null;this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),a.blockUI&&(a.unblockUI(),a("body").append(this.dpDiv)));this._inDialog=!1}},_tidyDialog:function(a){a.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(b){if(a.datepicker._curInst){var b=a(b.target),
c=a.datepicker._getInst(b[0]);(b[0].id!=a.datepicker._mainDivId&&0==b.parents("#"+a.datepicker._mainDivId).length&&!b.hasClass(a.datepicker.markerClassName)&&!b.closest("."+a.datepicker._triggerClass).length&&a.datepicker._datepickerShowing&&(!a.datepicker._inDialog||!a.blockUI)||b.hasClass(a.datepicker.markerClassName)&&a.datepicker._curInst!=c)&&a.datepicker._hideDatepicker()}},_adjustDate:function(b,c,d){var b=a(b),e=this._getInst(b[0]);this._isDisabledDatepicker(b[0])||(this._adjustInstDate(e,
c+("M"==d?this._get(e,"showCurrentAtPos"):0),d),this._updateDatepicker(e))},_gotoToday:function(b){var b=a(b),c=this._getInst(b[0]);if(this._get(c,"gotoCurrent")&&c.currentDay)c.selectedDay=c.currentDay,c.drawMonth=c.selectedMonth=c.currentMonth,c.drawYear=c.selectedYear=c.currentYear;else{var d=new Date;c.selectedDay=d.getDate();c.drawMonth=c.selectedMonth=d.getMonth();c.drawYear=c.selectedYear=d.getFullYear()}this._notifyChange(c);this._adjustDate(b)},_selectMonthYear:function(b,c,d){var b=a(b),
e=this._getInst(b[0]);e["selected"+("M"==d?"Month":"Year")]=e["draw"+("M"==d?"Month":"Year")]=parseInt(c.options[c.selectedIndex].value,10);this._notifyChange(e);this._adjustDate(b)},_selectDay:function(b,c,d,e){var f=a(b);!a(e).hasClass(this._unselectableClass)&&!this._isDisabledDatepicker(f[0])&&(f=this._getInst(f[0]),f.selectedDay=f.currentDay=a("a",e).html(),f.selectedMonth=f.currentMonth=c,f.selectedYear=f.currentYear=d,this._selectDate(b,this._formatDate(f,f.currentDay,f.currentMonth,f.currentYear)))},
_clearDate:function(b){b=a(b);this._getInst(b[0]);this._selectDate(b,"")},_selectDate:function(b,c){var d=a(b),d=this._getInst(d[0]),c=null!=c?c:this._formatDate(d);d.input&&d.input.val(c);this._updateAlternate(d);var e=this._get(d,"onSelect");e?e.apply(d.input?d.input[0]:null,[c,d]):d.input&&d.input.trigger("change");d.inline?this._updateDatepicker(d):(this._hideDatepicker(),this._lastInput=d.input[0],"object"!=typeof d.input[0]&&d.input.focus(),this._lastInput=null)},_updateAlternate:function(b){var c=
this._get(b,"altField");if(c){var d=this._get(b,"altFormat")||this._get(b,"dateFormat"),e=this._getDate(b),f=this.formatDate(d,e,this._getFormatConfig(b));a(c).each(function(){a(this).val(f)})}},noWeekends:function(a){a=a.getDay();return[0<a&&6>a,""]},iso8601Week:function(a){a=new Date(a.getTime());a.setDate(a.getDate()+4-(a.getDay()||7));var b=a.getTime();return a.setMonth(0),a.setDate(1),Math.floor(Math.round((b-a)/864E5)/7)+1},parseDate:function(b,c,d){if(null==b||null==c)throw"Invalid arguments";
c="object"==typeof c?c.toString():c+"";if(""==c)return null;for(var e=(d?d.shortYearCutoff:null)||this._defaults.shortYearCutoff,e="string"!=typeof e?e:(new Date).getFullYear()%100+parseInt(e,10),f=(d?d.dayNamesShort:null)||this._defaults.dayNamesShort,g=(d?d.dayNames:null)||this._defaults.dayNames,r=(d?d.monthNamesShort:null)||this._defaults.monthNamesShort,s=(d?d.monthNames:null)||this._defaults.monthNames,t=d=-1,v=-1,u=-1,w=!1,y=function(a){a=L+1<b.length&&b.charAt(L+1)==a;return a&&L++,a},A=function(a){var b=
y(a),a=RegExp("^\\d{1,"+("@"==a?14:"!"==a?20:"y"==a&&b?4:"o"==a?3:2)+"}"),a=c.substring(K).match(a);if(!a)throw"Missing number at position "+K;return K+=a[0].length,parseInt(a[0],10)},B=function(b,d,e){var b=a.map(y(b)?e:d,function(a,b){return[[b,a]]}).sort(function(a,b){return-(a[1].length-b[1].length)}),f=-1;a.each(b,function(a,b){var d=b[1];if(c.substr(K,d.length).toLowerCase()==d.toLowerCase())return f=b[0],K+=d.length,!1});if(-1!=f)return f+1;throw"Unknown name at position "+K;},x=function(){if(c.charAt(K)!=
b.charAt(L))throw"Unexpected literal at position "+K;K++},K=0,L=0;L<b.length;L++)if(w)"'"==b.charAt(L)&&!y("'")?w=!1:x();else switch(b.charAt(L)){case "d":v=A("d");break;case "D":B("D",f,g);break;case "o":u=A("o");break;case "m":t=A("m");break;case "M":t=B("M",r,s);break;case "y":d=A("y");break;case "@":var N=new Date(A("@")),d=N.getFullYear(),t=N.getMonth()+1,v=N.getDate();break;case "!":N=new Date((A("!")-this._ticksTo1970)/1E4);d=N.getFullYear();t=N.getMonth()+1;v=N.getDate();break;case "'":y("'")?
x():w=!0;break;default:x()}if(K<c.length&&(f=c.substr(K),!/^\s+/.test(f)))throw"Extra/unparsed characters found in date: "+f;-1==d?d=(new Date).getFullYear():100>d&&(d+=(new Date).getFullYear()-(new Date).getFullYear()%100+(d<=e?0:-100));if(-1<u){t=1;v=u;do{e=this._getDaysInMonth(d,t-1);if(v<=e)break;t++;v-=e}while(1)}N=this._daylightSavingAdjust(new Date(d,t-1,v));if(N.getFullYear()!=d||N.getMonth()+1!=t||N.getDate()!=v)throw"Invalid date";return N},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",
RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:864E9*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(a,b,c){if(!b)return"";var d=(c?c.dayNamesShort:null)||this._defaults.dayNamesShort,e=(c?c.dayNames:null)||this._defaults.dayNames,f=(c?c.monthNamesShort:null)||this._defaults.monthNamesShort,c=(c?c.monthNames:null)||this._defaults.monthNames,g=
function(b){b=u+1<a.length&&a.charAt(u+1)==b;return b&&u++,b},s=function(a,b,c){b=""+b;if(g(a))for(;b.length<c;)b="0"+b;return b},t="",v=!1;if(b)for(var u=0;u<a.length;u++)if(v)"'"==a.charAt(u)&&!g("'")?v=!1:t+=a.charAt(u);else switch(a.charAt(u)){case "d":t+=s("d",b.getDate(),2);break;case "D":var w;w=b.getDay();var y=d,A=e;w=g("D")?A[w]:y[w];t+=w;break;case "o":t+=s("o",Math.round(((new Date(b.getFullYear(),b.getMonth(),b.getDate())).getTime()-(new Date(b.getFullYear(),0,0)).getTime())/864E5),3);
break;case "m":t+=s("m",b.getMonth()+1,2);break;case "M":w=b.getMonth();y=f;A=c;w=g("M")?A[w]:y[w];t+=w;break;case "y":t+=g("y")?b.getFullYear():(10>b.getYear()%100?"0":"")+b.getYear()%100;break;case "@":t+=b.getTime();break;case "!":t+=1E4*b.getTime()+this._ticksTo1970;break;case "'":g("'")?t+="'":v=!0;break;default:t+=a.charAt(u)}return t},_possibleChars:function(a){for(var b="",c=!1,d=function(b){b=e+1<a.length&&a.charAt(e+1)==b;return b&&e++,b},e=0;e<a.length;e++)if(c)"'"==a.charAt(e)&&!d("'")?
c=!1:b+=a.charAt(e);else switch(a.charAt(e)){case "d":case "m":case "y":case "@":b+="0123456789";break;case "D":case "M":return null;case "'":d("'")?b+="'":c=!0;break;default:b+=a.charAt(e)}return b},_get:function(a,c){return a.settings[c]!==b?a.settings[c]:this._defaults[c]},_setDateFromField:function(a,b){if(a.input.val()!=a.lastVal){var c=this._get(a,"dateFormat"),d=a.lastVal=a.input?a.input.val():null,e,f;e=f=this._getDefaultDate(a);var g=this._getFormatConfig(a);try{e=this.parseDate(c,d,g)||
f}catch(s){this.log(s),d=b?"":d}a.selectedDay=e.getDate();a.drawMonth=a.selectedMonth=e.getMonth();a.drawYear=a.selectedYear=e.getFullYear();a.currentDay=d?e.getDate():0;a.currentMonth=d?e.getMonth():0;a.currentYear=d?e.getFullYear():0;this._adjustInstDate(a)}},_getDefaultDate:function(a){return this._restrictMinMax(a,this._determineDate(a,this._get(a,"defaultDate"),new Date))},_determineDate:function(b,c,d){if(null==c||""===c)c=d;else{var e;if("string"==typeof c)a:{try{e=a.datepicker.parseDate(a.datepicker._get(b,
"dateFormat"),c,a.datepicker._getFormatConfig(b));break a}catch(f){}var g=(c.toLowerCase().match(/^c/)?a.datepicker._getDate(b):null)||new Date,b=g.getFullYear();e=g.getMonth();for(var g=g.getDate(),r=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,s=r.exec(c);s;){switch(s[2]||"d"){case "d":case "D":g+=parseInt(s[1],10);break;case "w":case "W":g+=7*parseInt(s[1],10);break;case "m":case "M":e+=parseInt(s[1],10);g=Math.min(g,a.datepicker._getDaysInMonth(b,e));break;case "y":case "Y":b+=parseInt(s[1],10),g=Math.min(g,
a.datepicker._getDaysInMonth(b,e))}s=r.exec(c)}e=new Date(b,e,g)}else"number"==typeof c?isNaN(c)?c=d:(b=new Date,c=(b.setDate(b.getDate()+c),b)):c=new Date(c.getTime()),e=c;c=e}return c=c&&"Invalid Date"==c.toString()?d:c,c&&(c.setHours(0),c.setMinutes(0),c.setSeconds(0),c.setMilliseconds(0)),this._daylightSavingAdjust(c)},_daylightSavingAdjust:function(a){return a?(a.setHours(12<a.getHours()?a.getHours()+2:0),a):null},_setDate:function(a,b,c){var d=!b,e=a.selectedMonth,f=a.selectedYear,b=this._restrictMinMax(a,
this._determineDate(a,b,new Date));a.selectedDay=a.currentDay=b.getDate();a.drawMonth=a.selectedMonth=a.currentMonth=b.getMonth();a.drawYear=a.selectedYear=a.currentYear=b.getFullYear();(e!=a.selectedMonth||f!=a.selectedYear)&&!c&&this._notifyChange(a);this._adjustInstDate(a);a.input&&a.input.val(d?"":this._formatDate(a))},_getDate:function(a){return!a.currentYear||a.input&&""==a.input.val()?null:this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay))},_attachHandlers:function(b){var c=
this._get(b,"stepMonths"),d="#"+b.id.replace(/\\\\/g,"\\");b.dpDiv.find("[data-handler]").map(function(){a(this).bind(this.getAttribute("data-event"),{prev:function(){window["DP_jQuery_"+f].datepicker._adjustDate(d,-c,"M")},next:function(){window["DP_jQuery_"+f].datepicker._adjustDate(d,+c,"M")},hide:function(){window["DP_jQuery_"+f].datepicker._hideDatepicker()},today:function(){window["DP_jQuery_"+f].datepicker._gotoToday(d)},selectDay:function(){return window["DP_jQuery_"+f].datepicker._selectDay(d,
+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return window["DP_jQuery_"+f].datepicker._selectMonthYear(d,this,"M"),!1},selectYear:function(){return window["DP_jQuery_"+f].datepicker._selectMonthYear(d,this,"Y"),!1}}[this.getAttribute("data-handler")])})},_generateHTML:function(b){var c=new Date,c=this._daylightSavingAdjust(new Date(c.getFullYear(),c.getMonth(),c.getDate())),d=this._get(b,"isRTL"),e=this._get(b,"showButtonPanel"),f=this._get(b,"hideIfNoPrevNext"),
g=this._get(b,"navigationAsDateFormat"),r=this._getNumberOfMonths(b),s=this._get(b,"showCurrentAtPos"),t=this._get(b,"stepMonths"),v=1!=r[0]||1!=r[1],u=this._daylightSavingAdjust(b.currentDay?new Date(b.currentYear,b.currentMonth,b.currentDay):new Date(9999,9,9)),w=this._getMinMaxDate(b,"min"),y=this._getMinMaxDate(b,"max"),s=b.drawMonth-s,A=b.drawYear;0>s&&(s+=12,A--);if(y)for(var B=this._daylightSavingAdjust(new Date(y.getFullYear(),y.getMonth()-r[0]*r[1]+1,y.getDate())),B=w&&B<w?w:B;this._daylightSavingAdjust(new Date(A,
s,1))>B;)s--,0>s&&(s=11,A--);b.drawMonth=s;b.drawYear=A;var B=this._get(b,"prevText"),B=g?this.formatDate(B,this._daylightSavingAdjust(new Date(A,s-t,1)),this._getFormatConfig(b)):B,B=this._canAdjustMonth(b,-1,A,s)?'<a class="ui-datepicker-prev ui-corner-all" data-handler="prev" data-event="click" title="'+B+'"><span class="ui-icon ui-icon-circle-triangle-'+(d?"e":"w")+'">'+B+"</span></a>":f?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+B+'"><span class="ui-icon ui-icon-circle-triangle-'+
(d?"e":"w")+'">'+B+"</span></a>",x=this._get(b,"nextText"),x=g?this.formatDate(x,this._daylightSavingAdjust(new Date(A,s+t,1)),this._getFormatConfig(b)):x,f=this._canAdjustMonth(b,1,A,s)?'<a class="ui-datepicker-next ui-corner-all" data-handler="next" data-event="click" title="'+x+'"><span class="ui-icon ui-icon-circle-triangle-'+(d?"w":"e")+'">'+x+"</span></a>":f?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+x+'"><span class="ui-icon ui-icon-circle-triangle-'+(d?"w":
"e")+'">'+x+"</span></a>",t=this._get(b,"currentText"),x=this._get(b,"gotoCurrent")&&b.currentDay?u:c,t=g?this.formatDate(t,x,this._getFormatConfig(b)):t,g=b.inline?"":'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" data-handler="hide" data-event="click">'+this._get(b,"closeText")+"</button>",e=e?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(d?g:"")+(this._isInRange(b,x)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" data-handler="today" data-event="click">'+
t+"</button>":"")+(d?"":g)+"</div>":"",g=parseInt(this._get(b,"firstDay"),10),g=isNaN(g)?0:g,t=this._get(b,"showWeek"),x=this._get(b,"dayNames");this._get(b,"dayNamesShort");var K=this._get(b,"dayNamesMin"),L=this._get(b,"monthNames"),N=this._get(b,"monthNamesShort"),U=this._get(b,"beforeShowDay"),aa=this._get(b,"showOtherMonths"),Ba=this._get(b,"selectOtherMonths");this._get(b,"calculateWeek");for(var pa=this._getDefaultDate(b),Q="",ba=0;ba<r[0];ba++){var X="";this.maxRows=4;for(var qa=0;qa<r[1];qa++){var Sa=
this._daylightSavingAdjust(new Date(A,s,b.selectedDay)),R=" ui-corner-all",F="";if(v){F+='<div class="ui-datepicker-group';if(1<r[1])switch(qa){case 0:F+=" ui-datepicker-group-first";R=" ui-corner-"+(d?"right":"left");break;case r[1]-1:F+=" ui-datepicker-group-last";R=" ui-corner-"+(d?"left":"right");break;default:F+=" ui-datepicker-group-middle",R=""}F+='">'}for(var F=F+('<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+R+'">'+(/all|left/.test(R)&&0==ba?d?f:B:"")+(/all|right/.test(R)&&
0==ba?d?B:f:"")+this._generateMonthYearHeader(b,s,A,w,y,0<ba||0<qa,L,N)+'</div><table class="ui-datepicker-calendar"><thead><tr>'),T=t?'<th class="ui-datepicker-week-col">'+this._get(b,"weekHeader")+"</th>":"",R=0;7>R;R++)var O=(R+g)%7,T=T+("<th"+(5<=(R+g+6)%7?' class="ui-datepicker-week-end"':"")+'><span title="'+x[O]+'">'+K[O]+"</span></th>");F+=T+"</tr></thead><tbody>";T=this._getDaysInMonth(A,s);A==b.selectedYear&&s==b.selectedMonth&&(b.selectedDay=Math.min(b.selectedDay,T));R=(this._getFirstDayOfMonth(A,
s)-g+7)%7;T=Math.ceil((R+T)/7);this.maxRows=T=v?this.maxRows>T?this.maxRows:T:T;for(var O=this._daylightSavingAdjust(new Date(A,s,1-R)),ma=0;ma<T;ma++){for(var F=F+"<tr>",ra=t?'<td class="ui-datepicker-week-col">'+this._get(b,"calculateWeek")(O)+"</td>":"",R=0;7>R;R++){var E=U?U.apply(b.input?b.input[0]:null,[O]):[!0,""],ca=O.getMonth()!=s,z=ca&&!Ba||!E[0]||w&&O<w||y&&O>y,ra=ra+('<td class="'+(5<=(R+g+6)%7?" ui-datepicker-week-end":"")+(ca?" ui-datepicker-other-month":"")+(O.getTime()==Sa.getTime()&&
s==b.selectedMonth&&b._keyEvent||pa.getTime()==O.getTime()&&pa.getTime()==Sa.getTime()?" "+this._dayOverClass:"")+(z?" "+this._unselectableClass+" ui-state-disabled":"")+(ca&&!aa?"":" "+E[1]+(O.getTime()==u.getTime()?" "+this._currentClass:"")+(O.getTime()==c.getTime()?" ui-datepicker-today":""))+'"'+((!ca||aa)&&E[2]?' title="'+E[2]+'"':"")+(z?"":' data-handler="selectDay" data-event="click" data-month="'+O.getMonth()+'" data-year="'+O.getFullYear()+'"')+">"+(ca&&!aa?"&#xa0;":z?'<span class="ui-state-default">'+
O.getDate()+"</span>":'<a class="ui-state-default'+(O.getTime()==c.getTime()?" ui-state-highlight":"")+(O.getTime()==u.getTime()?" ui-state-active":"")+(ca?" ui-priority-secondary":"")+'" href="#">'+O.getDate()+"</a>")+"</td>");O.setDate(O.getDate()+1);O=this._daylightSavingAdjust(O)}F+=ra+"</tr>"}s++;11<s&&(s=0,A++);F+="</tbody></table>"+(v?"</div>"+(0<r[0]&&qa==r[1]-1?'<div class="ui-datepicker-row-break"></div>':""):"");X+=F}Q+=X}return Q+=e+(a.ui.ie6&&!b.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':
""),b._keyEvent=!1,Q},_generateMonthYearHeader:function(a,b,c,d,e,f,g,s){var t=this._get(a,"changeMonth"),v=this._get(a,"changeYear"),u=this._get(a,"showMonthAfterYear"),w='<div class="ui-datepicker-title">',y="";if(f||!t)y+='<span class="ui-datepicker-month">'+g[b]+"</span>";else{for(var g=d&&d.getFullYear()==c,A=e&&e.getFullYear()==c,y=y+'<select class="ui-datepicker-month" data-handler="selectMonth" data-event="change">',B=0;12>B;B++)(!g||B>=d.getMonth())&&(!A||B<=e.getMonth())&&(y+='<option value="'+
B+'"'+(B==b?' selected="selected"':"")+">"+s[B]+"</option>");y+="</select>"}u||(w+=y+(f||!t||!v?"&#xa0;":""));if(!a.yearshtml)if(a.yearshtml="",f||!v)w+='<span class="ui-datepicker-year">'+c+"</span>";else{var s=this._get(a,"yearRange").split(":"),x=(new Date).getFullYear(),g=function(a){a=a.match(/c[+-].*/)?c+parseInt(a.substring(1),10):a.match(/[+-].*/)?x+parseInt(a,10):parseInt(a,10);return isNaN(a)?x:a},b=g(s[0]),s=Math.max(b,g(s[1]||"")),b=d?Math.max(b,d.getFullYear()):b,s=e?Math.min(s,e.getFullYear()):
s;for(a.yearshtml+='<select class="ui-datepicker-year" data-handler="selectYear" data-event="change">';b<=s;b++)a.yearshtml+='<option value="'+b+'"'+(b==c?' selected="selected"':"")+">"+b+"</option>";a.yearshtml+="</select>";w+=a.yearshtml;a.yearshtml=null}return w+=this._get(a,"yearSuffix"),u&&(w+=(f||!t||!v?"&#xa0;":"")+y),w+="</div>",w},_adjustInstDate:function(a,b,c){var d=a.drawYear+("Y"==c?b:0),e=a.drawMonth+("M"==c?b:0),b=Math.min(a.selectedDay,this._getDaysInMonth(d,e))+("D"==c?b:0),d=this._restrictMinMax(a,
this._daylightSavingAdjust(new Date(d,e,b)));a.selectedDay=d.getDate();a.drawMonth=a.selectedMonth=d.getMonth();a.drawYear=a.selectedYear=d.getFullYear();("M"==c||"Y"==c)&&this._notifyChange(a)},_restrictMinMax:function(a,b){var c=this._getMinMaxDate(a,"min"),d=this._getMinMaxDate(a,"max"),c=c&&b<c?c:b;return c=d&&c>d?d:c,c},_notifyChange:function(a){var b=this._get(a,"onChangeMonthYear");b&&b.apply(a.input?a.input[0]:null,[a.selectedYear,a.selectedMonth+1,a])},_getNumberOfMonths:function(a){a=this._get(a,
"numberOfMonths");return null==a?[1,1]:"number"==typeof a?[1,a]:a},_getMinMaxDate:function(a,b){return this._determineDate(a,this._get(a,b+"Date"),null)},_getDaysInMonth:function(a,b){return 32-this._daylightSavingAdjust(new Date(a,b,32)).getDate()},_getFirstDayOfMonth:function(a,b){return(new Date(a,b,1)).getDay()},_canAdjustMonth:function(a,b,c,d){var e=this._getNumberOfMonths(a),c=this._daylightSavingAdjust(new Date(c,d+(0>b?b:e[0]*e[1]),1));return 0>b&&c.setDate(this._getDaysInMonth(c.getFullYear(),
c.getMonth())),this._isInRange(a,c)},_isInRange:function(a,b){var c=this._getMinMaxDate(a,"min"),d=this._getMinMaxDate(a,"max");return(!c||b.getTime()>=c.getTime())&&(!d||b.getTime()<=d.getTime())},_getFormatConfig:function(a){var b=this._get(a,"shortYearCutoff");return b="string"!=typeof b?b:(new Date).getFullYear()%100+parseInt(b,10),{shortYearCutoff:b,dayNamesShort:this._get(a,"dayNamesShort"),dayNames:this._get(a,"dayNames"),monthNamesShort:this._get(a,"monthNamesShort"),monthNames:this._get(a,
"monthNames")}},_formatDate:function(a,b,c,d){b||(a.currentDay=a.selectedDay,a.currentMonth=a.selectedMonth,a.currentYear=a.selectedYear);b=b?"object"==typeof b?b:this._daylightSavingAdjust(new Date(d,c,b)):this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay));return this.formatDate(this._get(a,"dateFormat"),b,this._getFormatConfig(a))}});a.fn.datepicker=function(b){if(!this.length)return this;a.datepicker.initialized||(a(document).mousedown(a.datepicker._checkExternalClick).find(document.body).append(a.datepicker.dpDiv),
a.datepicker.initialized=!0);var c=Array.prototype.slice.call(arguments,1);return"string"!=typeof b||"isDisabled"!=b&&"getDate"!=b&&"widget"!=b?"option"==b&&2==arguments.length&&"string"==typeof arguments[1]?a.datepicker["_"+b+"Datepicker"].apply(a.datepicker,[this[0]].concat(c)):this.each(function(){"string"==typeof b?a.datepicker["_"+b+"Datepicker"].apply(a.datepicker,[this].concat(c)):a.datepicker._attachDatepicker(this,b)}):a.datepicker["_"+b+"Datepicker"].apply(a.datepicker,[this[0]].concat(c))};
a.datepicker=new c;a.datepicker.initialized=!1;a.datepicker.uuid=(new Date).getTime();a.datepicker.version="1.9.1";window["DP_jQuery_"+f]=a})(jQuery);
(function(a){a.widget("ui.slider",a.ui.mouse,{version:"1.9.1",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null},_create:function(){var b,c,d=this.options,e=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),f=[];this._mouseSliding=this._keySliding=!1;this._animateOff=!0;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+this.orientation+
" ui-widget ui-widget-content ui-corner-all"+(d.disabled?" ui-slider-disabled ui-disabled":""));this.range=a([]);d.range&&(!0===d.range&&(d.values||(d.values=[this._valueMin(),this._valueMin()]),d.values.length&&2!==d.values.length&&(d.values=[d.values[0],d.values[0]])),this.range=a("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+("min"===d.range||"max"===d.range?" ui-slider-range-"+d.range:"")));c=d.values&&d.values.length||1;for(b=e.length;b<c;b++)f.push("<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>");
this.handles=e.add(a(f.join("")).appendTo(this.element));this.handle=this.handles.eq(0);this.handles.add(this.range).filter("a").click(function(a){a.preventDefault()}).mouseenter(function(){d.disabled||a(this).addClass("ui-state-hover")}).mouseleave(function(){a(this).removeClass("ui-state-hover")}).focus(function(){d.disabled?a(this).blur():(a(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),a(this).addClass("ui-state-focus"))}).blur(function(){a(this).removeClass("ui-state-focus")});
this.handles.each(function(b){a(this).data("ui-slider-handle-index",b)});this._on(this.handles,{keydown:function(b){var c,d,e,f=a(b.target).data("ui-slider-handle-index");switch(b.keyCode){case a.ui.keyCode.HOME:case a.ui.keyCode.END:case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(b.preventDefault(),!this._keySliding&&(this._keySliding=!0,a(b.target).addClass("ui-state-active"),c=this._start(b,f),!1===
c))return}c=this.options.step;this.options.values&&this.options.values.length?d=e=this.values(f):d=e=this.value();switch(b.keyCode){case a.ui.keyCode.HOME:e=this._valueMin();break;case a.ui.keyCode.END:e=this._valueMax();break;case a.ui.keyCode.PAGE_UP:e=this._trimAlignValue(d+(this._valueMax()-this._valueMin())/5);break;case a.ui.keyCode.PAGE_DOWN:e=this._trimAlignValue(d-(this._valueMax()-this._valueMin())/5);break;case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:if(d===this._valueMax())return;e=this._trimAlignValue(d+
c);break;case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(d===this._valueMin())return;e=this._trimAlignValue(d-c)}this._slide(b,f,e)},keyup:function(b){var c=a(b.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(b,c),this._change(b,c),a(b.target).removeClass("ui-state-active"))}});this._refreshValue();this._animateOff=!1},_destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all");
this._mouseDestroy()},_mouseCapture:function(b){var c,d,e,f,g,h,j,n,p=this,q=this.options;return q.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),c={x:b.pageX,y:b.pageY},d=this._normValueFromMouse(c),e=this._valueMax()-this._valueMin()+1,this.handles.each(function(b){var c=Math.abs(d-p.values(b));e>c&&(e=c,f=a(this),g=b)}),!0===q.range&&this.values(1)===q.min&&(g+=1,f=a(this.handles[g])),h=this._start(b,g),
!1===h?!1:(this._mouseSliding=!0,this._handleIndex=g,f.addClass("ui-state-active").focus(),j=f.offset(),n=!a(b.target).parents().andSelf().is(".ui-slider-handle"),this._clickOffset=n?{left:0,top:0}:{left:b.pageX-j.left-f.width()/2,top:b.pageY-j.top-f.height()/2-(parseInt(f.css("borderTopWidth"),10)||0)-(parseInt(f.css("borderBottomWidth"),10)||0)+(parseInt(f.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(b,g,d),this._animateOff=!0,!0))},_mouseStart:function(){return!0},
_mouseDrag:function(a){var c=this._normValueFromMouse({x:a.pageX,y:a.pageY});return this._slide(a,this._handleIndex,c),!1},_mouseStop:function(a){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(a,this._handleIndex),this._change(a,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(a){var c,
d,e,f,g;return"horizontal"===this.orientation?(c=this.elementSize.width,d=a.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(c=this.elementSize.height,d=a.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),e=d/c,1<e&&(e=1),0>e&&(e=0),"vertical"===this.orientation&&(e=1-e),f=this._valueMax()-this._valueMin(),g=this._valueMin()+e*f,this._trimAlignValue(g)},_start:function(a,c){var d={handle:this.handles[c],value:this.value()};return this.options.values&&this.options.values.length&&
(d.value=this.values(c),d.values=this.values()),this._trigger("start",a,d)},_slide:function(a,c,d){var e,f,g;this.options.values&&this.options.values.length?(e=this.values(c?0:1),2===this.options.values.length&&!0===this.options.range&&(0===c&&d>e||1===c&&d<e)&&(d=e),d!==this.values(c)&&(f=this.values(),f[c]=d,g=this._trigger("slide",a,{handle:this.handles[c],value:d,values:f}),this.values(c?0:1),!1!==g&&this.values(c,d,!0))):d!==this.value()&&(g=this._trigger("slide",a,{handle:this.handles[c],value:d}),
!1!==g&&this.value(d))},_stop:function(a,c){var d={handle:this.handles[c],value:this.value()};this.options.values&&this.options.values.length&&(d.value=this.values(c),d.values=this.values());this._trigger("stop",a,d)},_change:function(a,c){if(!this._keySliding&&!this._mouseSliding){var d={handle:this.handles[c],value:this.value()};this.options.values&&this.options.values.length&&(d.value=this.values(c),d.values=this.values());this._trigger("change",a,d)}},value:function(a){if(arguments.length)this.options.value=
this._trimAlignValue(a),this._refreshValue(),this._change(null,0);else return this._value()},values:function(b,c){var d,e,f;if(1<arguments.length)this.options.values[b]=this._trimAlignValue(c),this._refreshValue(),this._change(null,b);else{if(!arguments.length)return this._values();if(!a.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(b):this.value();d=this.options.values;e=arguments[0];for(f=0;f<d.length;f+=1)d[f]=this._trimAlignValue(e[f]),this._change(null,
f);this._refreshValue()}},_setOption:function(b,c){var d,e=0;a.isArray(this.options.values)&&(e=this.options.values.length);a.Widget.prototype._setOption.apply(this,arguments);switch(b){case "disabled":c?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.prop("disabled",!0),this.element.addClass("ui-disabled")):(this.handles.prop("disabled",!1),this.element.removeClass("ui-disabled"));break;case "orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+
this.orientation);this._refreshValue();break;case "value":this._animateOff=!0;this._refreshValue();this._change(null,0);this._animateOff=!1;break;case "values":this._animateOff=!0;this._refreshValue();for(d=0;d<e;d+=1)this._change(null,d);this._animateOff=!1;break;case "min":case "max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1}},_value:function(){var a=this.options.value;return a=this._trimAlignValue(a),a},_values:function(a){var c,d;if(arguments.length)return c=this.options.values[a],
c=this._trimAlignValue(c),c;c=this.options.values.slice();for(d=0;d<c.length;d+=1)c[d]=this._trimAlignValue(c[d]);return c},_trimAlignValue:function(a){if(a<=this._valueMin())return this._valueMin();if(a>=this._valueMax())return this._valueMax();var c=0<this.options.step?this.options.step:1,d=(a-this._valueMin())%c,a=a-d;return 2*Math.abs(d)>=c&&(a+=0<d?c:-c),parseFloat(a.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var b,
c,d,e,f,g=this.options.range,h=this.options,j=this,n=this._animateOff?!1:h.animate,p={};this.options.values&&this.options.values.length?this.handles.each(function(d){c=100*((j.values(d)-j._valueMin())/(j._valueMax()-j._valueMin()));p["horizontal"===j.orientation?"left":"bottom"]=c+"%";a(this).stop(1,1)[n?"animate":"css"](p,h.animate);!0===j.options.range&&("horizontal"===j.orientation?(0===d&&j.range.stop(1,1)[n?"animate":"css"]({left:c+"%"},h.animate),1===d&&j.range[n?"animate":"css"]({width:c-b+
"%"},{queue:!1,duration:h.animate})):(0===d&&j.range.stop(1,1)[n?"animate":"css"]({bottom:c+"%"},h.animate),1===d&&j.range[n?"animate":"css"]({height:c-b+"%"},{queue:!1,duration:h.animate})));b=c}):(d=this.value(),e=this._valueMin(),f=this._valueMax(),c=f!==e?100*((d-e)/(f-e)):0,p["horizontal"===this.orientation?"left":"bottom"]=c+"%",this.handle.stop(1,1)[n?"animate":"css"](p,h.animate),"min"===g&&"horizontal"===this.orientation&&this.range.stop(1,1)[n?"animate":"css"]({width:c+"%"},h.animate),"max"===
g&&"horizontal"===this.orientation&&this.range[n?"animate":"css"]({width:100-c+"%"},{queue:!1,duration:h.animate}),"min"===g&&"vertical"===this.orientation&&this.range.stop(1,1)[n?"animate":"css"]({height:c+"%"},h.animate),"max"===g&&"vertical"===this.orientation&&this.range[n?"animate":"css"]({height:100-c+"%"},{queue:!1,duration:h.animate}))}})})(jQuery);
jQuery.effects||function(a,b){var c=!1!==a.uiBackCompat;a.effects={effect:{}};var d=jQuery,e=function(a,b,c){var d=q[b.type]||{};return null==a?c||!b.def?null:b.def:(a=d.floor?~~a:parseFloat(a),isNaN(a)?b.def:d.mod?(a+d.mod)%d.mod:0>a?0:d.max<a?d.max:a)},f=function(a){var b=n(),c=b._rgba=[];return a=a.toLowerCase(),t(j,function(d,e){var f,h=e.re.exec(a),h=h&&e.parse(h),g=e.space||"rgba";if(h)return f=b[g](h),b[p[g].cache]=f[p[g].cache],c=b._rgba=f._rgba,!1}),c.length?("0,0,0,0"===c.join()&&d.extend(c,
s.transparent),b):s[a]},g=function(a,b,c){return c=(c+1)%1,1>6*c?a+6*(b-a)*c:1>2*c?b:2>3*c?a+6*(b-a)*(2/3-c):a},h=/^([\-+])=\s*(\d+\.?\d*)/,j=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(a){return[a[1],a[2],a[3],a[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(a){return[2.55*a[1],2.55*a[2],2.55*a[3],a[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,
parse:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(a){return[a[1],a[2]/100,a[3]/100,a[4]]}}],n=d.Color=function(a,b,c,e){return new d.Color.fn.parse(a,b,c,e)},p={rgba:{props:{red:{idx:0,type:"byte"},
green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},q={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},m=n.support={},r=d("<p>")[0],s,t=d.each;r.style.cssText="background-color:rgba(1,1,1,.5)";m.rgba=-1<r.style.backgroundColor.indexOf("rgba");t(p,function(a,b){b.cache="_"+a;b.props.alpha={idx:3,type:"percent",def:1}});n.fn=d.extend(n.prototype,{parse:function(b,c,h,
g){if(void 0===b)return this._rgba=[null,null,null,null],this;if(b.jquery||b.nodeType)b=d(b).css(c),c=void 0;var j=this,m=d.type(b),q=this._rgba=[];void 0!==c&&(b=[b,c,h,g],m="array");if("string"===m)return this.parse(f(b)||s._default);if("array"===m)return t(p.rgba.props,function(a,c){q[c.idx]=e(b[c.idx],c)}),this;if("object"===m)return b instanceof n?t(p,function(a,c){b[c.cache]&&(j[c.cache]=b[c.cache].slice())}):t(p,function(c,d){var f=d.cache;t(d.props,function(a,c){if(!j[f]&&d.to){if("alpha"===
a||null==b[a])return;j[f]=d.to(j._rgba)}j[f][c.idx]=e(b[a],c,!0)});j[f]&&0>a.inArray(null,j[f].slice(0,3))&&(j[f][3]=1,d.from&&(j._rgba=d.from(j[f])))}),this},is:function(a){var b=n(a),c=!0,d=this;return t(p,function(a,e){var f,h=b[e.cache];return h&&(f=d[e.cache]||e.to&&e.to(d._rgba)||[],t(e.props,function(a,b){if(null!=h[b.idx])return c=h[b.idx]===f[b.idx],c})),c}),c},_space:function(){var a=[],b=this;return t(p,function(c,d){b[d.cache]&&a.push(c)}),a.pop()},transition:function(a,b){var c=n(a),
d=c._space(),f=p[d],h=0===this.alpha()?n("transparent"):this,g=h[f.cache]||f.to(h._rgba),j=g.slice();return c=c[f.cache],t(f.props,function(a,d){var f=d.idx,h=g[f],n=c[f],p=q[d.type]||{};null!==n&&(null===h?j[f]=n:(p.mod&&(n-h>p.mod/2?h+=p.mod:h-n>p.mod/2&&(h-=p.mod)),j[f]=e((n-h)*b+h,d)))}),this[d](j)},blend:function(a){if(1===this._rgba[3])return this;var b=this._rgba.slice(),c=b.pop(),e=n(a)._rgba;return n(d.map(b,function(a,b){return(1-c)*e[b]+c*a}))},toRgbaString:function(){var a="rgba(",b=d.map(this._rgba,
function(a,b){return null==a?2<b?1:0:a});return 1===b[3]&&(b.pop(),a="rgb("),a+b.join()+")"},toHslaString:function(){var a="hsla(",b=d.map(this.hsla(),function(a,b){return null==a&&(a=2<b?1:0),b&&3>b&&(a=Math.round(100*a)+"%"),a});return 1===b[3]&&(b.pop(),a="hsl("),a+b.join()+")"},toHexString:function(a){var b=this._rgba.slice(),c=b.pop();return a&&b.push(~~(255*c)),"#"+d.map(b,function(a){return a=(a||0).toString(16),1===a.length?"0"+a:a}).join("")},toString:function(){return 0===this._rgba[3]?
"transparent":this.toRgbaString()}});n.fn.parse.prototype=n.fn;p.hsla.to=function(a){if(null==a[0]||null==a[1]||null==a[2])return[null,null,null,a[3]];var b=a[0]/255,c=a[1]/255,d=a[2]/255,a=a[3],e=Math.max(b,c,d),f=Math.min(b,c,d),h=e-f,g=e+f,j=0.5*g,n,p;return f===e?n=0:b===e?n=60*(c-d)/h+360:c===e?n=60*(d-b)/h+120:n=60*(b-c)/h+240,0===j||1===j?p=j:0.5>=j?p=h/g:p=h/(2-g),[Math.round(n)%360,p,j,null==a?1:a]};p.hsla.from=function(a){if(null==a[0]||null==a[1]||null==a[2])return[null,null,null,a[3]];
var b=a[0]/360,c=a[1],d=a[2],a=a[3],c=0.5>=d?d*(1+c):d+c-d*c,d=2*d-c;return[Math.round(255*g(d,c,b+1/3)),Math.round(255*g(d,c,b)),Math.round(255*g(d,c,b-1/3)),a]};t(p,function(a,b){var c=b.props,f=b.cache,g=b.to,j=b.from;n.fn[a]=function(a){g&&!this[f]&&(this[f]=g(this._rgba));if(void 0===a)return this[f].slice();var b,h=d.type(a),p="array"===h||"object"===h?a:arguments,m=this[f].slice();return t(c,function(a,b){var c=p["object"===h?a:b.idx];null==c&&(c=m[b.idx]);m[b.idx]=e(c,b)}),j?(b=n(j(m)),b[f]=
m,b):n(m)};t(c,function(b,c){n.fn[b]||(n.fn[b]=function(e){var f=d.type(e),g="alpha"===b?this._hsla?"hsla":"rgba":a,j=this[g](),n=j[c.idx],p;return"undefined"===f?n:("function"===f&&(e=e.call(this,n),f=d.type(e)),null==e&&c.empty?this:("string"===f&&(p=h.exec(e),p&&(e=n+parseFloat(p[2])*("+"===p[1]?1:-1))),j[c.idx]=e,this[g](j)))})})});t("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor".split(" "),
function(a,b){d.cssHooks[b]={set:function(a,c){var e,h="";if("string"!==d.type(c)||(e=f(c))){c=n(e||c);if(!m.rgba&&1!==c._rgba[3]){for(e="backgroundColor"===b?a.parentNode:a;(""===h||"transparent"===h)&&e&&e.style;)try{h=d.css(e,"backgroundColor"),e=e.parentNode}catch(g){}c=c.blend(h&&"transparent"!==h?h:"_default")}c=c.toRgbaString()}try{a.style[b]=c}catch(j){}}};d.fx.step[b]=function(a){a.colorInit||(a.start=n(a.elem,b),a.end=n(a.end),a.colorInit=!0);d.cssHooks[b].set(a.elem,a.start.transition(a.end,
a.pos))}});d.cssHooks.borderColor={expand:function(a){var b={};return t(["Top","Right","Bottom","Left"],function(c,d){b["border"+d+"Color"]=a}),b}};s=d.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"};var v=function(){var b=this.ownerDocument.defaultView?
this.ownerDocument.defaultView.getComputedStyle(this,null):this.currentStyle,c={},d,e;if(b&&b.length&&b[0]&&b[b[0]])for(e=b.length;e--;)d=b[e],"string"==typeof b[d]&&(c[a.camelCase(d)]=b[d]);else for(d in b)"string"==typeof b[d]&&(c[d]=b[d]);return c},u=["add","remove","toggle"],w={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};a.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(b,c){a.fx.step[c]=
function(a){if("none"!==a.end&&!a.setAttr||1===a.pos&&!a.setAttr)jQuery.style(a.elem,c,a.end),a.setAttr=!0}});a.effects.animateClass=function(b,c,d,e){var f=a.speed(c,d,e);return this.queue(function(){var c=a(this),d=c.attr("class")||"",e,h=f.children?c.find("*").andSelf():c,h=h.map(function(){return{el:a(this),start:v.call(this)}});e=function(){a.each(u,function(a,d){b[d]&&c[d+"Class"](b[d])})};e();h=h.map(function(){this.end=v.call(this.el[0]);var b=this.start,c=this.end,d={},e,f;for(e in c)f=c[e],
b[e]!==f&&!w[e]&&(a.fx.step[e]||!isNaN(parseFloat(f)))&&(d[e]=f);return this.diff=d,this});c.attr("class",d);h=h.map(function(){var b=this,c=a.Deferred(),d=jQuery.extend({},f,{queue:!1,complete:function(){c.resolve(b)}});return this.el.animate(this.diff,d),c.promise()});a.when.apply(a,h.get()).done(function(){e();a.each(arguments,function(){var b=this.el;a.each(this.diff,function(a){b.css(a,"")})});f.complete.call(c[0])})})};a.fn.extend({_addClass:a.fn.addClass,addClass:function(b,c,d,e){return c?
a.effects.animateClass.call(this,{add:b},c,d,e):this._addClass(b)},_removeClass:a.fn.removeClass,removeClass:function(b,c,d,e){return c?a.effects.animateClass.call(this,{remove:b},c,d,e):this._removeClass(b)},_toggleClass:a.fn.toggleClass,toggleClass:function(c,d,e,f,h){return"boolean"==typeof d||d===b?e?a.effects.animateClass.call(this,d?{add:c}:{remove:c},e,f,h):this._toggleClass(c,d):a.effects.animateClass.call(this,{toggle:c},d,e,f)},switchClass:function(b,c,d,e,f){return a.effects.animateClass.call(this,
{add:c,remove:b},d,e,f)}});var y=function(b,c,d,e){a.isPlainObject(b)&&(c=b,b=b.effect);b={effect:b};null==c&&(c={});a.isFunction(c)&&(e=c,d=null,c={});if("number"==typeof c||a.fx.speeds[c])e=d,d=c,c={};return a.isFunction(d)&&(e=d,d=null),c&&a.extend(b,c),d=d||c.duration,b.duration=a.fx.off?0:"number"==typeof d?d:d in a.fx.speeds?a.fx.speeds[d]:a.fx.speeds._default,b.complete=e||c.complete,b},A=function(b){return!b||"number"==typeof b||a.fx.speeds[b]?!0:"string"==typeof b&&!a.effects.effect[b]?c&&
a.effects[b]?!1:!0:!1};a.extend(a.effects,{version:"1.9.1",save:function(a,b){for(var c=0;c<b.length;c++)null!==b[c]&&a.data("ui-effects-"+b[c],a[0].style[b[c]])},restore:function(a,c){var d,e;for(e=0;e<c.length;e++)null!==c[e]&&(d=a.data("ui-effects-"+c[e]),d===b&&(d=""),a.css(c[e],d))},setMode:function(a,b){return"toggle"===b&&(b=a.is(":hidden")?"show":"hide"),b},getBaseline:function(a,b){var c,d;switch(a[0]){case "top":c=0;break;case "middle":c=0.5;break;case "bottom":c=1;break;default:c=a[0]/
b.height}switch(a[1]){case "left":d=0;break;case "center":d=0.5;break;case "right":d=1;break;default:d=a[1]/b.width}return{x:d,y:c}},createWrapper:function(b){if(b.parent().is(".ui-effects-wrapper"))return b.parent();var c={width:b.outerWidth(!0),height:b.outerHeight(!0),"float":b.css("float")},d=a("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),e={width:b.width(),height:b.height()},f=document.activeElement;try{f.id}catch(h){f=
document.body}return b.wrap(d),(b[0]===f||a.contains(b[0],f))&&a(f).focus(),d=b.parent(),"static"===b.css("position")?(d.css({position:"relative"}),b.css({position:"relative"})):(a.extend(c,{position:b.css("position"),zIndex:b.css("z-index")}),a.each(["top","left","bottom","right"],function(a,d){c[d]=b.css(d);isNaN(parseInt(c[d],10))&&(c[d]="auto")}),b.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),b.css(e),d.css(c).show()},removeWrapper:function(b){var c=document.activeElement;
return b.parent().is(".ui-effects-wrapper")&&(b.parent().replaceWith(b),(b[0]===c||a.contains(b[0],c))&&a(c).focus()),b},setTransition:function(b,c,d,e){return e=e||{},a.each(c,function(a,c){var f=b.cssUnit(c);0<f[0]&&(e[c]=f[0]*d+f[1])}),e}});a.fn.extend({effect:function(){function b(c){function e(){a.isFunction(g)&&g.call(f[0]);a.isFunction(c)&&c()}var f=a(this),g=d.complete,j=d.mode;(f.is(":hidden")?"hide"===j:"show"===j)?e():h.call(f[0],d,e)}var d=y.apply(this,arguments),e=d.mode,f=d.queue,h=
a.effects.effect[d.effect],g=!h&&c&&a.effects[d.effect];return a.fx.off||!h&&!g?e?this[e](d.duration,d.complete):this.each(function(){d.complete&&d.complete.call(this)}):h?!1===f?this.each(b):this.queue(f||"fx",b):g.call(this,{options:d,duration:d.duration,callback:d.complete,mode:d.mode})},_show:a.fn.show,show:function(a){if(A(a))return this._show.apply(this,arguments);var b=y.apply(this,arguments);return b.mode="show",this.effect.call(this,b)},_hide:a.fn.hide,hide:function(a){if(A(a))return this._hide.apply(this,
arguments);var b=y.apply(this,arguments);return b.mode="hide",this.effect.call(this,b)},__toggle:a.fn.toggle,toggle:function(b){if(A(b)||"boolean"==typeof b||a.isFunction(b))return this.__toggle.apply(this,arguments);var c=y.apply(this,arguments);return c.mode="toggle",this.effect.call(this,c)},cssUnit:function(b){var c=this.css(b),d=[];return a.each(["em","px","%","pt"],function(a,b){0<c.indexOf(b)&&(d=[parseFloat(c),b])}),d}});var B={};a.each(["Quad","Cubic","Quart","Quint","Expo"],function(a,b){B[b]=
function(b){return Math.pow(b,a+2)}});a.extend(B,{Sine:function(a){return 1-Math.cos(a*Math.PI/2)},Circ:function(a){return 1-Math.sqrt(1-a*a)},Elastic:function(a){return 0===a||1===a?a:-Math.pow(2,8*(a-1))*Math.sin((80*(a-1)-7.5)*Math.PI/15)},Back:function(a){return a*a*(3*a-2)},Bounce:function(a){for(var b,c=4;a<((b=Math.pow(2,--c))-1)/11;);return 1/Math.pow(4,3-c)-7.5625*Math.pow((3*b-2)/22-a,2)}});a.each(B,function(b,c){a.easing["easeIn"+b]=c;a.easing["easeOut"+b]=function(a){return 1-c(1-a)};
a.easing["easeInOut"+b]=function(a){return 0.5>a?c(2*a)/2:1-c(-2*a+2)/2}})}(jQuery);
(function(a){function b(a,b){if(!(1<a.originalEvent.touches.length)){a.preventDefault();var c=a.originalEvent.changedTouches[0],d=document.createEvent("MouseEvents");d.initMouseEvent(b,!0,!0,window,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,null);a.target.dispatchEvent(d)}}a.support.touch="ontouchend"in document;if(a.support.touch){var c=a.ui.mouse.prototype,d=c._mouseInit,e;c._touchStart=function(a){!e&&this._mouseCapture(a.originalEvent.changedTouches[0])&&(e=!0,this._touchMoved=!1,
b(a,"mouseover"),b(a,"mousemove"),b(a,"mousedown"))};c._touchMove=function(a){e&&(this._touchMoved=!0,b(a,"mousemove"))};c._touchEnd=function(a){e&&(b(a,"mouseup"),b(a,"mouseout"),this._touchMoved||b(a,"click"),e=!1)};c._mouseInit=function(){this.element.bind("touchstart",a.proxy(this,"_touchStart")).bind("touchmove",a.proxy(this,"_touchMove")).bind("touchend",a.proxy(this,"_touchEnd"));d.call(this)}}})(jQuery);
(function(a){a.widget("ui.rangeSliderMouseTouch",a.ui.mouse,{_mouseInit:function(){var b=this;a.ui.mouse.prototype._mouseInit.apply(this);this._mouseDownEvent=!1;this.element.bind("touchstart."+this.widgetName,function(a){return b._touchStart(a)})},_mouseDestroy:function(){a(document).unbind("touchmove."+this.widgetName,this._touchMoveDelegate).unbind("touchend."+this.widgetName,this._touchEndDelegate);a.ui.mouse.prototype._mouseDestroy.apply(this)},_touchStart:function(b){b.which=1;b.preventDefault();
this._fillTouchEvent(b);var c=this,d=this._mouseDownEvent;this._mouseDown(b);d!==this._mouseDownEvent&&(this._touchEndDelegate=function(a){c._touchEnd(a)},this._touchMoveDelegate=function(a){c._touchMove(a)},a(document).bind("touchmove."+this.widgetName,this._touchMoveDelegate).bind("touchend."+this.widgetName,this._touchEndDelegate))},_touchEnd:function(b){this._fillTouchEvent(b);this._mouseUp(b);a(document).unbind("touchmove."+this.widgetName,this._touchMoveDelegate).unbind("touchend."+this.widgetName,
this._touchEndDelegate);this._mouseDownEvent=!1;a(document).trigger("mouseup")},_touchMove:function(a){a.preventDefault();this._fillTouchEvent(a);return this._mouseMove(a)},_fillTouchEvent:function(a){var c;c="undefined"===typeof a.targetTouches&&"undefined"===typeof a.changedTouches?a.originalEvent.targetTouches[0]||a.originalEvent.changedTouches[0]:a.targetTouches[0]||a.changedTouches[0];a.pageX=c.pageX;a.pageY=c.pageY}})})(jQuery);
(function(a){a.widget("ui.rangeSliderDraggable",a.ui.rangeSliderMouseTouch,{cache:null,options:{containment:null},_create:function(){setTimeout(a.proxy(this._initElement,this),10)},_initElement:function(){this._mouseInit();this._cache()},_setOption:function(b,c){"containment"==b&&(this.options.containment=null===c||0==a(c).length?null:a(c))},_mouseStart:function(a){this._cache();this.cache.click={left:a.pageX,top:a.pageY};this.cache.initialOffset=this.element.offset();this._triggerMouseEvent("mousestart");
return!0},_mouseDrag:function(a){a=a.pageX-this.cache.click.left;a=this._constraintPosition(a+this.cache.initialOffset.left);this._applyPosition(a);this._triggerMouseEvent("sliderDrag");return!1},_mouseStop:function(){this._triggerMouseEvent("stop")},_constraintPosition:function(a){0!==this.element.parent().length&&null!=this.cache.parent.offset&&(a=Math.min(a,this.cache.parent.offset.left+this.cache.parent.width-this.cache.width.outer),a=Math.max(a,this.cache.parent.offset.left));return a},_applyPosition:function(a){var c=
{top:this.cache.offset.top,left:a};this.element.offset({left:a});this.cache.offset=c},_cacheIfNecessary:function(){null===this.cache&&this._cache()},_cache:function(){this.cache={};this._cacheMargins();this._cacheParent();this._cacheDimensions();this.cache.offset=this.element.offset()},_cacheMargins:function(){this.cache.margin={left:this._parsePixels(this.element,"marginLeft"),right:this._parsePixels(this.element,"marginRight"),top:this._parsePixels(this.element,"marginTop"),bottom:this._parsePixels(this.element,
"marginBottom")}},_cacheParent:function(){if(null!==this.options.parent){var a=this.element.parent();this.cache.parent={offset:a.offset(),width:a.width()}}else this.cache.parent=null},_cacheDimensions:function(){this.cache.width={outer:this.element.outerWidth(),inner:this.element.width()}},_parsePixels:function(a,c){return parseInt(a.css(c),10)||0},_triggerMouseEvent:function(a){var c=this._prepareEventData();this.element.trigger(a,c)},_prepareEventData:function(){return{element:this.element,offset:this.cache.offset||
null}}})})(jQuery);
(function(a){a.widget("ui.rangeSliderHandle",a.ui.rangeSliderDraggable,{currentMove:null,margin:0,parentElement:null,options:{isLeft:!0,bounds:{min:0,max:100},range:!1,value:0,step:!1},_value:0,_left:0,_create:function(){a.ui.rangeSliderDraggable.prototype._create.apply(this);this.element.css("position","absolute").css("top",0).addClass("ui-rangeSlider-handle").toggleClass("ui-rangeSlider-leftHandle",this.options.isLeft).toggleClass("ui-rangeSlider-rightHandle",!this.options.isLeft);this._value=this.options.value},
_setOption:function(b,c){"isLeft"===b&&(!0===c||!1===c)&&c!=this.options.isLeft?(this.options.isLeft=c,this.element.toggleClass("ui-rangeSlider-leftHandle",this.options.isLeft).toggleClass("ui-rangeSlider-rightHandle",!this.options.isLeft),this._position(this._value),this.element.trigger("switch",this.options.isLeft)):"step"===b&&this._checkStep(c)?(this.options.step=c,this.update()):"bounds"===b?(this.options.bounds=c,this.update()):"range"===b&&this._checkRange(c)&&(this.options.range=c,this.update());
a.ui.rangeSliderDraggable.prototype._setOption.apply(this,[b,c])},_checkRange:function(a){return!1===a||("undefined"===typeof a.min||!1===a.min||parseFloat(a.min)===a.min)&&("undefined"===typeof a.max||!1===a.max||parseFloat(a.max)===a.max)},_checkStep:function(a){return!1===a||parseFloat(a)==a},_initElement:function(){a.ui.rangeSliderDraggable.prototype._initElement.apply(this);0===this.cache.parent.width||null===this.cache.parent.width?setTimeout(a.proxy(this._initElement,this),500):(this._position(this.options.value),
this._triggerMouseEvent("initialize"))},_bounds:function(){return this.options.bounds},_cache:function(){a.ui.rangeSliderDraggable.prototype._cache.apply(this);this._cacheParent()},_cacheParent:function(){var a=this.element.parent();this.cache.parent={element:a,offset:a.offset(),padding:{left:this._parsePixels(a,"paddingLeft")},width:a.width()}},_position:function(a){a=this._getPositionForValue(a);this._applyPosition(a)},_constraintPosition:function(a){a=this._getValueForPosition(a);return this._getPositionForValue(a)},
_applyPosition:function(b){a.ui.rangeSliderDraggable.prototype._applyPosition.apply(this,[b]);this._left=b;this._setValue(this._getValueForPosition(b));this._triggerMouseEvent("moving")},_prepareEventData:function(){var b=a.ui.rangeSliderDraggable.prototype._prepareEventData.apply(this);b.value=this._value;return b},_setValue:function(a){a!=this._value&&(this._value=a)},_constraintValue:function(a){a=Math.min(a,this._bounds().max);a=Math.max(a,this._bounds().min);a=this._round(a);if(!1!==this.options.range){var c=
this.options.range.min||!1,d=this.options.range.max||!1;!1!==c&&(a=Math.max(a,this._round(c)));!1!==d&&(a=Math.min(a,this._round(d)))}return a},_round:function(a){return!1!==this.options.step&&0<this.options.step?Math.round(a/this.options.step)*this.options.step:a},_getPositionForValue:function(a){if(null==this.cache.parent.offset)return 0;a=this._constraintValue(a);return(a-this.options.bounds.min)/(this.options.bounds.max-this.options.bounds.min)*(this.cache.parent.width-this.cache.width.outer)+
this.cache.parent.offset.left},_getValueForPosition:function(a){a=this._getRawValueForPositionAndBounds(a,this.options.bounds.min,this.options.bounds.max);return this._constraintValue(a)},_getRawValueForPositionAndBounds:function(a,c,d){return(a-(null==this.cache.parent.offset?0:this.cache.parent.offset.left))/(this.cache.parent.width-this.cache.width.outer)*(d-c)+c},value:function(a){"undefined"!=typeof a&&(this._cache(),a=this._constraintValue(a),this._position(a));return this._value},update:function(){this._cache();
var a=this._constraintValue(this._value),c=this._getPositionForValue(a);a!=this._value?(this._triggerMouseEvent("updating"),this._position(a),this._triggerMouseEvent("update")):c!=this.cache.offset.left&&(this._triggerMouseEvent("updating"),this._position(a),this._triggerMouseEvent("update"))},position:function(a){"undefined"!=typeof a&&(this._cache(),a=this._constraintPosition(a),this._applyPosition(a));return this._left},add:function(a,c){return a+c},substract:function(a,c){return a-c},stepsBetween:function(a,
c){return!1===this.options.step?c-a:(c-a)/this.options.step},multiplyStep:function(a,c){return a*c},moveRight:function(a){var c;if(!1==this.options.step)return c=this._left,this.position(this._left+a),this._left-c;c=this._value;this.value(this.add(c,this.multiplyStep(this.options.step,a)));return this.stepsBetween(c,this._value)},moveLeft:function(a){return-this.moveRight(-a)},stepRatio:function(){return!1==this.options.step?1:this.cache.parent.width/((this.options.bounds.max-this.options.bounds.min)/
this.options.step)}})})(jQuery);
(function(a){a.widget("ui.rangeSliderBar",a.ui.rangeSliderDraggable,{options:{leftHandle:null,rightHandle:null,bounds:{min:0,max:100},type:"rangeSliderHandle",range:!1,drag:function(){},stop:function(){},values:{min:0,max:20},wheelSpeed:4,wheelMode:null},_values:{min:0,max:20},_waitingToInit:2,_wheelTimeout:!1,_create:function(){a.ui.rangeSliderDraggable.prototype._create.apply(this);this.element.css("position","absolute").css("top",0).addClass("ui-rangeSlider-bar");this.options.leftHandle.bind("initialize",
a.proxy(this._onInitialized,this)).bind("mousestart",a.proxy(this._cache,this)).bind("stop",a.proxy(this._onHandleStop,this));this.options.rightHandle.bind("initialize",a.proxy(this._onInitialized,this)).bind("mousestart",a.proxy(this._cache,this)).bind("stop",a.proxy(this._onHandleStop,this));this._bindHandles();this._values=this.options.values;this._setWheelModeOption(this.options.wheelMode)},_setOption:function(a,c){"range"===a?this._setRangeOption(c):"wheelSpeed"===a?this._setWheelSpeedOption(c):
"wheelMode"===a&&this._setWheelModeOption(c)},_setRangeOption:function(a){if("object"!=typeof a||null===a)a=!1;!1===a&&!1===this.options.range||(this.options.range=!1!==a?{min:"undefined"===typeof a.min?this.options.range.min||!1:a.min,max:"undefined"===typeof a.max?this.options.range.max||!1:a.max}:!1,this._setLeftRange(),this._setRightRange())},_setWheelSpeedOption:function(a){"number"===typeof a&&0<a&&(this.options.wheelSpeed=a)},_setWheelModeOption:function(a){if(null===a||!1===a||"zoom"===a||
"scroll"===a)this.options.wheelMode!==a&&this.element.parent().unbind("mousewheel.bar"),this._bindMouseWheel(a),this.options.wheelMode=a},_bindMouseWheel:function(b){"zoom"===b?this.element.parent().bind("mousewheel.bar",a.proxy(this._mouseWheelZoom,this)):"scroll"===b&&this.element.parent().bind("mousewheel.bar",a.proxy(this._mouseWheelScroll,this))},_setLeftRange:function(){if(!1==this.options.range)return!1;var a=this._values.max,c={min:!1,max:!1};c.max=!1!==(this.options.range.min||!1)?this._leftHandle("substract",
a,this.options.range.min):!1;c.min=!1!==(this.options.range.max||!1)?this._leftHandle("substract",a,this.options.range.max):!1;this._leftHandle("option","range",c)},_setRightRange:function(){var a=this._values.min,c={min:!1,max:!1};c.min=!1!==(this.options.range.min||!1)?this._rightHandle("add",a,this.options.range.min):!1;c.max=!1!==(this.options.range.max||!1)?this._rightHandle("add",a,this.options.range.max):!1;this._rightHandle("option","range",c)},_deactivateRange:function(){this._leftHandle("option",
"range",!1);this._rightHandle("option","range",!1)},_reactivateRange:function(){this._setRangeOption(this.options.range)},_onInitialized:function(){this._waitingToInit--;0===this._waitingToInit&&this._initMe()},_initMe:function(){this._cache();this.min(this.options.values.min);this.max(this.options.values.max);var a=this._leftHandle("position"),c=this._rightHandle("position")+this.options.rightHandle.width();this.element.offset({left:a});this.element.css("width",c-a)},_leftHandle:function(){return this._handleProxy(this.options.leftHandle,
arguments)},_rightHandle:function(){return this._handleProxy(this.options.rightHandle,arguments)},_handleProxy:function(a,c){var d=Array.prototype.slice.call(c);return a[this.options.type].apply(a,d)},_cache:function(){a.ui.rangeSliderDraggable.prototype._cache.apply(this);this._cacheHandles()},_cacheHandles:function(){this.cache.rightHandle={};this.cache.rightHandle.width=this.options.rightHandle.width();this.cache.rightHandle.offset=this.options.rightHandle.offset();this.cache.leftHandle={};this.cache.leftHandle.offset=
this.options.leftHandle.offset()},_mouseStart:function(b){a.ui.rangeSliderDraggable.prototype._mouseStart.apply(this,[b]);this._deactivateRange()},_mouseStop:function(b){a.ui.rangeSliderDraggable.prototype._mouseStop.apply(this,[b]);this._cacheHandles();this._values.min=this._leftHandle("value");this._values.max=this._rightHandle("value");this._reactivateRange();this._leftHandle().trigger("stop");this._rightHandle().trigger("stop")},_onDragLeftHandle:function(a,c){this._cacheIfNecessary();this._switchedValues()?
(this._switchHandles(),this._onDragRightHandle(a,c)):(this._values.min=c.value,this.cache.offset.left=c.offset.left,this.cache.leftHandle.offset=c.offset,this._positionBar())},_onDragRightHandle:function(a,c){this._cacheIfNecessary();this._switchedValues()?(this._switchHandles(),this._onDragLeftHandle(a,c)):(this._values.max=c.value,this.cache.rightHandle.offset=c.offset,this._positionBar())},_positionBar:function(){var a=this.cache.rightHandle.offset.left+this.cache.rightHandle.width-this.cache.leftHandle.offset.left;
this.cache.width.inner=a;this.element.css("width",a).offset({left:this.cache.leftHandle.offset.left})},_onHandleStop:function(){this._setLeftRange();this._setRightRange()},_switchedValues:function(){if(this.min()>this.max()){var a=this._values.min;this._values.min=this._values.max;this._values.max=a;return!0}return!1},_switchHandles:function(){var a=this.options.leftHandle;this.options.leftHandle=this.options.rightHandle;this.options.rightHandle=a;this._leftHandle("option","isLeft",!0);this._rightHandle("option",
"isLeft",!1);this._bindHandles();this._cacheHandles()},_bindHandles:function(){this.options.leftHandle.unbind(".bar").bind("sliderDrag.bar update.bar moving.bar",a.proxy(this._onDragLeftHandle,this));this.options.rightHandle.unbind(".bar").bind("sliderDrag.bar update.bar moving.bar",a.proxy(this._onDragRightHandle,this))},_constraintPosition:function(b){var c={};c.left=a.ui.rangeSliderDraggable.prototype._constraintPosition.apply(this,[b]);c.left=this._leftHandle("position",c.left);b=this._rightHandle("position",
c.left+this.cache.width.outer-this.cache.rightHandle.width);c.width=b-c.left+this.cache.rightHandle.width;return c},_applyPosition:function(b){a.ui.rangeSliderDraggable.prototype._applyPosition.apply(this,[b.left]);this.element.width(b.width)},_mouseWheelZoom:function(b,c,d,e){b=this._values.min+(this._values.max-this._values.min)/2;c={};d={};!1===this.options.range||!1===this.options.range.min?(c.max=b,d.min=b):(c.max=b-this.options.range.min/2,d.min=b+this.options.range.min/2);!1!==this.options.range&&
!1!==this.options.range.max&&(c.min=b-this.options.range.max/2,d.max=b+this.options.range.max/2);this._leftHandle("option","range",c);this._rightHandle("option","range",d);clearTimeout(this._wheelTimeout);this._wheelTimeout=setTimeout(a.proxy(this._wheelStop,this),200);this.zoomOut(e*this.options.wheelSpeed);return!1},_mouseWheelScroll:function(b,c,d,e){!1===this._wheelTimeout?this.startScroll():clearTimeout(this._wheelTimeout);this._wheelTimeout=setTimeout(a.proxy(this._wheelStop,this),200);this.scrollLeft(e*
this.options.wheelSpeed);return!1},_wheelStop:function(){this.stopScroll();this._wheelTimeout=!1},min:function(a){return this._leftHandle("value",a)},max:function(a){return this._rightHandle("value",a)},startScroll:function(){this._deactivateRange()},stopScroll:function(){this._reactivateRange();this._triggerMouseEvent("stop")},scrollLeft:function(a){a=a||1;if(0>a)return this.scrollRight(-a);a=this._leftHandle("moveLeft",a);this._rightHandle("moveLeft",a);this.update();this._triggerMouseEvent("scroll")},
scrollRight:function(a){a=a||1;if(0>a)return this.scrollLeft(-a);a=this._rightHandle("moveRight",a);this._leftHandle("moveRight",a);this.update();this._triggerMouseEvent("scroll")},zoomIn:function(a){a=a||1;if(0>a)return this.zoomOut(-a);var c=this._rightHandle("moveLeft",a);a>c&&(c/=2,this._rightHandle("moveRight",c));this._leftHandle("moveRight",c);this.update();this._triggerMouseEvent("zoom")},zoomOut:function(a){a=a||1;if(0>a)return this.zoomIn(-a);var c=this._rightHandle("moveRight",a);a>c&&
(c/=2,this._rightHandle("moveLeft",c));this._leftHandle("moveLeft",c);this.update();this._triggerMouseEvent("zoom")},values:function(a,c){if("undefined"!==typeof a&&"undefined"!==typeof c){var d=Math.min(a,c),e=Math.max(a,c);this._deactivateRange();this.options.leftHandle.unbind(".bar");this.options.rightHandle.unbind(".bar");this._values.min=this._leftHandle("value",d);this._values.max=this._rightHandle("value",e);this._bindHandles();this._reactivateRange();this.update()}return{min:this._values.min,
max:this._values.max}},update:function(){this._values.min=this.min();this._values.max=this.max();this._cache();this._positionBar()}})})(jQuery);
(function(a){function b(b,d,e,f){this.label1=b;this.label2=d;this.type=e;this.options=f;this.handle1=this.label1[this.type]("option","handle");this.handle2=this.label2[this.type]("option","handle");this.cache=null;this.left=b;this.right=d;this.updating=this.initialized=this.moving=!1;this.Init=function(){this.BindHandle(this.handle1);this.BindHandle(this.handle2);"show"===this.options.show?(setTimeout(a.proxy(this.PositionLabels,this),1),this.initialized=!0):setTimeout(a.proxy(this.AfterInit,this),
1E3)};this.AfterInit=function(){this.initialized=!0};this.Cache=function(){"none"!=this.label1.css("display")&&(this.cache={},this.cache.label1={},this.cache.label2={},this.cache.handle1={},this.cache.handle2={},this.cache.offsetParent={},this.CacheElement(this.label1,this.cache.label1),this.CacheElement(this.label2,this.cache.label2),this.CacheElement(this.handle1,this.cache.handle1),this.CacheElement(this.handle2,this.cache.handle2),this.CacheElement(this.label1.offsetParent(),this.cache.offsetParent))};
this.CacheIfNecessary=function(){null===this.cache?this.Cache():(this.CacheWidth(this.label1,this.cache.label1),this.CacheWidth(this.label2,this.cache.label2),this.CacheHeight(this.label1,this.cache.label1),this.CacheHeight(this.label2,this.cache.label2),this.CacheWidth(this.label1.offsetParent(),this.cache.offsetParent))};this.CacheElement=function(a,b){this.CacheWidth(a,b);this.CacheHeight(a,b);b.offset=a.offset();b.margin={left:this.ParsePixels("marginLeft",a),right:this.ParsePixels("marginRight",
a)};b.border={left:this.ParsePixels("borderLeftWidth",a),right:this.ParsePixels("borderRightWidth",a)}};this.CacheWidth=function(a,b){b.width=a.width();b.outerWidth=a.outerWidth()};this.CacheHeight=function(a,b){b.outerHeightMargin=a.outerHeight(!0)};this.ParsePixels=function(a,b){return parseInt(b.css(a),10)||0};this.BindHandle=function(b){b.bind("updating",a.proxy(this.onHandleUpdating,this));b.bind("update",a.proxy(this.onHandleUpdated,this));b.bind("moving",a.proxy(this.onHandleMoving,this));
b.bind("stop",a.proxy(this.onHandleStop,this))};this.PositionLabels=function(){this.CacheIfNecessary();if(null!=this.cache){var a=this.GetRawPosition(this.cache.label1,this.cache.handle1),b=this.GetRawPosition(this.cache.label2,this.cache.handle2);this.ConstraintPositions(a,b);this.PositionLabel(this.label1,a.left,this.cache.label1);this.PositionLabel(this.label2,b.left,this.cache.label2)}};this.PositionLabel=function(a,b,c){var d=this.cache.offsetParent.offset.left+this.cache.offsetParent.border.left;
0<=d-b?(a.css("right",""),a.offset({left:b})):(d+=this.cache.offsetParent.width,b=b+c.margin.left+c.outerWidth+c.margin.right,b=d-b,a.css("left",""),a.css("right",b))};this.ConstraintPositions=function(a,b){a.center<b.center&&a.outerRight>b.outerLeft?(a=this.getLeftPosition(a,b),this.getRightPosition(a,b)):a.center>b.center&&b.outerRight>a.outerLeft&&(b=this.getLeftPosition(b,a),this.getRightPosition(b,a))};this.getLeftPosition=function(a,b){a.left=(b.center+a.center)/2-a.cache.outerWidth-a.cache.margin.right+
a.cache.border.left;return a};this.getRightPosition=function(a,b){b.left=(b.center+a.center)/2+b.cache.margin.left+b.cache.border.left;return b};this.ShowIfNecessary=function(){"show"===this.options.show||this.moving||(!this.initialized||this.updating)||(this.label1.stop(!0,!0).fadeIn(this.options.durationIn||0),this.label2.stop(!0,!0).fadeIn(this.options.durationIn||0),this.moving=!0)};this.HideIfNeeded=function(){!0===this.moving&&(this.label1.stop(!0,!0).delay(this.options.delayOut||0).fadeOut(this.options.durationOut||
0),this.label2.stop(!0,!0).delay(this.options.delayOut||0).fadeOut(this.options.durationOut||0),this.moving=!1)};this.onHandleMoving=function(a,b){this.ShowIfNecessary();this.CacheIfNecessary();this.UpdateHandlePosition(b);this.PositionLabels()};this.onHandleUpdating=function(){this.updating=!0};this.onHandleUpdated=function(){this.updating=!1;this.cache=null};this.onHandleStop=function(){this.HideIfNeeded()};this.UpdateHandlePosition=function(a){null!=this.cache&&(a.element[0]==this.handle1[0]?this.UpdatePosition(a,
this.cache.handle1):this.UpdatePosition(a,this.cache.handle2))};this.UpdatePosition=function(a,b){b.offset=a.offset};this.GetRawPosition=function(a,b){var c=b.offset.left+b.outerWidth/2,d=c-a.outerWidth/2,e=d-a.margin.left-a.border.left;return{left:d,outerLeft:e,top:b.offset.top-a.outerHeightMargin,right:d+a.outerWidth-a.border.left-a.border.right,outerRight:e+a.outerWidth+a.margin.left+a.margin.right,cache:a,center:c}};this.Init()}a.widget("ui.rangeSliderLabel",a.ui.rangeSliderMouseTouch,{options:{handle:null,
formatter:!1,handleType:"rangeSliderHandle",show:"show",durationIn:0,durationOut:500,delayOut:500,isLeft:!1},cache:null,_positionner:null,_valueContainer:null,_innerElement:null,_create:function(){this.options.isLeft=this._handle("option","isLeft");this.element.addClass("ui-rangeSlider-label").css("position","absolute").css("display","block");this._valueContainer=a("<div class='ui-rangeSlider-label-value' />").appendTo(this.element);this._innerElement=a("<div class='ui-rangeSlider-label-inner' />").appendTo(this.element);
this._toggleClass();this.options.handle.bind("moving",a.proxy(this._onMoving,this)).bind("update",a.proxy(this._onUpdate,this)).bind("switch",a.proxy(this._onSwitch,this));"show"!==this.options.show&&this.element.hide();this._mouseInit()},_handle:function(){var a=Array.prototype.slice.apply(arguments);return this.options.handle[this.options.handleType].apply(this.options.handle,a)},_setOption:function(a,b){"show"===a?this._updateShowOption(b):("durationIn"===a||"durationOut"===a||"delayOut"===a)&&
this._updateDurations(a,b)},_updateShowOption:function(a){this.options.show=a;"show"!==this.options.show?this.element.hide():(this.element.show(),this._display(this.options.handle[this.options.handleType]("value")),this._positionner.PositionLabels());this._positionner.options.show=this.options.show},_updateDurations:function(a,b){parseInt(b)===b&&(this._positionner.options[a]=b,this.options[a]=b)},_display:function(a){!1==this.options.formatter?this._displayText(Math.round(a)):this._displayText(this.options.formatter(a))},
_displayText:function(a){this._valueContainer.text(a)},_toggleClass:function(){this.element.toggleClass("ui-rangeSlider-leftLabel",this.options.isLeft).toggleClass("ui-rangeSlider-rightLabel",!this.options.isLeft)},_mouseDown:function(a){this.options.handle.trigger(a)},_mouseUp:function(a){this.options.handle.trigger(a)},_mouseMove:function(a){this.options.handle.trigger(a)},_onMoving:function(a,b){this._display(b.value)},_onUpdate:function(){"show"===this.options.show&&this.update()},_onSwitch:function(a,
b){this.options.isLeft=b;this._toggleClass();this._positionner.PositionLabels()},pair:function(a){null==this._positionner&&(this._positionner=new b(this.element,a,this.widgetName,{show:this.options.show,durationIn:this.options.durationIn,durationOut:this.options.durationOut,delayOut:this.options.delayOut}),a[this.widgetName]("positionner",this._positionner))},positionner:function(a){"undefined"!==typeof a&&(this._positionner=a);return this._positionner},update:function(){this._positionner.cache=null;
this._display(this._handle("value"));"show"==this.options.show&&this._positionner.PositionLabels()}})})(jQuery);
(function(a){a.widget("ui.rangeSlider",{options:{bounds:{min:0,max:100},defaultValues:{min:20,max:50},wheelMode:null,wheelSpeed:4,arrows:!0,valueLabels:"show",formatter:null,durationIn:0,durationOut:400,delayOut:200,range:{min:!1,max:!1},step:!1},_values:null,_valuesChanged:!1,bar:null,leftHandle:null,rightHandle:null,innerBar:null,container:null,arrows:null,labels:null,changing:{min:!1,max:!1},changed:{min:!1,max:!1},_create:function(){this._values={min:this.options.defaultValues.min,max:this.options.defaultValues.max};
this.labels={left:null,right:null,leftDisplayed:!0,rightDisplayed:!0};this.arrows={left:null,right:null};this.changing={min:!1,max:!1};this.changed={min:!1,max:!1};"absolute"!==this.element.css("position")&&this.element.css("position","relative");this.container=a("<div class='ui-rangeSlider-container' />").css("position","absolute").appendTo(this.element);this.innerBar=a("<div class='ui-rangeSlider-innerBar' />").css("position","absolute").css("top",0).css("left",0);this.leftHandle=this._createHandle({isLeft:!0,
bounds:this.options.bounds,value:this.options.defaultValues.min,step:this.options.step}).appendTo(this.container);this.rightHandle=this._createHandle({isLeft:!1,bounds:this.options.bounds,value:this.options.defaultValues.max,step:this.options.step}).appendTo(this.container);this._createBar();this.container.prepend(this.innerBar);this.arrows.left=this._createArrow("left");this.arrows.right=this._createArrow("right");this.element.addClass("ui-rangeSlider");this.options.arrows?this.element.addClass("ui-rangeSlider-withArrows"):
(this.arrows.left.css("display","none"),this.arrows.right.css("display","none"),this.element.addClass("ui-rangeSlider-noArrow"));"hide"!==this.options.valueLabels?this._createLabels():this._destroyLabels();this._bindResize();setTimeout(a.proxy(this.resize,this),1);setTimeout(a.proxy(this._initValues,this),1)},_bindResize:function(){var b=this;this._resizeProxy=function(a){b.resize(a)};a(window).resize(this._resizeProxy)},_initWidth:function(){this.container.css("width",this.element.width()-this.container.outerWidth(!0)+
this.container.width());this.innerBar.css("width",this.container.width()-this.innerBar.outerWidth(!0)+this.innerBar.width())},_initValues:function(){this.values(this.options.defaultValues.min,this.options.defaultValues.max)},_setOption:function(a,c){"defaultValues"===a?"undefined"!==typeof c.min&&"undefined"!==typeof c.max&&(parseFloat(c.min)===c.min&&parseFloat(c.max)===c.max)&&(this.options.defaultValues=c):"wheelMode"===a||"wheelSpeed"===a?(this._bar("option",a,c),this.options[a]=this._bar("option",
a)):"arrows"===a&&(!0===c||!1===c)&&c!==this.options.arrows?this._setArrowsOption(c):"valueLabels"===a?this._setLabelsOption(c):"durationIn"===a||"durationOut"===a||"delayOut"===a?this._setLabelsDurations(a,c):"formatter"===a&&null!==c&&"function"===typeof c?(this.options.formatter=c,"hide"!==this.options.valueLabels&&(this._destroyLabels(),this._createLabels())):"bounds"===a&&"undefined"!==typeof c.min&&"undefined"!==typeof c.max?this.bounds(c.min,c.max):"range"===a?(this._bar("option","range",c),
this.options.range=this._bar("option","range"),this._changed(!0)):"step"===a&&(this.options.step=c,this._leftHandle("option","step",c),this._rightHandle("option","step",c),this._changed(!0))},_validProperty:function(a,c,d){return null===a||"undefined"===typeof a[c]?d:a[c]},_setLabelsOption:function(a){"hide"!==a&&"show"!==a&&"change"!==a||(this.options.valueLabels=a,"hide"!==a?(this._createLabels(),this._leftLabel("update"),this._rightLabel("update")):this._destroyLabels())},_setArrowsOption:function(a){!0===
a?(this.element.removeClass("ui-rangeSlider-noArrow").addClass("ui-rangeSlider-withArrows"),this.arrows.left.css("display","block"),this.arrows.right.css("display","block"),this.options.arrows=!0):!1===a&&(this.element.addClass("ui-rangeSlider-noArrow").removeClass("ui-rangeSlider-withArrows"),this.arrows.left.css("display","none"),this.arrows.right.css("display","none"),this.options.arrows=!1);this._initWidth()},_setLabelsDurations:function(a,c){parseInt(c,10)===c&&(null!==this.labels.left&&this._leftLabel("option",
a,c),null!==this.labels.right&&this._rightLabel("option",a,c),this.options[a]=c)},_createHandle:function(b){return a("<div />")[this._handleType()](b).bind("sliderDrag",a.proxy(this._changing,this)).bind("stop",a.proxy(this._changed,this))},_createBar:function(){this.bar=a("<div />").prependTo(this.container).bind("sliderDrag scroll zoom",a.proxy(this._changing,this)).bind("stop",a.proxy(this._changed,this));this._bar({leftHandle:this.leftHandle,rightHandle:this.rightHandle,values:{min:this.options.defaultValues.min,
max:this.options.defaultValues.max},type:this._handleType(),range:this.options.range,wheelMode:this.options.wheelMode,wheelSpeed:this.options.wheelSpeed});this.options.range=this._bar("option","range");this.options.wheelMode=this._bar("option","wheelMode");this.options.wheelSpeed=this._bar("option","wheelSpeed")},_createArrow:function(b){var c=a("<div class='ui-rangeSlider-arrow' />").append("<div class='ui-rangeSlider-arrow-inner' />").addClass("ui-rangeSlider-"+b+"Arrow").css("position","absolute").css(b,
0).appendTo(this.element),b="right"===b?a.proxy(this._scrollRightClick,this):a.proxy(this._scrollLeftClick,this);c.bind("mousedown touchstart",b);return c},_proxy:function(a,c,d){d=Array.prototype.slice.call(d);return a[c].apply(a,d)},_handleType:function(){return"rangeSliderHandle"},_barType:function(){return"rangeSliderBar"},_bar:function(){return this._proxy(this.bar,this._barType(),arguments)},_labelType:function(){return"rangeSliderLabel"},_leftLabel:function(){return this._proxy(this.labels.left,
this._labelType(),arguments)},_rightLabel:function(){return this._proxy(this.labels.right,this._labelType(),arguments)},_leftHandle:function(){return this._proxy(this.leftHandle,this._handleType(),arguments)},_rightHandle:function(){return this._proxy(this.rightHandle,this._handleType(),arguments)},_getValue:function(a,c){c===this.rightHandle&&(a-=c.outerWidth());return a*(this.options.bounds.max-this.options.bounds.min)/(this.container.innerWidth()-c.outerWidth(!0))+this.options.bounds.min},_trigger:function(a){var c=
this;setTimeout(function(){c.element.trigger(a,{label:c.element,values:c.values()})},1)},_changing:function(){this._updateValues()&&(this._trigger("valuesChanging"),this._valuesChanged=!0)},_changed:function(a){if(this._updateValues()||this._valuesChanged)this._trigger("valuesChanged"),!0!==a&&this._trigger("userValuesChanged"),this._valuesChanged=!1},_updateValues:function(){var a=this._leftHandle("value"),c=this._rightHandle("value"),d=this._min(a,c),e=this._max(a,c),d=d!==this._values.min||e!==
this._values.max;this._values.min=this._min(a,c);this._values.max=this._max(a,c);return d},_min:function(a,c){return Math.min(a,c)},_max:function(a,c){return Math.max(a,c)},_createLabel:function(b,c){var d;null===b?(d=this._getLabelConstructorParameters(b,c),b=a("<div />").appendTo(this.element)[this._labelType()](d)):(d=this._getLabelRefreshParameters(b,c),b[this._labelType()](d));return b},_getLabelConstructorParameters:function(a,c){return{handle:c,handleType:this._handleType(),formatter:this._getFormatter(),
show:this.options.valueLabels,durationIn:this.options.durationIn,durationOut:this.options.durationOut,delayOut:this.options.delayOut}},_getLabelRefreshParameters:function(){return{formatter:this._getFormatter(),show:this.options.valueLabels,durationIn:this.options.durationIn,durationOut:this.options.durationOut,delayOut:this.options.delayOut}},_getFormatter:function(){return!1===this.options.formatter||null===this.options.formatter?this._defaultFormatter:this.options.formatter},_defaultFormatter:function(a){return Math.round(a)},
_destroyLabel:function(a){null!==a&&(a.remove(),a=null);return a},_createLabels:function(){this.labels.left=this._createLabel(this.labels.left,this.leftHandle);this.labels.right=this._createLabel(this.labels.right,this.rightHandle);this._leftLabel("pair",this.labels.right)},_destroyLabels:function(){this.labels.left=this._destroyLabel(this.labels.left);this.labels.right=this._destroyLabel(this.labels.right)},_stepRatio:function(){return this._leftHandle("stepRatio")},_scrollRightClick:function(a){a.preventDefault();
this._bar("startScroll");this._bindStopScroll();this._continueScrolling("scrollRight",4*this._stepRatio(),1)},_continueScrolling:function(a,c,d,e){this._bar(a,d);e=e||5;e--;var f=this,g=Math.max(1,4/this._stepRatio());this._scrollTimeout=setTimeout(function(){0===e&&(16<c?c=Math.max(16,c/1.5):d=Math.min(g,2*d),e=5);f._continueScrolling(a,c,d,e)},c)},_scrollLeftClick:function(a){a.preventDefault();this._bar("startScroll");this._bindStopScroll();this._continueScrolling("scrollLeft",4*this._stepRatio(),
1)},_bindStopScroll:function(){var b=this;this._stopScrollHandle=function(a){a.preventDefault();b._stopScroll()};a(document).bind("mouseup touchend",this._stopScrollHandle)},_stopScroll:function(){a(document).unbind("mouseup touchend",this._stopScrollHandle);this._bar("stopScroll");clearTimeout(this._scrollTimeout)},values:function(a,c){var d=this._bar("values",a,c);"undefined"!==typeof a&&"undefined"!==typeof c&&this._changed(!0);return d},min:function(a){this._values.min=this.values(a,this._values.max).min;
return this._values.min},max:function(a){this._values.max=this.values(this._values.min,a).max;return this._values.max},bounds:function(a,c){"undefined"!==typeof a&&"undefined"!==typeof c&&(parseFloat(a)===a&&parseFloat(c)===c&&a<c)&&(this._setBounds(a,c),this._changed(!0));return this.options.bounds},_setBounds:function(a,c){this.options.bounds={min:a,max:c};this._leftHandle("option","bounds",this.options.bounds);this._rightHandle("option","bounds",this.options.bounds);this._bar("option","bounds",
this.options.bounds)},zoomIn:function(a){this._bar("zoomIn",a)},zoomOut:function(a){this._bar("zoomOut",a)},scrollLeft:function(a){this._bar("startScroll");this._bar("scrollLeft",a);this._bar("stopScroll")},scrollRight:function(a){this._bar("startScroll");this._bar("scrollRight",a);this._bar("stopScroll")},resize:function(){this._initWidth();this._leftHandle("update");this._rightHandle("update")},destroy:function(){this.element.removeClass("ui-rangeSlider-withArrows").removeClass("ui-rangeSlider-noArrow");
this.bar.detach();this.leftHandle.detach();this.rightHandle.detach();this.innerBar.detach();this.container.detach();this.arrows.left.detach();this.arrows.right.detach();this.element.removeClass("ui-rangeSlider");this._destroyLabels();delete this.options;a(window).unbind("resize",this._resizeProxy);a.Widget.prototype.destroy.apply(this,arguments)}})})(jQuery);
(function(a){a.widget("ui.dateRangeSliderHandle",a.ui.rangeSliderHandle,{_steps:!1,_boundsValues:{},_create:function(){a.ui.rangeSliderHandle.prototype._create.apply(this);this._createBoundsValues()},_getValueForPosition:function(a){a=this._getRawValueForPositionAndBounds(a,this.options.bounds.min.valueOf(),this.options.bounds.max.valueOf());return this._constraintValue(new Date(a))},_setOption:function(b,c){"step"===b?(this.options.step=c,this._createSteps(),this.update()):(a.ui.rangeSliderHandle.prototype._setOption.apply(this,
[b,c]),"bounds"===b&&this._createBoundsValues())},_createBoundsValues:function(){this._boundsValues={min:this.options.bounds.min.valueOf(),max:this.options.bounds.max.valueOf()}},_bounds:function(){return this._boundsValues},_createSteps:function(){if(!1===this.options.step||!this._isValidStep())this._steps=!1;else{var a=new Date(this.options.bounds.min),c=new Date(this.options.bounds.max),d=a,e=0;for(this._steps=[];d<=c;)this._steps.push(d.valueOf()),d=this._addStep(a,e,this.options.step),e++}},
_isValidStep:function(){return"object"===typeof this.options.step},_addStep:function(a,c,d){a=new Date(a.valueOf());a=this._addThing(a,"FullYear",c,d.years);a=this._addThing(a,"Month",c,d.months);a=this._addThing(a,"Date",c,d.days);a=this._addThing(a,"Hours",c,d.hours);a=this._addThing(a,"Minutes",c,d.minutes);return this._addThing(a,"Seconds",c,d.seconds)},_addThing:function(a,c,d,e){if(0===d||0===(e||0))return a;a["set"+c](a["get"+c]()+d*(e||0));return a},_round:function(a){if(!1===this._steps)return a;
for(var c=this.options.bounds.min.valueOf(),c=Math.max(0,(a-c)/(this.options.bounds.max.valueOf()-c)),d=Math.floor(this._steps.length*c);this._steps[d]>a;)d--;for(;d+1<this._steps.length&&this._steps[d+1]<=a;)d++;if(d>=this._steps.length-1)return this._steps[this._steps.length-1];if(0==d)return this._steps[0];c=this._steps[d];d=this._steps[d+1];return a-c<d-a?c:d},update:function(){this._createBoundsValues();this._createSteps();a.ui.rangeSliderHandle.prototype.update.apply(this)},add:function(a,c){return this._addStep(new Date(a),
1,c).valueOf()},substract:function(a,c){return this._addStep(new Date(a),-1,c).valueOf()},stepsBetween:function(a,c){if(!1===this.options.step)return val2-val1;var d=Math.min(a,c),e=Math.max(a,c),f=0,g=!1,h=a>c;for(0>this.add(d,this.options.step)-d&&(g=!0);d<e;)g?e=this.add(e,this.options.step):d=this.add(d,this.options.step),f++;return h?-f:f},multiplyStep:function(a,c){var d={},e;for(e in a)d[e]=a[e]*c;return d},stepRatio:function(){return!1==this.options.step?1:this.cache.parent.width/this._steps.length}})})(jQuery);
(function(a){a.widget("ui.dateRangeSlider",a.ui.rangeSlider,{options:{bounds:{min:new Date(2E3,0,1),max:new Date(2012,0,1)},defaultValues:{min:new Date(2011,0,1),max:new Date(2012,0,1)}},scaleBar:null,leftBar:null,rightBar:null,_create:function(){a.ui.rangeSlider.prototype._create.apply(this);this.scaleBar=a("<div class='ui-rangeSlider-scaleBar' />");this.innerBar.append(this.scaleBar);this.leftBar=a("<div class='ui-rangeSlider-mask' />");this.innerBar.append(this.leftBar);this.rightBar=a("<div class='ui-rangeSlider-mask' />");
this.innerBar.append(this.rightBar);this.element.addClass("ui-dateRangeSlider")},destroy:function(){this.element.removeClass("ui-dateRangeSlider");a.ui.rangeSlider.prototype.destroy.apply(this)},_setOption:function(b,c){("defaultValues"===b||"bounds"===b)&&"undefined"!==typeof c&&null!==c&&"undefined"!==typeof c.min&&"undefined"!==typeof c.max&&c.min instanceof Date&&c.max instanceof Date?a.ui.rangeSlider.prototype._setOption.apply(this,[b,{min:c.min.valueOf(),max:c.max.valueOf()}]):a.ui.rangeSlider.prototype._setOption.apply(this,
this._toArray(arguments))},_handleType:function(){return"dateRangeSliderHandle"},option:function(b,c){if("bounds"===b||"defaultValues"===b){var d=a.ui.rangeSlider.prototype.option.apply(this,arguments);return{min:new Date(d.min),max:new Date(d.max)}}return a.ui.rangeSlider.prototype.option.apply(this,this._toArray(arguments))},_defaultFormatter:function(a){var c=a.getMonth()+1,d=a.getDate();return""+a.getFullYear()+"-"+(10>c?"0"+c:c)+"-"+(10>d?"0"+d:d)},_getFormatter:function(){var a=this.options.formatter;
if(!1===this.options.formatter||null===this.options.formatter)a=this._defaultFormatter;var c=a;return function(a){return c(new Date(a))}},_initWidth:function(){a.ui.rangeSlider.prototype._initWidth.apply(this);this._createScale()},values:function(b,c){var d=null,d="undefined"!==typeof b&&"undefined"!==typeof c&&b instanceof Date&&c instanceof Date?a.ui.rangeSlider.prototype.values.apply(this,[b.valueOf(),c.valueOf()]):a.ui.rangeSlider.prototype.values.apply(this,this._toArray(arguments));this._positionBars();
return{min:new Date(d.min),max:new Date(d.max)}},min:function(b){return"undefined"!==typeof b&&b instanceof Date?new Date(a.ui.rangeSlider.prototype.min.apply(this,[b.valueOf()])):new Date(a.ui.rangeSlider.prototype.min.apply(this))},max:function(b){return"undefined"!==typeof b&&b instanceof Date?new Date(a.ui.rangeSlider.prototype.max.apply(this,[b.valueOf()])):new Date(a.ui.rangeSlider.prototype.max.apply(this))},_toArray:function(a){return Array.prototype.slice.call(a)},_getScaleValue:function(a){return a*
(this.options.bounds.max.getTime()-this.options.bounds.min.getTime())/(this.scaleBar.width()-1)+this.options.bounds.min.getTime()},_getScalePosition:function(a){return(a.getTime()-this.options.bounds.min.getTime())*(this.scaleBar.width()-1)/(this.options.bounds.max.getTime()-this.options.bounds.min.getTime())},_createScale:function(){this.scaleBar.empty();var a,c,d,e,f,g="";a=this.innerBar.width();c=this.options.bounds.min.getFullYear();var h=this.options.bounds.max.getFullYear(),j=(150*(h-c)/a|0)+
1;this.scaleBar.css("width",a);for(a=c;a<=h;a++){d=this._getScalePosition(new Date(a,0,1));e=this._getScalePosition(new Date(a+1,0,1))-d;g+='<span class="ui-rangeSlider-bgy" style="left:'+d+"px;width:"+e+"px;background-color:rgba(255,255,255,"+(0===a%2?"0":"0.2")+');"></span>';0===a/j%1&&(g+='<span class="ui-rangeSlider-bigScaleUnit" style="left:'+d+'px;">'+a+"</span>");for(c=0;12>c;c++)d=this._getScalePosition(new Date(a,c,1)),e=this._getScalePosition(new Date(a,c+1,1))-d,g+='<span class="ui-rangeSlider-bgm" style="left:'+
d+"px;width:"+e+"px;background-color:rgba(0,0,0,"+(0===c%2?"0.1":"0.2")+');"></span>',f=10>c+1?"0"+(c+1):c+1,e=(150/(12*e)|0)+1,0===c/e%1&&(g+='<span class="ui-rangeSlider-scaleUnit" style="left:'+d+'px;">'+f+"</span>")}this.scaleBar.append(g)},_positionBars:function(){var b=a(".ui-rangeSlider-bar",this.element),c=this.innerBar.offset().left,d=b.offset().left+b.width();this.leftBar.offset({left:c}).css("width",b.offset().left-c);this.rightBar.offset({left:d}).css("width",this.innerBar.width()+this.innerBar.offset().left-
d)},bounds:function(b,c){var d;d="undefined"!==typeof b&&b instanceof Date&&"undefined"!==typeof c&&c instanceof Date?a.ui.rangeSlider.prototype.bounds.apply(this,[b.valueOf(),c.valueOf()]):a.ui.rangeSlider.prototype.bounds.apply(this,this._toArray(arguments));this._setBounds(b,c);this._initWidth();this._changed(!0);return{min:new Date(d.min),max:new Date(d.max)}}})})(jQuery);
!function(a,b,c,d){c.swipebox=function(e,f){var g,h,j={useCSS:!0,useSVG:!0,initialIndexOnArray:0,closeBySwipe:!0,hideBarsOnMobile:!0,hideBarsDelay:3E3,videoMaxWidth:1140,vimeoColor:"CCCCCC",beforeOpen:null,afterOpen:null,afterClose:null},n=this,p=[],q=e.selector,m=c(q),r=navigator.userAgent.match(/(iPad)|(iPhone)|(iPod)|(Android)|(PlayBook)|(BB10)|(BlackBerry)|(Opera Mini)|(IEMobile)|(webOS)|(MeeGo)/i),s=null!==r||b.createTouch!==d||"ontouchstart"in a||"onmsgesturechange"in a||navigator.msMaxTouchPoints,
t=!!b.createElementNS&&!!b.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,v=a.innerWidth?a.innerWidth:c(a).width(),u=a.innerHeight?a.innerHeight:c(a).height();n.settings={};n.init=function(){n.settings=c.extend({},j,f);c.isArray(e)?(p=e,g.target=c(a),g.init(n.settings.initialIndexOnArray)):c(b).on("click",q,function(a){if("slide current"===a.target.parentNode.className)return!1;c.isArray(e)||(g.destroy(),h=c(q),g.actions());p=[];var b,d;d||(b="data-rel",d=c(this).attr(b));d||(b=
"rel",d=c(this).attr(b));h=d&&""!==d&&"nofollow"!==d?m.filter("["+b+'="'+d+'"]'):c(q);h.each(function(){var a=null,b=null;c(this).attr("title")&&(a=c(this).attr("title"));c(this).attr("href")&&(b=c(this).attr("href"));p.push({href:b,title:a})});b=h.index(c(this));a.preventDefault();a.stopPropagation();g.target=c(a.target);g.init(b)})};g={init:function(a){n.settings.beforeOpen&&n.settings.beforeOpen();this.target.trigger("swipebox-start");c.swipebox.isOpen=!0;this.build();this.openSlide(a);this.openMedia(a);
this.preloadMedia(a+1);this.preloadMedia(a-1);n.settings.afterOpen&&n.settings.afterOpen()},build:function(){var a;c("body").append('<div id="swipebox-overlay">\t\t\t\t\t<div id="swipebox-slider"></div>\t\t\t\t\t<div id="swipebox-caption"></div>\t\t\t\t\t<div id="swipebox-action">\t\t\t\t\t\t<a id="swipebox-close"></a>\t\t\t\t\t\t<a id="swipebox-prev"></a>\t\t\t\t\t\t<a id="swipebox-next"></a>\t\t\t\t\t</div>\t\t\t</div>');this.doCssTrans()&&(c("#swipebox-slider").css({"-webkit-transition":"left 0.4s ease",
"-moz-transition":"left 0.4s ease","-o-transition":"left 0.4s ease","-khtml-transition":"left 0.4s ease",transition:"left 0.4s ease"}),c("#swipebox-overlay").css({"-webkit-transition":"opacity 1s ease","-moz-transition":"opacity 1s ease","-o-transition":"opacity 1s ease","-khtml-transition":"opacity 1s ease",transition:"opacity 1s ease"}),c("#swipebox-action, #swipebox-caption").css({"-webkit-transition":"0.5s","-moz-transition":"0.5s","-o-transition":"0.5s","-khtml-transition":"0.5s",transition:"0.5s"}));
t&&!0===n.settings.useSVG&&(a=c("#swipebox-action #swipebox-close").css("background-image"),a=a.replace("png","svg"),c("#swipebox-action #swipebox-prev,#swipebox-action #swipebox-next,#swipebox-action #swipebox-close").css({"background-image":a}));r&&!0===n.settings.hideBarsOnMobile&&c("#swipebox-action, #swipebox-caption").hide();c.each(p,function(){c("#swipebox-slider").append('<div class="slide"></div>')});this.setDim();this.actions();s&&this.gesture();this.keyboard();this.animBars();this.resize()},
setDim:function(){var b,d,e={};"onorientationchange"in a?a.addEventListener("orientationchange",function(){0===a.orientation?(b=v,d=u):(90===a.orientation||-90===a.orientation)&&(b=u,d=v)},!1):(b=a.innerWidth?a.innerWidth:c(a).width(),d=a.innerHeight?a.innerHeight:c(a).height());e={width:b,height:d};c("#swipebox-overlay").css(e)},resize:function(){var b=this;c(a).resize(function(){b.setDim()}).resize()},supportTransition:function(){var a,c="transition WebkitTransition MozTransition OTransition msTransition KhtmlTransition".split(" ");
for(a=0;a<c.length;a++)if(b.createElement("div").style[c[a]]!==d)return c[a];return!1},doCssTrans:function(){return n.settings.useCSS&&this.supportTransition()?!0:void 0},gesture:function(){var a=this,b=null,d=null,e=!1,f,h,g={},j=c("#swipebox-caption, #swipebox-action"),p=c("#swipebox-slider");j.addClass("visible-bars");a.setTimeout();c("body").bind("touchstart",function(a){return c(this).addClass("touching"),g=a.originalEvent.targetTouches[0],f=a.originalEvent.targetTouches[0].pageX,h=a.originalEvent.targetTouches[0].pageY,
c(".touching").bind("touchmove",function(a){if(a.preventDefault(),a.stopPropagation(),g=a.originalEvent.targetTouches[0],n.settings.closeBySwipe&&(d=g.pageY-h,50<=Math.abs(d)||e))a=0.75-Math.abs(d)/p.height(),p.css({top:d+"px"}),p.css({opacity:a}),e=!0}),!1}).bind("touchend",function(h){if(h.preventDefault(),h.stopPropagation(),n.settings.closeBySwipe)if(0.5>=p.css("opacity")?(h=0<d?p.height():-p.height(),p.animate({top:h+"px",opacity:0},300,function(){a.closeSlide()})):p.animate({top:0,opacity:1},
300),e)return void(e=!1);b=g.pageX-f;10<=b?a.getPrev():-10>=b?a.getNext():j.hasClass("visible-bars")?(a.clearTimeout(),a.hideBars()):(a.showBars(),a.setTimeout());c(".touching").off("touchmove").removeClass("touching")})},setTimeout:function(){if(0<n.settings.hideBarsDelay){var b=this;b.clearTimeout();b.timeout=a.setTimeout(function(){b.hideBars()},n.settings.hideBarsDelay)}},clearTimeout:function(){a.clearTimeout(this.timeout);this.timeout=null},showBars:function(){var a=c("#swipebox-caption, #swipebox-action");
this.doCssTrans()?a.addClass("visible-bars"):(c("#swipebox-caption").animate({top:0},500),c("#swipebox-action").animate({bottom:0},500),setTimeout(function(){a.addClass("visible-bars")},1E3))},hideBars:function(){var a=c("#swipebox-caption, #swipebox-action");this.doCssTrans()?a.removeClass("visible-bars"):(c("#swipebox-caption").animate({top:"-50px"},500),c("#swipebox-action").animate({bottom:"-50px"},500),setTimeout(function(){a.removeClass("visible-bars")},1E3))},animBars:function(){var a=this,
b=c("#swipebox-caption, #swipebox-action");b.addClass("visible-bars");a.setTimeout();c("#swipebox-slider").click(function(){b.hasClass("visible-bars")||(a.showBars(),a.setTimeout())});c("#swipebox-action").hover(function(){a.showBars();b.addClass("visible-bars");a.clearTimeout()},function(){b.removeClass("visible-bars");a.setTimeout()})},keyboard:function(){var b=this;c(a).bind("keyup",function(a){a.preventDefault();a.stopPropagation();37===a.keyCode?b.getPrev():39===a.keyCode?b.getNext():27===a.keyCode&&
b.closeSlide()})},actions:function(){var a=this;2>p.length?c("#swipebox-prev, #swipebox-next").hide():(c("#swipebox-prev").bind("touchend click",function(b){b.preventDefault();b.stopPropagation();a.getPrev();a.setTimeout()}),c("#swipebox-next").bind("touchend click",function(b){b.preventDefault();b.stopPropagation();a.getNext();a.setTimeout()}));c("#swipebox-close").bind("touchend click",function(){a.closeSlide()})},setSlide:function(a,b){var b=b||!1,d=c("#swipebox-slider");this.doCssTrans()?d.css({left:100*
-a+"%"}):d.animate({left:100*-a+"%"});c("#swipebox-slider .slide").removeClass("current");c("#swipebox-slider .slide").eq(a).addClass("current");this.setTitle(a);b&&d.fadeIn();c("#swipebox-prev, #swipebox-next").removeClass("disabled");0===a?c("#swipebox-prev").addClass("disabled"):a===p.length-1&&c("#swipebox-next").addClass("disabled")},openSlide:function(b){c("html").addClass("swipebox-html");s&&c("html").addClass("swipebox-touch");c(a).trigger("resize");this.setSlide(b,!0)},preloadMedia:function(a){var b=
this,c=null;p[a]!==d&&(c=p[a].href);b.isVideo(c)?b.openMedia(a):setTimeout(function(){b.openMedia(a)},1E3)},openMedia:function(a){var b=null;return p[a]!==d&&(b=p[a].href),0>a||a>=p.length?!1:void(this.isVideo(b)?c("#swipebox-slider .slide").eq(a).html(this.getVideo(b)):this.loadMedia(b,function(){c("#swipebox-slider .slide").eq(a).html(this)}))},setTitle:function(a){var b=null;c("#swipebox-caption").empty();p[a]!==d&&(b=p[a].title);b&&c("#swipebox-caption").append(b)},isVideo:function(a){return a&&
(a.match(/youtube\.com\/watch\?v=([a-zA-Z0-9\-_]+)/)||a.match(/vimeo\.com\/([0-9]*)/)||a.match(/youtu\.be\/([a-zA-Z0-9\-_]+)/))?!0:void 0},getVideo:function(a){var b="",c=a.match(/watch\?v=([a-zA-Z0-9\-_]+)/),d=a.match(/youtu\.be\/([a-zA-Z0-9\-_]+)/),a=a.match(/vimeo\.com\/([0-9]*)/);return c||d?(d&&(c=d),b='<iframe width="560" height="315" src="//www.youtube.com/embed/'+c[1]+'" frameborder="0" allowfullscreen></iframe>'):a&&(b='<iframe width="560" height="315"  src="//player.vimeo.com/video/'+a[1]+
"?byline=0&amp;portrait=0&amp;color="+n.settings.vimeoColor+'" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'),'<div class="swipebox-video-container" style="max-width:'+n.settings.videomaxWidth+'px"><div class="swipebox-video">'+b+"</div></div>"},loadMedia:function(a,b){if(!this.isVideo(a)){var d=c("<img>").on("load",function(){b.call(d)});d.attr("src",a)}},getNext:function(){var a=c("#swipebox-slider .slide").index(c("#swipebox-slider .slide.current"));a+1<p.length?
(a++,this.setSlide(a),this.preloadMedia(a+1)):(c("#swipebox-slider").addClass("rightSpring"),setTimeout(function(){c("#swipebox-slider").removeClass("rightSpring")},500))},getPrev:function(){var a=c("#swipebox-slider .slide").index(c("#swipebox-slider .slide.current"));0<a?(a--,this.setSlide(a),this.preloadMedia(a-1)):(c("#swipebox-slider").addClass("leftSpring"),setTimeout(function(){c("#swipebox-slider").removeClass("leftSpring")},500))},closeSlide:function(){c("html").removeClass("swipebox-html");
c("html").removeClass("swipebox-touch");c(a).trigger("resize");this.destroy()},destroy:function(){c(a).unbind("keyup");c("body").unbind("touchstart");c("body").unbind("touchmove");c("body").unbind("touchend");c("#swipebox-slider").unbind();c("#swipebox-overlay").remove();c.isArray(e)||e.removeData("_swipebox");this.target&&this.target.trigger("swipebox-destroy");c.swipebox.isOpen=!1;n.settings.afterClose&&n.settings.afterClose()}};n.init()};c.fn.swipebox=function(a){c.data(this,"_swipebox")||(a=new c.swipebox(this,
a),this.data("_swipebox",a));return this.data("_swipebox")}}(window,document,jQuery);"object"!==typeof JSON&&(JSON={});
(function(){function a(a){return 10>a?"0"+a:a}function b(a){e.lastIndex=0;return e.test(a)?'"'+a.replace(e,function(a){var b=h[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function c(a,d){var e,h,r,s,t=f,v,u=d[a];u&&("object"===typeof u&&"function"===typeof u.toJSON)&&(u=u.toJSON(a));"function"===typeof j&&(u=j.call(d,a,u));switch(typeof u){case "string":return b(u);case "number":return isFinite(u)?String(u):"null";case "boolean":case "null":return String(u);
case "object":if(!u)return"null";f+=g;v=[];if("[object Array]"===Object.prototype.toString.apply(u)){s=u.length;for(e=0;e<s;e+=1)v[e]=c(e,u)||"null";r=0===v.length?"[]":f?"[\n"+f+v.join(",\n"+f)+"\n"+t+"]":"["+v.join(",")+"]";f=t;return r}if(j&&"object"===typeof j){s=j.length;for(e=0;e<s;e+=1)"string"===typeof j[e]&&(h=j[e],(r=c(h,u))&&v.push(b(h)+(f?": ":":")+r))}else for(h in u)Object.prototype.hasOwnProperty.call(u,h)&&(r=c(h,u))&&v.push(b(h)+(f?": ":":")+r);r=0===v.length?"{}":f?"{\n"+f+v.join(",\n"+
f)+"\n"+t+"}":"{"+v.join(",")+"}";f=t;return r}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,f,g,h={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},j;"function"!==typeof JSON.stringify&&(JSON.stringify=function(a,b,d){var e;g=f="";if("number"===typeof d)for(e=0;e<d;e+=1)g+=" ";else"string"===typeof d&&(g=d);if((j=b)&&"function"!==typeof b&&("object"!==typeof b||"number"!==typeof b.length))throw Error("JSON.stringify");return c("",{"":a})});
"function"!==typeof JSON.parse&&(JSON.parse=function(a,b){function c(a,d){var e,f,h=a[d];if(h&&"object"===typeof h)for(e in h)Object.prototype.hasOwnProperty.call(h,e)&&(f=c(h,e),void 0!==f?h[e]=f:delete h[e]);return b.call(a,d,h)}var e,a=String(a);d.lastIndex=0;d.test(a)&&(a=a.replace(d,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return e=eval("("+a+")"),"function"===typeof b?c({"":e},""):e;throw new SyntaxError("JSON.parse");})})();
(function(a,b){var c=a.History=a.History||{},d=a.jQuery;if("undefined"!==typeof c.Adapter)throw Error("History.js Adapter has already been loaded...");c.Adapter={bind:function(a,b,c){d(a).bind(b,c)},trigger:function(a,b,c){d(a).trigger(b,c)},extractEventData:function(a,c,d){return c&&c.originalEvent&&c.originalEvent[a]||d&&d[a]||b},onDomLoad:function(a){d(a)}};"undefined"!==typeof c.init&&c.init()})(window);
(function(a){var b=a.document,c=a.setInterval||c,d=a.History=a.History||{};if("undefined"!==typeof d.initHtml4)throw Error("History.js HTML4 Support has already been loaded...");d.initHtml4=function(){if("undefined"!==typeof d.initHtml4.initialized)return!1;d.initHtml4.initialized=!0;d.enabled=!0;d.savedHashes=[];d.isLastHash=function(a){var b=d.getHashByIndex();return a===b};d.isHashEqual=function(a,b){a=encodeURIComponent(a).replace(/%25/g,"%");b=encodeURIComponent(b).replace(/%25/g,"%");return a===
b};d.saveHash=function(a){if(d.isLastHash(a))return!1;d.savedHashes.push(a);return!0};d.getHashByIndex=function(a){var b=null;return b="undefined"===typeof a?d.savedHashes[d.savedHashes.length-1]:0>a?d.savedHashes[d.savedHashes.length+a]:d.savedHashes[a]};d.discardedHashes={};d.discardedStates={};d.discardState=function(a,b,c){var h=d.getHashByState(a);d.discardedStates[h]={discardedState:a,backState:c,forwardState:b};return!0};d.discardHash=function(a,b,c){d.discardedHashes[a]={discardedHash:a,backState:c,
forwardState:b};return!0};d.discardedState=function(a){a=d.getHashByState(a);return d.discardedStates[a]||!1};d.discardedHash=function(a){return d.discardedHashes[a]||!1};d.recycleState=function(a){var b=d.getHashByState(a);d.discardedState(a)&&delete d.discardedStates[b];return!0};d.emulated.hashChange&&(d.hashChangeInit=function(){d.checkerFunction=null;var e="",f,g,h,j=Boolean(d.getHash());d.isInternetExplorer()?(f=b.createElement("iframe"),f.setAttribute("id","historyjs-iframe"),f.setAttribute("src",
"#"),f.style.display="none",b.body.appendChild(f),f.contentWindow.document.open(),f.contentWindow.document.close(),g="",h=!1,d.checkerFunction=function(){if(h)return!1;h=!0;var b=d.getHash(),c=d.getHash(f.contentWindow.document);b!==e?(e=b,c!==b&&(g=b,f.contentWindow.document.open(),f.contentWindow.document.close(),f.contentWindow.document.location.hash=d.escapeHash(b)),d.Adapter.trigger(a,"hashchange")):c!==g&&(g=c,j&&""===c?d.back():d.setHash(c,!1));h=!1;return!0}):d.checkerFunction=function(){var b=
d.getHash()||"";b!==e&&(e=b,d.Adapter.trigger(a,"hashchange"));return!0};d.intervalList.push(c(d.checkerFunction,d.options.hashChangeInterval));return!0},d.Adapter.onDomLoad(d.hashChangeInit));d.emulated.pushState&&(d.onHashChange=function(b){var b=b&&b.newURL||d.getLocationHref(),c=d.getHashByUrl(b),b=null;if(d.isLastHash(c))return d.busy(!1),!1;d.doubleCheckComplete();d.saveHash(c);if(c&&d.isTraditionalAnchor(c))return d.Adapter.trigger(a,"anchorchange"),d.busy(!1),!1;b=d.extractState(d.getFullUrl(c||
d.getLocationHref()),!0);if(d.isLastSavedState(b))return d.busy(!1),!1;d.getHashByState(b);if(c=d.discardedState(b))return d.getHashByIndex(-2)===d.getHashByState(c.forwardState)?d.back(!1):d.forward(!1),!1;d.pushState(b.data,b.title,encodeURI(b.url),!1);return!0},d.Adapter.bind(a,"hashchange",d.onHashChange),d.pushState=function(b,c,g,h){g=encodeURI(g).replace(/%25/g,"%");if(d.getHashByUrl(g))throw Error("History.js does not support states with fragment-identifiers (hashes/anchors).");if(!1!==h&&
d.busy())return d.pushQueue({scope:d,callback:d.pushState,args:arguments,queue:h}),!1;d.busy(!0);var j=d.createStateObject(b,c,g),n=d.getHashByState(j),p=d.getState(!1),p=d.getHashByState(p),q=d.getHash(),m=d.expectedStateId==j.id;d.storeState(j);d.expectedStateId=j.id;d.recycleState(j);d.setTitle(j);if(n===p)return d.busy(!1),!1;d.saveState(j);m||d.Adapter.trigger(a,"statechange");!d.isHashEqual(n,q)&&!d.isHashEqual(n,d.getShortUrl(d.getLocationHref()))&&d.setHash(n,!1);d.busy(!1);return!0},d.replaceState=
function(b,c,g,h){g=encodeURI(g).replace(/%25/g,"%");if(d.getHashByUrl(g))throw Error("History.js does not support states with fragment-identifiers (hashes/anchors).");if(!1!==h&&d.busy())return d.pushQueue({scope:d,callback:d.replaceState,args:arguments,queue:h}),!1;d.busy(!0);var j=d.createStateObject(b,c,g),n=d.getHashByState(j),p=d.getState(!1),q=d.getHashByState(p),m=d.getStateByIndex(-2);d.discardState(p,j,m);n===q?(d.storeState(j),d.expectedStateId=j.id,d.recycleState(j),d.setTitle(j),d.saveState(j),
d.Adapter.trigger(a,"statechange"),d.busy(!1)):d.pushState(j.data,j.title,j.url,!1);return!0});if(d.emulated.pushState&&d.getHash()&&!d.emulated.hashChange)d.Adapter.onDomLoad(function(){d.Adapter.trigger(a,"hashchange")})};"undefined"!==typeof d.init&&d.init()})(window);
(function(a,b){var c=a.console||b,d=a.document,e=a.navigator,f=!1,g=a.setTimeout,h=a.clearTimeout,j=a.setInterval,n=a.clearInterval,p=a.JSON,q=a.alert,m=a.History=a.History||{},r=a.history;try{f=a.sessionStorage,f.setItem("TEST","1"),f.removeItem("TEST")}catch(s){f=!1}p.stringify=p.stringify||p.encode;p.parse=p.parse||p.decode;if("undefined"!==typeof m.init)throw Error("History.js Core has already been loaded...");m.init=function(){if("undefined"===typeof m.Adapter)return!1;"undefined"!==typeof m.initCore&&
m.initCore();"undefined"!==typeof m.initHtml4&&m.initHtml4();return!0};m.initCore=function(){if("undefined"!==typeof m.initCore.initialized)return!1;m.initCore.initialized=!0;m.options=m.options||{};m.options.hashChangeInterval=m.options.hashChangeInterval||100;m.options.safariPollInterval=m.options.safariPollInterval||500;m.options.doubleCheckInterval=m.options.doubleCheckInterval||500;m.options.disableSuid=m.options.disableSuid||!1;m.options.storeInterval=m.options.storeInterval||1E3;m.options.busyDelay=
m.options.busyDelay||250;m.options.debug=m.options.debug||!1;m.options.initialTitle=m.options.initialTitle||d.title;m.options.html4Mode=m.options.html4Mode||!1;m.options.delayInit=m.options.delayInit||!1;m.intervalList=[];m.clearAllIntervals=function(){var a,b=m.intervalList;if("undefined"!==typeof b&&null!==b){for(a=0;a<b.length;a++)n(b[a]);m.intervalList=null}};m.debug=function(){m.options.debug&&m.log.apply(m,arguments)};m.log=function(){var a=!("undefined"===typeof c||"undefined"===typeof c.log||
"undefined"===typeof c.log.apply),b=d.getElementById("log"),e,f,h,g;a?(f=Array.prototype.slice.call(arguments),e=f.shift(),"undefined"!==typeof c.debug?c.debug.apply(c,[e,f]):c.log.apply(c,[e,f])):e="\n"+arguments[0]+"\n";f=1;for(h=arguments.length;f<h;++f){g=arguments[f];if("object"===typeof g&&"undefined"!==typeof p)try{g=p.stringify(g)}catch(j){}e+="\n"+g+"\n"}b?(b.value+=e+"\n-----\n",b.scrollTop=b.scrollHeight-b.clientHeight):a||q(e);return!0};m.getInternetExplorerMajorVersion=function(){var a=
m.getInternetExplorerMajorVersion,b;if("undefined"!==typeof m.getInternetExplorerMajorVersion.cached)b=m.getInternetExplorerMajorVersion.cached;else{b=3;for(var c=d.createElement("div"),e=c.getElementsByTagName("i");(c.innerHTML="<\!--[if gt IE "+ ++b+"]><i></i><![endif]--\>")&&e[0];);b=4<b?b:!1}return a.cached=b};m.isInternetExplorer=function(){return m.isInternetExplorer.cached="undefined"!==typeof m.isInternetExplorer.cached?m.isInternetExplorer.cached:Boolean(m.getInternetExplorerMajorVersion())};
m.emulated=m.options.html4Mode?{pushState:!0,hashChange:!0}:{pushState:!Boolean(a.history&&a.history.pushState&&a.history.replaceState&&!(/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(e.userAgent)||/AppleWebKit\/5([0-2]|3[0-2])/i.test(e.userAgent))),hashChange:Boolean(!("onhashchange"in a||"onhashchange"in d)||m.isInternetExplorer()&&8>m.getInternetExplorerMajorVersion())};m.enabled=!m.emulated.pushState;m.bugs={setHash:Boolean(!m.emulated.pushState&&"Apple Computer, Inc."===e.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(e.userAgent)),
safariPoll:Boolean(!m.emulated.pushState&&"Apple Computer, Inc."===e.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(e.userAgent)),ieDoubleCheck:Boolean(m.isInternetExplorer()&&8>m.getInternetExplorerMajorVersion()),hashEscape:Boolean(m.isInternetExplorer()&&7>m.getInternetExplorerMajorVersion())};m.isEmptyObject=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0};m.cloneObject=function(a){a?(a=p.stringify(a),a=p.parse(a)):a={};return a};m.getRootUrl=function(){var a=d.location.protocol+
"//"+(d.location.hostname||d.location.host);d.location.port&&(a+=":"+d.location.port);return a+"/"};m.getBaseHref=function(){var a=d.getElementsByTagName("base"),b=null,b="";1===a.length&&(b=a[0],b=b.href.replace(/[^\/]+$/,""));(b=b.replace(/\/+$/,""))&&(b+="/");return b};m.getBaseUrl=function(){return m.getBaseHref()||m.getBasePageUrl()||m.getRootUrl()};m.getPageUrl=function(){return((m.getState(!1,!1)||{}).url||m.getLocationHref()).replace(/\/+$/,"").replace(/[^\/]+$/,function(a){return/\./.test(a)?
a:a+"/"})};m.getBasePageUrl=function(){return m.getLocationHref().replace(/[#\?].*/,"").replace(/[^\/]+$/,function(a){return/[^\/]$/.test(a)?"":a}).replace(/\/+$/,"")+"/"};m.getFullUrl=function(a,b){var c=a,d=a.substring(0,1),b="undefined"===typeof b?!0:b;/[a-z]+\:\/\//.test(a)||(c="/"===d?m.getRootUrl()+a.replace(/^\/+/,""):"#"===d?m.getPageUrl().replace(/#.*/,"")+a:"?"===d?m.getPageUrl().replace(/[\?#].*/,"")+a:b?m.getBaseUrl()+a.replace(/^(\.\/)+/,""):m.getBasePageUrl()+a.replace(/^(\.\/)+/,""));
return c.replace(/\#$/,"")};m.getShortUrl=function(a){var b=m.getBaseUrl(),c=m.getRootUrl();m.emulated.pushState&&(a=a.replace(b,""));a=a.replace(c,"/");m.isTraditionalAnchor(a)&&(a="./"+a);return a=a.replace(/^(\.\/)+/g,"./").replace(/\#$/,"")};m.getLocationHref=function(a){a=a||d;return a.URL===a.location.href?a.location.href:a.location.href===decodeURIComponent(a.URL)?a.URL:a.location.hash&&decodeURIComponent(a.location.href.replace(/^[^#]+/,""))===a.location.hash||-1==a.URL.indexOf("#")&&-1!=
a.location.href.indexOf("#")?a.location.href:a.URL||a.location.href};m.store={};m.idToState=m.idToState||{};m.stateToId=m.stateToId||{};m.urlToId=m.urlToId||{};m.storedStates=m.storedStates||[];m.savedStates=m.savedStates||[];m.normalizeStore=function(){m.store.idToState=m.store.idToState||{};m.store.urlToId=m.store.urlToId||{};m.store.stateToId=m.store.stateToId||{}};m.getState=function(a,b){"undefined"===typeof a&&(a=!0);"undefined"===typeof b&&(b=!0);var c=m.getLastSavedState();!c&&b&&(c=m.createStateObject());
a&&(c=m.cloneObject(c),c.url=c.cleanUrl||c.url);return c};m.getIdByState=function(a){var b=m.extractId(a.url),c;if(!b)if(c=m.getStateString(a),"undefined"!==typeof m.stateToId[c])b=m.stateToId[c];else if("undefined"!==typeof m.store.stateToId[c])b=m.store.stateToId[c];else{for(;!(b=(new Date).getTime()+String(Math.random()).replace(/\D/g,""),"undefined"===typeof m.idToState[b]&&"undefined"===typeof m.store.idToState[b]););m.stateToId[c]=b;m.idToState[b]=a}return b};m.normalizeState=function(a){var b;
if(!a||"object"!==typeof a)a={};if("undefined"!==typeof a.normalized)return a;if(!a.data||"object"!==typeof a.data)a.data={};b={normalized:!0};b.title=a.title||"";b.url=m.getFullUrl(a.url?a.url:m.getLocationHref());b.hash=m.getShortUrl(b.url);b.data=m.cloneObject(a.data);b.id=m.getIdByState(b);b.cleanUrl=b.url.replace(/\??\&_suid.*/,"");b.url=b.cleanUrl;a=!m.isEmptyObject(b.data);if((b.title||a)&&!0!==m.options.disableSuid)b.hash=m.getShortUrl(b.url).replace(/\??\&_suid.*/,""),/\?/.test(b.hash)||
(b.hash+="?"),b.hash+="&_suid="+b.id;b.hashedUrl=m.getFullUrl(b.hash);if((m.emulated.pushState||m.bugs.safariPoll)&&m.hasUrlDuplicate(b))b.url=b.hashedUrl;return b};m.createStateObject=function(a,b,c){a={data:a,title:b,url:c};return a=m.normalizeState(a)};m.getStateById=function(a){a=String(a);return m.idToState[a]||m.store.idToState[a]||b};m.getStateString=function(a){a={data:m.normalizeState(a).data,title:a.title,url:a.url};return p.stringify(a)};m.getStateId=function(a){return m.normalizeState(a).id};
m.getHashByState=function(a){return m.normalizeState(a).hash};m.extractId=function(a){a=-1!=a.indexOf("#")?a.split("#")[0]:a;return((a=/(.*)\&_suid=([0-9]+)$/.exec(a))?String(a[2]||""):"")||!1};m.isTraditionalAnchor=function(a){return!/[\/\?\.]/.test(a)};m.extractState=function(a,b){var c=null,d,e,b=b||!1;(d=m.extractId(a))&&(c=m.getStateById(d));c||(e=m.getFullUrl(a),(d=m.getIdByUrl(e)||!1)&&(c=m.getStateById(d)),!c&&(b&&!m.isTraditionalAnchor(a))&&(c=m.createStateObject(null,null,e)));return c};
m.getIdByUrl=function(a){return m.urlToId[a]||m.store.urlToId[a]||b};m.getLastSavedState=function(){return m.savedStates[m.savedStates.length-1]||b};m.getLastStoredState=function(){return m.storedStates[m.storedStates.length-1]||b};m.hasUrlDuplicate=function(a){var b=!1;return b=(b=m.extractState(a.url))&&b.id!==a.id};m.storeState=function(a){m.urlToId[a.url]=a.id;m.storedStates.push(m.cloneObject(a));return a};m.isLastSavedState=function(a){var b=!1;m.savedStates.length&&(a=a.id,b=m.getLastSavedState(),
b=b.id,b=a===b);return b};m.saveState=function(a){if(m.isLastSavedState(a))return!1;m.savedStates.push(m.cloneObject(a));return!0};m.getStateByIndex=function(a){var b=null;return b="undefined"===typeof a?m.savedStates[m.savedStates.length-1]:0>a?m.savedStates[m.savedStates.length+a]:m.savedStates[a]};m.getCurrentIndex=function(){var a=null;return a=1>m.savedStates.length?0:m.savedStates.length-1};m.getHash=function(a){a=m.getLocationHref(a);return m.getHashByUrl(a)};m.unescapeHash=function(a){a=m.normalizeHash(a);
return a=decodeURIComponent(a)};m.normalizeHash=function(a){return a.replace(/[^#]*#/,"").replace(/#.*/,"")};m.setHash=function(a,b){var c;if(!1!==b&&m.busy())return m.pushQueue({scope:m,callback:m.setHash,args:arguments,queue:b}),!1;m.busy(!0);(c=m.extractState(a,!0))&&!m.emulated.pushState?m.pushState(c.data,c.title,c.url,!1):m.getHash()!==a&&(m.bugs.setHash?(c=m.getPageUrl(),m.pushState(null,null,c+"#"+a,!1)):d.location.hash=a);return m};m.escapeHash=function(b){b=m.normalizeHash(b);b=a.encodeURIComponent(b);
m.bugs.hashEscape||(b=b.replace(/\%21/g,"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?"));return b};m.getHashByUrl=function(a){a=String(a).replace(/([^#]*)#?([^#]*)#?(.*)/,"$2");return a=m.unescapeHash(a)};m.setTitle=function(a){var b=a.title,c;b||(c=m.getStateByIndex(0))&&c.url===a.url&&(b=c.title||m.options.initialTitle);try{d.getElementsByTagName("title")[0].innerHTML=b.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")}catch(e){}d.title=b;return m};m.queues=[];
m.busy=function(a){"undefined"!==typeof a?m.busy.flag=a:"undefined"===typeof m.busy.flag&&(m.busy.flag=!1);if(!m.busy.flag){h(m.busy.timeout);var b=function(){var a,c;if(!m.busy.flag)for(a=m.queues.length-1;0<=a;--a)c=m.queues[a],0!==c.length&&(c=c.shift(),m.fireQueueItem(c),m.busy.timeout=g(b,m.options.busyDelay))};m.busy.timeout=g(b,m.options.busyDelay)}return m.busy.flag};m.busy.flag=!1;m.fireQueueItem=function(a){return a.callback.apply(a.scope||m,a.args||[])};m.pushQueue=function(a){m.queues[a.queue||
0]=m.queues[a.queue||0]||[];m.queues[a.queue||0].push(a);return m};m.queue=function(a,b){"function"===typeof a&&(a={callback:a});"undefined"!==typeof b&&(a.queue=b);m.busy()?m.pushQueue(a):m.fireQueueItem(a);return m};m.clearQueue=function(){m.busy.flag=!1;m.queues=[];return m};m.stateChanged=!1;m.doubleChecker=!1;m.doubleCheckComplete=function(){m.stateChanged=!0;m.doubleCheckClear();return m};m.doubleCheckClear=function(){m.doubleChecker&&(h(m.doubleChecker),m.doubleChecker=!1);return m};m.doubleCheck=
function(a){m.stateChanged=!1;m.doubleCheckClear();m.bugs.ieDoubleCheck&&(m.doubleChecker=g(function(){m.doubleCheckClear();m.stateChanged||a();return!0},m.options.doubleCheckInterval));return m};m.safariStatePoll=function(){var b=m.extractState(m.getLocationHref());if(!m.isLastSavedState(b))return b||m.createStateObject(),m.Adapter.trigger(a,"popstate"),m};m.back=function(a){if(!1!==a&&m.busy())return m.pushQueue({scope:m,callback:m.back,args:arguments,queue:a}),!1;m.busy(!0);m.doubleCheck(function(){m.back(!1)});
r.go(-1);return!0};m.forward=function(a){if(!1!==a&&m.busy())return m.pushQueue({scope:m,callback:m.forward,args:arguments,queue:a}),!1;m.busy(!0);m.doubleCheck(function(){m.forward(!1)});r.go(1);return!0};m.go=function(a,b){var c;if(0<a)for(c=1;c<=a;++c)m.forward(b);else if(0>a)for(c=-1;c>=a;--c)m.back(b);else throw Error("History.go: History.go requires a positive or negative integer passed.");return m};if(m.emulated.pushState){var s=function(){};m.pushState=m.pushState||s;m.replaceState=m.replaceState||
s}else m.onPopState=function(b,c){var d=!1,d=!1;m.doubleCheckComplete();if(d=m.getHash())return(d=m.extractState(d||m.getLocationHref(),!0))?m.replaceState(d.data,d.title,d.url,!1):(m.Adapter.trigger(a,"anchorchange"),m.busy(!1)),m.expectedStateId=!1;(d=(d=m.Adapter.extractEventData("state",b,c)||!1)?m.getStateById(d):m.expectedStateId?m.getStateById(m.expectedStateId):m.extractState(m.getLocationHref()))||(d=m.createStateObject(null,null,m.getLocationHref()));m.expectedStateId=!1;if(m.isLastSavedState(d))return m.busy(!1),
!1;m.storeState(d);m.saveState(d);m.setTitle(d);m.Adapter.trigger(a,"statechange");m.busy(!1);return!0},m.Adapter.bind(a,"popstate",m.onPopState),m.pushState=function(b,c,d,e){if(m.getHashByUrl(d)&&m.emulated.pushState)throw Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(!1!==e&&m.busy())return m.pushQueue({scope:m,callback:m.pushState,args:arguments,queue:e}),!1;m.busy(!0);var f=m.createStateObject(b,c,d);m.isLastSavedState(f)?m.busy(!1):(m.storeState(f),
m.expectedStateId=f.id,r.pushState(f.id,f.title,f.url),m.Adapter.trigger(a,"popstate"));return!0},m.replaceState=function(b,c,d,e){if(m.getHashByUrl(d)&&m.emulated.pushState)throw Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(!1!==e&&m.busy())return m.pushQueue({scope:m,callback:m.replaceState,args:arguments,queue:e}),!1;m.busy(!0);var f=m.createStateObject(b,c,d);m.isLastSavedState(f)?m.busy(!1):(m.storeState(f),m.expectedStateId=f.id,r.replaceState(f.id,
f.title,f.url),m.Adapter.trigger(a,"popstate"));return!0};if(f)try{m.store=p.parse(f.getItem("History.store"))||{}}catch(v){m.store={}}else m.store={};m.normalizeStore();m.Adapter.bind(a,"unload",m.clearAllIntervals);m.saveState(m.storeState(m.extractState(m.getLocationHref(),!0)));f&&(m.onUnload=function(){var a,b;try{a=p.parse(f.getItem("History.store"))||{}}catch(c){a={}}a.idToState=a.idToState||{};a.urlToId=a.urlToId||{};a.stateToId=a.stateToId||{};for(b in m.idToState)m.idToState.hasOwnProperty(b)&&
(a.idToState[b]=m.idToState[b]);for(b in m.urlToId)m.urlToId.hasOwnProperty(b)&&(a.urlToId[b]=m.urlToId[b]);for(b in m.stateToId)m.stateToId.hasOwnProperty(b)&&(a.stateToId[b]=m.stateToId[b]);m.store=a;m.normalizeStore();a=p.stringify(a);try{f.setItem("History.store",a)}catch(d){if(d.code===DOMException.QUOTA_EXCEEDED_ERR)f.length&&(f.removeItem("History.store"),f.setItem("History.store",a));else throw d;}},m.intervalList.push(j(m.onUnload,m.options.storeInterval)),m.Adapter.bind(a,"beforeunload",
m.onUnload),m.Adapter.bind(a,"unload",m.onUnload));if(!m.emulated.pushState&&(m.bugs.safariPoll&&m.intervalList.push(j(m.safariStatePoll,m.options.safariPollInterval)),"Apple Computer, Inc."===e.vendor||"Mozilla"===(e.appCodeName||"")))if(m.Adapter.bind(a,"hashchange",function(){m.Adapter.trigger(a,"popstate")}),m.getHash())m.Adapter.onDomLoad(function(){m.Adapter.trigger(a,"hashchange")})};(!m.options||!m.options.delayInit)&&m.init()})(window);
(function(a){a.fn.visible=function(b,c,d){var e=a(this).eq(0),f=e.get(0),g=a(window),h=g.scrollTop(),j=h+g.height(),n=g.scrollLeft(),g=n+g.width(),p=e.offset().top,q=p+e.height(),m=e.offset().left,r=m+e.width(),e=!0===b?q:p,p=!0===b?p:q,q=!0===b?r:m,b=!0===b?m:r,c=!0===c?f.offsetWidth*f.offsetHeight:!0,d=d?d:"both";if("both"===d)return!!c&&p<=j&&e>=h&&b<=g&&q>=n;if("vertical"===d)return!!c&&p<=j&&e>=h;if("horizontal"===d)return!!c&&b<=g&&q>=n}})(jQuery);
var OpenLayers={VERSION_NUMBER:"Release 2.13.1",singleFile:!0,_getScriptLocation:function(){for(var a=/(^|(.*?\/))(OpenLayers[^\/]*?\.js)(\?|$)/,b=document.getElementsByTagName("script"),c,d="",e=0,f=b.length;e<f;e++)if(c=b[e].getAttribute("src"))if(c=c.match(a)){d=c[1];break}return function(){return d}}(),ImgPath:"",Class:function(){var a=arguments.length,b=arguments[0],c=arguments[a-1],d="function"==typeof c.initialize?c.initialize:function(){b.prototype.initialize.apply(this,arguments)};1<a?(a=
[d,b].concat(Array.prototype.slice.call(arguments).slice(1,a-1),c),OpenLayers.inherit.apply(null,a)):d.prototype=c;return d},inherit:function(a,b){var c=function(){};c.prototype=b.prototype;a.prototype=new c;var d,e,c=2;for(d=arguments.length;c<d;c++)e=arguments[c],"function"===typeof e&&(e=e.prototype),OpenLayers.Util.extend(a.prototype,e)}};OpenLayers.Util=OpenLayers.Util||{};
OpenLayers.Util.extend=function(a,b){a=a||{};if(b){for(var c in b){var d=b[c];void 0!==d&&(a[c]=d)}!("function"==typeof window.Event&&b instanceof window.Event)&&(b.hasOwnProperty&&b.hasOwnProperty("toString"))&&(a.toString=b.toString)}return a};
OpenLayers.String={startsWith:function(a,b){return 0==a.indexOf(b)},contains:function(a,b){return-1!=a.indexOf(b)},trim:function(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},camelize:function(a){for(var a=a.split("-"),b=a[0],c=1,d=a.length;c<d;c++)var e=a[c],b=b+(e.charAt(0).toUpperCase()+e.substring(1));return b},format:function(a,b,c){b||(b=window);return a.replace(OpenLayers.String.tokenRegEx,function(a,e){for(var f,g=e.split(/\.+/),h=0;h<g.length;h++){0==h&&(f=b);if(void 0===f)break;
f=f[g[h]]}"function"==typeof f&&(f=c?f.apply(null,c):f());return"undefined"==typeof f?"undefined":f})},tokenRegEx:/\$\{([\w.]+?)\}/g,numberRegEx:/^([+-]?)(?=\d|\.\d)\d*(\.\d*)?([Ee]([+-]?\d+))?$/,isNumeric:function(a){return OpenLayers.String.numberRegEx.test(a)},numericIf:function(a,b){var c=a;!0===b&&(null!=a&&a.replace)&&(a=a.replace(/^\s*|\s*$/g,""));return OpenLayers.String.isNumeric(a)?parseFloat(a):c}};
OpenLayers.Number={decimalSeparator:".",thousandsSeparator:",",limitSigDigs:function(a,b){var c=0;0<b&&(c=parseFloat(a.toPrecision(b)));return c},format:function(a,b,c,d){b="undefined"!=typeof b?b:0;c="undefined"!=typeof c?c:OpenLayers.Number.thousandsSeparator;d="undefined"!=typeof d?d:OpenLayers.Number.decimalSeparator;null!=b&&(a=parseFloat(a.toFixed(b)));var e=a.toString().split(".");1==e.length&&null==b&&(b=0);a=e[0];if(c)for(var f=/(-?[0-9]+)([0-9]{3})/;f.test(a);)a=a.replace(f,"$1"+c+"$2");
0==b?b=a:(c=1<e.length?e[1]:"0",null!=b&&(c+=Array(b-c.length+1).join("0")),b=a+d+c);return b},zeroPad:function(a,b,c){for(a=a.toString(c||10);a.length<b;)a="0"+a;return a}};
OpenLayers.Function={bind:function(a,b){var c=Array.prototype.slice.apply(arguments,[2]);return function(){var d=c.concat(Array.prototype.slice.apply(arguments,[0]));return a.apply(b,d)}},bindAsEventListener:function(a,b){return function(c){return a.call(b,c||window.event)}},False:function(){return!1},True:function(){return!0},Void:function(){}};
OpenLayers.Array={filter:function(a,b,c){var d=[];if(Array.prototype.filter)d=a.filter(b,c);else{var e=a.length;if("function"!=typeof b)throw new TypeError;for(var f=0;f<e;f++)if(f in a){var g=a[f];b.call(c,g,f,a)&&d.push(g)}}return d}};
OpenLayers.Bounds=OpenLayers.Class({left:null,bottom:null,right:null,top:null,centerLonLat:null,initialize:function(a,b,c,d){OpenLayers.Util.isArray(a)&&(d=a[3],c=a[2],b=a[1],a=a[0]);null!=a&&(this.left=OpenLayers.Util.toFloat(a));null!=b&&(this.bottom=OpenLayers.Util.toFloat(b));null!=c&&(this.right=OpenLayers.Util.toFloat(c));null!=d&&(this.top=OpenLayers.Util.toFloat(d))},clone:function(){return new OpenLayers.Bounds(this.left,this.bottom,this.right,this.top)},equals:function(a){var b=!1;null!=
a&&(b=this.left==a.left&&this.right==a.right&&this.top==a.top&&this.bottom==a.bottom);return b},toString:function(){return[this.left,this.bottom,this.right,this.top].join()},toArray:function(a){return!0===a?[this.bottom,this.left,this.top,this.right]:[this.left,this.bottom,this.right,this.top]},toBBOX:function(a,b){null==a&&(a=6);var c=Math.pow(10,a),d=Math.round(this.left*c)/c,e=Math.round(this.bottom*c)/c,f=Math.round(this.right*c)/c,c=Math.round(this.top*c)/c;return!0===b?e+","+d+","+c+","+f:d+
","+e+","+f+","+c},toGeometry:function(){return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(this.left,this.bottom),new OpenLayers.Geometry.Point(this.right,this.bottom),new OpenLayers.Geometry.Point(this.right,this.top),new OpenLayers.Geometry.Point(this.left,this.top)])])},getWidth:function(){return this.right-this.left},getHeight:function(){return this.top-this.bottom},getSize:function(){return new OpenLayers.Size(this.getWidth(),this.getHeight())},
getCenterPixel:function(){return new OpenLayers.Pixel((this.left+this.right)/2,(this.bottom+this.top)/2)},getCenterLonLat:function(){this.centerLonLat||(this.centerLonLat=new OpenLayers.LonLat((this.left+this.right)/2,(this.bottom+this.top)/2));return this.centerLonLat},scale:function(a,b){null==b&&(b=this.getCenterLonLat());var c,d;"OpenLayers.LonLat"==b.CLASS_NAME?(c=b.lon,d=b.lat):(c=b.x,d=b.y);return new OpenLayers.Bounds((this.left-c)*a+c,(this.bottom-d)*a+d,(this.right-c)*a+c,(this.top-d)*a+
d)},add:function(a,b){if(null==a||null==b)throw new TypeError("Bounds.add cannot receive null values");return new OpenLayers.Bounds(this.left+a,this.bottom+b,this.right+a,this.top+b)},extend:function(a){if(a)switch(a.CLASS_NAME){case "OpenLayers.LonLat":this.extendXY(a.lon,a.lat);break;case "OpenLayers.Geometry.Point":this.extendXY(a.x,a.y);break;case "OpenLayers.Bounds":this.centerLonLat=null;if(null==this.left||a.left<this.left)this.left=a.left;if(null==this.bottom||a.bottom<this.bottom)this.bottom=
a.bottom;if(null==this.right||a.right>this.right)this.right=a.right;if(null==this.top||a.top>this.top)this.top=a.top}},extendXY:function(a,b){this.centerLonLat=null;if(null==this.left||a<this.left)this.left=a;if(null==this.bottom||b<this.bottom)this.bottom=b;if(null==this.right||a>this.right)this.right=a;if(null==this.top||b>this.top)this.top=b},containsLonLat:function(a,b){"boolean"===typeof b&&(b={inclusive:b});var b=b||{},c=this.contains(a.lon,a.lat,b.inclusive),d=b.worldBounds;d&&!c&&(c=d.getWidth(),
d=Math.round((a.lon-(d.left+d.right)/2)/c),c=this.containsLonLat({lon:a.lon-d*c,lat:a.lat},{inclusive:b.inclusive}));return c},containsPixel:function(a,b){return this.contains(a.x,a.y,b)},contains:function(a,b,c){null==c&&(c=!0);if(null==a||null==b)return!1;var a=OpenLayers.Util.toFloat(a),b=OpenLayers.Util.toFloat(b),d=!1;return d=c?a>=this.left&&a<=this.right&&b>=this.bottom&&b<=this.top:a>this.left&&a<this.right&&b>this.bottom&&b<this.top},intersectsBounds:function(a,b){"boolean"===typeof b&&(b=
{inclusive:b});b=b||{};if(b.worldBounds)var c=this.wrapDateLine(b.worldBounds),a=a.wrapDateLine(b.worldBounds);else c=this;null==b.inclusive&&(b.inclusive=!0);var d=!1,e=c.left==a.right||c.right==a.left||c.top==a.bottom||c.bottom==a.top;if(b.inclusive||!e)var d=a.top>=c.bottom&&a.top<=c.top||c.top>a.bottom&&c.top<a.top,e=a.left>=c.left&&a.left<=c.right||c.left>=a.left&&c.left<=a.right,f=a.right>=c.left&&a.right<=c.right||c.right>=a.left&&c.right<=a.right,d=(a.bottom>=c.bottom&&a.bottom<=c.top||c.bottom>=
a.bottom&&c.bottom<=a.top||d)&&(e||f);if(b.worldBounds&&!d){var g=b.worldBounds,e=g.getWidth(),f=!g.containsBounds(c),g=!g.containsBounds(a);f&&!g?(a=a.add(-e,0),d=c.intersectsBounds(a,{inclusive:b.inclusive})):g&&!f&&(c=c.add(-e,0),d=a.intersectsBounds(c,{inclusive:b.inclusive}))}return d},containsBounds:function(a,b,c){null==b&&(b=!1);null==c&&(c=!0);var d=this.contains(a.left,a.bottom,c),e=this.contains(a.right,a.bottom,c),f=this.contains(a.left,a.top,c),a=this.contains(a.right,a.top,c);return b?
d||e||f||a:d&&e&&f&&a},determineQuadrant:function(a){var b="",c=this.getCenterLonLat(),b=b+(a.lat<c.lat?"b":"t");return b+=a.lon<c.lon?"l":"r"},transform:function(a,b){this.centerLonLat=null;var c=OpenLayers.Projection.transform({x:this.left,y:this.bottom},a,b),d=OpenLayers.Projection.transform({x:this.right,y:this.bottom},a,b),e=OpenLayers.Projection.transform({x:this.left,y:this.top},a,b),f=OpenLayers.Projection.transform({x:this.right,y:this.top},a,b);this.left=Math.min(c.x,e.x);this.bottom=Math.min(c.y,
d.y);this.right=Math.max(d.x,f.x);this.top=Math.max(e.y,f.y);return this},wrapDateLine:function(a,b){var b=b||{},c=b.leftTolerance||0,d=b.rightTolerance||0,e=this.clone();if(a){for(var f=a.getWidth();e.left<a.left&&e.right-d<=a.left;)e=e.add(f,0);for(;e.left+c>=a.right&&e.right>a.right;)e=e.add(-f,0);c=e.left+c;c<a.right&&(c>a.left&&e.right-d>a.right)&&(e=e.add(-f,0))}return e},CLASS_NAME:"OpenLayers.Bounds"});
OpenLayers.Bounds.fromString=function(a,b){var c=a.split(",");return OpenLayers.Bounds.fromArray(c,b)};OpenLayers.Bounds.fromArray=function(a,b){return!0===b?new OpenLayers.Bounds(a[1],a[0],a[3],a[2]):new OpenLayers.Bounds(a[0],a[1],a[2],a[3])};OpenLayers.Bounds.fromSize=function(a){return new OpenLayers.Bounds(0,a.h,a.w,0)};OpenLayers.Bounds.oppositeQuadrant=function(a){var b;b=""+("t"==a.charAt(0)?"b":"t");return b+="l"==a.charAt(1)?"r":"l"};
OpenLayers.Element={visible:function(a){return"none"!=OpenLayers.Util.getElement(a).style.display},toggle:function(){for(var a=0,b=arguments.length;a<b;a++){var c=OpenLayers.Util.getElement(arguments[a]),d=OpenLayers.Element.visible(c)?"none":"";c.style.display=d}},remove:function(a){a=OpenLayers.Util.getElement(a);a.parentNode.removeChild(a)},getHeight:function(a){a=OpenLayers.Util.getElement(a);return a.offsetHeight},hasClass:function(a,b){var c=a.className;return!!c&&RegExp("(^|\\s)"+b+"(\\s|$)").test(c)},
addClass:function(a,b){OpenLayers.Element.hasClass(a,b)||(a.className+=(a.className?" ":"")+b);return a},removeClass:function(a,b){var c=a.className;c&&(a.className=OpenLayers.String.trim(c.replace(RegExp("(^|\\s+)"+b+"(\\s+|$)")," ")));return a},toggleClass:function(a,b){OpenLayers.Element.hasClass(a,b)?OpenLayers.Element.removeClass(a,b):OpenLayers.Element.addClass(a,b);return a},getStyle:function(a,b){var a=OpenLayers.Util.getElement(a),c=null;if(a&&a.style){c=a.style[OpenLayers.String.camelize(b)];
c||(document.defaultView&&document.defaultView.getComputedStyle?c=(c=document.defaultView.getComputedStyle(a,null))?c.getPropertyValue(b):null:a.currentStyle&&(c=a.currentStyle[OpenLayers.String.camelize(b)]));var d=["left","top","right","bottom"];window.opera&&(-1!=OpenLayers.Util.indexOf(d,b)&&"static"==OpenLayers.Element.getStyle(a,"position"))&&(c="auto")}return"auto"==c?null:c}};
OpenLayers.LonLat=OpenLayers.Class({lon:0,lat:0,initialize:function(a,b){OpenLayers.Util.isArray(a)&&(b=a[1],a=a[0]);this.lon=OpenLayers.Util.toFloat(a);this.lat=OpenLayers.Util.toFloat(b)},toString:function(){return"lon="+this.lon+",lat="+this.lat},toShortString:function(){return this.lon+", "+this.lat},clone:function(){return new OpenLayers.LonLat(this.lon,this.lat)},add:function(a,b){if(null==a||null==b)throw new TypeError("LonLat.add cannot receive null values");return new OpenLayers.LonLat(this.lon+
OpenLayers.Util.toFloat(a),this.lat+OpenLayers.Util.toFloat(b))},equals:function(a){var b=!1;null!=a&&(b=this.lon==a.lon&&this.lat==a.lat||isNaN(this.lon)&&isNaN(this.lat)&&isNaN(a.lon)&&isNaN(a.lat));return b},transform:function(a,b){var c=OpenLayers.Projection.transform({x:this.lon,y:this.lat},a,b);this.lon=c.x;this.lat=c.y;return this},wrapDateLine:function(a){var b=this.clone();if(a){for(;b.lon<a.left;)b.lon+=a.getWidth();for(;b.lon>a.right;)b.lon-=a.getWidth()}return b},CLASS_NAME:"OpenLayers.LonLat"});
OpenLayers.LonLat.fromString=function(a){a=a.split(",");return new OpenLayers.LonLat(a[0],a[1])};OpenLayers.LonLat.fromArray=function(a){var b=OpenLayers.Util.isArray(a);return new OpenLayers.LonLat(b&&a[0],b&&a[1])};
OpenLayers.Pixel=OpenLayers.Class({x:0,y:0,initialize:function(a,b){this.x=parseFloat(a);this.y=parseFloat(b)},toString:function(){return"x="+this.x+",y="+this.y},clone:function(){return new OpenLayers.Pixel(this.x,this.y)},equals:function(a){var b=!1;null!=a&&(b=this.x==a.x&&this.y==a.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(a.x)&&isNaN(a.y));return b},distanceTo:function(a){return Math.sqrt(Math.pow(this.x-a.x,2)+Math.pow(this.y-a.y,2))},add:function(a,b){if(null==a||null==b)throw new TypeError("Pixel.add cannot receive null values");
return new OpenLayers.Pixel(this.x+a,this.y+b)},offset:function(a){var b=this.clone();a&&(b=this.add(a.x,a.y));return b},CLASS_NAME:"OpenLayers.Pixel"});
OpenLayers.Size=OpenLayers.Class({w:0,h:0,initialize:function(a,b){this.w=parseFloat(a);this.h=parseFloat(b)},toString:function(){return"w="+this.w+",h="+this.h},clone:function(){return new OpenLayers.Size(this.w,this.h)},equals:function(a){var b=!1;null!=a&&(b=this.w==a.w&&this.h==a.h||isNaN(this.w)&&isNaN(this.h)&&isNaN(a.w)&&isNaN(a.h));return b},CLASS_NAME:"OpenLayers.Size"});
OpenLayers.Console={log:function(){},debug:function(){},info:function(){},warn:function(){},error:function(){},userError:function(a){alert(a)},assert:function(){},dir:function(){},dirxml:function(){},trace:function(){},group:function(){},groupEnd:function(){},time:function(){},timeEnd:function(){},profile:function(){},profileEnd:function(){},count:function(){},CLASS_NAME:"OpenLayers.Console"};
(function(){for(var a=document.getElementsByTagName("script"),b=0,c=a.length;b<c;++b)if(-1!=a[b].src.indexOf("firebug.js")&&console){OpenLayers.Util.extend(OpenLayers.Console,console);break}})();
OpenLayers.Lang={code:null,defaultCode:"en",getCode:function(){OpenLayers.Lang.code||OpenLayers.Lang.setCode();return OpenLayers.Lang.code},setCode:function(a){var b;a||(a="msie"==OpenLayers.BROWSER_NAME?navigator.userLanguage:navigator.language);a=a.split("-");a[0]=a[0].toLowerCase();"object"==typeof OpenLayers.Lang[a[0]]&&(b=a[0]);if(a[1]){var c=a[0]+"-"+a[1].toUpperCase();"object"==typeof OpenLayers.Lang[c]&&(b=c)}b||(OpenLayers.Console.warn("Failed to find OpenLayers.Lang."+a.join("-")+" dictionary, falling back to default language"),
b=OpenLayers.Lang.defaultCode);OpenLayers.Lang.code=b},translate:function(a,b){var c=OpenLayers.Lang[OpenLayers.Lang.getCode()];(c=c&&c[a])||(c=a);b&&(c=OpenLayers.String.format(c,b));return c}};OpenLayers.i18n=OpenLayers.Lang.translate;OpenLayers.Util=OpenLayers.Util||{};OpenLayers.Util.getElement=function(){for(var a=[],b=0,c=arguments.length;b<c;b++){var d=arguments[b];"string"==typeof d&&(d=document.getElementById(d));if(1==arguments.length)return d;a.push(d)}return a};
OpenLayers.Util.isElement=function(a){return!!(a&&1===a.nodeType)};OpenLayers.Util.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)};OpenLayers.Util.removeItem=function(a,b){for(var c=a.length-1;0<=c;c--)a[c]==b&&a.splice(c,1);return a};OpenLayers.Util.indexOf=function(a,b){if("function"==typeof a.indexOf)return a.indexOf(b);for(var c=0,d=a.length;c<d;c++)if(a[c]==b)return c;return-1};OpenLayers.Util.dotless=/\./g;
OpenLayers.Util.modifyDOMElement=function(a,b,c,d,e,f,g,h){b&&(a.id=b.replace(OpenLayers.Util.dotless,"_"));c&&(a.style.left=c.x+"px",a.style.top=c.y+"px");d&&(a.style.width=d.w+"px",a.style.height=d.h+"px");e&&(a.style.position=e);f&&(a.style.border=f);g&&(a.style.overflow=g);0<=parseFloat(h)&&1>parseFloat(h)?(a.style.filter="alpha(opacity="+100*h+")",a.style.opacity=h):1==parseFloat(h)&&(a.style.filter="",a.style.opacity="")};
OpenLayers.Util.createDiv=function(a,b,c,d,e,f,g,h){var j=document.createElement("div");d&&(j.style.backgroundImage="url("+d+")");a||(a=OpenLayers.Util.createUniqueID("OpenLayersDiv"));e||(e="absolute");OpenLayers.Util.modifyDOMElement(j,a,b,c,e,f,g,h);return j};
OpenLayers.Util.createImage=function(a,b,c,d,e,f,g,h){var j=document.createElement("img");a||(a=OpenLayers.Util.createUniqueID("OpenLayersDiv"));e||(e="relative");OpenLayers.Util.modifyDOMElement(j,a,b,c,e,f,null,g);h&&(j.style.display="none",b=function(){j.style.display="";OpenLayers.Event.stopObservingElement(j)},OpenLayers.Event.observe(j,"load",b),OpenLayers.Event.observe(j,"error",b));j.style.alt=a;j.galleryImg="no";d&&(j.src=d);return j};OpenLayers.IMAGE_RELOAD_ATTEMPTS=0;
OpenLayers.Util.alphaHackNeeded=null;OpenLayers.Util.alphaHack=function(){if(null==OpenLayers.Util.alphaHackNeeded){var a=navigator.appVersion.split("MSIE"),a=parseFloat(a[1]),b=!1;try{b=!!document.body.filters}catch(c){}OpenLayers.Util.alphaHackNeeded=b&&5.5<=a&&7>a}return OpenLayers.Util.alphaHackNeeded};
OpenLayers.Util.modifyAlphaImageDiv=function(a,b,c,d,e,f,g,h,j){OpenLayers.Util.modifyDOMElement(a,b,c,d,f,null,null,j);b=a.childNodes[0];e&&(b.src=e);OpenLayers.Util.modifyDOMElement(b,a.id+"_innerImage",null,d,"relative",g);OpenLayers.Util.alphaHack()&&("none"!=a.style.display&&(a.style.display="inline-block"),null==h&&(h="scale"),a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+b.src+"', sizingMethod='"+h+"')",0<=parseFloat(a.style.opacity)&&1>parseFloat(a.style.opacity)&&
(a.style.filter+=" alpha(opacity="+100*a.style.opacity+")"),b.style.filter="alpha(opacity=0)")};OpenLayers.Util.createAlphaImageDiv=function(a,b,c,d,e,f,g,h,j){var n=OpenLayers.Util.createDiv(),j=OpenLayers.Util.createImage(null,null,null,null,null,null,null,j);j.className="olAlphaImg";n.appendChild(j);OpenLayers.Util.modifyAlphaImageDiv(n,a,b,c,d,e,f,g,h);return n};OpenLayers.Util.upperCaseObject=function(a){var b={},c;for(c in a)b[c.toUpperCase()]=a[c];return b};
OpenLayers.Util.applyDefaults=function(a,b){var a=a||{},c="function"==typeof window.Event&&b instanceof window.Event,d;for(d in b)if(void 0===a[d]||!c&&b.hasOwnProperty&&b.hasOwnProperty(d)&&!a.hasOwnProperty(d))a[d]=b[d];!c&&(b&&b.hasOwnProperty&&b.hasOwnProperty("toString")&&!a.hasOwnProperty("toString"))&&(a.toString=b.toString);return a};
OpenLayers.Util.getParameterString=function(a){var b=[],c;for(c in a){var d=a[c];if(null!=d&&"function"!=typeof d){if("object"==typeof d&&d.constructor==Array){for(var e=[],f,g=0,h=d.length;g<h;g++)f=d[g],e.push(encodeURIComponent(null===f||void 0===f?"":f));d=e.join(",")}else d=encodeURIComponent(d);b.push(encodeURIComponent(c)+"="+d)}}return b.join("&")};OpenLayers.Util.urlAppend=function(a,b){var c=a;if(b)var d=(a+" ").split(/[?&]/),c=c+(" "===d.pop()?b:d.length?"&"+b:"?"+b);return c};
OpenLayers.Util.getImagesLocation=function(){return OpenLayers.ImgPath||OpenLayers._getScriptLocation()+"img/"};OpenLayers.Util.getImageLocation=function(a){return OpenLayers.Util.getImagesLocation()+a};OpenLayers.Util.Try=function(){for(var a=null,b=0,c=arguments.length;b<c;b++){var d=arguments[b];try{a=d();break}catch(e){}}return a};
OpenLayers.Util.getXmlNodeValue=function(a){var b=null;OpenLayers.Util.Try(function(){b=a.text;b||(b=a.textContent);b||(b=a.firstChild.nodeValue)},function(){b=a.textContent});return b};OpenLayers.Util.mouseLeft=function(a,b){for(var c=a.relatedTarget?a.relatedTarget:a.toElement;c!=b&&null!=c;)c=c.parentNode;return c!=b};OpenLayers.Util.DEFAULT_PRECISION=14;OpenLayers.Util.toFloat=function(a,b){null==b&&(b=OpenLayers.Util.DEFAULT_PRECISION);"number"!==typeof a&&(a=parseFloat(a));return 0===b?a:parseFloat(a.toPrecision(b))};
OpenLayers.Util.rad=function(a){return a*Math.PI/180};OpenLayers.Util.deg=function(a){return 180*a/Math.PI};OpenLayers.Util.VincentyConstants={a:6378137,b:6356752.3142,f:1/298.257223563};
OpenLayers.Util.distVincenty=function(a,b){for(var c=OpenLayers.Util.VincentyConstants,d=c.a,e=c.b,c=c.f,f=OpenLayers.Util.rad(b.lon-a.lon),g=Math.atan((1-c)*Math.tan(OpenLayers.Util.rad(a.lat))),h=Math.atan((1-c)*Math.tan(OpenLayers.Util.rad(b.lat))),j=Math.sin(g),g=Math.cos(g),n=Math.sin(h),h=Math.cos(h),p=f,q=2*Math.PI,m=20;1E-12<Math.abs(p-q)&&0<--m;){var r=Math.sin(p),s=Math.cos(p),t=Math.sqrt(h*r*h*r+(g*n-j*h*s)*(g*n-j*h*s));if(0==t)return 0;var s=j*n+g*h*s,v=Math.atan2(t,s),u=Math.asin(g*h*
r/t),w=Math.cos(u)*Math.cos(u),r=s-2*j*n/w,y=c/16*w*(4+c*(4-3*w)),q=p,p=f+(1-y)*c*Math.sin(u)*(v+y*t*(r+y*s*(-1+2*r*r)))}if(0==m)return NaN;d=w*(d*d-e*e)/(e*e);c=d/1024*(256+d*(-128+d*(74-47*d)));return(e*(1+d/16384*(4096+d*(-768+d*(320-175*d))))*(v-c*t*(r+c/4*(s*(-1+2*r*r)-c/6*r*(-3+4*t*t)*(-3+4*r*r))))).toFixed(3)/1E3};
OpenLayers.Util.destinationVincenty=function(a,b,c){for(var d=OpenLayers.Util,e=d.VincentyConstants,f=e.a,g=e.b,h=e.f,e=a.lon,a=a.lat,j=d.rad(b),b=Math.sin(j),j=Math.cos(j),a=(1-h)*Math.tan(d.rad(a)),n=1/Math.sqrt(1+a*a),p=a*n,q=Math.atan2(a,j),a=n*b,m=1-a*a,f=m*(f*f-g*g)/(g*g),r=1+f/16384*(4096+f*(-768+f*(320-175*f))),s=f/1024*(256+f*(-128+f*(74-47*f))),f=c/(g*r),t=2*Math.PI;1E-12<Math.abs(f-t);)var v=Math.cos(2*q+f),u=Math.sin(f),w=Math.cos(f),y=s*u*(v+s/4*(w*(-1+2*v*v)-s/6*v*(-3+4*u*u)*(-3+4*v*
v))),t=f,f=c/(g*r)+y;c=p*u-n*w*j;g=Math.atan2(p*w+n*u*j,(1-h)*Math.sqrt(a*a+c*c));b=Math.atan2(u*b,n*w-p*u*j);j=h/16*m*(4+h*(4-3*m));v=b-(1-j)*h*a*(f+j*u*(v+j*w*(-1+2*v*v)));Math.atan2(a,-c);return new OpenLayers.LonLat(e+d.deg(v),d.deg(g))};
OpenLayers.Util.getParameters=function(a,b){var b=b||{},a=null===a||void 0===a?window.location.href:a,c="";if(OpenLayers.String.contains(a,"?"))var d=a.indexOf("?")+1,c=OpenLayers.String.contains(a,"#")?a.indexOf("#"):a.length,c=a.substring(d,c);for(var d={},c=c.split(/[&;]/),e=0,f=c.length;e<f;++e){var g=c[e].split("=");if(g[0]){var h=g[0];try{h=decodeURIComponent(h)}catch(j){h=unescape(h)}g=(g[1]||"").replace(/\+/g," ");try{g=decodeURIComponent(g)}catch(n){g=unescape(g)}!1!==b.splitArgs&&(g=g.split(","));
1==g.length&&(g=g[0]);d[h]=g}}return d};OpenLayers.Util.lastSeqID=0;OpenLayers.Util.createUniqueID=function(a){a=null==a?"id_":a.replace(OpenLayers.Util.dotless,"_");OpenLayers.Util.lastSeqID+=1;return a+OpenLayers.Util.lastSeqID};OpenLayers.INCHES_PER_UNIT={inches:1,ft:12,mi:63360,m:39.37,km:39370,dd:4374754,yd:36};OpenLayers.INCHES_PER_UNIT["in"]=OpenLayers.INCHES_PER_UNIT.inches;OpenLayers.INCHES_PER_UNIT.degrees=OpenLayers.INCHES_PER_UNIT.dd;OpenLayers.INCHES_PER_UNIT.nmi=1852*OpenLayers.INCHES_PER_UNIT.m;
OpenLayers.METERS_PER_INCH=0.0254000508001016;
OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{Inch:OpenLayers.INCHES_PER_UNIT.inches,Meter:1/OpenLayers.METERS_PER_INCH,Foot:0.3048006096012192/OpenLayers.METERS_PER_INCH,IFoot:0.3048/OpenLayers.METERS_PER_INCH,ClarkeFoot:0.3047972651151/OpenLayers.METERS_PER_INCH,SearsFoot:0.30479947153867626/OpenLayers.METERS_PER_INCH,GoldCoastFoot:0.3047997101815088/OpenLayers.METERS_PER_INCH,IInch:0.0254/OpenLayers.METERS_PER_INCH,MicroInch:2.54E-5/OpenLayers.METERS_PER_INCH,Mil:2.54E-8/OpenLayers.METERS_PER_INCH,
Centimeter:0.01/OpenLayers.METERS_PER_INCH,Kilometer:1E3/OpenLayers.METERS_PER_INCH,Yard:0.9144018288036576/OpenLayers.METERS_PER_INCH,SearsYard:0.914398414616029/OpenLayers.METERS_PER_INCH,IndianYard:0.9143985307444408/OpenLayers.METERS_PER_INCH,IndianYd37:0.91439523/OpenLayers.METERS_PER_INCH,IndianYd62:0.9143988/OpenLayers.METERS_PER_INCH,IndianYd75:0.9143985/OpenLayers.METERS_PER_INCH,IndianFoot:0.30479951/OpenLayers.METERS_PER_INCH,IndianFt37:0.30479841/OpenLayers.METERS_PER_INCH,IndianFt62:0.3047996/
OpenLayers.METERS_PER_INCH,IndianFt75:0.3047995/OpenLayers.METERS_PER_INCH,Mile:1609.3472186944373/OpenLayers.METERS_PER_INCH,IYard:0.9144/OpenLayers.METERS_PER_INCH,IMile:1609.344/OpenLayers.METERS_PER_INCH,NautM:1852/OpenLayers.METERS_PER_INCH,"Lat-66":110943.31648893273/OpenLayers.METERS_PER_INCH,"Lat-83":110946.25736872235/OpenLayers.METERS_PER_INCH,Decimeter:0.1/OpenLayers.METERS_PER_INCH,Millimeter:0.0010/OpenLayers.METERS_PER_INCH,Dekameter:10/OpenLayers.METERS_PER_INCH,Decameter:10/OpenLayers.METERS_PER_INCH,
Hectometer:100/OpenLayers.METERS_PER_INCH,GermanMeter:1.0000135965/OpenLayers.METERS_PER_INCH,CaGrid:0.999738/OpenLayers.METERS_PER_INCH,ClarkeChain:20.1166194976/OpenLayers.METERS_PER_INCH,GunterChain:20.11684023368047/OpenLayers.METERS_PER_INCH,BenoitChain:20.116782494375872/OpenLayers.METERS_PER_INCH,SearsChain:20.11676512155/OpenLayers.METERS_PER_INCH,ClarkeLink:0.201166194976/OpenLayers.METERS_PER_INCH,GunterLink:0.2011684023368047/OpenLayers.METERS_PER_INCH,BenoitLink:0.20116782494375873/OpenLayers.METERS_PER_INCH,
SearsLink:0.2011676512155/OpenLayers.METERS_PER_INCH,Rod:5.02921005842012/OpenLayers.METERS_PER_INCH,IntnlChain:20.1168/OpenLayers.METERS_PER_INCH,IntnlLink:0.201168/OpenLayers.METERS_PER_INCH,Perch:5.02921005842012/OpenLayers.METERS_PER_INCH,Pole:5.02921005842012/OpenLayers.METERS_PER_INCH,Furlong:201.1684023368046/OpenLayers.METERS_PER_INCH,Rood:3.778266898/OpenLayers.METERS_PER_INCH,CapeFoot:0.3047972615/OpenLayers.METERS_PER_INCH,Brealey:375/OpenLayers.METERS_PER_INCH,ModAmFt:0.304812252984506/
OpenLayers.METERS_PER_INCH,Fathom:1.8288/OpenLayers.METERS_PER_INCH,"NautM-UK":1853.184/OpenLayers.METERS_PER_INCH,"50kilometers":5E4/OpenLayers.METERS_PER_INCH,"150kilometers":15E4/OpenLayers.METERS_PER_INCH});
OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{mm:OpenLayers.INCHES_PER_UNIT.Meter/1E3,cm:OpenLayers.INCHES_PER_UNIT.Meter/100,dm:100*OpenLayers.INCHES_PER_UNIT.Meter,km:1E3*OpenLayers.INCHES_PER_UNIT.Meter,kmi:OpenLayers.INCHES_PER_UNIT.nmi,fath:OpenLayers.INCHES_PER_UNIT.Fathom,ch:OpenLayers.INCHES_PER_UNIT.IntnlChain,link:OpenLayers.INCHES_PER_UNIT.IntnlLink,"us-in":OpenLayers.INCHES_PER_UNIT.inches,"us-ft":OpenLayers.INCHES_PER_UNIT.Foot,"us-yd":OpenLayers.INCHES_PER_UNIT.Yard,"us-ch":OpenLayers.INCHES_PER_UNIT.GunterChain,
"us-mi":OpenLayers.INCHES_PER_UNIT.Mile,"ind-yd":OpenLayers.INCHES_PER_UNIT.IndianYd37,"ind-ft":OpenLayers.INCHES_PER_UNIT.IndianFt37,"ind-ch":20.11669506/OpenLayers.METERS_PER_INCH});OpenLayers.DOTS_PER_INCH=72;OpenLayers.Util.normalizeScale=function(a){return 1<a?1/a:a};OpenLayers.Util.getResolutionFromScale=function(a,b){var c;a&&(null==b&&(b="degrees"),c=1/(OpenLayers.Util.normalizeScale(a)*OpenLayers.INCHES_PER_UNIT[b]*OpenLayers.DOTS_PER_INCH));return c};
OpenLayers.Util.getScaleFromResolution=function(a,b){null==b&&(b="degrees");return a*OpenLayers.INCHES_PER_UNIT[b]*OpenLayers.DOTS_PER_INCH};
OpenLayers.Util.pagePosition=function(a){var b=[0,0],c=OpenLayers.Util.getViewportElement();if(!a||a==window||a==c)return b;var d=OpenLayers.IS_GECKO&&document.getBoxObjectFor&&"absolute"==OpenLayers.Element.getStyle(a,"position")&&(""==a.style.top||""==a.style.left),e=null;if(a.getBoundingClientRect)a=a.getBoundingClientRect(),e=window.pageYOffset||c.scrollTop,b[0]=a.left+(window.pageXOffset||c.scrollLeft),b[1]=a.top+e;else if(document.getBoxObjectFor&&!d)a=document.getBoxObjectFor(a),c=document.getBoxObjectFor(c),
b[0]=a.screenX-c.screenX,b[1]=a.screenY-c.screenY;else{b[0]=a.offsetLeft;b[1]=a.offsetTop;e=a.offsetParent;if(e!=a)for(;e;)b[0]+=e.offsetLeft,b[1]+=e.offsetTop,e=e.offsetParent;c=OpenLayers.BROWSER_NAME;if("opera"==c||"safari"==c&&"absolute"==OpenLayers.Element.getStyle(a,"position"))b[1]-=document.body.offsetTop;for(e=a.offsetParent;e&&e!=document.body;){b[0]-=e.scrollLeft;if("opera"!=c||"TR"!=e.tagName)b[1]-=e.scrollTop;e=e.offsetParent}}return b};
OpenLayers.Util.getViewportElement=function(){var a=arguments.callee.viewportElement;void 0==a&&(a="msie"==OpenLayers.BROWSER_NAME&&"CSS1Compat"!=document.compatMode?document.body:document.documentElement,arguments.callee.viewportElement=a);return a};
OpenLayers.Util.isEquivalentUrl=function(a,b,c){c=c||{};OpenLayers.Util.applyDefaults(c,{ignoreCase:!0,ignorePort80:!0,ignoreHash:!0,splitArgs:!1});var a=OpenLayers.Util.createUrlObject(a,c),b=OpenLayers.Util.createUrlObject(b,c),d;for(d in a)if("args"!==d&&a[d]!=b[d])return!1;for(d in a.args){if(a.args[d]!=b.args[d])return!1;delete b.args[d]}for(d in b.args)return!1;return!0};
OpenLayers.Util.createUrlObject=function(a,b){b=b||{};if(!/^\w+:\/\//.test(a)){var c=window.location,d=c.port?":"+c.port:"",d=c.protocol+"//"+c.host.split(":").shift()+d;0===a.indexOf("/")?a=d+a:(c=c.pathname.split("/"),c.pop(),a=d+c.join("/")+"/"+a)}b.ignoreCase&&(a=a.toLowerCase());c=document.createElement("a");c.href=a;d={};d.host=c.host.split(":").shift();d.protocol=c.protocol;d.port=b.ignorePort80?"80"==c.port||"0"==c.port?"":c.port:""==c.port||"0"==c.port?"80":c.port;d.hash=b.ignoreHash||"#"===
c.hash?"":c.hash;var e=c.search;e||(e=a.indexOf("?"),e=-1!=e?a.substr(e):"");d.args=OpenLayers.Util.getParameters(e,{splitArgs:b.splitArgs});d.pathname="/"==c.pathname.charAt(0)?c.pathname:"/"+c.pathname;return d};OpenLayers.Util.removeTail=function(a){var b=null,b=a.indexOf("?"),c=a.indexOf("#");return b=-1==b?-1!=c?a.substr(0,c):a:-1!=c?a.substr(0,Math.min(b,c)):a.substr(0,b)};OpenLayers.IS_GECKO=function(){var a=navigator.userAgent.toLowerCase();return-1==a.indexOf("webkit")&&-1!=a.indexOf("gecko")}();
OpenLayers.CANVAS_SUPPORTED=function(){var a=document.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))}();OpenLayers.BROWSER_NAME=function(){var a="",b=navigator.userAgent.toLowerCase();-1!=b.indexOf("opera")?a="opera":-1!=b.indexOf("msie")?a="msie":-1!=b.indexOf("safari")?a="safari":-1!=b.indexOf("mozilla")&&(a=-1!=b.indexOf("firefox")?"firefox":"mozilla");return a}();OpenLayers.Util.getBrowserName=function(){return OpenLayers.BROWSER_NAME};
OpenLayers.Util.getRenderedDimensions=function(a,b,c){var d,e,f=document.createElement("div");f.style.visibility="hidden";for(var g=c&&c.containerElement?c.containerElement:document.body,h=!1,j=null,n=g;n&&"body"!=n.tagName.toLowerCase();){var p=OpenLayers.Element.getStyle(n,"position");if("absolute"==p){h=!0;break}else if(p&&"static"!=p)break;n=n.parentNode}if(h&&(0===g.clientHeight||0===g.clientWidth))j=document.createElement("div"),j.style.visibility="hidden",j.style.position="absolute",j.style.overflow=
"visible",j.style.width=document.body.clientWidth+"px",j.style.height=document.body.clientHeight+"px",j.appendChild(f);f.style.position="absolute";b&&(b.w?(d=b.w,f.style.width=d+"px"):b.h&&(e=b.h,f.style.height=e+"px"));c&&c.displayClass&&(f.className=c.displayClass);b=document.createElement("div");b.innerHTML=a;b.style.overflow="visible";if(b.childNodes){a=0;for(c=b.childNodes.length;a<c;a++)b.childNodes[a].style&&(b.childNodes[a].style.overflow="visible")}f.appendChild(b);j?g.appendChild(j):g.appendChild(f);
d||(d=parseInt(b.scrollWidth),f.style.width=d+"px");e||(e=parseInt(b.scrollHeight));f.removeChild(b);j?(j.removeChild(f),g.removeChild(j)):g.removeChild(f);return new OpenLayers.Size(d,e)};
OpenLayers.Util.getScrollbarWidth=function(){var a=OpenLayers.Util._scrollbarWidth;if(null==a){var b=null,c=null,b=a=0,b=document.createElement("div");b.style.position="absolute";b.style.top="-1000px";b.style.left="-1000px";b.style.width="100px";b.style.height="50px";b.style.overflow="hidden";c=document.createElement("div");c.style.width="100%";c.style.height="200px";b.appendChild(c);document.body.appendChild(b);a=c.offsetWidth;b.style.overflow="scroll";b=c.offsetWidth;document.body.removeChild(document.body.lastChild);
OpenLayers.Util._scrollbarWidth=a-b;a=OpenLayers.Util._scrollbarWidth}return a};
OpenLayers.Util.getFormattedLonLat=function(a,b,c){c||(c="dms");var a=(a+540)%360-180,d=Math.abs(a),e=Math.floor(d),f=d=(d-e)/(1/60),d=Math.floor(d),f=Math.round(10*((f-d)/(1/60))),f=f/10;60<=f&&(f-=60,d+=1,60<=d&&(d-=60,e+=1));10>e&&(e="0"+e);e+="\u00b0";0<=c.indexOf("dm")&&(10>d&&(d="0"+d),e+=d+"'",0<=c.indexOf("dms")&&(10>f&&(f="0"+f),e+=f+'"'));return e="lon"==b?e+(0>a?OpenLayers.i18n("W"):OpenLayers.i18n("E")):e+(0>a?OpenLayers.i18n("S"):OpenLayers.i18n("N"))};
OpenLayers.Util=OpenLayers.Util||{};
OpenLayers.Util.vendorPrefix=function(){function a(a,b){if(void 0===f[b]){var d,e=0,p=c.length,q="undefined"!==typeof a.cssText;for(f[b]=null;e<p;e++)if((d=c[e])?(q||(d=d.toLowerCase()),d=d+b.charAt(0).toUpperCase()+b.slice(1)):d=b,void 0!==a[d]){f[b]=d;break}}return f[b]}function b(b){return a(d,b)}var c=["","O","ms","Moz","Webkit"],d=document.createElement("div").style,e={},f={};return{css:function(a){if(void 0===e[a]){var c=a.replace(/(-[\s\S])/g,function(a){return a.charAt(1).toUpperCase()}),c=
b(c);c=c?c.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()}).replace(/^ms-/,"-ms-"):null;e[a]=c}return e[a]},js:a,style:b,cssCache:e,jsCache:f}}();
OpenLayers.Event={observers:!1,KEY_SPACE:32,KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,element:function(a){return a.target||a.srcElement},isSingleTouch:function(a){return a.touches&&1==a.touches.length},isMultiTouch:function(a){return a.touches&&1<a.touches.length},isLeftClick:function(a){return a.which&&1==a.which||a.button&&1==a.button},isRightClick:function(a){return a.which&&3==a.which||a.button&&2==a.button},stop:function(a,
b){b||OpenLayers.Event.preventDefault(a);a.stopPropagation?a.stopPropagation():a.cancelBubble=!0},preventDefault:function(a){a.preventDefault?a.preventDefault():a.returnValue=!1},findElement:function(a,b){for(var c=OpenLayers.Event.element(a);c.parentNode&&(!c.tagName||c.tagName.toUpperCase()!=b.toUpperCase());)c=c.parentNode;return c},observe:function(a,b,c,d){a=OpenLayers.Util.getElement(a);d=d||!1;if("keypress"==b&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||a.attachEvent))b="keydown";
this.observers||(this.observers={});if(!a._eventCacheID){var e="eventCacheID_";a.id&&(e=a.id+"_"+e);a._eventCacheID=OpenLayers.Util.createUniqueID(e)}e=a._eventCacheID;this.observers[e]||(this.observers[e]=[]);this.observers[e].push({element:a,name:b,observer:c,useCapture:d});a.addEventListener?a.addEventListener(b,c,d):a.attachEvent&&a.attachEvent("on"+b,c)},stopObservingElement:function(a){a=OpenLayers.Util.getElement(a)._eventCacheID;this._removeElementObservers(OpenLayers.Event.observers[a])},
_removeElementObservers:function(a){if(a)for(var b=a.length-1;0<=b;b--){var c=a[b];OpenLayers.Event.stopObserving.apply(this,[c.element,c.name,c.observer,c.useCapture])}},stopObserving:function(a,b,c,d){var d=d||!1,a=OpenLayers.Util.getElement(a),e=a._eventCacheID;if("keypress"==b&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||a.detachEvent))b="keydown";var f=!1,g=OpenLayers.Event.observers[e];if(g)for(var h=0;!f&&h<g.length;){var j=g[h];if(j.name==b&&j.observer==c&&j.useCapture==d){g.splice(h,
1);0==g.length&&delete OpenLayers.Event.observers[e];f=!0;break}h++}f&&(a.removeEventListener?a.removeEventListener(b,c,d):a&&a.detachEvent&&a.detachEvent("on"+b,c));return f},unloadCache:function(){if(OpenLayers.Event&&OpenLayers.Event.observers){for(var a in OpenLayers.Event.observers)OpenLayers.Event._removeElementObservers.apply(this,[OpenLayers.Event.observers[a]]);OpenLayers.Event.observers=!1}},CLASS_NAME:"OpenLayers.Event"};
OpenLayers.Event.observe(window,"unload",OpenLayers.Event.unloadCache,!1);
OpenLayers.Events=OpenLayers.Class({BROWSER_EVENTS:"mouseover mouseout mousedown mouseup mousemove click dblclick rightclick dblrightclick resize focus blur touchstart touchmove touchend keydown".split(" "),listeners:null,object:null,element:null,eventHandler:null,fallThrough:null,includeXY:!1,extensions:null,extensionCount:null,clearMouseListener:null,initialize:function(a,b,c,d,e){OpenLayers.Util.extend(this,e);this.object=a;this.fallThrough=d;this.listeners={};this.extensions={};this.extensionCount=
{};this._msTouches=[];null!=b&&this.attachToElement(b)},destroy:function(){for(var a in this.extensions)"boolean"!==typeof this.extensions[a]&&this.extensions[a].destroy();this.extensions=null;this.element&&(OpenLayers.Event.stopObservingElement(this.element),this.element.hasScrollEvent&&OpenLayers.Event.stopObserving(window,"scroll",this.clearMouseListener));this.eventHandler=this.fallThrough=this.object=this.listeners=this.element=null},addEventType:function(){},attachToElement:function(a){this.element?
OpenLayers.Event.stopObservingElement(this.element):(this.eventHandler=OpenLayers.Function.bindAsEventListener(this.handleBrowserEvent,this),this.clearMouseListener=OpenLayers.Function.bind(this.clearMouseCache,this));this.element=a;for(var b=!!window.navigator.msMaxTouchPoints,c,d=0,e=this.BROWSER_EVENTS.length;d<e;d++)c=this.BROWSER_EVENTS[d],OpenLayers.Event.observe(a,c,this.eventHandler),b&&0===c.indexOf("touch")&&this.addMsTouchListener(a,c,this.eventHandler);OpenLayers.Event.observe(a,"dragstart",
OpenLayers.Event.stop)},on:function(a){for(var b in a)"scope"!=b&&a.hasOwnProperty(b)&&this.register(b,a.scope,a[b])},register:function(a,b,c,d){a in OpenLayers.Events&&!this.extensions[a]&&(this.extensions[a]=new OpenLayers.Events[a](this));if(null!=c){null==b&&(b=this.object);var e=this.listeners[a];e||(e=[],this.listeners[a]=e,this.extensionCount[a]=0);b={obj:b,func:c};d?(e.splice(this.extensionCount[a],0,b),"object"===typeof d&&d.extension&&this.extensionCount[a]++):e.push(b)}},registerPriority:function(a,
b,c){this.register(a,b,c,!0)},un:function(a){for(var b in a)"scope"!=b&&a.hasOwnProperty(b)&&this.unregister(b,a.scope,a[b])},unregister:function(a,b,c){null==b&&(b=this.object);a=this.listeners[a];if(null!=a)for(var d=0,e=a.length;d<e;d++)if(a[d].obj==b&&a[d].func==c){a.splice(d,1);break}},remove:function(a){null!=this.listeners[a]&&(this.listeners[a]=[])},triggerEvent:function(a,b){var c=this.listeners[a];if(c&&0!=c.length){null==b&&(b={});b.object=this.object;b.element=this.element;b.type||(b.type=
a);for(var c=c.slice(),d,e=0,f=c.length;e<f&&!(d=c[e],d=d.func.apply(d.obj,[b]),void 0!=d&&!1==d);e++);this.fallThrough||OpenLayers.Event.stop(b,!0);return d}},handleBrowserEvent:function(a){var b=a.type,c=this.listeners[b];if(c&&0!=c.length){if((c=a.touches)&&c[0]){for(var d=0,e=0,f=c.length,g,h=0;h<f;++h)g=this.getTouchClientXY(c[h]),d+=g.clientX,e+=g.clientY;a.clientX=d/f;a.clientY=e/f}this.includeXY&&(a.xy=this.getMousePosition(a));this.triggerEvent(b,a)}},getTouchClientXY:function(a){var b=window.olMockWin||
window,c=b.pageXOffset,b=b.pageYOffset,d=a.clientX,e=a.clientY;if(0===a.pageY&&Math.floor(e)>Math.floor(a.pageY)||0===a.pageX&&Math.floor(d)>Math.floor(a.pageX))d-=c,e-=b;else if(e<a.pageY-b||d<a.pageX-c)d=a.pageX-c,e=a.pageY-b;a.olClientX=d;a.olClientY=e;return{clientX:d,clientY:e}},clearMouseCache:function(){this.element.scrolls=null;this.element.lefttop=null;this.element.offsets=null},getMousePosition:function(a){this.includeXY?this.element.hasScrollEvent||(OpenLayers.Event.observe(window,"scroll",
this.clearMouseListener),this.element.hasScrollEvent=!0):this.clearMouseCache();if(!this.element.scrolls){var b=OpenLayers.Util.getViewportElement();this.element.scrolls=[window.pageXOffset||b.scrollLeft,window.pageYOffset||b.scrollTop]}this.element.lefttop||(this.element.lefttop=[document.documentElement.clientLeft||0,document.documentElement.clientTop||0]);this.element.offsets||(this.element.offsets=OpenLayers.Util.pagePosition(this.element));return new OpenLayers.Pixel(a.clientX+this.element.scrolls[0]-
this.element.offsets[0]-this.element.lefttop[0],a.clientY+this.element.scrolls[1]-this.element.offsets[1]-this.element.lefttop[1])},addMsTouchListener:function(a,b,c){function d(a){c(OpenLayers.Util.applyDefaults({stopPropagation:function(){for(var a=e.length-1;0<=a;--a)e[a].stopPropagation()},preventDefault:function(){for(var a=e.length-1;0<=a;--a)e[a].preventDefault()},type:b},a))}var e=this._msTouches;switch(b){case "touchstart":return this.addMsTouchListenerStart(a,b,d);case "touchend":return this.addMsTouchListenerEnd(a,
b,d);case "touchmove":return this.addMsTouchListenerMove(a,b,d);default:throw"Unknown touch event type";}},addMsTouchListenerStart:function(a,b,c){var d=this._msTouches;OpenLayers.Event.observe(a,"MSPointerDown",function(a){for(var b=!1,g=0,h=d.length;g<h;++g)if(d[g].pointerId==a.pointerId){b=!0;break}b||d.push(a);a.touches=d.slice();c(a)});OpenLayers.Event.observe(a,"MSPointerUp",function(a){for(var b=0,c=d.length;b<c;++b)if(d[b].pointerId==a.pointerId){d.splice(b,1);break}})},addMsTouchListenerMove:function(a,
b,c){var d=this._msTouches;OpenLayers.Event.observe(a,"MSPointerMove",function(a){if(!(a.pointerType==a.MSPOINTER_TYPE_MOUSE&&0==a.buttons)&&!(1==d.length&&d[0].pageX==a.pageX&&d[0].pageY==a.pageY)){for(var b=0,g=d.length;b<g;++b)if(d[b].pointerId==a.pointerId){d[b]=a;break}a.touches=d.slice();c(a)}})},addMsTouchListenerEnd:function(a,b,c){var d=this._msTouches;OpenLayers.Event.observe(a,"MSPointerUp",function(a){for(var b=0,g=d.length;b<g;++b)if(d[b].pointerId==a.pointerId){d.splice(b,1);break}a.touches=
d.slice();c(a)})},CLASS_NAME:"OpenLayers.Events"});OpenLayers.Animation=function(a){var b=OpenLayers.Util.vendorPrefix.js(a,"requestAnimationFrame"),c,d=a[b]||function(b){a.setTimeout(b,16)};c=function(b,c){d.apply(a,[b,c])};var e=0,f={};return{isNative:!!b,requestFrame:c,start:function(a,b,d){var b=0<b?b:Number.POSITIVE_INFINITY,n=++e,p=+new Date;f[n]=function(){f[n]&&+new Date-p<=b?(a(),f[n]&&c(f[n],d)):delete f[n]};c(f[n],d);return n},stop:function(a){delete f[a]}}}(window);
OpenLayers.Tween=OpenLayers.Class({easing:null,begin:null,finish:null,duration:null,callbacks:null,time:null,minFrameRate:null,startTime:null,animationId:null,playing:!1,initialize:function(a){this.easing=a?a:OpenLayers.Easing.Expo.easeOut},start:function(a,b,c,d){this.playing=!0;this.begin=a;this.finish=b;this.duration=c;this.callbacks=d.callbacks;this.minFrameRate=d.minFrameRate||30;this.time=0;this.startTime=(new Date).getTime();OpenLayers.Animation.stop(this.animationId);this.animationId=null;
this.callbacks&&this.callbacks.start&&this.callbacks.start.call(this,this.begin);this.animationId=OpenLayers.Animation.start(OpenLayers.Function.bind(this.play,this))},stop:function(){this.playing&&(this.callbacks&&this.callbacks.done&&this.callbacks.done.call(this,this.finish),OpenLayers.Animation.stop(this.animationId),this.animationId=null,this.playing=!1)},play:function(){var a={},b;for(b in this.begin){var c=this.begin[b],d=this.finish[b];if(null==c||null==d||isNaN(c)||isNaN(d))throw new TypeError("invalid value for Tween");
a[b]=this.easing.apply(this,[this.time,c,d-c,this.duration])}this.time++;this.callbacks&&this.callbacks.eachStep&&((new Date).getTime()-this.startTime)/this.time<=1E3/this.minFrameRate&&this.callbacks.eachStep.call(this,a);this.time>this.duration&&this.stop()},CLASS_NAME:"OpenLayers.Tween"});OpenLayers.Easing={CLASS_NAME:"OpenLayers.Easing"};OpenLayers.Easing.Linear={easeIn:function(a,b,c,d){return c*a/d+b},easeOut:function(a,b,c,d){return c*a/d+b},easeInOut:function(a,b,c,d){return c*a/d+b},CLASS_NAME:"OpenLayers.Easing.Linear"};
OpenLayers.Easing.Expo={easeIn:function(a,b,c,d){return 0==a?b:c*Math.pow(2,10*(a/d-1))+b},easeOut:function(a,b,c,d){return a==d?b+c:c*(-Math.pow(2,-10*a/d)+1)+b},easeInOut:function(a,b,c,d){return 0==a?b:a==d?b+c:1>(a/=d/2)?c/2*Math.pow(2,10*(a-1))+b:c/2*(-Math.pow(2,-10*--a)+2)+b},CLASS_NAME:"OpenLayers.Easing.Expo"};
OpenLayers.Easing.Quad={easeIn:function(a,b,c,d){return c*(a/=d)*a+b},easeOut:function(a,b,c,d){return-c*(a/=d)*(a-2)+b},easeInOut:function(a,b,c,d){return 1>(a/=d/2)?c/2*a*a+b:-c/2*(--a*(a-2)-1)+b},CLASS_NAME:"OpenLayers.Easing.Quad"};
OpenLayers.Projection=OpenLayers.Class({proj:null,projCode:null,titleRegEx:/\+title=[^\+]*/,initialize:function(a,b){OpenLayers.Util.extend(this,b);this.projCode=a;"object"==typeof Proj4js&&(this.proj=new Proj4js.Proj(a))},getCode:function(){return this.proj?this.proj.srsCode:this.projCode},getUnits:function(){return this.proj?this.proj.units:null},toString:function(){return this.getCode()},equals:function(a){var b=!1;a&&(a instanceof OpenLayers.Projection||(a=new OpenLayers.Projection(a)),"object"==
typeof Proj4js&&this.proj.defData&&a.proj.defData?b=this.proj.defData.replace(this.titleRegEx,"")==a.proj.defData.replace(this.titleRegEx,""):a.getCode&&(b=this.getCode(),a=a.getCode(),b=b==a||!!OpenLayers.Projection.transforms[b]&&OpenLayers.Projection.transforms[b][a]===OpenLayers.Projection.nullTransform));return b},destroy:function(){delete this.proj;delete this.projCode},CLASS_NAME:"OpenLayers.Projection"});OpenLayers.Projection.transforms={};
OpenLayers.Projection.defaults={"EPSG:4326":{units:"degrees",maxExtent:[-180,-90,180,90],yx:!0},"CRS:84":{units:"degrees",maxExtent:[-180,-90,180,90]},"EPSG:900913":{units:"m",maxExtent:[-2.003750834E7,-2.003750834E7,2.003750834E7,2.003750834E7]}};
OpenLayers.Projection.addTransform=function(a,b,c){if(c===OpenLayers.Projection.nullTransform){var d=OpenLayers.Projection.defaults[a];d&&!OpenLayers.Projection.defaults[b]&&(OpenLayers.Projection.defaults[b]=d)}OpenLayers.Projection.transforms[a]||(OpenLayers.Projection.transforms[a]={});OpenLayers.Projection.transforms[a][b]=c};
OpenLayers.Projection.transform=function(a,b,c){if(b&&c)if(b instanceof OpenLayers.Projection||(b=new OpenLayers.Projection(b)),c instanceof OpenLayers.Projection||(c=new OpenLayers.Projection(c)),b.proj&&c.proj)a=Proj4js.transform(b.proj,c.proj,a);else{var b=b.getCode(),c=c.getCode(),d=OpenLayers.Projection.transforms;if(d[b]&&d[b][c])d[b][c](a)}return a};OpenLayers.Projection.nullTransform=function(a){return a};
(function(){function a(a){a.x=180*a.x/d;a.y=180/Math.PI*(2*Math.atan(Math.exp(a.y/d*Math.PI))-Math.PI/2);return a}function b(a){a.x=a.x*d/180;var b=Math.log(Math.tan((90+a.y)*Math.PI/360))/Math.PI*d;a.y=Math.max(-2.003750834E7,Math.min(b,2.003750834E7));return a}function c(c,d){var e=OpenLayers.Projection.addTransform,f=OpenLayers.Projection.nullTransform,g,m,r,s,t;g=0;for(m=d.length;g<m;++g){r=d[g];e(c,r,b);e(r,c,a);for(t=g+1;t<m;++t)s=d[t],e(r,s,f),e(s,r,f)}}var d=2.003750834E7,e=["EPSG:900913",
"EPSG:3857","EPSG:102113","EPSG:102100"],f=["CRS:84","urn:ogc:def:crs:EPSG:6.6:4326","EPSG:4326"],g;for(g=e.length-1;0<=g;--g)c(e[g],f);for(g=f.length-1;0<=g;--g)c(f[g],e)})();
OpenLayers.Map=OpenLayers.Class({Z_INDEX_BASE:{BaseLayer:100,Overlay:325,Feature:725,Popup:750,Control:1E3},id:null,fractionalZoom:!1,events:null,allOverlays:!1,div:null,dragging:!1,size:null,viewPortDiv:null,layerContainerOrigin:null,layerContainerDiv:null,layers:null,controls:null,popups:null,baseLayer:null,center:null,resolution:null,zoom:0,panRatio:1.5,options:null,tileSize:null,projection:"EPSG:4326",units:null,resolutions:null,maxResolution:null,minResolution:null,maxScale:null,minScale:null,
maxExtent:null,minExtent:null,restrictedExtent:null,numZoomLevels:16,theme:null,displayProjection:null,fallThrough:!1,autoUpdateSize:!0,eventListeners:null,panTween:null,panMethod:OpenLayers.Easing.Expo.easeOut,panDuration:50,zoomTween:null,zoomMethod:OpenLayers.Easing.Quad.easeOut,zoomDuration:20,paddingForPopups:null,layerContainerOriginPx:null,minPx:null,maxPx:null,initialize:function(a,b){1===arguments.length&&"object"===typeof a&&(a=(b=a)&&b.div);this.tileSize=new OpenLayers.Size(OpenLayers.Map.TILE_WIDTH,
OpenLayers.Map.TILE_HEIGHT);this.paddingForPopups=new OpenLayers.Bounds(15,15,15,15);this.theme=OpenLayers._getScriptLocation()+"theme/default/style.css";this.options=OpenLayers.Util.extend({},b);OpenLayers.Util.extend(this,b);OpenLayers.Util.applyDefaults(this,OpenLayers.Projection.defaults[this.projection instanceof OpenLayers.Projection?this.projection.projCode:this.projection]);this.maxExtent&&!(this.maxExtent instanceof OpenLayers.Bounds)&&(this.maxExtent=new OpenLayers.Bounds(this.maxExtent));
this.minExtent&&!(this.minExtent instanceof OpenLayers.Bounds)&&(this.minExtent=new OpenLayers.Bounds(this.minExtent));this.restrictedExtent&&!(this.restrictedExtent instanceof OpenLayers.Bounds)&&(this.restrictedExtent=new OpenLayers.Bounds(this.restrictedExtent));this.center&&!(this.center instanceof OpenLayers.LonLat)&&(this.center=new OpenLayers.LonLat(this.center));this.layers=[];this.id=OpenLayers.Util.createUniqueID("OpenLayers.Map_");this.div=OpenLayers.Util.getElement(a);this.div||(this.div=
document.createElement("div"),this.div.style.height="1px",this.div.style.width="1px");OpenLayers.Element.addClass(this.div,"olMap");var c=this.id+"_OpenLayers_ViewPort";this.viewPortDiv=OpenLayers.Util.createDiv(c,null,null,null,"relative",null,"hidden");this.viewPortDiv.style.width="100%";this.viewPortDiv.style.height="100%";this.viewPortDiv.className="olMapViewport";this.div.appendChild(this.viewPortDiv);this.events=new OpenLayers.Events(this,this.viewPortDiv,null,this.fallThrough,{includeXY:!0});
OpenLayers.TileManager&&null!==this.tileManager&&(this.tileManager instanceof OpenLayers.TileManager||(this.tileManager=new OpenLayers.TileManager(this.tileManager)),this.tileManager.addMap(this));c=this.id+"_OpenLayers_Container";this.layerContainerDiv=OpenLayers.Util.createDiv(c);this.layerContainerDiv.style.zIndex=this.Z_INDEX_BASE.Popup-1;this.layerContainerOriginPx={x:0,y:0};this.applyTransform();this.viewPortDiv.appendChild(this.layerContainerDiv);this.updateSize();if(this.eventListeners instanceof
Object)this.events.on(this.eventListeners);!0===this.autoUpdateSize&&(this.updateSizeDestroy=OpenLayers.Function.bind(this.updateSize,this),OpenLayers.Event.observe(window,"resize",this.updateSizeDestroy));if(this.theme){for(var c=!0,d=document.getElementsByTagName("link"),e=0,f=d.length;e<f;++e)if(OpenLayers.Util.isEquivalentUrl(d.item(e).href,this.theme)){c=!1;break}c&&(c=document.createElement("link"),c.setAttribute("rel","stylesheet"),c.setAttribute("type","text/css"),c.setAttribute("href",this.theme),
document.getElementsByTagName("head")[0].appendChild(c))}null==this.controls&&(this.controls=[],null!=OpenLayers.Control&&(OpenLayers.Control.Navigation?this.controls.push(new OpenLayers.Control.Navigation):OpenLayers.Control.TouchNavigation&&this.controls.push(new OpenLayers.Control.TouchNavigation),OpenLayers.Control.Zoom?this.controls.push(new OpenLayers.Control.Zoom):OpenLayers.Control.PanZoom&&this.controls.push(new OpenLayers.Control.PanZoom),OpenLayers.Control.ArgParser&&this.controls.push(new OpenLayers.Control.ArgParser),
OpenLayers.Control.Attribution&&this.controls.push(new OpenLayers.Control.Attribution)));e=0;for(f=this.controls.length;e<f;e++)this.addControlToMap(this.controls[e]);this.popups=[];this.unloadDestroy=OpenLayers.Function.bind(this.destroy,this);OpenLayers.Event.observe(window,"unload",this.unloadDestroy);b&&b.layers&&(delete this.center,delete this.zoom,this.addLayers(b.layers),b.center&&!this.getCenter()&&this.setCenter(b.center,b.zoom));this.panMethod&&(this.panTween=new OpenLayers.Tween(this.panMethod));
this.zoomMethod&&this.applyTransform.transform&&(this.zoomTween=new OpenLayers.Tween(this.zoomMethod))},getViewport:function(){return this.viewPortDiv},render:function(a){this.div=OpenLayers.Util.getElement(a);OpenLayers.Element.addClass(this.div,"olMap");this.viewPortDiv.parentNode.removeChild(this.viewPortDiv);this.div.appendChild(this.viewPortDiv);this.updateSize()},unloadDestroy:null,updateSizeDestroy:null,destroy:function(){if(!this.unloadDestroy)return!1;this.panTween&&(this.panTween.stop(),
this.panTween=null);this.zoomTween&&(this.zoomTween.stop(),this.zoomTween=null);OpenLayers.Event.stopObserving(window,"unload",this.unloadDestroy);this.unloadDestroy=null;this.updateSizeDestroy&&OpenLayers.Event.stopObserving(window,"resize",this.updateSizeDestroy);this.paddingForPopups=null;if(null!=this.controls){for(var a=this.controls.length-1;0<=a;--a)this.controls[a].destroy();this.controls=null}if(null!=this.layers){for(a=this.layers.length-1;0<=a;--a)this.layers[a].destroy(!1);this.layers=
null}this.viewPortDiv&&this.viewPortDiv.parentNode&&this.viewPortDiv.parentNode.removeChild(this.viewPortDiv);this.viewPortDiv=null;this.tileManager&&(this.tileManager.removeMap(this),this.tileManager=null);this.eventListeners&&(this.events.un(this.eventListeners),this.eventListeners=null);this.events.destroy();this.options=this.events=null},setOptions:function(a){var b=this.minPx&&a.restrictedExtent!=this.restrictedExtent;OpenLayers.Util.extend(this,a);b&&this.moveTo(this.getCachedCenter(),this.zoom,
{forceZoomChange:!0})},getTileSize:function(){return this.tileSize},getBy:function(a,b,c){var d="function"==typeof c.test;return OpenLayers.Array.filter(this[a],function(a){return a[b]==c||d&&c.test(a[b])})},getLayersBy:function(a,b){return this.getBy("layers",a,b)},getLayersByName:function(a){return this.getLayersBy("name",a)},getLayersByClass:function(a){return this.getLayersBy("CLASS_NAME",a)},getControlsBy:function(a,b){return this.getBy("controls",a,b)},getControlsByClass:function(a){return this.getControlsBy("CLASS_NAME",
a)},getLayer:function(a){for(var b=null,c=0,d=this.layers.length;c<d;c++){var e=this.layers[c];if(e.id==a){b=e;break}}return b},setLayerZIndex:function(a,b){a.setZIndex(this.Z_INDEX_BASE[a.isBaseLayer?"BaseLayer":"Overlay"]+5*b)},resetLayersZIndex:function(){for(var a=0,b=this.layers.length;a<b;a++)this.setLayerZIndex(this.layers[a],a)},addLayer:function(a){for(var b=0,c=this.layers.length;b<c;b++)if(this.layers[b]==a)return!1;if(!1===this.events.triggerEvent("preaddlayer",{layer:a}))return!1;this.allOverlays&&
(a.isBaseLayer=!1);a.div.className="olLayerDiv";a.div.style.overflow="";this.setLayerZIndex(a,this.layers.length);a.isFixed?this.viewPortDiv.appendChild(a.div):this.layerContainerDiv.appendChild(a.div);this.layers.push(a);a.setMap(this);a.isBaseLayer||this.allOverlays&&!this.baseLayer?null==this.baseLayer?this.setBaseLayer(a):a.setVisibility(!1):a.redraw();this.events.triggerEvent("addlayer",{layer:a});a.events.triggerEvent("added",{map:this,layer:a});a.afterAdd();return!0},addLayers:function(a){for(var b=
0,c=a.length;b<c;b++)this.addLayer(a[b])},removeLayer:function(a,b){if(!1!==this.events.triggerEvent("preremovelayer",{layer:a})){null==b&&(b=!0);a.isFixed?this.viewPortDiv.removeChild(a.div):this.layerContainerDiv.removeChild(a.div);OpenLayers.Util.removeItem(this.layers,a);a.removeMap(this);a.map=null;if(this.baseLayer==a&&(this.baseLayer=null,b))for(var c=0,d=this.layers.length;c<d;c++){var e=this.layers[c];if(e.isBaseLayer||this.allOverlays){this.setBaseLayer(e);break}}this.resetLayersZIndex();
this.events.triggerEvent("removelayer",{layer:a});a.events.triggerEvent("removed",{map:this,layer:a})}},getNumLayers:function(){return this.layers.length},getLayerIndex:function(a){return OpenLayers.Util.indexOf(this.layers,a)},setLayerIndex:function(a,b){var c=this.getLayerIndex(a);0>b?b=0:b>this.layers.length&&(b=this.layers.length);if(c!=b){this.layers.splice(c,1);this.layers.splice(b,0,a);for(var c=0,d=this.layers.length;c<d;c++)this.setLayerZIndex(this.layers[c],c);this.events.triggerEvent("changelayer",
{layer:a,property:"order"});this.allOverlays&&(0===b?this.setBaseLayer(a):this.baseLayer!==this.layers[0]&&this.setBaseLayer(this.layers[0]))}},raiseLayer:function(a,b){var c=this.getLayerIndex(a)+b;this.setLayerIndex(a,c)},setBaseLayer:function(a){if(a!=this.baseLayer&&-1!=OpenLayers.Util.indexOf(this.layers,a)){var b=this.getCachedCenter(),c=OpenLayers.Util.getResolutionFromScale(this.getScale(),a.units);null!=this.baseLayer&&!this.allOverlays&&this.baseLayer.setVisibility(!1);this.baseLayer=a;
if(!this.allOverlays||this.baseLayer.visibility)this.baseLayer.setVisibility(!0),!1===this.baseLayer.inRange&&this.baseLayer.redraw();null!=b&&(a=this.getZoomForResolution(c||this.resolution,!0),this.setCenter(b,a,!1,!0));this.events.triggerEvent("changebaselayer",{layer:this.baseLayer})}},addControl:function(a,b){this.controls.push(a);this.addControlToMap(a,b)},addControls:function(a,b){for(var c=1===arguments.length?[]:b,d=0,e=a.length;d<e;d++)this.addControl(a[d],c[d]?c[d]:null)},addControlToMap:function(a,
b){a.outsideViewport=null!=a.div;this.displayProjection&&!a.displayProjection&&(a.displayProjection=this.displayProjection);a.setMap(this);var c=a.draw(b);c&&!a.outsideViewport&&(c.style.zIndex=this.Z_INDEX_BASE.Control+this.controls.length,this.viewPortDiv.appendChild(c));a.autoActivate&&a.activate()},getControl:function(a){for(var b=null,c=0,d=this.controls.length;c<d;c++){var e=this.controls[c];if(e.id==a){b=e;break}}return b},removeControl:function(a){a&&a==this.getControl(a.id)&&(a.div&&a.div.parentNode==
this.viewPortDiv&&this.viewPortDiv.removeChild(a.div),OpenLayers.Util.removeItem(this.controls,a))},addPopup:function(a,b){if(b)for(var c=this.popups.length-1;0<=c;--c)this.removePopup(this.popups[c]);a.map=this;this.popups.push(a);if(c=a.draw())c.style.zIndex=this.Z_INDEX_BASE.Popup+this.popups.length,this.layerContainerDiv.appendChild(c)},removePopup:function(a){OpenLayers.Util.removeItem(this.popups,a);if(a.div)try{this.layerContainerDiv.removeChild(a.div)}catch(b){}a.map=null},getSize:function(){var a=
null;null!=this.size&&(a=this.size.clone());return a},updateSize:function(){var a=this.getCurrentSize();if(a&&!isNaN(a.h)&&!isNaN(a.w)){this.events.clearMouseCache();var b=this.getSize();null==b&&(this.size=b=a);if(!a.equals(b)){this.size=a;a=0;for(b=this.layers.length;a<b;a++)this.layers[a].onMapResize();a=this.getCachedCenter();null!=this.baseLayer&&null!=a&&(b=this.getZoom(),this.zoom=null,this.setCenter(a,b))}}this.events.triggerEvent("updatesize")},getCurrentSize:function(){var a=new OpenLayers.Size(this.div.clientWidth,
this.div.clientHeight);if(0==a.w&&0==a.h||isNaN(a.w)&&isNaN(a.h))a.w=this.div.offsetWidth,a.h=this.div.offsetHeight;if(0==a.w&&0==a.h||isNaN(a.w)&&isNaN(a.h))a.w=parseInt(this.div.style.width),a.h=parseInt(this.div.style.height);return a},calculateBounds:function(a,b){var c=null;null==a&&(a=this.getCachedCenter());null==b&&(b=this.getResolution());if(null!=a&&null!=b)var c=this.size.w*b/2,d=this.size.h*b/2,c=new OpenLayers.Bounds(a.lon-c,a.lat-d,a.lon+c,a.lat+d);return c},getCenter:function(){var a=
null,b=this.getCachedCenter();b&&(a=b.clone());return a},getCachedCenter:function(){!this.center&&this.size&&(this.center=this.getLonLatFromViewPortPx({x:this.size.w/2,y:this.size.h/2}));return this.center},getZoom:function(){return this.zoom},pan:function(a,b,c){c=OpenLayers.Util.applyDefaults(c,{animate:!0,dragging:!1});if(c.dragging)(0!=a||0!=b)&&this.moveByPx(a,b);else{var d=this.getViewPortPxFromLonLat(this.getCachedCenter()),a=d.add(a,b);if(this.dragging||!a.equals(d))d=this.getLonLatFromViewPortPx(a),
c.animate?this.panTo(d):(this.moveTo(d),this.dragging&&(this.dragging=!1,this.events.triggerEvent("moveend")))}},panTo:function(a){if(this.panTween&&this.getExtent().scale(this.panRatio).containsLonLat(a)){var b=this.getCachedCenter();if(!a.equals(b)){var b=this.getPixelFromLonLat(b),c=this.getPixelFromLonLat(a),d=0,e=0;this.panTween.start({x:0,y:0},{x:c.x-b.x,y:c.y-b.y},this.panDuration,{callbacks:{eachStep:OpenLayers.Function.bind(function(a){this.moveByPx(a.x-d,a.y-e);d=Math.round(a.x);e=Math.round(a.y)},
this),done:OpenLayers.Function.bind(function(){this.moveTo(a);this.dragging=!1;this.events.triggerEvent("moveend")},this)}})}}else this.setCenter(a)},setCenter:function(a,b,c,d){this.panTween&&this.panTween.stop();this.zoomTween&&this.zoomTween.stop();this.moveTo(a,b,{dragging:c,forceZoomChange:d})},moveByPx:function(a,b){var c=this.size.w/2,d=this.size.h/2,e=c+a,f=d+b,g=this.baseLayer.wrapDateLine,h=0,j=0;this.restrictedExtent&&(h=c,j=d,g=!1);a=g||e<=this.maxPx.x-h&&e>=this.minPx.x+h?Math.round(a):
0;b=f<=this.maxPx.y-j&&f>=this.minPx.y+j?Math.round(b):0;if(a||b){this.dragging||(this.dragging=!0,this.events.triggerEvent("movestart"));this.center=null;a&&(this.layerContainerOriginPx.x-=a,this.minPx.x-=a,this.maxPx.x-=a);b&&(this.layerContainerOriginPx.y-=b,this.minPx.y-=b,this.maxPx.y-=b);this.applyTransform();d=0;for(e=this.layers.length;d<e;++d)if(c=this.layers[d],c.visibility&&(c===this.baseLayer||c.inRange))c.moveByPx(a,b),c.events.triggerEvent("move");this.events.triggerEvent("move")}},
adjustZoom:function(a){if(this.baseLayer&&this.baseLayer.wrapDateLine){var b=this.baseLayer.resolutions,c=this.getMaxExtent().getWidth()/this.size.w;if(this.getResolutionForZoom(a)>c)if(this.fractionalZoom)a=this.getZoomForResolution(c);else for(var d=a|0,e=b.length;d<e;++d)if(b[d]<=c){a=d;break}}return a},getMinZoom:function(){return this.adjustZoom(0)},moveTo:function(a,b,c){null!=a&&!(a instanceof OpenLayers.LonLat)&&(a=new OpenLayers.LonLat(a));c||(c={});null!=b&&(b=parseFloat(b),this.fractionalZoom||
(b=Math.round(b)));var d=b,b=this.adjustZoom(b);b!==d&&(a=this.getCenter());var d=c.dragging||this.dragging,e=c.forceZoomChange;!this.getCachedCenter()&&!this.isValidLonLat(a)&&(a=this.maxExtent.getCenterLonLat(),this.center=a.clone());if(null!=this.restrictedExtent){null==a&&(a=this.center);null==b&&(b=this.getZoom());var f=this.getResolutionForZoom(b),f=this.calculateBounds(a,f);if(!this.restrictedExtent.containsBounds(f)){var g=this.restrictedExtent.getCenterLonLat();f.getWidth()>this.restrictedExtent.getWidth()?
a=new OpenLayers.LonLat(g.lon,a.lat):f.left<this.restrictedExtent.left?a=a.add(this.restrictedExtent.left-f.left,0):f.right>this.restrictedExtent.right&&(a=a.add(this.restrictedExtent.right-f.right,0));f.getHeight()>this.restrictedExtent.getHeight()?a=new OpenLayers.LonLat(a.lon,g.lat):f.bottom<this.restrictedExtent.bottom?a=a.add(0,this.restrictedExtent.bottom-f.bottom):f.top>this.restrictedExtent.top&&(a=a.add(0,this.restrictedExtent.top-f.top))}}e=e||this.isValidZoomLevel(b)&&b!=this.getZoom();
f=this.isValidLonLat(a)&&!a.equals(this.center);if(e||f||d){d||this.events.triggerEvent("movestart",{zoomChanged:e});f&&(!e&&this.center&&this.centerLayerContainer(a),this.center=a.clone());a=e?this.getResolutionForZoom(b):this.getResolution();if(e||null==this.layerContainerOrigin){this.layerContainerOrigin=this.getCachedCenter();this.layerContainerOriginPx.x=0;this.layerContainerOriginPx.y=0;this.applyTransform();var f=this.getMaxExtent({restricted:!0}),h=f.getCenterLonLat(),g=this.center.lon-h.lon,
h=h.lat-this.center.lat,j=Math.round(f.getWidth()/a),n=Math.round(f.getHeight()/a);this.minPx={x:(this.size.w-j)/2-g/a,y:(this.size.h-n)/2-h/a};this.maxPx={x:this.minPx.x+Math.round(f.getWidth()/a),y:this.minPx.y+Math.round(f.getHeight()/a)}}e&&(this.zoom=b,this.resolution=a);a=this.getExtent();this.baseLayer.visibility&&(this.baseLayer.moveTo(a,e,c.dragging),c.dragging||this.baseLayer.events.triggerEvent("moveend",{zoomChanged:e}));a=this.baseLayer.getExtent();for(b=this.layers.length-1;0<=b;--b)f=
this.layers[b],f!==this.baseLayer&&!f.isBaseLayer&&(g=f.calculateInRange(),f.inRange!=g&&((f.inRange=g)||f.display(!1),this.events.triggerEvent("changelayer",{layer:f,property:"visibility"})),g&&f.visibility&&(f.moveTo(a,e,c.dragging),c.dragging||f.events.triggerEvent("moveend",{zoomChanged:e})));this.events.triggerEvent("move");d||this.events.triggerEvent("moveend");if(e){b=0;for(c=this.popups.length;b<c;b++)this.popups[b].updatePosition();this.events.triggerEvent("zoomend")}}},centerLayerContainer:function(a){var b=
this.getViewPortPxFromLonLat(this.layerContainerOrigin),c=this.getViewPortPxFromLonLat(a);if(null!=b&&null!=c){var d=this.layerContainerOriginPx.x,a=this.layerContainerOriginPx.y,e=Math.round(b.x-c.x),b=Math.round(b.y-c.y);this.applyTransform(this.layerContainerOriginPx.x=e,this.layerContainerOriginPx.y=b);d-=e;a-=b;this.minPx.x-=d;this.maxPx.x-=d;this.minPx.y-=a;this.maxPx.y-=a}},isValidZoomLevel:function(a){return null!=a&&0<=a&&a<this.getNumZoomLevels()},isValidLonLat:function(a){var b=!1;null!=
a&&(b=this.getMaxExtent(),b=b.containsLonLat(a,{worldBounds:this.baseLayer.wrapDateLine&&b}));return b},getProjection:function(){var a=this.getProjectionObject();return a?a.getCode():null},getProjectionObject:function(){var a=null;null!=this.baseLayer&&(a=this.baseLayer.projection);return a},getMaxResolution:function(){var a=null;null!=this.baseLayer&&(a=this.baseLayer.maxResolution);return a},getMaxExtent:function(a){var b=null;a&&a.restricted&&this.restrictedExtent?b=this.restrictedExtent:null!=
this.baseLayer&&(b=this.baseLayer.maxExtent);return b},getNumZoomLevels:function(){var a=null;null!=this.baseLayer&&(a=this.baseLayer.numZoomLevels);return a},getExtent:function(){var a=null;null!=this.baseLayer&&(a=this.baseLayer.getExtent());return a},getResolution:function(){var a=null;null!=this.baseLayer?a=this.baseLayer.getResolution():!0===this.allOverlays&&0<this.layers.length&&(a=this.layers[0].getResolution());return a},getUnits:function(){var a=null;null!=this.baseLayer&&(a=this.baseLayer.units);
return a},getScale:function(){var a=null;null!=this.baseLayer&&(a=this.getResolution(),a=OpenLayers.Util.getScaleFromResolution(a,this.baseLayer.units));return a},getZoomForExtent:function(a,b){var c=null;null!=this.baseLayer&&(c=this.baseLayer.getZoomForExtent(a,b));return c},getResolutionForZoom:function(a){var b=null;this.baseLayer&&(b=this.baseLayer.getResolutionForZoom(a));return b},getZoomForResolution:function(a,b){var c=null;null!=this.baseLayer&&(c=this.baseLayer.getZoomForResolution(a,b));
return c},zoomTo:function(a,b){var c=this;if(c.isValidZoomLevel(a))if(c.baseLayer.wrapDateLine&&(a=c.adjustZoom(a)),c.zoomTween){var d=c.getResolution(),e=c.getResolutionForZoom(a),f={scale:1},d={scale:d/e};c.zoomTween.playing&&c.zoomTween.duration<3*c.zoomDuration?c.zoomTween.finish={scale:c.zoomTween.finish.scale*d.scale}:(b||(e=c.getSize(),b={x:e.w/2,y:e.h/2}),c.zoomTween.start(f,d,c.zoomDuration,{minFrameRate:50,callbacks:{eachStep:function(a){var d=c.layerContainerOriginPx,a=a.scale;c.applyTransform(d.x+
((a-1)*(d.x-b.x)|0),d.y+((a-1)*(d.y-b.y)|0),a)},done:function(a){c.applyTransform();var a=c.getResolution()/a.scale,d=c.getZoomForResolution(a,!0);c.moveTo(c.getZoomTargetCenter(b,a),d,!0)}}}))}else f=b?c.getZoomTargetCenter(b,c.getResolutionForZoom(a)):null,c.setCenter(f,a)},zoomIn:function(){this.zoomTo(this.getZoom()+1)},zoomOut:function(){this.zoomTo(this.getZoom()-1)},zoomToExtent:function(a,b){a instanceof OpenLayers.Bounds||(a=new OpenLayers.Bounds(a));var c=a.getCenterLonLat();if(this.baseLayer.wrapDateLine){c=
this.getMaxExtent();for(a=a.clone();a.right<a.left;)a.right+=c.getWidth();c=a.getCenterLonLat().wrapDateLine(c)}this.setCenter(c,this.getZoomForExtent(a,b))},zoomToMaxExtent:function(a){a=this.getMaxExtent({restricted:a?a.restricted:!0});this.zoomToExtent(a)},zoomToScale:function(a,b){var c=OpenLayers.Util.getResolutionFromScale(a,this.baseLayer.units),d=this.size.w*c/2,c=this.size.h*c/2,e=this.getCachedCenter(),d=new OpenLayers.Bounds(e.lon-d,e.lat-c,e.lon+d,e.lat+c);this.zoomToExtent(d,b)},getLonLatFromViewPortPx:function(a){var b=
null;null!=this.baseLayer&&(b=this.baseLayer.getLonLatFromViewPortPx(a));return b},getViewPortPxFromLonLat:function(a){var b=null;null!=this.baseLayer&&(b=this.baseLayer.getViewPortPxFromLonLat(a));return b},getZoomTargetCenter:function(a,b){var c=null,d=this.getSize(),e=d.w/2-a.x,d=a.y-d.h/2,f=this.getLonLatFromPixel(a);f&&(c=new OpenLayers.LonLat(f.lon+e*b,f.lat+d*b));return c},getLonLatFromPixel:function(a){return this.getLonLatFromViewPortPx(a)},getPixelFromLonLat:function(a){a=this.getViewPortPxFromLonLat(a);
a.x=Math.round(a.x);a.y=Math.round(a.y);return a},getGeodesicPixelSize:function(a){var b=a?this.getLonLatFromPixel(a):this.getCachedCenter()||new OpenLayers.LonLat(0,0),c=this.getResolution(),a=b.add(-c/2,0),d=b.add(c/2,0),e=b.add(0,-c/2),b=b.add(0,c/2),c=new OpenLayers.Projection("EPSG:4326"),f=this.getProjectionObject()||c;f.equals(c)||(a.transform(f,c),d.transform(f,c),e.transform(f,c),b.transform(f,c));return new OpenLayers.Size(OpenLayers.Util.distVincenty(a,d),OpenLayers.Util.distVincenty(e,
b))},getViewPortPxFromLayerPx:function(a){var b=null;null!=a&&(b=a.add(this.layerContainerOriginPx.x,this.layerContainerOriginPx.y));return b},getLayerPxFromViewPortPx:function(a){var b=null;if(null!=a&&(b=a.add(-this.layerContainerOriginPx.x,-this.layerContainerOriginPx.y),isNaN(b.x)||isNaN(b.y)))b=null;return b},getLonLatFromLayerPx:function(a){a=this.getViewPortPxFromLayerPx(a);return this.getLonLatFromViewPortPx(a)},getLayerPxFromLonLat:function(a){a=this.getPixelFromLonLat(a);return this.getLayerPxFromViewPortPx(a)},
applyTransform:function(a,b,c){var c=c||1,d=this.layerContainerOriginPx,e=1!==c,a=a||d.x,b=b||d.y,f=this.layerContainerDiv.style,g=this.applyTransform.transform,h=this.applyTransform.template;if(void 0===g&&(g=OpenLayers.Util.vendorPrefix.style("transform"),this.applyTransform.transform=g)){var j=OpenLayers.Element.getStyle(this.viewPortDiv,OpenLayers.Util.vendorPrefix.css("transform"));if(!j||"none"!==j)h=["translate3d(",",0) ","scale3d(",",1)"],f[g]=[h[0],"0,0",h[1]].join("");if(!h||!~f[g].indexOf(h[0]))h=
["translate(",") ","scale(",")"];this.applyTransform.template=h}null!==g&&("translate3d("===h[0]||!0===e)?(!0===e&&"translate("===h[0]&&(a-=d.x,b-=d.y,f.left=d.x+"px",f.top=d.y+"px"),f[g]=[h[0],a,"px,",b,"px",h[1],h[2],c,",",c,h[3]].join("")):(f.left=a+"px",f.top=b+"px",null!==g&&(f[g]=""))},CLASS_NAME:"OpenLayers.Map"});OpenLayers.Map.TILE_WIDTH=256;OpenLayers.Map.TILE_HEIGHT=256;
OpenLayers.Layer=OpenLayers.Class({id:null,name:null,div:null,opacity:1,alwaysInRange:null,RESOLUTION_PROPERTIES:"scales resolutions maxScale minScale maxResolution minResolution numZoomLevels maxZoomLevel".split(" "),events:null,map:null,isBaseLayer:!1,alpha:!1,displayInLayerSwitcher:!0,visibility:!0,attribution:null,inRange:!1,imageSize:null,options:null,eventListeners:null,gutter:0,projection:null,units:null,scales:null,resolutions:null,maxExtent:null,minExtent:null,maxResolution:null,minResolution:null,
numZoomLevels:null,minScale:null,maxScale:null,displayOutsideMaxExtent:!1,wrapDateLine:!1,metadata:null,initialize:function(a,b){this.metadata={};b=OpenLayers.Util.extend({},b);null!=this.alwaysInRange&&(b.alwaysInRange=this.alwaysInRange);this.addOptions(b);this.name=a;if(null==this.id&&(this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_"),this.div=OpenLayers.Util.createDiv(this.id),this.div.style.width="100%",this.div.style.height="100%",this.div.dir="ltr",this.events=new OpenLayers.Events(this,
this.div),this.eventListeners instanceof Object))this.events.on(this.eventListeners)},destroy:function(a){null==a&&(a=!0);null!=this.map&&this.map.removeLayer(this,a);this.options=this.div=this.name=this.map=this.projection=null;this.events&&(this.eventListeners&&this.events.un(this.eventListeners),this.events.destroy());this.events=this.eventListeners=null},clone:function(a){null==a&&(a=new OpenLayers.Layer(this.name,this.getOptions()));OpenLayers.Util.applyDefaults(a,this);a.map=null;return a},
getOptions:function(){var a={},b;for(b in this.options)a[b]=this[b];return a},setName:function(a){a!=this.name&&(this.name=a,null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"name"}))},addOptions:function(a,b){null==this.options&&(this.options={});a&&("string"==typeof a.projection&&(a.projection=new OpenLayers.Projection(a.projection)),a.projection&&OpenLayers.Util.applyDefaults(a,OpenLayers.Projection.defaults[a.projection.getCode()]),a.maxExtent&&!(a.maxExtent instanceof
OpenLayers.Bounds)&&(a.maxExtent=new OpenLayers.Bounds(a.maxExtent)),a.minExtent&&!(a.minExtent instanceof OpenLayers.Bounds)&&(a.minExtent=new OpenLayers.Bounds(a.minExtent)));OpenLayers.Util.extend(this.options,a);OpenLayers.Util.extend(this,a);this.projection&&this.projection.getUnits()&&(this.units=this.projection.getUnits());if(this.map){var c=this.map.getResolution(),d=this.RESOLUTION_PROPERTIES.concat(["projection","units","minExtent","maxExtent"]),e;for(e in a)if(a.hasOwnProperty(e)&&0<=OpenLayers.Util.indexOf(d,
e)){this.initResolutions();b&&this.map.baseLayer===this&&(this.map.setCenter(this.map.getCenter(),this.map.getZoomForResolution(c),!1,!0),this.map.events.triggerEvent("changebaselayer",{layer:this}));break}}},onMapResize:function(){},redraw:function(){var a=!1;if(this.map){this.inRange=this.calculateInRange();var b=this.getExtent();b&&(this.inRange&&this.visibility)&&(this.moveTo(b,!0,!1),this.events.triggerEvent("moveend",{zoomChanged:!0}),a=!0)}return a},moveTo:function(){var a=this.visibility;
this.isBaseLayer||(a=a&&this.inRange);this.display(a)},moveByPx:function(){},setMap:function(a){null==this.map&&(this.map=a,this.maxExtent=this.maxExtent||this.map.maxExtent,this.minExtent=this.minExtent||this.map.minExtent,this.projection=this.projection||this.map.projection,"string"==typeof this.projection&&(this.projection=new OpenLayers.Projection(this.projection)),this.units=this.projection.getUnits()||this.units||this.map.units,this.initResolutions(),this.isBaseLayer||(this.inRange=this.calculateInRange(),
this.div.style.display=this.visibility&&this.inRange?"":"none"),this.setTileSize())},afterAdd:function(){},removeMap:function(){},getImageSize:function(){return this.imageSize||this.tileSize},setTileSize:function(a){this.tileSize=a=a?a:this.tileSize?this.tileSize:this.map.getTileSize();this.gutter&&(this.imageSize=new OpenLayers.Size(a.w+2*this.gutter,a.h+2*this.gutter))},getVisibility:function(){return this.visibility},setVisibility:function(a){a!=this.visibility&&(this.visibility=a,this.display(a),
this.redraw(),null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"visibility"}),this.events.triggerEvent("visibilitychanged"))},display:function(a){a!=("none"!=this.div.style.display)&&(this.div.style.display=a&&this.calculateInRange()?"block":"none")},calculateInRange:function(){var a=!1;this.alwaysInRange?a=!0:this.map&&(a=this.map.getResolution(),a=a>=this.minResolution&&a<=this.maxResolution);return a},setIsBaseLayer:function(a){a!=this.isBaseLayer&&(this.isBaseLayer=
a,null!=this.map&&this.map.events.triggerEvent("changebaselayer",{layer:this}))},initResolutions:function(){var a,b,c,d={},e=!0;a=0;for(b=this.RESOLUTION_PROPERTIES.length;a<b;a++)c=this.RESOLUTION_PROPERTIES[a],d[c]=this.options[c],e&&this.options[c]&&(e=!1);null==this.options.alwaysInRange&&(this.alwaysInRange=e);null==d.resolutions&&(d.resolutions=this.resolutionsFromScales(d.scales));null==d.resolutions&&(d.resolutions=this.calculateResolutions(d));if(null==d.resolutions){a=0;for(b=this.RESOLUTION_PROPERTIES.length;a<
b;a++)c=this.RESOLUTION_PROPERTIES[a],d[c]=null!=this.options[c]?this.options[c]:this.map[c];null==d.resolutions&&(d.resolutions=this.resolutionsFromScales(d.scales));null==d.resolutions&&(d.resolutions=this.calculateResolutions(d))}var f;this.options.maxResolution&&"auto"!==this.options.maxResolution&&(f=this.options.maxResolution);this.options.minScale&&(f=OpenLayers.Util.getResolutionFromScale(this.options.minScale,this.units));var g;this.options.minResolution&&"auto"!==this.options.minResolution&&
(g=this.options.minResolution);this.options.maxScale&&(g=OpenLayers.Util.getResolutionFromScale(this.options.maxScale,this.units));d.resolutions&&(d.resolutions.sort(function(a,b){return b-a}),f||(f=d.resolutions[0]),g||(g=d.resolutions[d.resolutions.length-1]));if(this.resolutions=d.resolutions){b=this.resolutions.length;this.scales=Array(b);for(a=0;a<b;a++)this.scales[a]=OpenLayers.Util.getScaleFromResolution(this.resolutions[a],this.units);this.numZoomLevels=b}if(this.minResolution=g)this.maxScale=
OpenLayers.Util.getScaleFromResolution(g,this.units);if(this.maxResolution=f)this.minScale=OpenLayers.Util.getScaleFromResolution(f,this.units)},resolutionsFromScales:function(a){if(null!=a){var b,c,d;d=a.length;b=Array(d);for(c=0;c<d;c++)b[c]=OpenLayers.Util.getResolutionFromScale(a[c],this.units);return b}},calculateResolutions:function(a){var b,c,d=a.maxResolution;null!=a.minScale?d=OpenLayers.Util.getResolutionFromScale(a.minScale,this.units):"auto"==d&&null!=this.maxExtent&&(b=this.map.getSize(),
c=this.maxExtent.getWidth()/b.w,b=this.maxExtent.getHeight()/b.h,d=Math.max(c,b));c=a.minResolution;null!=a.maxScale?c=OpenLayers.Util.getResolutionFromScale(a.maxScale,this.units):"auto"==a.minResolution&&null!=this.minExtent&&(b=this.map.getSize(),c=this.minExtent.getWidth()/b.w,b=this.minExtent.getHeight()/b.h,c=Math.max(c,b));"number"!==typeof d&&("number"!==typeof c&&null!=this.maxExtent)&&(d=this.map.getTileSize(),d=Math.max(this.maxExtent.getWidth()/d.w,this.maxExtent.getHeight()/d.h));b=a.maxZoomLevel;
a=a.numZoomLevels;"number"===typeof c&&"number"===typeof d&&void 0===a?a=Math.floor(Math.log(d/c)/Math.log(2))+1:void 0===a&&null!=b&&(a=b+1);if(!("number"!==typeof a||0>=a||"number"!==typeof d&&"number"!==typeof c)){b=Array(a);var e=2;"number"==typeof c&&"number"==typeof d&&(e=Math.pow(d/c,1/(a-1)));var f;if("number"===typeof d)for(f=0;f<a;f++)b[f]=d/Math.pow(e,f);else for(f=0;f<a;f++)b[a-1-f]=c*Math.pow(e,f);return b}},getResolution:function(){var a=this.map.getZoom();return this.getResolutionForZoom(a)},
getExtent:function(){return this.map.calculateBounds()},getZoomForExtent:function(a,b){var c=this.map.getSize(),c=Math.max(a.getWidth()/c.w,a.getHeight()/c.h);return this.getZoomForResolution(c,b)},getDataExtent:function(){},getResolutionForZoom:function(a){a=Math.max(0,Math.min(a,this.resolutions.length-1));if(this.map.fractionalZoom)var b=Math.floor(a),c=Math.ceil(a),a=this.resolutions[b]-(a-b)*(this.resolutions[b]-this.resolutions[c]);else a=this.resolutions[Math.round(a)];return a},getZoomForResolution:function(a,
b){var c,d;if(this.map.fractionalZoom){var e=0,f=this.resolutions[e],g=this.resolutions[this.resolutions.length-1],h;c=0;for(d=this.resolutions.length;c<d;++c)if(h=this.resolutions[c],h>=a&&(f=h,e=c),h<=a){g=h;break}c=f-g;c=0<c?e+(f-a)/c:e}else{f=Number.POSITIVE_INFINITY;c=0;for(d=this.resolutions.length;c<d;c++)if(b){e=Math.abs(this.resolutions[c]-a);if(e>f)break;f=e}else if(this.resolutions[c]<a)break;c=Math.max(0,c-1)}return c},getLonLatFromViewPortPx:function(a){var b=null,c=this.map;if(null!=
a&&c.minPx){var b=c.getResolution(),d=c.getMaxExtent({restricted:!0}),b=new OpenLayers.LonLat((a.x-c.minPx.x)*b+d.left,(c.minPx.y-a.y)*b+d.top);this.wrapDateLine&&(b=b.wrapDateLine(this.maxExtent))}return b},getViewPortPxFromLonLat:function(a,b){var c=null;null!=a&&(b=b||this.map.getResolution(),c=this.map.calculateBounds(null,b),c=new OpenLayers.Pixel(1/b*(a.lon-c.left),1/b*(c.top-a.lat)));return c},setOpacity:function(a){if(a!=this.opacity){this.opacity=a;for(var b=this.div.childNodes,c=0,d=b.length;c<
d;++c){var e=b[c].firstChild||b[c],f=b[c].lastChild;f&&"iframe"===f.nodeName.toLowerCase()&&(e=f.parentNode);OpenLayers.Util.modifyDOMElement(e,null,null,null,null,null,null,a)}null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"opacity"})}},getZIndex:function(){return this.div.style.zIndex},setZIndex:function(a){this.div.style.zIndex=a},adjustBounds:function(a){if(this.gutter)var b=this.gutter*this.map.getResolution(),a=new OpenLayers.Bounds(a.left-b,a.bottom-b,a.right+
b,a.top+b);this.wrapDateLine&&(b={rightTolerance:this.getResolution(),leftTolerance:this.getResolution()},a=a.wrapDateLine(this.maxExtent,b));return a},CLASS_NAME:"OpenLayers.Layer"});
OpenLayers.Layer.HTTPRequest=OpenLayers.Class(OpenLayers.Layer,{URL_HASH_FACTOR:(Math.sqrt(5)-1)/2,url:null,params:null,reproject:!1,initialize:function(a,b,c,d){OpenLayers.Layer.prototype.initialize.apply(this,[a,d]);this.url=b;this.params||(this.params=OpenLayers.Util.extend({},c))},destroy:function(){this.params=this.url=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(a){null==a&&(a=new OpenLayers.Layer.HTTPRequest(this.name,this.url,this.params,this.getOptions()));
return a=OpenLayers.Layer.prototype.clone.apply(this,[a])},setUrl:function(a){this.url=a},mergeNewParams:function(a){this.params=OpenLayers.Util.extend(this.params,a);a=this.redraw();null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"params"});return a},redraw:function(a){return a?this.mergeNewParams({_olSalt:Math.random()}):OpenLayers.Layer.prototype.redraw.apply(this,[])},selectUrl:function(a,b){for(var c=1,d=0,e=a.length;d<e;d++)c*=a.charCodeAt(d)*this.URL_HASH_FACTOR,
c-=Math.floor(c);return b[Math.floor(c*b.length)]},getFullRequestString:function(a,b){var c=b||this.url,d=OpenLayers.Util.extend({},this.params),d=OpenLayers.Util.extend(d,a),e=OpenLayers.Util.getParameterString(d);OpenLayers.Util.isArray(c)&&(c=this.selectUrl(e,c));var e=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(c)),f;for(f in d)f.toUpperCase()in e&&delete d[f];e=OpenLayers.Util.getParameterString(d);return OpenLayers.Util.urlAppend(c,e)},CLASS_NAME:"OpenLayers.Layer.HTTPRequest"});
OpenLayers.Tile=OpenLayers.Class({events:null,eventListeners:null,id:null,layer:null,url:null,bounds:null,size:null,position:null,isLoading:!1,initialize:function(a,b,c,d,e,f){this.layer=a;this.position=b.clone();this.setBounds(c);this.url=d;e&&(this.size=e.clone());this.id=OpenLayers.Util.createUniqueID("Tile_");OpenLayers.Util.extend(this,f);this.events=new OpenLayers.Events(this);if(this.eventListeners instanceof Object)this.events.on(this.eventListeners)},unload:function(){this.isLoading&&(this.isLoading=
!1,this.events.triggerEvent("unload"))},destroy:function(){this.position=this.size=this.bounds=this.layer=null;this.eventListeners&&this.events.un(this.eventListeners);this.events.destroy();this.events=this.eventListeners=null},draw:function(a){a||this.clear();var b=this.shouldDraw();b&&(!a&&!1===this.events.triggerEvent("beforedraw"))&&(b=null);return b},shouldDraw:function(){var a=!1,b=this.layer.maxExtent;if(b){var c=this.layer.map,c=c.baseLayer.wrapDateLine&&c.getMaxExtent();this.bounds.intersectsBounds(b,
{inclusive:!1,worldBounds:c})&&(a=!0)}return a||this.layer.displayOutsideMaxExtent},setBounds:function(a){a=a.clone();if(this.layer.map.baseLayer.wrapDateLine)var b=this.layer.map.getMaxExtent(),c=this.layer.map.getResolution(),a=a.wrapDateLine(b,{leftTolerance:c,rightTolerance:c});this.bounds=a},moveTo:function(a,b,c){null==c&&(c=!0);this.setBounds(a);this.position=b.clone();c&&this.draw()},clear:function(){},CLASS_NAME:"OpenLayers.Tile"});
OpenLayers.Tile.Image=OpenLayers.Class(OpenLayers.Tile,{url:null,imgDiv:null,frame:null,imageReloadAttempts:null,layerAlphaHack:null,asyncRequestId:null,maxGetUrlLength:null,canvasContext:null,crossOriginKeyword:null,initialize:function(a,b,c,d,e,f){OpenLayers.Tile.prototype.initialize.apply(this,arguments);this.url=d;this.layerAlphaHack=this.layer.alpha&&OpenLayers.Util.alphaHack();if(null!=this.maxGetUrlLength||this.layer.gutter||this.layerAlphaHack)this.frame=document.createElement("div"),this.frame.style.position=
"absolute",this.frame.style.overflow="hidden";null!=this.maxGetUrlLength&&OpenLayers.Util.extend(this,OpenLayers.Tile.Image.IFrame)},destroy:function(){this.imgDiv&&(this.clear(),this.frame=this.imgDiv=null);this.asyncRequestId=null;OpenLayers.Tile.prototype.destroy.apply(this,arguments)},draw:function(){var a=OpenLayers.Tile.prototype.draw.apply(this,arguments);a?(this.layer!=this.layer.map.baseLayer&&this.layer.reproject&&(this.bounds=this.getBoundsFromBaseLayer(this.position)),this.isLoading?this._loadEvent=
"reload":(this.isLoading=!0,this._loadEvent="loadstart"),this.renderTile(),this.positionTile()):!1===a&&this.unload();return a},renderTile:function(){if(this.layer.async){var a=this.asyncRequestId=(this.asyncRequestId||0)+1;this.layer.getURLasync(this.bounds,function(b){a==this.asyncRequestId&&(this.url=b,this.initImage())},this)}else this.url=this.layer.getURL(this.bounds),this.initImage()},positionTile:function(){var a=this.getTile().style,b=this.frame?this.size:this.layer.getImageSize(this.bounds),
c=1;this.layer instanceof OpenLayers.Layer.Grid&&(c=this.layer.getServerResolution()/this.layer.map.getResolution());a.left=this.position.x+"px";a.top=this.position.y+"px";a.width=Math.round(c*b.w)+"px";a.height=Math.round(c*b.h)+"px"},clear:function(){OpenLayers.Tile.prototype.clear.apply(this,arguments);var a=this.imgDiv;if(a){var b=this.getTile();b.parentNode===this.layer.div&&this.layer.div.removeChild(b);this.setImgSrc();!0===this.layerAlphaHack&&(a.style.filter="");OpenLayers.Element.removeClass(a,
"olImageLoadError")}this.canvasContext=null},getImage:function(){if(!this.imgDiv){this.imgDiv=OpenLayers.Tile.Image.IMAGE.cloneNode(!1);var a=this.imgDiv.style;if(this.frame){var b=0,c=0;this.layer.gutter&&(b=100*(this.layer.gutter/this.layer.tileSize.w),c=100*(this.layer.gutter/this.layer.tileSize.h));a.left=-b+"%";a.top=-c+"%";a.width=2*b+100+"%";a.height=2*c+100+"%"}a.visibility="hidden";a.opacity=0;1>this.layer.opacity&&(a.filter="alpha(opacity="+100*this.layer.opacity+")");a.position="absolute";
this.layerAlphaHack&&(a.paddingTop=a.height,a.height="0",a.width="100%");this.frame&&this.frame.appendChild(this.imgDiv)}return this.imgDiv},setImage:function(a){this.imgDiv=a},initImage:function(){if(!this.url&&!this.imgDiv)this.isLoading=!1;else{this.events.triggerEvent("beforeload");this.layer.div.appendChild(this.getTile());this.events.triggerEvent(this._loadEvent);var a=this.getImage(),b=a.getAttribute("src")||"";this.url&&OpenLayers.Util.isEquivalentUrl(b,this.url)?this._loadTimeout=window.setTimeout(OpenLayers.Function.bind(this.onImageLoad,
this),0):(this.stopLoading(),this.crossOriginKeyword&&a.removeAttribute("crossorigin"),OpenLayers.Event.observe(a,"load",OpenLayers.Function.bind(this.onImageLoad,this)),OpenLayers.Event.observe(a,"error",OpenLayers.Function.bind(this.onImageError,this)),this.imageReloadAttempts=0,this.setImgSrc(this.url))}},setImgSrc:function(a){var b=this.imgDiv;a?(b.style.visibility="hidden",b.style.opacity=0,this.crossOriginKeyword&&("data:"!==a.substr(0,5)?b.setAttribute("crossorigin",this.crossOriginKeyword):
b.removeAttribute("crossorigin")),b.src=a):(this.stopLoading(),this.imgDiv=null,b.parentNode&&b.parentNode.removeChild(b))},getTile:function(){return this.frame?this.frame:this.getImage()},createBackBuffer:function(){if(this.imgDiv&&!this.isLoading){var a;this.frame?(a=this.frame.cloneNode(!1),a.appendChild(this.imgDiv)):a=this.imgDiv;this.imgDiv=null;return a}},onImageLoad:function(){var a=this.imgDiv;this.stopLoading();a.style.visibility="inherit";a.style.opacity=this.layer.opacity;this.isLoading=
!1;this.canvasContext=null;this.events.triggerEvent("loadend");!0===this.layerAlphaHack&&(a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+a.src+"', sizingMethod='scale')")},onImageError:function(){var a=this.imgDiv;null!=a.src&&(this.imageReloadAttempts++,this.imageReloadAttempts<=OpenLayers.IMAGE_RELOAD_ATTEMPTS?this.setImgSrc(this.layer.getURL(this.bounds)):(OpenLayers.Element.addClass(a,"olImageLoadError"),this.events.triggerEvent("loaderror"),this.onImageLoad()))},stopLoading:function(){OpenLayers.Event.stopObservingElement(this.imgDiv);
window.clearTimeout(this._loadTimeout);delete this._loadTimeout},getCanvasContext:function(){if(OpenLayers.CANVAS_SUPPORTED&&this.imgDiv&&!this.isLoading){if(!this.canvasContext){var a=document.createElement("canvas");a.width=this.size.w;a.height=this.size.h;this.canvasContext=a.getContext("2d");this.canvasContext.drawImage(this.imgDiv,0,0)}return this.canvasContext}},CLASS_NAME:"OpenLayers.Tile.Image"});
OpenLayers.Tile.Image.IMAGE=function(){var a=new Image;a.className="olTileImage";a.galleryImg="no";return a}();
OpenLayers.Layer.Grid=OpenLayers.Class(OpenLayers.Layer.HTTPRequest,{tileSize:null,tileOriginCorner:"bl",tileOrigin:null,tileOptions:null,tileClass:OpenLayers.Tile.Image,grid:null,singleTile:!1,ratio:1.5,buffer:0,transitionEffect:"resize",numLoadingTiles:0,serverResolutions:null,loading:!1,backBuffer:null,gridResolution:null,backBufferResolution:null,backBufferLonLat:null,backBufferTimerId:null,removeBackBufferDelay:null,className:null,gridLayout:null,rowSign:null,transitionendEvents:["transitionend",
"webkitTransitionEnd","otransitionend","oTransitionEnd"],initialize:function(a,b,c,d){OpenLayers.Layer.HTTPRequest.prototype.initialize.apply(this,arguments);this.grid=[];this._removeBackBuffer=OpenLayers.Function.bind(this.removeBackBuffer,this);this.initProperties();this.rowSign="t"===this.tileOriginCorner.substr(0,1)?1:-1},initProperties:function(){void 0===this.options.removeBackBufferDelay&&(this.removeBackBufferDelay=this.singleTile?0:2500);void 0===this.options.className&&(this.className=this.singleTile?
"olLayerGridSingleTile":"olLayerGrid")},setMap:function(a){OpenLayers.Layer.HTTPRequest.prototype.setMap.call(this,a);OpenLayers.Element.addClass(this.div,this.className)},removeMap:function(){this.removeBackBuffer()},destroy:function(){this.removeBackBuffer();this.clearGrid();this.tileSize=this.grid=null;OpenLayers.Layer.HTTPRequest.prototype.destroy.apply(this,arguments)},clearGrid:function(){if(this.grid){for(var a=0,b=this.grid.length;a<b;a++)for(var c=this.grid[a],d=0,e=c.length;d<e;d++)this.destroyTile(c[d]);
this.grid=[];this.gridLayout=this.gridResolution=null}},addOptions:function(a,b){var c=void 0!==a.singleTile&&a.singleTile!==this.singleTile;OpenLayers.Layer.HTTPRequest.prototype.addOptions.apply(this,arguments);this.map&&c&&(this.initProperties(),this.clearGrid(),this.tileSize=this.options.tileSize,this.setTileSize(),this.moveTo(null,!0))},clone:function(a){null==a&&(a=new OpenLayers.Layer.Grid(this.name,this.url,this.params,this.getOptions()));a=OpenLayers.Layer.HTTPRequest.prototype.clone.apply(this,
[a]);null!=this.tileSize&&(a.tileSize=this.tileSize.clone());a.grid=[];a.gridResolution=null;a.backBuffer=null;a.backBufferTimerId=null;a.loading=!1;a.numLoadingTiles=0;return a},moveTo:function(a,b,c){OpenLayers.Layer.HTTPRequest.prototype.moveTo.apply(this,arguments);a=a||this.map.getExtent();if(null!=a){var d=!this.grid.length||b,e=this.getTilesBounds(),f=this.map.getResolution();this.getServerResolution(f);if(this.singleTile){if(d||!c&&!e.containsBounds(a))b&&"resize"!==this.transitionEffect&&
this.removeBackBuffer(),(!b||"resize"===this.transitionEffect)&&this.applyBackBuffer(f),this.initSingleTile(a)}else(d=d||!e.intersectsBounds(a,{worldBounds:this.map.baseLayer.wrapDateLine&&this.map.getMaxExtent()}))?(b&&("resize"===this.transitionEffect||this.gridResolution===f)&&this.applyBackBuffer(f),this.initGriddedTiles(a)):this.moveGriddedTiles()}},getTileData:function(a){var b=null,c=a.lon,d=a.lat,e=this.grid.length;if(this.map&&e){var f=this.map.getResolution(),a=this.tileSize.w,g=this.tileSize.h,
h=this.grid[0][0].bounds,j=h.left,h=h.top;if(c<j&&this.map.baseLayer.wrapDateLine)var n=this.map.getMaxExtent().getWidth(),p=Math.ceil((j-c)/n),c=c+n*p;c=(c-j)/(f*a);d=(h-d)/(f*g);f=Math.floor(c);j=Math.floor(d);0<=j&&j<e&&(e=this.grid[j][f])&&(b={tile:e,i:Math.floor((c-f)*a),j:Math.floor((d-j)*g)})}return b},destroyTile:function(a){this.removeTileMonitoringHooks(a);a.destroy()},getServerResolution:function(a){var b=Number.POSITIVE_INFINITY,a=a||this.map.getResolution();if(this.serverResolutions&&
-1===OpenLayers.Util.indexOf(this.serverResolutions,a)){var c,d,e,f;for(c=this.serverResolutions.length-1;0<=c;c--){e=this.serverResolutions[c];d=Math.abs(e-a);if(d>b)break;b=d;f=e}a=f}return a},getServerZoom:function(){var a=this.getServerResolution();return this.serverResolutions?OpenLayers.Util.indexOf(this.serverResolutions,a):this.map.getZoomForResolution(a)+(this.zoomOffset||0)},applyBackBuffer:function(a){null!==this.backBufferTimerId&&this.removeBackBuffer();var b=this.backBuffer;if(!b){b=
this.createBackBuffer();if(!b)return;a===this.gridResolution?this.div.insertBefore(b,this.div.firstChild):this.map.baseLayer.div.parentNode.insertBefore(b,this.map.baseLayer.div);this.backBuffer=b;var c=this.grid[0][0].bounds;this.backBufferLonLat={lon:c.left,lat:c.top};this.backBufferResolution=this.gridResolution}for(var c=this.backBufferResolution/a,d=b.childNodes,e,f=d.length-1;0<=f;--f)e=d[f],e.style.top=(c*e._i*e._h|0)+"px",e.style.left=(c*e._j*e._w|0)+"px",e.style.width=Math.round(c*e._w)+
"px",e.style.height=Math.round(c*e._h)+"px";a=this.getViewPortPxFromLonLat(this.backBufferLonLat,a);c=this.map.layerContainerOriginPx.y;b.style.left=Math.round(a.x-this.map.layerContainerOriginPx.x)+"px";b.style.top=Math.round(a.y-c)+"px"},createBackBuffer:function(){var a;if(0<this.grid.length){a=document.createElement("div");a.id=this.div.id+"_bb";a.className="olBackBuffer";a.style.position="absolute";var b=this.map;a.style.zIndex="resize"===this.transitionEffect?this.getZIndex()-1:b.Z_INDEX_BASE.BaseLayer-
(b.getNumLayers()-b.getLayerIndex(this));for(var b=0,c=this.grid.length;b<c;b++)for(var d=0,e=this.grid[b].length;d<e;d++){var f=this.grid[b][d],g=this.grid[b][d].createBackBuffer();g&&(g._i=b,g._j=d,g._w=f.size.w,g._h=f.size.h,g.id=f.id+"_bb",a.appendChild(g))}}return a},removeBackBuffer:function(){if(this._transitionElement){for(var a=this.transitionendEvents.length-1;0<=a;--a)OpenLayers.Event.stopObserving(this._transitionElement,this.transitionendEvents[a],this._removeBackBuffer);delete this._transitionElement}this.backBuffer&&
(this.backBuffer.parentNode&&this.backBuffer.parentNode.removeChild(this.backBuffer),this.backBufferResolution=this.backBuffer=null,null!==this.backBufferTimerId&&(window.clearTimeout(this.backBufferTimerId),this.backBufferTimerId=null))},moveByPx:function(){this.singleTile||this.moveGriddedTiles()},setTileSize:function(a){this.singleTile&&(a=this.map.getSize(),a.h=parseInt(a.h*this.ratio,10),a.w=parseInt(a.w*this.ratio,10));OpenLayers.Layer.HTTPRequest.prototype.setTileSize.apply(this,[a])},getTilesBounds:function(){var a=
null,b=this.grid.length;if(b)var a=this.grid[b-1][0].bounds,b=this.grid[0].length*a.getWidth(),c=this.grid.length*a.getHeight(),a=new OpenLayers.Bounds(a.left,a.bottom,a.left+b,a.bottom+c);return a},initSingleTile:function(a){this.events.triggerEvent("retile");var b=a.getCenterLonLat(),c=a.getWidth()*this.ratio,a=a.getHeight()*this.ratio,b=new OpenLayers.Bounds(b.lon-c/2,b.lat-a/2,b.lon+c/2,b.lat+a/2),c=this.map.getLayerPxFromLonLat({lon:b.left,lat:b.top});this.grid.length||(this.grid[0]=[]);(a=this.grid[0][0])?
a.moveTo(b,c):(a=this.addTile(b,c),this.addTileMonitoringHooks(a),a.draw(),this.grid[0][0]=a);this.removeExcessTiles(1,1);this.gridResolution=this.getServerResolution()},calculateGridLayout:function(a,b,c){var d=c*this.tileSize.w,c=c*this.tileSize.h,e=Math.floor((a.left-b.lon)/d)-this.buffer,f=this.rowSign,a=Math[~f?"floor":"ceil"](f*(b.lat-a.top+c)/c)-this.buffer*f;return{tilelon:d,tilelat:c,startcol:e,startrow:a}},getTileOrigin:function(){var a=this.tileOrigin;if(!a)var a=this.getMaxExtent(),b=
{tl:["left","top"],tr:["right","top"],bl:["left","bottom"],br:["right","bottom"]}[this.tileOriginCorner],a=new OpenLayers.LonLat(a[b[0]],a[b[1]]);return a},getTileBoundsForGridIndex:function(a,b){var c=this.getTileOrigin(),d=this.gridLayout,e=d.tilelon,f=d.tilelat,g=d.startcol,d=d.startrow,h=this.rowSign;return new OpenLayers.Bounds(c.lon+(g+b)*e,c.lat-(d+a*h)*f*h,c.lon+(g+b+1)*e,c.lat-(d+(a-1)*h)*f*h)},initGriddedTiles:function(a){this.events.triggerEvent("retile");var b=this.map.getSize(),c=this.getTileOrigin(),
d=this.map.getResolution(),e=this.getServerResolution(),f=d/e,d=this.tileSize.w/f,f=this.tileSize.h/f,g=Math.ceil(b.h/f)+2*this.buffer+1,b=Math.ceil(b.w/d)+2*this.buffer+1;this.gridLayout=e=this.calculateGridLayout(a,c,e);var c=e.tilelon,h=e.tilelat,e=this.map.layerContainerOriginPx.x,j=this.map.layerContainerOriginPx.y,n=this.getTileBoundsForGridIndex(0,0),p=this.map.getViewPortPxFromLonLat(new OpenLayers.LonLat(n.left,n.top));p.x=Math.round(p.x)-e;p.y=Math.round(p.y)-j;var e=[],j=this.map.getCenter(),
q=0;do{var m=this.grid[q];m||(m=[],this.grid.push(m));var r=0;do{var n=this.getTileBoundsForGridIndex(q,r),s=p.clone();s.x+=r*Math.round(d);s.y+=q*Math.round(f);var t=m[r];t?t.moveTo(n,s,!1):(t=this.addTile(n,s),this.addTileMonitoringHooks(t),m.push(t));s=n.getCenterLonLat();e.push({tile:t,distance:Math.pow(s.lon-j.lon,2)+Math.pow(s.lat-j.lat,2)});r+=1}while(n.right<=a.right+c*this.buffer||r<b);q+=1}while(n.bottom>=a.bottom-h*this.buffer||q<g);this.removeExcessTiles(q,r);this.gridResolution=d=this.getServerResolution();
e.sort(function(a,b){return a.distance-b.distance});a=0;for(d=e.length;a<d;++a)e[a].tile.draw()},getMaxExtent:function(){return this.maxExtent},addTile:function(a,b){var c=new this.tileClass(this,b,a,null,this.tileSize,this.tileOptions);this.events.triggerEvent("addtile",{tile:c});return c},addTileMonitoringHooks:function(a){a.onLoadStart=function(){!1===this.loading&&(this.loading=!0,this.events.triggerEvent("loadstart"));this.events.triggerEvent("tileloadstart",{tile:a});this.numLoadingTiles++;
!this.singleTile&&(this.backBuffer&&this.gridResolution===this.backBufferResolution)&&OpenLayers.Element.addClass(a.getTile(),"olTileReplacing")};a.onLoadEnd=function(b){this.numLoadingTiles--;b="unload"===b.type;this.events.triggerEvent("tileloaded",{tile:a,aborted:b});if(!this.singleTile&&!b&&this.backBuffer&&this.gridResolution===this.backBufferResolution){var c=a.getTile();if("none"===OpenLayers.Element.getStyle(c,"display")){var d=document.getElementById(a.id+"_bb");d&&d.parentNode.removeChild(d)}OpenLayers.Element.removeClass(c,
"olTileReplacing")}if(0===this.numLoadingTiles){if(this.backBuffer)if(0===this.backBuffer.childNodes.length)this.removeBackBuffer();else{this._transitionElement=b?this.div.lastChild:a.imgDiv;b=this.transitionendEvents;for(c=b.length-1;0<=c;--c)OpenLayers.Event.observe(this._transitionElement,b[c],this._removeBackBuffer);this.backBufferTimerId=window.setTimeout(this._removeBackBuffer,this.removeBackBufferDelay)}this.loading=!1;this.events.triggerEvent("loadend")}};a.onLoadError=function(){this.events.triggerEvent("tileerror",
{tile:a})};a.events.on({loadstart:a.onLoadStart,loadend:a.onLoadEnd,unload:a.onLoadEnd,loaderror:a.onLoadError,scope:this})},removeTileMonitoringHooks:function(a){a.unload();a.events.un({loadstart:a.onLoadStart,loadend:a.onLoadEnd,unload:a.onLoadEnd,loaderror:a.onLoadError,scope:this})},moveGriddedTiles:function(){for(var a=this.buffer+1;;){var b=this.grid[0][0],c=b.position.x+this.map.layerContainerOriginPx.x,b=b.position.y+this.map.layerContainerOriginPx.y,d=this.getServerResolution()/this.map.getResolution(),
d={w:Math.round(this.tileSize.w*d),h:Math.round(this.tileSize.h*d)};if(c>-d.w*(a-1))this.shiftColumn(!0,d);else if(c<-d.w*a)this.shiftColumn(!1,d);else if(b>-d.h*(a-1))this.shiftRow(!0,d);else if(b<-d.h*a)this.shiftRow(!1,d);else break}},shiftRow:function(a,b){var c=this.grid,d=a?0:c.length-1,e=a?-1:1;this.gridLayout.startrow+=e*this.rowSign;for(var f=c[d],g=c[a?"pop":"shift"](),h=0,j=g.length;h<j;h++){var n=g[h],p=f[h].position.clone();p.y+=b.h*e;n.moveTo(this.getTileBoundsForGridIndex(d,h),p)}c[a?
"unshift":"push"](g)},shiftColumn:function(a,b){var c=this.grid,d=a?0:c[0].length-1,e=a?-1:1;this.gridLayout.startcol+=e;for(var f=0,g=c.length;f<g;f++){var h=c[f],j=h[d].position.clone(),n=h[a?"pop":"shift"]();j.x+=b.w*e;n.moveTo(this.getTileBoundsForGridIndex(f,d),j);h[a?"unshift":"push"](n)}},removeExcessTiles:function(a,b){for(var c,d;this.grid.length>a;){var e=this.grid.pop();c=0;for(d=e.length;c<d;c++){var f=e[c];this.destroyTile(f)}}c=0;for(d=this.grid.length;c<d;c++)for(;this.grid[c].length>
b;)e=this.grid[c],f=e.pop(),this.destroyTile(f)},onMapResize:function(){this.singleTile&&(this.clearGrid(),this.setTileSize())},getTileBounds:function(a){var b=this.maxExtent,c=this.getResolution(),d=c*this.tileSize.w,c=c*this.tileSize.h,e=this.getLonLatFromViewPortPx(a),a=b.left+d*Math.floor((e.lon-b.left)/d),b=b.bottom+c*Math.floor((e.lat-b.bottom)/c);return new OpenLayers.Bounds(a,b,a+d,b+c)},CLASS_NAME:"OpenLayers.Layer.Grid"});
OpenLayers.Layer.WMTS=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,version:"1.0.0",requestEncoding:"KVP",url:null,layer:null,matrixSet:null,style:null,format:"image/jpeg",tileOrigin:null,tileFullExtent:null,formatSuffix:null,matrixIds:null,dimensions:null,params:null,zoomOffset:0,serverResolutions:null,formatSuffixMap:{"image/png":"png","image/png8":"png","image/png24":"png","image/png32":"png",png:"png","image/jpeg":"jpg","image/jpg":"jpg",jpeg:"jpg",jpg:"jpg"},matrix:null,initialize:function(a){var b=
{url:!0,layer:!0,style:!0,matrixSet:!0},c;for(c in b)if(!(c in a))throw Error("Missing property '"+c+"' in layer configuration.");a.params=OpenLayers.Util.upperCaseObject(a.params);OpenLayers.Layer.Grid.prototype.initialize.apply(this,[a.name,a.url,a.params,a]);this.formatSuffix||(this.formatSuffix=this.formatSuffixMap[this.format]||this.format.split("/").pop());if(this.matrixIds&&(a=this.matrixIds.length)&&"string"===typeof this.matrixIds[0]){b=this.matrixIds;this.matrixIds=Array(a);for(c=0;c<a;++c)this.matrixIds[c]=
{identifier:b[c]}}},setMap:function(){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments)},updateMatrixProperties:function(){if(this.matrix=this.getMatrix())this.matrix.topLeftCorner&&(this.tileOrigin=this.matrix.topLeftCorner),this.matrix.tileWidth&&this.matrix.tileHeight&&(this.tileSize=new OpenLayers.Size(this.matrix.tileWidth,this.matrix.tileHeight)),this.tileOrigin||(this.tileOrigin=new OpenLayers.LonLat(this.maxExtent.left,this.maxExtent.top)),this.tileFullExtent||(this.tileFullExtent=
this.maxExtent)},moveTo:function(a,b,c){(b||!this.matrix)&&this.updateMatrixProperties();return OpenLayers.Layer.Grid.prototype.moveTo.apply(this,arguments)},clone:function(a){null==a&&(a=new OpenLayers.Layer.WMTS(this.options));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a])},getIdentifier:function(){return this.getServerZoom()},getMatrix:function(){var a;if(!this.matrixIds||0===this.matrixIds.length)a={identifier:this.getIdentifier()};else if("scaleDenominator"in this.matrixIds[0])for(var b=
OpenLayers.METERS_PER_INCH*OpenLayers.INCHES_PER_UNIT[this.units]*this.getServerResolution()/2.8E-4,c=Number.POSITIVE_INFINITY,d,e=0,f=this.matrixIds.length;e<f;++e)d=Math.abs(1-this.matrixIds[e].scaleDenominator/b),d<c&&(c=d,a=this.matrixIds[e]);else a=this.matrixIds[this.getIdentifier()];return a},getTileInfo:function(a){var b=this.getServerResolution(),c=(a.lon-this.tileOrigin.lon)/(b*this.tileSize.w),a=(this.tileOrigin.lat-a.lat)/(b*this.tileSize.h),b=Math.floor(c),d=Math.floor(a);return{col:b,
row:d,i:Math.floor((c-b)*this.tileSize.w),j:Math.floor((a-d)*this.tileSize.h)}},getURL:function(a){var a=this.adjustBounds(a),b="";if(!this.tileFullExtent||this.tileFullExtent.intersectsBounds(a)){var a=a.getCenterLonLat(),c=this.getTileInfo(a),a=this.dimensions,d,b=OpenLayers.Util.isArray(this.url)?this.selectUrl([this.version,this.style,this.matrixSet,this.matrix.identifier,c.row,c.col].join(),this.url):this.url;if("REST"===this.requestEncoding.toUpperCase())if(d=this.params,-1!==b.indexOf("{")){b=
b.replace(/\{/g,"${");c={style:this.style,Style:this.style,TileMatrixSet:this.matrixSet,TileMatrix:this.matrix.identifier,TileRow:c.row,TileCol:c.col};if(a){var e,f;for(f=a.length-1;0<=f;--f)e=a[f],c[e]=d[e.toUpperCase()]}b=OpenLayers.String.format(b,c)}else{e=this.version+"/"+this.layer+"/"+this.style+"/";if(a)for(f=0;f<a.length;f++)d[a[f]]&&(e=e+d[a[f]]+"/");e=e+this.matrixSet+"/"+this.matrix.identifier+"/"+c.row+"/"+c.col+"."+this.formatSuffix;b.match(/\/$/)||(b+="/");b+=e}else"KVP"===this.requestEncoding.toUpperCase()&&
(d={SERVICE:"WMTS",REQUEST:"GetTile",VERSION:this.version,LAYER:this.layer,STYLE:this.style,TILEMATRIXSET:this.matrixSet,TILEMATRIX:this.matrix.identifier,TILEROW:c.row,TILECOL:c.col,FORMAT:this.format},b=OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,[d]))}return b},mergeNewParams:function(a){if("KVP"===this.requestEncoding.toUpperCase())return OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,[OpenLayers.Util.upperCaseObject(a)])},CLASS_NAME:"OpenLayers.Layer.WMTS"});
OpenLayers.Control=OpenLayers.Class({id:null,map:null,div:null,type:null,allowSelection:!1,displayClass:"",title:"",autoActivate:!1,active:null,handlerOptions:null,handler:null,eventListeners:null,events:null,initialize:function(a){this.displayClass=this.CLASS_NAME.replace("OpenLayers.","ol").replace(/\./g,"");OpenLayers.Util.extend(this,a);this.events=new OpenLayers.Events(this);if(this.eventListeners instanceof Object)this.events.on(this.eventListeners);null==this.id&&(this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+
"_"))},destroy:function(){this.events&&(this.eventListeners&&this.events.un(this.eventListeners),this.events.destroy(),this.events=null);this.eventListeners=null;this.handler&&(this.handler.destroy(),this.handler=null);if(this.handlers){for(var a in this.handlers)this.handlers.hasOwnProperty(a)&&"function"==typeof this.handlers[a].destroy&&this.handlers[a].destroy();this.handlers=null}this.map&&(this.map.removeControl(this),this.map=null);this.div=null},setMap:function(a){this.map=a;this.handler&&
this.handler.setMap(a)},draw:function(a){null==this.div&&(this.div=OpenLayers.Util.createDiv(this.id),this.div.className=this.displayClass,this.allowSelection||(this.div.className+=" olControlNoSelect",this.div.setAttribute("unselectable","on",0),this.div.onselectstart=OpenLayers.Function.False),""!=this.title&&(this.div.title=this.title));null!=a&&(this.position=a.clone());this.moveTo(this.position);return this.div},moveTo:function(a){null!=a&&null!=this.div&&(this.div.style.left=a.x+"px",this.div.style.top=
a.y+"px")},activate:function(){if(this.active)return!1;this.handler&&this.handler.activate();this.active=!0;this.map&&OpenLayers.Element.addClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active");this.events.triggerEvent("activate");return!0},deactivate:function(){return this.active?(this.handler&&this.handler.deactivate(),this.active=!1,this.map&&OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active"),this.events.triggerEvent("deactivate"),
!0):!1},CLASS_NAME:"OpenLayers.Control"});OpenLayers.Control.TYPE_BUTTON=1;OpenLayers.Control.TYPE_TOGGLE=2;OpenLayers.Control.TYPE_TOOL=3;
OpenLayers.Events.buttonclick=OpenLayers.Class({target:null,events:"mousedown mouseup click dblclick touchstart touchmove touchend keydown".split(" "),startRegEx:/^mousedown|touchstart$/,cancelRegEx:/^touchmove$/,completeRegEx:/^mouseup|touchend$/,initialize:function(a){this.target=a;for(a=this.events.length-1;0<=a;--a)this.target.register(this.events[a],this,this.buttonClick,{extension:!0})},destroy:function(){for(var a=this.events.length-1;0<=a;--a)this.target.unregister(this.events[a],this,this.buttonClick);
delete this.target},getPressedButton:function(a){var b=3,c;do{if(OpenLayers.Element.hasClass(a,"olButton")){c=a;break}a=a.parentNode}while(0<--b&&a);return c},ignore:function(a){var b=3,c=!1;do{if("a"===a.nodeName.toLowerCase()){c=!0;break}a=a.parentNode}while(0<--b&&a);return c},buttonClick:function(a){var b=!0,c=OpenLayers.Event.element(a);if(c&&(OpenLayers.Event.isLeftClick(a)||!~a.type.indexOf("mouse")))if(c=this.getPressedButton(c)){if("keydown"===a.type)switch(a.keyCode){case OpenLayers.Event.KEY_RETURN:case OpenLayers.Event.KEY_SPACE:this.target.triggerEvent("buttonclick",
{buttonElement:c}),OpenLayers.Event.stop(a),b=!1}else if(this.startEvt){if(this.completeRegEx.test(a.type)){var b=OpenLayers.Util.pagePosition(c),d=OpenLayers.Util.getViewportElement(),e=window.pageYOffset||d.scrollTop;b[0]-=window.pageXOffset||d.scrollLeft;b[1]-=e;this.target.triggerEvent("buttonclick",{buttonElement:c,buttonXY:{x:this.startEvt.clientX-b[0],y:this.startEvt.clientY-b[1]}})}this.cancelRegEx.test(a.type)&&delete this.startEvt;OpenLayers.Event.stop(a);b=!1}this.startRegEx.test(a.type)&&
(this.startEvt=a,OpenLayers.Event.stop(a),b=!1)}else b=!this.ignore(OpenLayers.Event.element(a)),delete this.startEvt;return b}});
OpenLayers.Handler=OpenLayers.Class({id:null,control:null,map:null,keyMask:null,active:!1,evt:null,touch:!1,initialize:function(a,b,c){OpenLayers.Util.extend(this,c);this.control=a;this.callbacks=b;(a=this.map||a.map)&&this.setMap(a);this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},setMap:function(a){this.map=a},checkModifiers:function(a){return null==this.keyMask?!0:((a.shiftKey?OpenLayers.Handler.MOD_SHIFT:0)|(a.ctrlKey?OpenLayers.Handler.MOD_CTRL:0)|(a.altKey?OpenLayers.Handler.MOD_ALT:
0)|(a.metaKey?OpenLayers.Handler.MOD_META:0))==this.keyMask},activate:function(){if(this.active)return!1;for(var a=OpenLayers.Events.prototype.BROWSER_EVENTS,b=0,c=a.length;b<c;b++)this[a[b]]&&this.register(a[b],this[a[b]]);return this.active=!0},deactivate:function(){if(!this.active)return!1;for(var a=OpenLayers.Events.prototype.BROWSER_EVENTS,b=0,c=a.length;b<c;b++)this[a[b]]&&this.unregister(a[b],this[a[b]]);this.active=this.touch=!1;return!0},startTouch:function(){if(!this.touch){this.touch=!0;
for(var a="mousedown mouseup mousemove click dblclick mouseout".split(" "),b=0,c=a.length;b<c;b++)this[a[b]]&&this.unregister(a[b],this[a[b]])}},callback:function(a,b){a&&this.callbacks[a]&&this.callbacks[a].apply(this.control,b)},register:function(a,b){this.map.events.registerPriority(a,this,b);this.map.events.registerPriority(a,this,this.setEvent)},unregister:function(a,b){this.map.events.unregister(a,this,b);this.map.events.unregister(a,this,this.setEvent)},setEvent:function(a){this.evt=a;return!0},
destroy:function(){this.deactivate();this.control=this.map=null},CLASS_NAME:"OpenLayers.Handler"});OpenLayers.Handler.MOD_NONE=0;OpenLayers.Handler.MOD_SHIFT=1;OpenLayers.Handler.MOD_CTRL=2;OpenLayers.Handler.MOD_ALT=4;OpenLayers.Handler.MOD_META=8;
OpenLayers.Handler.Click=OpenLayers.Class(OpenLayers.Handler,{delay:300,single:!0,"double":!1,pixelTolerance:0,dblclickTolerance:13,stopSingle:!1,stopDouble:!1,timerId:null,down:null,last:null,first:null,rightclickTimerId:null,touchstart:function(a){this.startTouch();this.down=this.getEventInfo(a);this.last=this.getEventInfo(a);return!0},touchmove:function(a){this.last=this.getEventInfo(a);return!0},touchend:function(a){this.down&&(a.xy=this.last.xy,a.lastTouches=this.last.touches,this.handleSingle(a),
this.down=null);return!0},mousedown:function(a){this.down=this.getEventInfo(a);this.last=this.getEventInfo(a);return!0},mouseup:function(a){var b=!0;this.checkModifiers(a)&&(this.control.handleRightClicks&&OpenLayers.Event.isRightClick(a))&&(b=this.rightclick(a));return b},rightclick:function(a){if(this.passesTolerance(a)){if(null!=this.rightclickTimerId)return this.clearTimer(),this.callback("dblrightclick",[a]),!this.stopDouble;a=this["double"]?OpenLayers.Util.extend({},a):this.callback("rightclick",
[a]);a=OpenLayers.Function.bind(this.delayedRightCall,this,a);this.rightclickTimerId=window.setTimeout(a,this.delay)}return!this.stopSingle},delayedRightCall:function(a){this.rightclickTimerId=null;a&&this.callback("rightclick",[a])},click:function(a){this.last||(this.last=this.getEventInfo(a));this.handleSingle(a);return!this.stopSingle},dblclick:function(a){this.handleDouble(a);return!this.stopDouble},handleDouble:function(a){this.passesDblclickTolerance(a)&&(this["double"]&&this.callback("dblclick",
[a]),this.clearTimer())},handleSingle:function(a){this.passesTolerance(a)&&(null!=this.timerId?(this.last.touches&&1===this.last.touches.length&&(this["double"]&&OpenLayers.Event.preventDefault(a),this.handleDouble(a)),(!this.last.touches||2!==this.last.touches.length)&&this.clearTimer()):(this.first=this.getEventInfo(a),a=this.single?OpenLayers.Util.extend({},a):null,this.queuePotentialClick(a)))},queuePotentialClick:function(a){this.timerId=window.setTimeout(OpenLayers.Function.bind(this.delayedCall,
this,a),this.delay)},passesTolerance:function(a){var b=!0;if(null!=this.pixelTolerance&&this.down&&this.down.xy&&(b=this.pixelTolerance>=this.down.xy.distanceTo(a.xy))&&this.touch&&this.down.touches.length===this.last.touches.length)for(var a=0,c=this.down.touches.length;a<c;++a)if(this.getTouchDistance(this.down.touches[a],this.last.touches[a])>this.pixelTolerance){b=!1;break}return b},getTouchDistance:function(a,b){return Math.sqrt(Math.pow(a.clientX-b.clientX,2)+Math.pow(a.clientY-b.clientY,2))},
passesDblclickTolerance:function(){var a=!0;this.down&&this.first&&(a=this.down.xy.distanceTo(this.first.xy)<=this.dblclickTolerance);return a},clearTimer:function(){null!=this.timerId&&(window.clearTimeout(this.timerId),this.timerId=null);null!=this.rightclickTimerId&&(window.clearTimeout(this.rightclickTimerId),this.rightclickTimerId=null)},delayedCall:function(a){this.timerId=null;a&&this.callback("click",[a])},getEventInfo:function(a){var b;if(a.touches){var c=a.touches.length;b=Array(c);for(var d,
e=0;e<c;e++)d=a.touches[e],b[e]={clientX:d.olClientX,clientY:d.olClientY}}return{xy:a.xy,touches:b}},deactivate:function(){var a=!1;OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.clearTimer(),this.last=this.first=this.down=null,a=!0);return a},CLASS_NAME:"OpenLayers.Handler.Click"});
OpenLayers.Handler.Drag=OpenLayers.Class(OpenLayers.Handler,{started:!1,stopDown:!0,dragging:!1,last:null,start:null,lastMoveEvt:null,oldOnselectstart:null,interval:0,timeoutId:null,documentDrag:!1,documentEvents:null,initialize:function(a,b,c){OpenLayers.Handler.prototype.initialize.apply(this,arguments);if(!0===this.documentDrag){var d=this;this._docMove=function(a){d.mousemove({xy:{x:a.clientX,y:a.clientY},element:document})};this._docUp=function(a){d.mouseup({xy:{x:a.clientX,y:a.clientY}})}}},
dragstart:function(a){var b=!0;this.dragging=!1;this.checkModifiers(a)&&(OpenLayers.Event.isLeftClick(a)||OpenLayers.Event.isSingleTouch(a))?(this.started=!0,this.last=this.start=a.xy,OpenLayers.Element.addClass(this.map.viewPortDiv,"olDragDown"),this.down(a),this.callback("down",[a.xy]),OpenLayers.Event.preventDefault(a),this.oldOnselectstart||(this.oldOnselectstart=document.onselectstart?document.onselectstart:OpenLayers.Function.True),document.onselectstart=OpenLayers.Function.False,b=!this.stopDown):
(this.started=!1,this.last=this.start=null);return b},dragmove:function(a){this.lastMoveEvt=a;if(this.started&&!this.timeoutId&&(a.xy.x!=this.last.x||a.xy.y!=this.last.y))!0===this.documentDrag&&this.documentEvents&&(a.element===document?(this.adjustXY(a),this.setEvent(a)):this.removeDocumentEvents()),0<this.interval&&(this.timeoutId=setTimeout(OpenLayers.Function.bind(this.removeTimeout,this),this.interval)),this.dragging=!0,this.move(a),this.callback("move",[a.xy]),this.oldOnselectstart||(this.oldOnselectstart=
document.onselectstart,document.onselectstart=OpenLayers.Function.False),this.last=a.xy;return!0},dragend:function(a){if(this.started){!0===this.documentDrag&&this.documentEvents&&(this.adjustXY(a),this.removeDocumentEvents());var b=this.start!=this.last;this.dragging=this.started=!1;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown");this.up(a);this.callback("up",[a.xy]);b&&this.callback("done",[a.xy]);document.onselectstart=this.oldOnselectstart}return!0},down:function(){},move:function(){},
up:function(){},out:function(){},mousedown:function(a){return this.dragstart(a)},touchstart:function(a){this.startTouch();return this.dragstart(a)},mousemove:function(a){return this.dragmove(a)},touchmove:function(a){return this.dragmove(a)},removeTimeout:function(){this.timeoutId=null;this.dragging&&this.mousemove(this.lastMoveEvt)},mouseup:function(a){return this.dragend(a)},touchend:function(a){a.xy=this.last;return this.dragend(a)},mouseout:function(a){if(this.started&&OpenLayers.Util.mouseLeft(a,
this.map.viewPortDiv))if(!0===this.documentDrag)this.addDocumentEvents();else{var b=this.start!=this.last;this.dragging=this.started=!1;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown");this.out(a);this.callback("out",[]);b&&this.callback("done",[a.xy]);document.onselectstart&&(document.onselectstart=this.oldOnselectstart)}return!0},click:function(){return this.start==this.last},activate:function(){var a=!1;OpenLayers.Handler.prototype.activate.apply(this,arguments)&&(this.dragging=
!1,a=!0);return a},deactivate:function(){var a=!1;OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.dragging=this.started=!1,this.last=this.start=null,a=!0,OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown"));return a},adjustXY:function(a){var b=OpenLayers.Util.pagePosition(this.map.viewPortDiv);a.xy.x-=b[0];a.xy.y-=b[1]},addDocumentEvents:function(){OpenLayers.Element.addClass(document.body,"olDragDown");this.documentEvents=!0;OpenLayers.Event.observe(document,"mousemove",
this._docMove);OpenLayers.Event.observe(document,"mouseup",this._docUp)},removeDocumentEvents:function(){OpenLayers.Element.removeClass(document.body,"olDragDown");this.documentEvents=!1;OpenLayers.Event.stopObserving(document,"mousemove",this._docMove);OpenLayers.Event.stopObserving(document,"mouseup",this._docUp)},CLASS_NAME:"OpenLayers.Handler.Drag"});
OpenLayers.Control.OverviewMap=OpenLayers.Class(OpenLayers.Control,{element:null,ovmap:null,size:{w:180,h:90},layers:null,minRectSize:15,minRectDisplayClass:"RectReplacement",minRatio:8,maxRatio:32,mapOptions:null,autoPan:!1,handlers:null,resolutionFactor:1,maximized:!1,maximizeTitle:"",minimizeTitle:"",initialize:function(a){this.layers=[];this.handlers={};OpenLayers.Control.prototype.initialize.apply(this,[a])},destroy:function(){this.mapDiv&&(this.handlers.click&&this.handlers.click.destroy(),
this.handlers.drag&&this.handlers.drag.destroy(),this.ovmap&&this.ovmap.viewPortDiv.removeChild(this.extentRectangle),this.extentRectangle=null,this.rectEvents&&(this.rectEvents.destroy(),this.rectEvents=null),this.ovmap&&(this.ovmap.destroy(),this.ovmap=null),this.element.removeChild(this.mapDiv),this.mapDiv=null,this.div.removeChild(this.element),this.element=null,this.maximizeDiv&&(this.div.removeChild(this.maximizeDiv),this.maximizeDiv=null),this.minimizeDiv&&(this.div.removeChild(this.minimizeDiv),
this.minimizeDiv=null),this.map.events.un({buttonclick:this.onButtonClick,moveend:this.update,changebaselayer:this.baseLayerDraw,scope:this}),OpenLayers.Control.prototype.destroy.apply(this,arguments))},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(0===this.layers.length)if(this.map.baseLayer)this.layers=[this.map.baseLayer.clone()];else return this.map.events.register("changebaselayer",this,this.baseLayerDraw),this.div;this.element=document.createElement("div");this.element.className=
this.displayClass+"Element";this.element.style.display="none";this.mapDiv=document.createElement("div");this.mapDiv.style.width=this.size.w+"px";this.mapDiv.style.height=this.size.h+"px";this.mapDiv.style.position="relative";this.mapDiv.style.overflow="hidden";this.mapDiv.id=OpenLayers.Util.createUniqueID("overviewMap");this.extentRectangle=document.createElement("div");this.extentRectangle.style.position="absolute";this.extentRectangle.style.zIndex=1E3;this.extentRectangle.className=this.displayClass+
"ExtentRectangle";this.element.appendChild(this.mapDiv);this.div.appendChild(this.element);if(this.outsideViewport)this.element.style.display="";else{this.div.className+=" "+this.displayClass+"Container";var a=OpenLayers.Util.getImageLocation("layer-switcher-maximize.png");this.maximizeDiv=OpenLayers.Util.createAlphaImageDiv(this.displayClass+"MaximizeButton",null,null,a,"absolute");this.maximizeDiv.style.display="none";this.maximizeDiv.className=this.displayClass+"MaximizeButton olButton";this.maximizeTitle&&
(this.maximizeDiv.title=this.maximizeTitle);this.div.appendChild(this.maximizeDiv);a=OpenLayers.Util.getImageLocation("layer-switcher-minimize.png");this.minimizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_minimizeDiv",null,null,a,"absolute");this.minimizeDiv.style.display="none";this.minimizeDiv.className=this.displayClass+"MinimizeButton olButton";this.minimizeTitle&&(this.minimizeDiv.title=this.minimizeTitle);this.div.appendChild(this.minimizeDiv);this.minimizeControl()}this.map.getExtent()&&
this.update();this.map.events.on({buttonclick:this.onButtonClick,moveend:this.update,scope:this});this.maximized&&this.maximizeControl();return this.div},baseLayerDraw:function(){this.draw();this.map.events.unregister("changebaselayer",this,this.baseLayerDraw)},rectDrag:function(a){var b=this.handlers.drag.last.x-a.x,c=this.handlers.drag.last.y-a.y;if(0!=b||0!=c){var d=this.rectPxBounds.top,e=this.rectPxBounds.left,a=Math.abs(this.rectPxBounds.getHeight()),f=this.rectPxBounds.getWidth(),c=Math.max(0,
d-c),c=Math.min(c,this.ovmap.size.h-this.hComp-a),b=Math.max(0,e-b),b=Math.min(b,this.ovmap.size.w-this.wComp-f);this.setRectPxBounds(new OpenLayers.Bounds(b,c+a,b+f,c))}},mapDivClick:function(a){var b=this.rectPxBounds.getCenterPixel(),c=a.xy.x-b.x,d=a.xy.y-b.y,e=this.rectPxBounds.top,f=this.rectPxBounds.left,a=Math.abs(this.rectPxBounds.getHeight()),b=this.rectPxBounds.getWidth(),d=Math.max(0,e+d),d=Math.min(d,this.ovmap.size.h-a),c=Math.max(0,f+c),c=Math.min(c,this.ovmap.size.w-b);this.setRectPxBounds(new OpenLayers.Bounds(c,
d+a,c+b,d));this.updateMapToRect()},onButtonClick:function(a){a.buttonElement===this.minimizeDiv?this.minimizeControl():a.buttonElement===this.maximizeDiv&&this.maximizeControl()},maximizeControl:function(a){this.element.style.display="";this.showToggle(!1);null!=a&&OpenLayers.Event.stop(a)},minimizeControl:function(a){this.element.style.display="none";this.showToggle(!0);null!=a&&OpenLayers.Event.stop(a)},showToggle:function(a){this.maximizeDiv&&(this.maximizeDiv.style.display=a?"":"none");this.minimizeDiv&&
(this.minimizeDiv.style.display=a?"none":"")},update:function(){null==this.ovmap&&this.createMap();(this.autoPan||!this.isSuitableOverview())&&this.updateOverview();this.updateRectToMap()},isSuitableOverview:function(){var a=this.map.getExtent(),b=this.map.getMaxExtent(),a=new OpenLayers.Bounds(Math.max(a.left,b.left),Math.max(a.bottom,b.bottom),Math.min(a.right,b.right),Math.min(a.top,b.top));this.ovmap.getProjection()!=this.map.getProjection()&&(a=a.transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject()));
b=this.ovmap.getResolution()/this.map.getResolution();return b>this.minRatio&&b<=this.maxRatio&&this.ovmap.getExtent().containsBounds(a)},updateOverview:function(){var a=this.map.getResolution(),b=this.ovmap.getResolution(),c=b/a;c>this.maxRatio?b=this.minRatio*a:c<=this.minRatio&&(b=this.maxRatio*a);this.ovmap.getProjection()!=this.map.getProjection()?(a=this.map.center.clone(),a.transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject())):a=this.map.center;this.ovmap.setCenter(a,
this.ovmap.getZoomForResolution(b*this.resolutionFactor));this.updateRectToMap()},createMap:function(){var a=OpenLayers.Util.extend({controls:[],maxResolution:"auto",fallThrough:!1},this.mapOptions);this.ovmap=new OpenLayers.Map(this.mapDiv,a);this.ovmap.viewPortDiv.appendChild(this.extentRectangle);OpenLayers.Event.stopObserving(window,"unload",this.ovmap.unloadDestroy);this.ovmap.addLayers(this.layers);this.ovmap.zoomToMaxExtent();this.wComp=(this.wComp=parseInt(OpenLayers.Element.getStyle(this.extentRectangle,
"border-left-width"))+parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-right-width")))?this.wComp:2;this.hComp=(this.hComp=parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-top-width"))+parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-bottom-width")))?this.hComp:2;this.handlers.drag=new OpenLayers.Handler.Drag(this,{move:this.rectDrag,done:this.updateMapToRect},{map:this.ovmap});this.handlers.click=new OpenLayers.Handler.Click(this,{click:this.mapDivClick},
{single:!0,"double":!1,stopSingle:!0,stopDouble:!0,pixelTolerance:1,map:this.ovmap});this.handlers.click.activate();this.rectEvents=new OpenLayers.Events(this,this.extentRectangle,null,!0);this.rectEvents.register("mouseover",this,function(){!this.handlers.drag.active&&!this.map.dragging&&this.handlers.drag.activate()});this.rectEvents.register("mouseout",this,function(){this.handlers.drag.dragging||this.handlers.drag.deactivate()});if(this.ovmap.getProjection()!=this.map.getProjection()){var a=this.map.getProjectionObject().getUnits()||
this.map.units||this.map.baseLayer.units,b=this.ovmap.getProjectionObject().getUnits()||this.ovmap.units||this.ovmap.baseLayer.units;this.resolutionFactor=a&&b?OpenLayers.INCHES_PER_UNIT[a]/OpenLayers.INCHES_PER_UNIT[b]:1}},updateRectToMap:function(){var a;a=this.ovmap.getProjection()!=this.map.getProjection()?this.map.getExtent().transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject()):this.map.getExtent();(a=this.getRectBoundsFromMapBounds(a))&&this.setRectPxBounds(a)},updateMapToRect:function(){var a=
this.getMapBoundsFromRectBounds(this.rectPxBounds);this.ovmap.getProjection()!=this.map.getProjection()&&(a=a.transform(this.ovmap.getProjectionObject(),this.map.getProjectionObject()));this.map.panTo(a.getCenterLonLat())},setRectPxBounds:function(a){var b=Math.max(a.top,0),c=Math.max(a.left,0),d=Math.min(a.top+Math.abs(a.getHeight()),this.ovmap.size.h-this.hComp),a=Math.min(a.left+a.getWidth(),this.ovmap.size.w-this.wComp),e=Math.max(a-c,0),f=Math.max(d-b,0);e<this.minRectSize||f<this.minRectSize?
(this.extentRectangle.className=this.displayClass+this.minRectDisplayClass,e=c+e/2-this.minRectSize/2,this.extentRectangle.style.top=Math.round(b+f/2-this.minRectSize/2)+"px",this.extentRectangle.style.left=Math.round(e)+"px",this.extentRectangle.style.height=this.minRectSize+"px",this.extentRectangle.style.width=this.minRectSize+"px"):(this.extentRectangle.className=this.displayClass+"ExtentRectangle",this.extentRectangle.style.top=Math.round(b)+"px",this.extentRectangle.style.left=Math.round(c)+
"px",this.extentRectangle.style.height=Math.round(f)+"px",this.extentRectangle.style.width=Math.round(e)+"px");this.rectPxBounds=new OpenLayers.Bounds(Math.round(c),Math.round(d),Math.round(a),Math.round(b))},getRectBoundsFromMapBounds:function(a){var b=this.getOverviewPxFromLonLat({lon:a.left,lat:a.bottom}),a=this.getOverviewPxFromLonLat({lon:a.right,lat:a.top}),c=null;b&&a&&(c=new OpenLayers.Bounds(b.x,b.y,a.x,a.y));return c},getMapBoundsFromRectBounds:function(a){var b=this.getLonLatFromOverviewPx({x:a.left,
y:a.bottom}),a=this.getLonLatFromOverviewPx({x:a.right,y:a.top});return new OpenLayers.Bounds(b.lon,b.lat,a.lon,a.lat)},getLonLatFromOverviewPx:function(a){var b=this.ovmap.size,c=this.ovmap.getResolution(),d=this.ovmap.getExtent().getCenterLonLat();return{lon:d.lon+(a.x-b.w/2)*c,lat:d.lat-(a.y-b.h/2)*c}},getOverviewPxFromLonLat:function(a){var b=this.ovmap.getResolution(),c=this.ovmap.getExtent();if(c)return{x:Math.round(1/b*(a.lon-c.left)),y:Math.round(1/b*(c.top-a.lat))}},CLASS_NAME:"OpenLayers.Control.OverviewMap"});
OpenLayers.Layer.SphericalMercator={getExtent:function(){var a=null;return a=this.sphericalMercator?this.map.calculateBounds():OpenLayers.Layer.FixedZoomLevels.prototype.getExtent.apply(this)},getLonLatFromViewPortPx:function(a){return OpenLayers.Layer.prototype.getLonLatFromViewPortPx.apply(this,arguments)},getViewPortPxFromLonLat:function(a){return OpenLayers.Layer.prototype.getViewPortPxFromLonLat.apply(this,arguments)},initMercatorParameters:function(){this.RESOLUTIONS=[];for(var a=0;a<=this.MAX_ZOOM_LEVEL;++a)this.RESOLUTIONS[a]=
156543.03390625/Math.pow(2,a);this.units="m";this.projection=this.projection||"EPSG:900913"},forwardMercator:function(){var a=new OpenLayers.Projection("EPSG:4326"),b=new OpenLayers.Projection("EPSG:900913");return function(c,d){var e=OpenLayers.Projection.transform({x:c,y:d},a,b);return new OpenLayers.LonLat(e.x,e.y)}}(),inverseMercator:function(){var a=new OpenLayers.Projection("EPSG:4326"),b=new OpenLayers.Projection("EPSG:900913");return function(c,d){var e=OpenLayers.Projection.transform({x:c,
y:d},b,a);return new OpenLayers.LonLat(e.x,e.y)}}()};
OpenLayers.Layer.EventPane=OpenLayers.Class(OpenLayers.Layer,{smoothDragPan:!0,isBaseLayer:!0,isFixed:!0,pane:null,mapObject:null,initialize:function(a,b){OpenLayers.Layer.prototype.initialize.apply(this,arguments);null==this.pane&&(this.pane=OpenLayers.Util.createDiv(this.div.id+"_EventPane"))},destroy:function(){this.pane=this.mapObject=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},setMap:function(a){OpenLayers.Layer.prototype.setMap.apply(this,arguments);this.pane.style.zIndex=
parseInt(this.div.style.zIndex)+1;this.pane.style.display=this.div.style.display;this.pane.style.width="100%";this.pane.style.height="100%";"msie"==OpenLayers.BROWSER_NAME&&(this.pane.style.background="url("+OpenLayers.Util.getImageLocation("blank.gif")+")");this.isFixed?this.map.viewPortDiv.appendChild(this.pane):this.map.layerContainerDiv.appendChild(this.pane);this.loadMapObject();null==this.mapObject&&this.loadWarningMessage()},removeMap:function(a){this.pane&&this.pane.parentNode&&this.pane.parentNode.removeChild(this.pane);
OpenLayers.Layer.prototype.removeMap.apply(this,arguments)},loadWarningMessage:function(){this.div.style.backgroundColor="darkblue";var a=this.map.getSize(),b=Math.min(a.w,300),c=Math.min(a.h,200),b=new OpenLayers.Size(b,c),a=(new OpenLayers.Pixel(a.w/2,a.h/2)).add(-b.w/2,-b.h/2),a=OpenLayers.Util.createDiv(this.name+"_warning",a,b,null,null,null,"auto");a.style.padding="7px";a.style.backgroundColor="yellow";a.innerHTML=this.getWarningHTML();this.div.appendChild(a)},getWarningHTML:function(){return""},
display:function(a){OpenLayers.Layer.prototype.display.apply(this,arguments);this.pane.style.display=this.div.style.display},setZIndex:function(a){OpenLayers.Layer.prototype.setZIndex.apply(this,arguments);this.pane.style.zIndex=parseInt(this.div.style.zIndex)+1},moveByPx:function(a,b){OpenLayers.Layer.prototype.moveByPx.apply(this,arguments);this.dragPanMapObject?this.dragPanMapObject(a,-b):this.moveTo(this.map.getCachedCenter())},moveTo:function(a,b,c){OpenLayers.Layer.prototype.moveTo.apply(this,
arguments);if(null!=this.mapObject){var d=this.map.getCenter(),e=this.map.getZoom();if(null!=d){var f=this.getMapObjectCenter(),f=this.getOLLonLatFromMapObjectLonLat(f),g=this.getMapObjectZoom(),g=this.getOLZoomFromMapObjectZoom(g);if(!d.equals(f)||e!=g)!b&&f&&this.dragPanMapObject&&this.smoothDragPan?(e=this.map.getViewPortPxFromLonLat(f),d=this.map.getViewPortPxFromLonLat(d),this.dragPanMapObject(d.x-e.x,e.y-d.y)):(d=this.getMapObjectLonLatFromOLLonLat(d),e=this.getMapObjectZoomFromOLZoom(e),this.setMapObjectCenter(d,
e,c))}}},getLonLatFromViewPortPx:function(a){var b=null;null!=this.mapObject&&null!=this.getMapObjectCenter()&&(a=this.getMapObjectPixelFromOLPixel(a),a=this.getMapObjectLonLatFromMapObjectPixel(a),b=this.getOLLonLatFromMapObjectLonLat(a));return b},getViewPortPxFromLonLat:function(a){var b=null;null!=this.mapObject&&null!=this.getMapObjectCenter()&&(a=this.getMapObjectLonLatFromOLLonLat(a),a=this.getMapObjectPixelFromMapObjectLonLat(a),b=this.getOLPixelFromMapObjectPixel(a));return b},getOLLonLatFromMapObjectLonLat:function(a){var b=
null;null!=a&&(b=this.getLongitudeFromMapObjectLonLat(a),a=this.getLatitudeFromMapObjectLonLat(a),b=new OpenLayers.LonLat(b,a));return b},getMapObjectLonLatFromOLLonLat:function(a){var b=null;null!=a&&(b=this.getMapObjectLonLatFromLonLat(a.lon,a.lat));return b},getOLPixelFromMapObjectPixel:function(a){var b=null;null!=a&&(b=this.getXFromMapObjectPixel(a),a=this.getYFromMapObjectPixel(a),b=new OpenLayers.Pixel(b,a));return b},getMapObjectPixelFromOLPixel:function(a){var b=null;null!=a&&(b=this.getMapObjectPixelFromXY(a.x,
a.y));return b},CLASS_NAME:"OpenLayers.Layer.EventPane"});
OpenLayers.Layer.FixedZoomLevels=OpenLayers.Class({initialize:function(){},initResolutions:function(){for(var a=["minZoomLevel","maxZoomLevel","numZoomLevels"],b=0,c=a.length;b<c;b++){var d=a[b];this[d]=null!=this.options[d]?this.options[d]:this.map[d]}if(null==this.minZoomLevel||this.minZoomLevel<this.MIN_ZOOM_LEVEL)this.minZoomLevel=this.MIN_ZOOM_LEVEL;a=this.MAX_ZOOM_LEVEL-this.minZoomLevel+1;b=null==this.options.numZoomLevels&&null!=this.options.maxZoomLevel||null==this.numZoomLevels&&null!=this.maxZoomLevel?
this.maxZoomLevel-this.minZoomLevel+1:this.numZoomLevels;this.numZoomLevels=null!=b?Math.min(b,a):a;this.maxZoomLevel=this.minZoomLevel+this.numZoomLevels-1;if(null!=this.RESOLUTIONS){a=0;this.resolutions=[];for(b=this.minZoomLevel;b<=this.maxZoomLevel;b++)this.resolutions[a++]=this.RESOLUTIONS[b];this.maxResolution=this.resolutions[0];this.minResolution=this.resolutions[this.resolutions.length-1]}},getResolution:function(){if(null!=this.resolutions)return OpenLayers.Layer.prototype.getResolution.apply(this,
arguments);var a=null,b=this.map.getSize(),c=this.getExtent();null!=b&&null!=c&&(a=Math.max(c.getWidth()/b.w,c.getHeight()/b.h));return a},getExtent:function(){var a=this.map.getSize(),b=this.getLonLatFromViewPortPx({x:0,y:0}),a=this.getLonLatFromViewPortPx({x:a.w,y:a.h});return null!=b&&null!=a?new OpenLayers.Bounds(b.lon,a.lat,a.lon,b.lat):null},getZoomForResolution:function(a){if(null!=this.resolutions)return OpenLayers.Layer.prototype.getZoomForResolution.apply(this,arguments);var b=OpenLayers.Layer.prototype.getExtent.apply(this,
[]);return this.getZoomForExtent(b)},getOLZoomFromMapObjectZoom:function(a){var b=null;null!=a&&(b=a-this.minZoomLevel,this.map.baseLayer!==this&&(b=this.map.baseLayer.getZoomForResolution(this.getResolutionForZoom(b))));return b},getMapObjectZoomFromOLZoom:function(a){var b=null;null!=a&&(b=a+this.minZoomLevel,this.map.baseLayer!==this&&(b=this.getZoomForResolution(this.map.baseLayer.getResolutionForZoom(b))));return b},CLASS_NAME:"OpenLayers.Layer.FixedZoomLevels"});
OpenLayers.Layer.Google=OpenLayers.Class(OpenLayers.Layer.EventPane,OpenLayers.Layer.FixedZoomLevels,{MIN_ZOOM_LEVEL:0,MAX_ZOOM_LEVEL:21,RESOLUTIONS:[1.40625,0.703125,0.3515625,0.17578125,0.087890625,0.0439453125,0.02197265625,0.010986328125,0.0054931640625,0.00274658203125,0.001373291015625,6.866455078125E-4,3.4332275390625E-4,1.71661376953125E-4,8.58306884765625E-5,4.291534423828125E-5,2.145767211914062E-5,1.072883605957031E-5,5.36441802978515E-6,2.68220901489257E-6,1.341104507446289E-6,6.705522537231445E-7],
type:null,wrapDateLine:!0,sphericalMercator:!1,version:null,initialize:function(a,b){b=b||{};b.version||(b.version="function"===typeof GMap2?"2":"3");var c=OpenLayers.Layer.Google["v"+b.version.replace(/\./g,"_")];if(c)OpenLayers.Util.applyDefaults(b,c);else throw"Unsupported Google Maps API version: "+b.version;OpenLayers.Util.applyDefaults(b,c.DEFAULTS);b.maxExtent&&(b.maxExtent=b.maxExtent.clone());OpenLayers.Layer.EventPane.prototype.initialize.apply(this,[a,b]);OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(this,
[a,b]);this.sphericalMercator&&(OpenLayers.Util.extend(this,OpenLayers.Layer.SphericalMercator),this.initMercatorParameters())},clone:function(){return new OpenLayers.Layer.Google(this.name,this.getOptions())},setVisibility:function(a){var b=null==this.opacity?1:this.opacity;OpenLayers.Layer.EventPane.prototype.setVisibility.apply(this,arguments);this.setOpacity(b)},display:function(a){this._dragging||this.setGMapVisibility(a);OpenLayers.Layer.EventPane.prototype.display.apply(this,arguments)},moveTo:function(a,
b,c){this._dragging=c;OpenLayers.Layer.EventPane.prototype.moveTo.apply(this,arguments);delete this._dragging},setOpacity:function(a){a!==this.opacity&&(null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"opacity"}),this.opacity=a);if(this.getVisibility()){var b=this.getMapContainer();OpenLayers.Util.modifyDOMElement(b,null,null,null,null,null,null,a)}},destroy:function(){if(this.map){this.setGMapVisibility(!1);var a=OpenLayers.Layer.Google.cache[this.map.id];a&&1>=a.count&&
this.removeGMapElements()}OpenLayers.Layer.EventPane.prototype.destroy.apply(this,arguments)},removeGMapElements:function(){var a=OpenLayers.Layer.Google.cache[this.map.id];if(a){var b=this.mapObject&&this.getMapContainer();b&&b.parentNode&&b.parentNode.removeChild(b);(b=a.termsOfUse)&&b.parentNode&&b.parentNode.removeChild(b);(a=a.poweredBy)&&a.parentNode&&a.parentNode.removeChild(a);this.mapObject&&(window.google&&google.maps&&google.maps.event&&google.maps.event.clearListeners)&&google.maps.event.clearListeners(this.mapObject,
"tilesloaded")}},removeMap:function(a){this.visibility&&this.mapObject&&this.setGMapVisibility(!1);var b=OpenLayers.Layer.Google.cache[a.id];b&&(1>=b.count?(this.removeGMapElements(),delete OpenLayers.Layer.Google.cache[a.id]):--b.count);delete this.termsOfUse;delete this.poweredBy;delete this.mapObject;delete this.dragObject;OpenLayers.Layer.EventPane.prototype.removeMap.apply(this,arguments)},getOLBoundsFromMapObjectBounds:function(a){var b=null;null!=a&&(b=a.getSouthWest(),a=a.getNorthEast(),this.sphericalMercator?
(b=this.forwardMercator(b.lng(),b.lat()),a=this.forwardMercator(a.lng(),a.lat())):(b=new OpenLayers.LonLat(b.lng(),b.lat()),a=new OpenLayers.LonLat(a.lng(),a.lat())),b=new OpenLayers.Bounds(b.lon,b.lat,a.lon,a.lat));return b},getWarningHTML:function(){return OpenLayers.i18n("googleWarning")},getMapObjectCenter:function(){return this.mapObject.getCenter()},getMapObjectZoom:function(){return this.mapObject.getZoom()},getLongitudeFromMapObjectLonLat:function(a){return this.sphericalMercator?this.forwardMercator(a.lng(),
a.lat()).lon:a.lng()},getLatitudeFromMapObjectLonLat:function(a){return this.sphericalMercator?this.forwardMercator(a.lng(),a.lat()).lat:a.lat()},getXFromMapObjectPixel:function(a){return a.x},getYFromMapObjectPixel:function(a){return a.y},CLASS_NAME:"OpenLayers.Layer.Google"});OpenLayers.Layer.Google.cache={};
OpenLayers.Layer.Google.v2={termsOfUse:null,poweredBy:null,dragObject:null,loadMapObject:function(){this.type||(this.type=G_NORMAL_MAP);var a,b,c,d=OpenLayers.Layer.Google.cache[this.map.id];if(d)a=d.mapObject,b=d.termsOfUse,c=d.poweredBy,++d.count;else{var d=this.map.viewPortDiv,e=document.createElement("div");e.id=this.map.id+"_GMap2Container";e.style.position="absolute";e.style.width="100%";e.style.height="100%";d.appendChild(e);try{a=new GMap2(e),b=e.lastChild,d.appendChild(b),b.style.zIndex=
"1100",b.style.right="",b.style.bottom="",b.className="olLayerGoogleCopyright",c=e.lastChild,d.appendChild(c),c.style.zIndex="1100",c.style.right="",c.style.bottom="",c.className="olLayerGooglePoweredBy gmnoprint"}catch(f){throw f;}OpenLayers.Layer.Google.cache[this.map.id]={mapObject:a,termsOfUse:b,poweredBy:c,count:1}}this.mapObject=a;this.termsOfUse=b;this.poweredBy=c;-1===OpenLayers.Util.indexOf(this.mapObject.getMapTypes(),this.type)&&this.mapObject.addMapType(this.type);"function"==typeof a.getDragObject?
this.dragObject=a.getDragObject():this.dragPanMapObject=null;!1===this.isBaseLayer&&this.setGMapVisibility("none"!==this.div.style.display)},onMapResize:function(){if(this.visibility&&this.mapObject.isLoaded())this.mapObject.checkResize();else{if(!this._resized)var a=this,b=GEvent.addListener(this.mapObject,"load",function(){GEvent.removeListener(b);delete a._resized;a.mapObject.checkResize();a.moveTo(a.map.getCenter(),a.map.getZoom())});this._resized=!0}},setGMapVisibility:function(a){var b=OpenLayers.Layer.Google.cache[this.map.id];
if(b){var c=this.mapObject.getContainer();!0===a?(this.mapObject.setMapType(this.type),c.style.display="",this.termsOfUse.style.left="",this.termsOfUse.style.display="",this.poweredBy.style.display="",b.displayed=this.id):(b.displayed===this.id&&delete b.displayed,b.displayed||(c.style.display="none",this.termsOfUse.style.display="none",this.termsOfUse.style.left="-9999px",this.poweredBy.style.display="none"))}},getMapContainer:function(){return this.mapObject.getContainer()},getMapObjectBoundsFromOLBounds:function(a){var b=
null;null!=a&&(b=this.sphericalMercator?this.inverseMercator(a.bottom,a.left):new OpenLayers.LonLat(a.bottom,a.left),a=this.sphericalMercator?this.inverseMercator(a.top,a.right):new OpenLayers.LonLat(a.top,a.right),b=new GLatLngBounds(new GLatLng(b.lat,b.lon),new GLatLng(a.lat,a.lon)));return b},setMapObjectCenter:function(a,b){this.mapObject.setCenter(a,b)},dragPanMapObject:function(a,b){this.dragObject.moveBy(new GSize(-a,b))},getMapObjectLonLatFromMapObjectPixel:function(a){return this.mapObject.fromContainerPixelToLatLng(a)},
getMapObjectPixelFromMapObjectLonLat:function(a){return this.mapObject.fromLatLngToContainerPixel(a)},getMapObjectZoomFromMapObjectBounds:function(a){return this.mapObject.getBoundsZoomLevel(a)},getMapObjectLonLatFromLonLat:function(a,b){var c;this.sphericalMercator?(c=this.inverseMercator(a,b),c=new GLatLng(c.lat,c.lon)):c=new GLatLng(b,a);return c},getMapObjectPixelFromXY:function(a,b){return new GPoint(a,b)}};
OpenLayers.Format=OpenLayers.Class({options:null,externalProjection:null,internalProjection:null,data:null,keepData:!1,initialize:function(a){OpenLayers.Util.extend(this,a);this.options=a},destroy:function(){},read:function(){throw Error("Read not implemented.");},write:function(){throw Error("Write not implemented.");},CLASS_NAME:"OpenLayers.Format"});
OpenLayers.Format.XML=OpenLayers.Class(OpenLayers.Format,{namespaces:null,namespaceAlias:null,defaultPrefix:null,readers:{},writers:{},xmldom:null,initialize:function(a){window.ActiveXObject&&(this.xmldom=new ActiveXObject("Microsoft.XMLDOM"));OpenLayers.Format.prototype.initialize.apply(this,[a]);this.namespaces=OpenLayers.Util.extend({},this.namespaces);this.namespaceAlias={};for(var b in this.namespaces)this.namespaceAlias[this.namespaces[b]]=b},destroy:function(){this.xmldom=null;OpenLayers.Format.prototype.destroy.apply(this,
arguments)},setNamespace:function(a,b){this.namespaces[a]=b;this.namespaceAlias[b]=a},read:function(a){var b=a.indexOf("<");0<b&&(a=a.substring(b));b=OpenLayers.Util.Try(OpenLayers.Function.bind(function(){var b;b=window.ActiveXObject&&!this.xmldom?new ActiveXObject("Microsoft.XMLDOM"):this.xmldom;b.loadXML(a);return b},this),function(){return(new DOMParser).parseFromString(a,"text/xml")},function(){var b=new XMLHttpRequest;b.open("GET","data:text/xml;charset=utf-8,"+encodeURIComponent(a),!1);b.overrideMimeType&&
b.overrideMimeType("text/xml");b.send(null);return b.responseXML});this.keepData&&(this.data=b);return b},write:function(a){if(this.xmldom)a=a.xml;else{var b=new XMLSerializer;if(1==a.nodeType){var c=document.implementation.createDocument("","",null);c.importNode&&(a=c.importNode(a,!0));c.appendChild(a);a=b.serializeToString(c)}else a=b.serializeToString(a)}return a},createElementNS:function(a,b){return this.xmldom?"string"==typeof a?this.xmldom.createNode(1,b,a):this.xmldom.createNode(1,b,""):document.createElementNS(a,
b)},createDocumentFragment:function(){return this.xmldom?this.xmldom.createDocumentFragment():document.createDocumentFragment()},createTextNode:function(a){"string"!==typeof a&&(a=String(a));return this.xmldom?this.xmldom.createTextNode(a):document.createTextNode(a)},getElementsByTagNameNS:function(a,b,c){var d=[];if(a.getElementsByTagNameNS)d=a.getElementsByTagNameNS(b,c);else for(var a=a.getElementsByTagName("*"),e,f,g=0,h=a.length;g<h;++g)if(e=a[g],f=e.prefix?e.prefix+":"+c:c,"*"==c||f==e.nodeName)("*"==
b||b==e.namespaceURI)&&d.push(e);return d},getAttributeNodeNS:function(a,b,c){var d=null;if(a.getAttributeNodeNS)d=a.getAttributeNodeNS(b,c);else for(var a=a.attributes,e,f,g=0,h=a.length;g<h;++g)if(e=a[g],e.namespaceURI==b&&(f=e.prefix?e.prefix+":"+c:c,f==e.nodeName)){d=e;break}return d},getAttributeNS:function(a,b,c){var d="";if(a.getAttributeNS)d=a.getAttributeNS(b,c)||"";else if(a=this.getAttributeNodeNS(a,b,c))d=a.nodeValue;return d},getChildValue:function(a,b){var c=b||"";if(a)for(var d=a.firstChild;d;d=
d.nextSibling)switch(d.nodeType){case 3:case 4:c+=d.nodeValue}return c},isSimpleContent:function(a){for(var b=!0,a=a.firstChild;a;a=a.nextSibling)if(1===a.nodeType){b=!1;break}return b},contentType:function(a){for(var b=!1,c=!1,d=OpenLayers.Format.XML.CONTENT_TYPE.EMPTY,a=a.firstChild;a;a=a.nextSibling){switch(a.nodeType){case 1:c=!0;break;case 8:break;default:b=!0}if(c&&b)break}if(c&&b)d=OpenLayers.Format.XML.CONTENT_TYPE.MIXED;else{if(c)return OpenLayers.Format.XML.CONTENT_TYPE.COMPLEX;if(b)return OpenLayers.Format.XML.CONTENT_TYPE.SIMPLE}return d},
hasAttributeNS:function(a,b,c){var d=!1;return d=a.hasAttributeNS?a.hasAttributeNS(b,c):!!this.getAttributeNodeNS(a,b,c)},setAttributeNS:function(a,b,c,d){if(a.setAttributeNS)a.setAttributeNS(b,c,d);else if(this.xmldom)b?(b=a.ownerDocument.createNode(2,c,b),b.nodeValue=d,a.setAttributeNode(b)):a.setAttribute(c,d);else throw"setAttributeNS not implemented";},createElementNSPlus:function(a,b){var b=b||{},c=b.uri||this.namespaces[b.prefix];c||(c=a.indexOf(":"),c=this.namespaces[a.substring(0,c)]);c||
(c=this.namespaces[this.defaultPrefix]);c=this.createElementNS(c,a);b.attributes&&this.setAttributes(c,b.attributes);var d=b.value;null!=d&&c.appendChild(this.createTextNode(d));return c},setAttributes:function(a,b){var c,d,e;for(e in b)null!=b[e]&&b[e].toString&&(c=b[e].toString(),d=this.namespaces[e.substring(0,e.indexOf(":"))]||null,this.setAttributeNS(a,d,e,c))},readNode:function(a,b){b||(b={});var c=this.readers[a.namespaceURI?this.namespaceAlias[a.namespaceURI]:this.defaultPrefix];if(c){var d=
a.localName||a.nodeName.split(":").pop();(c=c[d]||c["*"])&&c.apply(this,[a,b])}return b},readChildNodes:function(a,b){b||(b={});for(var c=a.childNodes,d,e=0,f=c.length;e<f;++e)d=c[e],1==d.nodeType&&this.readNode(d,b);return b},writeNode:function(a,b,c){var d,e=a.indexOf(":");0<e?(d=a.substring(0,e),a=a.substring(e+1)):d=c?this.namespaceAlias[c.namespaceURI]:this.defaultPrefix;b=this.writers[d][a].apply(this,[b]);c&&c.appendChild(b);return b},getChildEl:function(a,b,c){return a&&this.getThisOrNextEl(a.firstChild,
b,c)},getNextEl:function(a,b,c){return a&&this.getThisOrNextEl(a.nextSibling,b,c)},getThisOrNextEl:function(a,b,c){a:for(;a;a=a.nextSibling)switch(a.nodeType){case 1:if((!b||b===(a.localName||a.nodeName.split(":").pop()))&&(!c||c===a.namespaceURI))break a;a=null;break a;case 3:if(/^\s*$/.test(a.nodeValue))break;case 4:case 6:case 12:case 10:case 11:a=null;break a}return a||null},lookupNamespaceURI:function(a,b){var c=null;if(a)if(a.lookupNamespaceURI)c=a.lookupNamespaceURI(b);else a:switch(a.nodeType){case 1:if(null!==
a.namespaceURI&&a.prefix===b){c=a.namespaceURI;break a}if(c=a.attributes.length)for(var d,e=0;e<c;++e)if(d=a.attributes[e],"xmlns"===d.prefix&&d.name==="xmlns:"+b){c=d.value||null;break a}else if("xmlns"===d.name&&null===b){c=d.value||null;break a}c=this.lookupNamespaceURI(a.parentNode,b);break a;case 2:c=this.lookupNamespaceURI(a.ownerElement,b);break a;case 9:c=this.lookupNamespaceURI(a.documentElement,b);break a;case 6:case 12:case 10:case 11:break a;default:c=this.lookupNamespaceURI(a.parentNode,
b)}return c},getXMLDoc:function(){!OpenLayers.Format.XML.document&&!this.xmldom&&(document.implementation&&document.implementation.createDocument?OpenLayers.Format.XML.document=document.implementation.createDocument("","",null):!this.xmldom&&window.ActiveXObject&&(this.xmldom=new ActiveXObject("Microsoft.XMLDOM")));return OpenLayers.Format.XML.document||this.xmldom},CLASS_NAME:"OpenLayers.Format.XML"});OpenLayers.Format.XML.CONTENT_TYPE={EMPTY:0,SIMPLE:1,COMPLEX:2,MIXED:3};
OpenLayers.Format.XML.lookupNamespaceURI=OpenLayers.Function.bind(OpenLayers.Format.XML.prototype.lookupNamespaceURI,OpenLayers.Format.XML.prototype);OpenLayers.Format.XML.document=null;OpenLayers.Format.WFST=function(a){var a=OpenLayers.Util.applyDefaults(a,OpenLayers.Format.WFST.DEFAULTS),b=OpenLayers.Format.WFST["v"+a.version.replace(/\./g,"_")];if(!b)throw"Unsupported WFST version: "+a.version;return new b(a)};OpenLayers.Format.WFST.DEFAULTS={version:"1.0.0"};
OpenLayers.Feature=OpenLayers.Class({layer:null,id:null,lonlat:null,data:null,marker:null,popupClass:null,popup:null,initialize:function(a,b,c){this.layer=a;this.lonlat=b;this.data=null!=c?c:{};this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){null!=this.layer&&null!=this.layer.map&&null!=this.popup&&this.layer.map.removePopup(this.popup);null!=this.layer&&null!=this.marker&&this.layer.removeMarker(this.marker);this.data=this.lonlat=this.id=this.layer=null;null!=this.marker&&
(this.destroyMarker(this.marker),this.marker=null);null!=this.popup&&(this.destroyPopup(this.popup),this.popup=null)},onScreen:function(){var a=!1;null!=this.layer&&null!=this.layer.map&&(a=this.layer.map.getExtent().containsLonLat(this.lonlat));return a},createMarker:function(){null!=this.lonlat&&(this.marker=new OpenLayers.Marker(this.lonlat,this.data.icon));return this.marker},destroyMarker:function(){this.marker.destroy()},createPopup:function(a){null!=this.lonlat&&(this.popup||(this.popup=new (this.popupClass?
this.popupClass:OpenLayers.Popup.Anchored)(this.id+"_popup",this.lonlat,this.data.popupSize,this.data.popupContentHTML,this.marker?this.marker.icon:null,a)),null!=this.data.overflow&&(this.popup.contentDiv.style.overflow=this.data.overflow),this.popup.feature=this);return this.popup},destroyPopup:function(){this.popup&&(this.popup.feature=null,this.popup.destroy(),this.popup=null)},CLASS_NAME:"OpenLayers.Feature"});OpenLayers.State={UNKNOWN:"Unknown",INSERT:"Insert",UPDATE:"Update",DELETE:"Delete"};
OpenLayers.Feature.Vector=OpenLayers.Class(OpenLayers.Feature,{fid:null,geometry:null,attributes:null,bounds:null,state:null,style:null,url:null,renderIntent:"default",modified:null,initialize:function(a,b,c){OpenLayers.Feature.prototype.initialize.apply(this,[null,null,b]);this.lonlat=null;this.geometry=a?a:null;this.state=null;this.attributes={};b&&(this.attributes=OpenLayers.Util.extend(this.attributes,b));this.style=c?c:null},destroy:function(){this.layer&&(this.layer.removeFeatures(this),this.layer=
null);this.modified=this.geometry=null;OpenLayers.Feature.prototype.destroy.apply(this,arguments)},clone:function(){return new OpenLayers.Feature.Vector(this.geometry?this.geometry.clone():null,this.attributes,this.style)},onScreen:function(a){var b=!1;this.layer&&this.layer.map&&(b=this.layer.map.getExtent(),a?(a=this.geometry.getBounds(),b=b.intersectsBounds(a)):b=b.toGeometry().intersects(this.geometry));return b},getVisibility:function(){return!(this.style&&"none"==this.style.display||!this.layer||
this.layer&&this.layer.styleMap&&"none"==this.layer.styleMap.createSymbolizer(this,this.renderIntent).display||this.layer&&!this.layer.getVisibility())},createMarker:function(){return null},destroyMarker:function(){},createPopup:function(){return null},atPoint:function(a,b,c){var d=!1;this.geometry&&(d=this.geometry.atPoint(a,b,c));return d},destroyPopup:function(){},move:function(a){if(this.layer&&this.geometry.move){var a="OpenLayers.LonLat"==a.CLASS_NAME?this.layer.getViewPortPxFromLonLat(a):a,
b=this.layer.getViewPortPxFromLonLat(this.geometry.getBounds().getCenterLonLat()),c=this.layer.map.getResolution();this.geometry.move(c*(a.x-b.x),c*(b.y-a.y));this.layer.drawFeature(this);return b}},toState:function(a){if(a==OpenLayers.State.UPDATE)switch(this.state){case OpenLayers.State.UNKNOWN:case OpenLayers.State.DELETE:this.state=a}else if(a==OpenLayers.State.INSERT)switch(this.state){case OpenLayers.State.UNKNOWN:break;default:this.state=a}else if(a==OpenLayers.State.DELETE)switch(this.state){case OpenLayers.State.UNKNOWN:case OpenLayers.State.UPDATE:this.state=
a}else a==OpenLayers.State.UNKNOWN&&(this.state=a)},CLASS_NAME:"OpenLayers.Feature.Vector"});
OpenLayers.Feature.Vector.style={"default":{fillColor:"#ee9900",fillOpacity:0.4,hoverFillColor:"white",hoverFillOpacity:0.8,strokeColor:"#ee9900",strokeOpacity:1,strokeWidth:1,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:0.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},select:{fillColor:"blue",fillOpacity:0.4,
hoverFillColor:"white",hoverFillOpacity:0.8,strokeColor:"blue",strokeOpacity:1,strokeWidth:2,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:0.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"pointer",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},temporary:{fillColor:"#66cccc",fillOpacity:0.2,hoverFillColor:"white",hoverFillOpacity:0.8,strokeColor:"#66cccc",strokeOpacity:1,
strokeLinecap:"round",strokeWidth:2,strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:0.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},"delete":{display:"none"}};
OpenLayers.Style=OpenLayers.Class({id:null,name:null,title:null,description:null,layerName:null,isDefault:!1,rules:null,context:null,defaultStyle:null,defaultsPerSymbolizer:!1,propertyStyles:null,initialize:function(a,b){OpenLayers.Util.extend(this,b);this.rules=[];b&&b.rules&&this.addRules(b.rules);this.setDefaultStyle(a||OpenLayers.Feature.Vector.style["default"]);this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var a=0,b=this.rules.length;a<b;a++)this.rules[a].destroy(),
this.rules[a]=null;this.defaultStyle=this.rules=null},createSymbolizer:function(a){for(var b=this.defaultsPerSymbolizer?{}:this.createLiterals(OpenLayers.Util.extend({},this.defaultStyle),a),c=this.rules,d,e=[],f=!1,g=0,h=c.length;g<h;g++)d=c[g],d.evaluate(a)&&(d instanceof OpenLayers.Rule&&d.elseFilter?e.push(d):(f=!0,this.applySymbolizer(d,b,a)));if(!1==f&&0<e.length){f=!0;g=0;for(h=e.length;g<h;g++)this.applySymbolizer(e[g],b,a)}0<c.length&&!1==f&&(b.display="none");null!=b.label&&"string"!==typeof b.label&&
(b.label=String(b.label));return b},applySymbolizer:function(a,b,c){var d=c.geometry?this.getSymbolizerPrefix(c.geometry):OpenLayers.Style.SYMBOLIZER_PREFIXES[0],a=a.symbolizer[d]||a.symbolizer;!0===this.defaultsPerSymbolizer&&(d=this.defaultStyle,OpenLayers.Util.applyDefaults(a,{pointRadius:d.pointRadius}),(!0===a.stroke||!0===a.graphic)&&OpenLayers.Util.applyDefaults(a,{strokeWidth:d.strokeWidth,strokeColor:d.strokeColor,strokeOpacity:d.strokeOpacity,strokeDashstyle:d.strokeDashstyle,strokeLinecap:d.strokeLinecap}),
(!0===a.fill||!0===a.graphic)&&OpenLayers.Util.applyDefaults(a,{fillColor:d.fillColor,fillOpacity:d.fillOpacity}),!0===a.graphic&&OpenLayers.Util.applyDefaults(a,{pointRadius:this.defaultStyle.pointRadius,externalGraphic:this.defaultStyle.externalGraphic,graphicName:this.defaultStyle.graphicName,graphicOpacity:this.defaultStyle.graphicOpacity,graphicWidth:this.defaultStyle.graphicWidth,graphicHeight:this.defaultStyle.graphicHeight,graphicXOffset:this.defaultStyle.graphicXOffset,graphicYOffset:this.defaultStyle.graphicYOffset}));
return this.createLiterals(OpenLayers.Util.extend(b,a),c)},createLiterals:function(a,b){var c=OpenLayers.Util.extend({},b.attributes||b.data);OpenLayers.Util.extend(c,this.context);for(var d in this.propertyStyles)a[d]=OpenLayers.Style.createLiteral(a[d],c,b,d);return a},findPropertyStyles:function(){var a={};this.addPropertyStyles(a,this.defaultStyle);for(var b=this.rules,c,d,e=0,f=b.length;e<f;e++){c=b[e].symbolizer;for(var g in c)if(d=c[g],"object"==typeof d)this.addPropertyStyles(a,d);else{this.addPropertyStyles(a,
c);break}}return a},addPropertyStyles:function(a,b){var c,d;for(d in b)c=b[d],"string"==typeof c&&c.match(/\$\{\w+\}/)&&(a[d]=!0);return a},addRules:function(a){Array.prototype.push.apply(this.rules,a);this.propertyStyles=this.findPropertyStyles()},setDefaultStyle:function(a){this.defaultStyle=a;this.propertyStyles=this.findPropertyStyles()},getSymbolizerPrefix:function(a){for(var b=OpenLayers.Style.SYMBOLIZER_PREFIXES,c=0,d=b.length;c<d;c++)if(-1!=a.CLASS_NAME.indexOf(b[c]))return b[c]},clone:function(){var a=
OpenLayers.Util.extend({},this);if(this.rules){a.rules=[];for(var b=0,c=this.rules.length;b<c;++b)a.rules.push(this.rules[b].clone())}a.context=this.context&&OpenLayers.Util.extend({},this.context);b=OpenLayers.Util.extend({},this.defaultStyle);return new OpenLayers.Style(b,a)},CLASS_NAME:"OpenLayers.Style"});OpenLayers.Style.createLiteral=function(a,b,c,d){"string"==typeof a&&-1!=a.indexOf("${")&&(a=OpenLayers.String.format(a,b,[c,d]),a=isNaN(a)||!a?a:parseFloat(a));return a};
OpenLayers.Style.SYMBOLIZER_PREFIXES=["Point","Line","Polygon","Text","Raster"];OpenLayers.Filter=OpenLayers.Class({initialize:function(a){OpenLayers.Util.extend(this,a)},destroy:function(){},evaluate:function(){return!0},clone:function(){return null},toString:function(){return OpenLayers.Format&&OpenLayers.Format.CQL?OpenLayers.Format.CQL.prototype.write(this):Object.prototype.toString.call(this)},CLASS_NAME:"OpenLayers.Filter"});
OpenLayers.Filter.Spatial=OpenLayers.Class(OpenLayers.Filter,{type:null,property:null,value:null,distance:null,distanceUnits:null,evaluate:function(a){var b=!1;switch(this.type){case OpenLayers.Filter.Spatial.BBOX:case OpenLayers.Filter.Spatial.INTERSECTS:if(a.geometry){var c=this.value;"OpenLayers.Bounds"==this.value.CLASS_NAME&&(c=this.value.toGeometry());a.geometry.intersects(c)&&(b=!0)}break;default:throw Error("evaluate is not implemented for this filter type.");}return b},clone:function(){var a=
OpenLayers.Util.applyDefaults({value:this.value&&this.value.clone&&this.value.clone()},this);return new OpenLayers.Filter.Spatial(a)},CLASS_NAME:"OpenLayers.Filter.Spatial"});OpenLayers.Filter.Spatial.BBOX="BBOX";OpenLayers.Filter.Spatial.INTERSECTS="INTERSECTS";OpenLayers.Filter.Spatial.DWITHIN="DWITHIN";OpenLayers.Filter.Spatial.WITHIN="WITHIN";OpenLayers.Filter.Spatial.CONTAINS="CONTAINS";
OpenLayers.Filter.FeatureId=OpenLayers.Class(OpenLayers.Filter,{fids:null,type:"FID",initialize:function(a){this.fids=[];OpenLayers.Filter.prototype.initialize.apply(this,[a])},evaluate:function(a){for(var b=0,c=this.fids.length;b<c;b++)if((a.fid||a.id)==this.fids[b])return!0;return!1},clone:function(){var a=new OpenLayers.Filter.FeatureId;OpenLayers.Util.extend(a,this);a.fids=this.fids.slice();return a},CLASS_NAME:"OpenLayers.Filter.FeatureId"});
OpenLayers.Format.WFST.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",wfs:"http://www.opengis.net/wfs",gml:"http://www.opengis.net/gml",ogc:"http://www.opengis.net/ogc",ows:"http://www.opengis.net/ows"},defaultPrefix:"wfs",version:null,schemaLocations:null,srsName:null,extractAttributes:!0,xy:!0,stateName:null,initialize:function(a){this.stateName={};this.stateName[OpenLayers.State.INSERT]="wfs:Insert";this.stateName[OpenLayers.State.UPDATE]=
"wfs:Update";this.stateName[OpenLayers.State.DELETE]="wfs:Delete";OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},getSrsName:function(a,b){var c=b&&b.srsName;c||(c=a&&a.layer?a.layer.projection.getCode():this.srsName);return c},read:function(a,b){b=b||{};OpenLayers.Util.applyDefaults(b,{output:"features"});"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&&9==a.nodeType&&(a=a.documentElement);var c={};a&&this.readNode(a,c,!0);c.features&&"features"===b.output&&
(c=c.features);return c},readers:{wfs:{FeatureCollection:function(a,b){b.features=[];this.readChildNodes(a,b)}}},write:function(a,b){var c=this.writeNode("wfs:Transaction",{features:a,options:b}),d=this.schemaLocationAttr();d&&this.setAttributeNS(c,this.namespaces.xsi,"xsi:schemaLocation",d);return OpenLayers.Format.XML.prototype.write.apply(this,[c])},writers:{wfs:{GetFeature:function(a){var b=this.createElementNSPlus("wfs:GetFeature",{attributes:{service:"WFS",version:this.version,handle:a&&a.handle,
outputFormat:a&&a.outputFormat,maxFeatures:a&&a.maxFeatures,"xsi:schemaLocation":this.schemaLocationAttr(a)}});if("string"==typeof this.featureType)this.writeNode("Query",a,b);else for(var c=0,d=this.featureType.length;c<d;c++)a.featureType=this.featureType[c],this.writeNode("Query",a,b);return b},Transaction:function(a){var a=a||{},b=a.options||{},c=this.createElementNSPlus("wfs:Transaction",{attributes:{service:"WFS",version:this.version,handle:b.handle}}),d,e=a.features;if(e){!0===b.multi&&OpenLayers.Util.extend(this.geometryTypes,
{"OpenLayers.Geometry.Point":"MultiPoint","OpenLayers.Geometry.LineString":!0===this.multiCurve?"MultiCurve":"MultiLineString","OpenLayers.Geometry.Polygon":!0===this.multiSurface?"MultiSurface":"MultiPolygon"});var f,g,a=0;for(d=e.length;a<d;++a)g=e[a],(f=this.stateName[g.state])&&this.writeNode(f,{feature:g,options:b},c);!0===b.multi&&this.setGeometryTypes()}if(b.nativeElements){a=0;for(d=b.nativeElements.length;a<d;++a)this.writeNode("wfs:Native",b.nativeElements[a],c)}return c},Native:function(a){return this.createElementNSPlus("wfs:Native",
{attributes:{vendorId:a.vendorId,safeToIgnore:a.safeToIgnore},value:a.value})},Insert:function(a){var b=a.feature,a=a.options,a=this.createElementNSPlus("wfs:Insert",{attributes:{handle:a&&a.handle}});this.srsName=this.getSrsName(b);this.writeNode("feature:_typeName",b,a);return a},Update:function(a){var b=a.feature,a=a.options,a=this.createElementNSPlus("wfs:Update",{attributes:{handle:a&&a.handle,typeName:(this.featureNS?this.featurePrefix+":":"")+this.featureType}});this.featureNS&&a.setAttribute("xmlns:"+
this.featurePrefix,this.featureNS);var c=b.modified;if(null!==this.geometryName&&(!c||void 0!==c.geometry))this.srsName=this.getSrsName(b),this.writeNode("Property",{name:this.geometryName,value:b.geometry},a);for(var d in b.attributes)void 0!==b.attributes[d]&&(!c||!c.attributes||c.attributes&&void 0!==c.attributes[d])&&this.writeNode("Property",{name:d,value:b.attributes[d]},a);this.writeNode("ogc:Filter",new OpenLayers.Filter.FeatureId({fids:[b.fid]}),a);return a},Property:function(a){var b=this.createElementNSPlus("wfs:Property");
this.writeNode("Name",a.name,b);null!==a.value&&this.writeNode("Value",a.value,b);return b},Name:function(a){return this.createElementNSPlus("wfs:Name",{value:a})},Value:function(a){var b;a instanceof OpenLayers.Geometry?(b=this.createElementNSPlus("wfs:Value"),a=this.writeNode("feature:_geometry",a).firstChild,b.appendChild(a)):b=this.createElementNSPlus("wfs:Value",{value:a});return b},Delete:function(a){var b=a.feature,a=a.options,a=this.createElementNSPlus("wfs:Delete",{attributes:{handle:a&&
a.handle,typeName:(this.featureNS?this.featurePrefix+":":"")+this.featureType}});this.featureNS&&a.setAttribute("xmlns:"+this.featurePrefix,this.featureNS);this.writeNode("ogc:Filter",new OpenLayers.Filter.FeatureId({fids:[b.fid]}),a);return a}}},schemaLocationAttr:function(a){var a=OpenLayers.Util.extend({featurePrefix:this.featurePrefix,schema:this.schema},a),b=OpenLayers.Util.extend({},this.schemaLocations);a.schema&&(b[a.featurePrefix]=a.schema);var a=[],c,d;for(d in b)(c=this.namespaces[d])&&
a.push(c+" "+b[d]);return a.join(" ")||void 0},setFilterProperty:function(a){if(a.filters)for(var b=0,c=a.filters.length;b<c;++b)OpenLayers.Format.WFST.v1.prototype.setFilterProperty.call(this,a.filters[b]);else a instanceof OpenLayers.Filter.Spatial&&!a.property&&(a.property=this.geometryName)},CLASS_NAME:"OpenLayers.Format.WFST.v1"});
OpenLayers.Format.OGCExceptionReport=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ogc:"http://www.opengis.net/ogc"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},defaultPrefix:"ogc",read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b={exceptionReport:null};a.documentElement&&(this.readChildNodes(a,b),null===b.exceptionReport&&(b=(new OpenLayers.Format.OWSCommon).read(a)));return b},readers:{ogc:{ServiceExceptionReport:function(a,
b){b.exceptionReport={exceptions:[]};this.readChildNodes(a,b.exceptionReport)},ServiceException:function(a,b){var c={code:a.getAttribute("code"),locator:a.getAttribute("locator"),text:this.getChildValue(a)};b.exceptions.push(c)}}},CLASS_NAME:"OpenLayers.Format.OGCExceptionReport"});
OpenLayers.Format.XML.VersionedOGC=OpenLayers.Class(OpenLayers.Format.XML,{defaultVersion:null,version:null,profile:null,allowFallback:!1,name:null,stringifyOutput:!1,parser:null,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]);a=this.CLASS_NAME;this.name=a.substring(a.lastIndexOf(".")+1)},getVersion:function(a,b){var c;a?(c=this.version,c||(c=a.getAttribute("version"),c||(c=this.defaultVersion))):c=b&&b.version||this.version||this.defaultVersion;return c},getParser:function(a){var a=
a||this.defaultVersion,b=this.profile?"_"+this.profile:"";if(!this.parser||this.parser.VERSION!=a){var c=OpenLayers.Format[this.name]["v"+a.replace(/\./g,"_")+b];if(!c&&(""!==b&&this.allowFallback&&(b="",c=OpenLayers.Format[this.name]["v"+a.replace(/\./g,"_")]),!c))throw"Can't find a "+this.name+" parser for version "+a+b;this.parser=new c(this.options)}return this.parser},write:function(a,b){var c=this.getVersion(null,b);this.parser=this.getParser(c);c=this.parser.write(a,b);return!1===this.stringifyOutput?
c:OpenLayers.Format.XML.prototype.write.apply(this,[c])},read:function(a,b){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var c=this.getVersion(a.documentElement);this.parser=this.getParser(c);var d=this.parser.read(a,b),e=this.parser.errorProperty||null;null!==e&&void 0===d[e]&&(e=new OpenLayers.Format.OGCExceptionReport,d.error=e.read(a));d.version=c;return d},CLASS_NAME:"OpenLayers.Format.XML.VersionedOGC"});
OpenLayers.Filter.Logical=OpenLayers.Class(OpenLayers.Filter,{filters:null,type:null,initialize:function(a){this.filters=[];OpenLayers.Filter.prototype.initialize.apply(this,[a])},destroy:function(){this.filters=null;OpenLayers.Filter.prototype.destroy.apply(this)},evaluate:function(a){var b,c;switch(this.type){case OpenLayers.Filter.Logical.AND:b=0;for(c=this.filters.length;b<c;b++)if(!1==this.filters[b].evaluate(a))return!1;return!0;case OpenLayers.Filter.Logical.OR:b=0;for(c=this.filters.length;b<
c;b++)if(!0==this.filters[b].evaluate(a))return!0;return!1;case OpenLayers.Filter.Logical.NOT:return!this.filters[0].evaluate(a)}},clone:function(){for(var a=[],b=0,c=this.filters.length;b<c;++b)a.push(this.filters[b].clone());return new OpenLayers.Filter.Logical({type:this.type,filters:a})},CLASS_NAME:"OpenLayers.Filter.Logical"});OpenLayers.Filter.Logical.AND="&&";OpenLayers.Filter.Logical.OR="||";OpenLayers.Filter.Logical.NOT="!";
OpenLayers.Filter.Comparison=OpenLayers.Class(OpenLayers.Filter,{type:null,property:null,value:null,matchCase:!0,lowerBoundary:null,upperBoundary:null,initialize:function(a){OpenLayers.Filter.prototype.initialize.apply(this,[a]);this.type===OpenLayers.Filter.Comparison.LIKE&&void 0===a.matchCase&&(this.matchCase=null)},evaluate:function(a){a instanceof OpenLayers.Feature.Vector&&(a=a.attributes);var b=!1,a=a[this.property];switch(this.type){case OpenLayers.Filter.Comparison.EQUAL_TO:b=this.value;
b=!this.matchCase&&"string"==typeof a&&"string"==typeof b?a.toUpperCase()==b.toUpperCase():a==b;break;case OpenLayers.Filter.Comparison.NOT_EQUAL_TO:b=this.value;b=!this.matchCase&&"string"==typeof a&&"string"==typeof b?a.toUpperCase()!=b.toUpperCase():a!=b;break;case OpenLayers.Filter.Comparison.LESS_THAN:b=a<this.value;break;case OpenLayers.Filter.Comparison.GREATER_THAN:b=a>this.value;break;case OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO:b=a<=this.value;break;case OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO:b=
a>=this.value;break;case OpenLayers.Filter.Comparison.BETWEEN:b=a>=this.lowerBoundary&&a<=this.upperBoundary;break;case OpenLayers.Filter.Comparison.LIKE:b=RegExp(this.value,"gi").test(a);break;case OpenLayers.Filter.Comparison.IS_NULL:b=null===a}return b},value2regex:function(a,b,c){if("."==a)throw Error("'.' is an unsupported wildCard character for OpenLayers.Filter.Comparison");a=a?a:"*";b=b?b:".";this.value=this.value.replace(RegExp("\\"+(c?c:"!")+"(.|$)","g"),"\\$1");this.value=this.value.replace(RegExp("\\"+
b,"g"),".");this.value=this.value.replace(RegExp("\\"+a,"g"),".*");this.value=this.value.replace(RegExp("\\\\.\\*","g"),"\\"+a);return this.value=this.value.replace(RegExp("\\\\\\.","g"),"\\"+b)},regex2value:function(){var a=this.value,a=a.replace(/!/g,"!!"),a=a.replace(/(\\)?\\\./g,function(a,c){return c?a:"!."}),a=a.replace(/(\\)?\\\*/g,function(a,c){return c?a:"!*"}),a=a.replace(/\\\\/g,"\\");return a=a.replace(/\.\*/g,"*")},clone:function(){return OpenLayers.Util.extend(new OpenLayers.Filter.Comparison,
this)},CLASS_NAME:"OpenLayers.Filter.Comparison"});OpenLayers.Filter.Comparison.EQUAL_TO="==";OpenLayers.Filter.Comparison.NOT_EQUAL_TO="!=";OpenLayers.Filter.Comparison.LESS_THAN="<";OpenLayers.Filter.Comparison.GREATER_THAN=">";OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO="<=";OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO=">=";OpenLayers.Filter.Comparison.BETWEEN="..";OpenLayers.Filter.Comparison.LIKE="~";OpenLayers.Filter.Comparison.IS_NULL="NULL";
OpenLayers.Format.Filter=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",CLASS_NAME:"OpenLayers.Format.Filter"});OpenLayers.Filter.Function=OpenLayers.Class(OpenLayers.Filter,{name:null,params:null,CLASS_NAME:"OpenLayers.Filter.Function"});
OpenLayers.Date={dateRegEx:/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:(?:T(\d{1,2}):(\d{2}):(\d{2}(?:\.\d+)?)(Z|(?:[+-]\d{1,2}(?::(\d{2}))?)))|Z)?$/,toISOString:function(){return"toISOString"in Date.prototype?function(a){return a.toISOString()}:function(a){return isNaN(a.getTime())?"Invalid Date":a.getUTCFullYear()+"-"+OpenLayers.Number.zeroPad(a.getUTCMonth()+1,2)+"-"+OpenLayers.Number.zeroPad(a.getUTCDate(),2)+"T"+OpenLayers.Number.zeroPad(a.getUTCHours(),2)+":"+OpenLayers.Number.zeroPad(a.getUTCMinutes(),
2)+":"+OpenLayers.Number.zeroPad(a.getUTCSeconds(),2)+"."+OpenLayers.Number.zeroPad(a.getUTCMilliseconds(),3)+"Z"}}(),parse:function(a){var b;if((a=a.match(this.dateRegEx))&&(a[1]||a[7])){b=parseInt(a[1],10)||0;var c=parseInt(a[2],10)-1||0,d=parseInt(a[3],10)||1;b=new Date(Date.UTC(b,c,d));if(c=a[7]){var d=parseInt(a[4],10),e=parseInt(a[5],10),f=parseFloat(a[6]),g=f|0,f=Math.round(1E3*(f-g));b.setUTCHours(d,e,g,f);"Z"!==c&&(c=parseInt(c,10),a=parseInt(a[8],10)||0,b=new Date(b.getTime()+-1E3*(60*60*
c+60*a)))}}else b=new Date("invalid");return b}};
OpenLayers.Format.Filter.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ogc:"http://www.opengis.net/ogc",gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"ogc",schemaLocation:null,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){var b={};this.readers.ogc.Filter.apply(this,[a,b]);return b.filter},readers:{ogc:{_expression:function(a){for(var b="",c=a.firstChild;c;c=
c.nextSibling)switch(c.nodeType){case 1:a=this.readNode(c);a.property?b+="${"+a.property+"}":void 0!==a.value&&(b+=a.value);break;case 3:case 4:b+=c.nodeValue}return b},Filter:function(a,b){var c={fids:[],filters:[]};this.readChildNodes(a,c);0<c.fids.length?b.filter=new OpenLayers.Filter.FeatureId({fids:c.fids}):0<c.filters.length&&(b.filter=c.filters[0])},FeatureId:function(a,b){var c=a.getAttribute("fid");c&&b.fids.push(c)},And:function(a,b){var c=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND});
this.readChildNodes(a,c);b.filters.push(c)},Or:function(a,b){var c=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.OR});this.readChildNodes(a,c);b.filters.push(c)},Not:function(a,b){var c=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.NOT});this.readChildNodes(a,c);b.filters.push(c)},PropertyIsLessThan:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LESS_THAN});this.readChildNodes(a,c);b.filters.push(c)},PropertyIsGreaterThan:function(a,
b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.GREATER_THAN});this.readChildNodes(a,c);b.filters.push(c)},PropertyIsLessThanOrEqualTo:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO});this.readChildNodes(a,c);b.filters.push(c)},PropertyIsGreaterThanOrEqualTo:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO});this.readChildNodes(a,c);b.filters.push(c)},
PropertyIsBetween:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.BETWEEN});this.readChildNodes(a,c);b.filters.push(c)},Literal:function(a,b){b.value=OpenLayers.String.numericIf(this.getChildValue(a),!0)},PropertyName:function(a,b){b.property=this.getChildValue(a)},LowerBoundary:function(a,b){b.lowerBoundary=OpenLayers.String.numericIf(this.readers.ogc._expression.call(this,a),!0)},UpperBoundary:function(a,b){b.upperBoundary=OpenLayers.String.numericIf(this.readers.ogc._expression.call(this,
a),!0)},Intersects:function(a,b){this.readSpatial(a,b,OpenLayers.Filter.Spatial.INTERSECTS)},Within:function(a,b){this.readSpatial(a,b,OpenLayers.Filter.Spatial.WITHIN)},Contains:function(a,b){this.readSpatial(a,b,OpenLayers.Filter.Spatial.CONTAINS)},DWithin:function(a,b){this.readSpatial(a,b,OpenLayers.Filter.Spatial.DWITHIN)},Distance:function(a,b){b.distance=parseInt(this.getChildValue(a));b.distanceUnits=a.getAttribute("units")},Function:function(){},PropertyIsNull:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.IS_NULL});
this.readChildNodes(a,c);b.filters.push(c)}}},readSpatial:function(a,b,c){c=new OpenLayers.Filter.Spatial({type:c});this.readChildNodes(a,c);c.value=c.components[0];delete c.components;b.filters.push(c)},encodeLiteral:function(a){a instanceof Date&&(a=OpenLayers.Date.toISOString(a));return a},writeOgcExpression:function(a,b){a instanceof OpenLayers.Filter.Function?this.writeNode("Function",a,b):this.writeNode("Literal",a,b);return b},write:function(a){return this.writers.ogc.Filter.apply(this,[a])},
writers:{ogc:{Filter:function(a){var b=this.createElementNSPlus("ogc:Filter");this.writeNode(this.getFilterType(a),a,b);return b},_featureIds:function(a){for(var b=this.createDocumentFragment(),c=0,d=a.fids.length;c<d;++c)this.writeNode("ogc:FeatureId",a.fids[c],b);return b},FeatureId:function(a){return this.createElementNSPlus("ogc:FeatureId",{attributes:{fid:a}})},And:function(a){for(var b=this.createElementNSPlus("ogc:And"),c,d=0,e=a.filters.length;d<e;++d)c=a.filters[d],this.writeNode(this.getFilterType(c),
c,b);return b},Or:function(a){for(var b=this.createElementNSPlus("ogc:Or"),c,d=0,e=a.filters.length;d<e;++d)c=a.filters[d],this.writeNode(this.getFilterType(c),c,b);return b},Not:function(a){var b=this.createElementNSPlus("ogc:Not"),a=a.filters[0];this.writeNode(this.getFilterType(a),a,b);return b},PropertyIsLessThan:function(a){var b=this.createElementNSPlus("ogc:PropertyIsLessThan");this.writeNode("PropertyName",a,b);this.writeOgcExpression(a.value,b);return b},PropertyIsGreaterThan:function(a){var b=
this.createElementNSPlus("ogc:PropertyIsGreaterThan");this.writeNode("PropertyName",a,b);this.writeOgcExpression(a.value,b);return b},PropertyIsLessThanOrEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsLessThanOrEqualTo");this.writeNode("PropertyName",a,b);this.writeOgcExpression(a.value,b);return b},PropertyIsGreaterThanOrEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsGreaterThanOrEqualTo");this.writeNode("PropertyName",a,b);this.writeOgcExpression(a.value,b);
return b},PropertyIsBetween:function(a){var b=this.createElementNSPlus("ogc:PropertyIsBetween");this.writeNode("PropertyName",a,b);this.writeNode("LowerBoundary",a,b);this.writeNode("UpperBoundary",a,b);return b},PropertyName:function(a){return this.createElementNSPlus("ogc:PropertyName",{value:a.property})},Literal:function(a){return this.createElementNSPlus("ogc:Literal",{value:(this.encodeLiteral||OpenLayers.Format.Filter.v1.prototype.encodeLiteral)(a)})},LowerBoundary:function(a){var b=this.createElementNSPlus("ogc:LowerBoundary");
this.writeOgcExpression(a.lowerBoundary,b);return b},UpperBoundary:function(a){var b=this.createElementNSPlus("ogc:UpperBoundary");this.writeNode("Literal",a.upperBoundary,b);return b},INTERSECTS:function(a){return this.writeSpatial(a,"Intersects")},WITHIN:function(a){return this.writeSpatial(a,"Within")},CONTAINS:function(a){return this.writeSpatial(a,"Contains")},DWITHIN:function(a){var b=this.writeSpatial(a,"DWithin");this.writeNode("Distance",a,b);return b},Distance:function(a){return this.createElementNSPlus("ogc:Distance",
{attributes:{units:a.distanceUnits},value:a.distance})},Function:function(a){for(var b=this.createElementNSPlus("ogc:Function",{attributes:{name:a.name}}),a=a.params,c=0,d=a.length;c<d;c++)this.writeOgcExpression(a[c],b);return b},PropertyIsNull:function(a){var b=this.createElementNSPlus("ogc:PropertyIsNull");this.writeNode("PropertyName",a,b);return b}}},getFilterType:function(a){var b=this.filterMap[a.type];if(!b)throw"Filter writing not supported for rule type: "+a.type;return b},filterMap:{"&&":"And",
"||":"Or","!":"Not","==":"PropertyIsEqualTo","!=":"PropertyIsNotEqualTo","<":"PropertyIsLessThan",">":"PropertyIsGreaterThan","<=":"PropertyIsLessThanOrEqualTo",">=":"PropertyIsGreaterThanOrEqualTo","..":"PropertyIsBetween","~":"PropertyIsLike",NULL:"PropertyIsNull",BBOX:"BBOX",DWITHIN:"DWITHIN",WITHIN:"WITHIN",CONTAINS:"CONTAINS",INTERSECTS:"INTERSECTS",FID:"_featureIds"},CLASS_NAME:"OpenLayers.Format.Filter.v1"});
OpenLayers.Geometry=OpenLayers.Class({id:null,parent:null,bounds:null,initialize:function(){this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){this.bounds=this.id=null},clone:function(){return new OpenLayers.Geometry},setBounds:function(a){a&&(this.bounds=a.clone())},clearBounds:function(){this.bounds=null;this.parent&&this.parent.clearBounds()},extendBounds:function(a){this.getBounds()?this.bounds.extend(a):this.setBounds(a)},getBounds:function(){null==this.bounds&&this.calculateBounds();
return this.bounds},calculateBounds:function(){},distanceTo:function(){},getVertices:function(){},atPoint:function(a,b,c){var d=!1;null!=this.getBounds()&&null!=a&&(b=null!=b?b:0,c=null!=c?c:0,d=(new OpenLayers.Bounds(this.bounds.left-b,this.bounds.bottom-c,this.bounds.right+b,this.bounds.top+c)).containsLonLat(a));return d},getLength:function(){return 0},getArea:function(){return 0},getCentroid:function(){return null},toString:function(){return OpenLayers.Format&&OpenLayers.Format.WKT?OpenLayers.Format.WKT.prototype.write(new OpenLayers.Feature.Vector(this)):
Object.prototype.toString.call(this)},CLASS_NAME:"OpenLayers.Geometry"});OpenLayers.Geometry.fromWKT=function(a){var b;if(OpenLayers.Format&&OpenLayers.Format.WKT){var c=OpenLayers.Geometry.fromWKT.format;c||(c=new OpenLayers.Format.WKT,OpenLayers.Geometry.fromWKT.format=c);a=c.read(a);if(a instanceof OpenLayers.Feature.Vector)b=a.geometry;else if(OpenLayers.Util.isArray(a)){b=a.length;for(var c=Array(b),d=0;d<b;++d)c[d]=a[d].geometry;b=new OpenLayers.Geometry.Collection(c)}}return b};
OpenLayers.Geometry.segmentsIntersect=function(a,b,c){var d=c&&c.point,c=c&&c.tolerance,e=!1,f=a.x1-b.x1,g=a.y1-b.y1,h=a.x2-a.x1,j=a.y2-a.y1,n=b.y2-b.y1,p=b.x2-b.x1,q=n*h-p*j,n=p*g-n*f,g=h*g-j*f;0==q?0==n&&0==g&&(e=!0):(f=n/q,q=g/q,0<=f&&(1>=f&&0<=q&&1>=q)&&(d?(h=a.x1+f*h,q=a.y1+f*j,e=new OpenLayers.Geometry.Point(h,q)):e=!0));if(c)if(e){if(d){a=[a,b];b=0;a:for(;2>b;++b){f=a[b];for(j=1;3>j;++j)if(h=f["x"+j],q=f["y"+j],d=Math.sqrt(Math.pow(h-e.x,2)+Math.pow(q-e.y,2)),d<c){e.x=h;e.y=q;break a}}}}else{a=
[a,b];b=0;a:for(;2>b;++b){h=a[b];q=a[(b+1)%2];for(j=1;3>j;++j)if(f={x:h["x"+j],y:h["y"+j]},g=OpenLayers.Geometry.distanceToSegment(f,q),g.distance<c){e=d?new OpenLayers.Geometry.Point(f.x,f.y):!0;break a}}}return e};OpenLayers.Geometry.distanceToSegment=function(a,b){var c=OpenLayers.Geometry.distanceSquaredToSegment(a,b);c.distance=Math.sqrt(c.distance);return c};
OpenLayers.Geometry.distanceSquaredToSegment=function(a,b){var c=a.x,d=a.y,e=b.x1,f=b.y1,g=b.x2,h=b.y2,j=g-e,n=h-f,p=(j*(c-e)+n*(d-f))/(Math.pow(j,2)+Math.pow(n,2));0>=p||(1<=p?(e=g,f=h):(e+=p*j,f+=p*n));return{distance:Math.pow(e-c,2)+Math.pow(f-d,2),x:e,y:f,along:p}};
OpenLayers.Geometry.Point=OpenLayers.Class(OpenLayers.Geometry,{x:null,y:null,initialize:function(a,b){OpenLayers.Geometry.prototype.initialize.apply(this,arguments);this.x=parseFloat(a);this.y=parseFloat(b)},clone:function(a){null==a&&(a=new OpenLayers.Geometry.Point(this.x,this.y));OpenLayers.Util.applyDefaults(a,this);return a},calculateBounds:function(){this.bounds=new OpenLayers.Bounds(this.x,this.y,this.x,this.y)},distanceTo:function(a,b){var c=!(b&&!1===b.edge)&&b&&b.details,d,e,f,g,h;a instanceof
OpenLayers.Geometry.Point?(e=this.x,f=this.y,g=a.x,h=a.y,d=Math.sqrt(Math.pow(e-g,2)+Math.pow(f-h,2)),d=!c?d:{x0:e,y0:f,x1:g,y1:h,distance:d}):(d=a.distanceTo(this,b),c&&(d={x0:d.x1,y0:d.y1,x1:d.x0,y1:d.y0,distance:d.distance}));return d},equals:function(a){var b=!1;null!=a&&(b=this.x==a.x&&this.y==a.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(a.x)&&isNaN(a.y));return b},toShortString:function(){return this.x+", "+this.y},move:function(a,b){this.x+=a;this.y+=b;this.clearBounds()},rotate:function(a,b){var a=
a*(Math.PI/180),c=this.distanceTo(b),d=a+Math.atan2(this.y-b.y,this.x-b.x);this.x=b.x+c*Math.cos(d);this.y=b.y+c*Math.sin(d);this.clearBounds()},getCentroid:function(){return new OpenLayers.Geometry.Point(this.x,this.y)},resize:function(a,b,c){this.x=b.x+a*(void 0==c?1:c)*(this.x-b.x);this.y=b.y+a*(this.y-b.y);this.clearBounds();return this},intersects:function(a){var b=!1;return b="OpenLayers.Geometry.Point"==a.CLASS_NAME?this.equals(a):a.intersects(this)},transform:function(a,b){a&&b&&(OpenLayers.Projection.transform(this,
a,b),this.bounds=null);return this},getVertices:function(){return[this]},CLASS_NAME:"OpenLayers.Geometry.Point"});
OpenLayers.Geometry.Collection=OpenLayers.Class(OpenLayers.Geometry,{components:null,componentTypes:null,initialize:function(a){OpenLayers.Geometry.prototype.initialize.apply(this,arguments);this.components=[];null!=a&&this.addComponents(a)},destroy:function(){this.components.length=0;this.components=null;OpenLayers.Geometry.prototype.destroy.apply(this,arguments)},clone:function(){for(var a=eval("new "+this.CLASS_NAME+"()"),b=0,c=this.components.length;b<c;b++)a.addComponent(this.components[b].clone());
OpenLayers.Util.applyDefaults(a,this);return a},getComponentsString:function(){for(var a=[],b=0,c=this.components.length;b<c;b++)a.push(this.components[b].toShortString());return a.join(",")},calculateBounds:function(){this.bounds=null;var a=new OpenLayers.Bounds,b=this.components;if(b)for(var c=0,d=b.length;c<d;c++)a.extend(b[c].getBounds());null!=a.left&&(null!=a.bottom&&null!=a.right&&null!=a.top)&&this.setBounds(a)},addComponents:function(a){OpenLayers.Util.isArray(a)||(a=[a]);for(var b=0,c=a.length;b<
c;b++)this.addComponent(a[b])},addComponent:function(a,b){var c=!1;if(a&&(null==this.componentTypes||-1<OpenLayers.Util.indexOf(this.componentTypes,a.CLASS_NAME))){if(null!=b&&b<this.components.length){var c=this.components.slice(0,b),d=this.components.slice(b,this.components.length);c.push(a);this.components=c.concat(d)}else this.components.push(a);a.parent=this;this.clearBounds();c=!0}return c},removeComponents:function(a){var b=!1;OpenLayers.Util.isArray(a)||(a=[a]);for(var c=a.length-1;0<=c;--c)b=
this.removeComponent(a[c])||b;return b},removeComponent:function(a){OpenLayers.Util.removeItem(this.components,a);this.clearBounds();return!0},getLength:function(){for(var a=0,b=0,c=this.components.length;b<c;b++)a+=this.components[b].getLength();return a},getArea:function(){for(var a=0,b=0,c=this.components.length;b<c;b++)a+=this.components[b].getArea();return a},getGeodesicArea:function(a){for(var b=0,c=0,d=this.components.length;c<d;c++)b+=this.components[c].getGeodesicArea(a);return b},getCentroid:function(a){if(!a)return this.components.length&&
this.components[0].getCentroid();a=this.components.length;if(!a)return!1;for(var b=[],c=[],d=0,e=Number.MAX_VALUE,f,g=0;g<a;++g){f=this.components[g];var h=f.getArea();f=f.getCentroid(!0);!isNaN(h)&&(!isNaN(f.x)&&!isNaN(f.y))&&(b.push(h),d+=h,e=h<e&&0<h?h:e,c.push(f))}a=b.length;if(0===d){for(g=0;g<a;++g)b[g]=1;d=b.length}else{for(g=0;g<a;++g)b[g]/=e;d/=e}for(var j=e=0,g=0;g<a;++g)f=c[g],h=b[g],e+=f.x*h,j+=f.y*h;return new OpenLayers.Geometry.Point(e/d,j/d)},getGeodesicLength:function(a){for(var b=
0,c=0,d=this.components.length;c<d;c++)b+=this.components[c].getGeodesicLength(a);return b},move:function(a,b){for(var c=0,d=this.components.length;c<d;c++)this.components[c].move(a,b)},rotate:function(a,b){for(var c=0,d=this.components.length;c<d;++c)this.components[c].rotate(a,b)},resize:function(a,b,c){for(var d=0;d<this.components.length;++d)this.components[d].resize(a,b,c);return this},distanceTo:function(a,b){for(var c=!(b&&!1===b.edge)&&b&&b.details,d,e,f,g=Number.POSITIVE_INFINITY,h=0,j=this.components.length;h<
j&&!(d=this.components[h].distanceTo(a,b),f=c?d.distance:d,f<g&&(g=f,e=d,0==g));++h);return e},equals:function(a){var b=!0;if(!a||!a.CLASS_NAME||this.CLASS_NAME!=a.CLASS_NAME)b=!1;else if(!OpenLayers.Util.isArray(a.components)||a.components.length!=this.components.length)b=!1;else for(var c=0,d=this.components.length;c<d;++c)if(!this.components[c].equals(a.components[c])){b=!1;break}return b},transform:function(a,b){if(a&&b){for(var c=0,d=this.components.length;c<d;c++)this.components[c].transform(a,
b);this.bounds=null}return this},intersects:function(a){for(var b=!1,c=0,d=this.components.length;c<d&&!(b=a.intersects(this.components[c]));++c);return b},getVertices:function(a){for(var b=[],c=0,d=this.components.length;c<d;++c)Array.prototype.push.apply(b,this.components[c].getVertices(a));return b},CLASS_NAME:"OpenLayers.Geometry.Collection"});
OpenLayers.Geometry.MultiPoint=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.Point"],addPoint:function(a,b){this.addComponent(a,b)},removePoint:function(a){this.removeComponent(a)},CLASS_NAME:"OpenLayers.Geometry.MultiPoint"});
OpenLayers.Geometry.Curve=OpenLayers.Class(OpenLayers.Geometry.MultiPoint,{componentTypes:["OpenLayers.Geometry.Point"],getLength:function(){var a=0;if(this.components&&1<this.components.length)for(var b=1,c=this.components.length;b<c;b++)a+=this.components[b-1].distanceTo(this.components[b]);return a},getGeodesicLength:function(a){var b=this;if(a){var c=new OpenLayers.Projection("EPSG:4326");c.equals(a)||(b=this.clone().transform(a,c))}a=0;if(b.components&&1<b.components.length)for(var d,e=1,f=b.components.length;e<
f;e++)c=b.components[e-1],d=b.components[e],a+=OpenLayers.Util.distVincenty({lon:c.x,lat:c.y},{lon:d.x,lat:d.y});return 1E3*a},CLASS_NAME:"OpenLayers.Geometry.Curve"});
OpenLayers.Geometry.LineString=OpenLayers.Class(OpenLayers.Geometry.Curve,{removeComponent:function(a){var b=this.components&&2<this.components.length;b&&OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this,arguments);return b},intersects:function(a){var b=!1,c=a.CLASS_NAME;if("OpenLayers.Geometry.LineString"==c||"OpenLayers.Geometry.LinearRing"==c||"OpenLayers.Geometry.Point"==c){var d=this.getSortedSegments(),a="OpenLayers.Geometry.Point"==c?[{x1:a.x,y1:a.y,x2:a.x,y2:a.y}]:a.getSortedSegments(),
e,f,g,h,j,n,p,q=0,m=d.length;a:for(;q<m;++q){c=d[q];e=c.x1;f=c.x2;g=c.y1;h=c.y2;var r=0,s=a.length;for(;r<s;++r){j=a[r];if(j.x1>f)break;if(!(j.x2<e)&&(n=j.y1,p=j.y2,!(Math.min(n,p)>Math.max(g,h))&&!(Math.max(n,p)<Math.min(g,h))&&OpenLayers.Geometry.segmentsIntersect(c,j))){b=!0;break a}}}}else b=a.intersects(this);return b},getSortedSegments:function(){for(var a=this.components.length-1,b=Array(a),c,d,e=0;e<a;++e)c=this.components[e],d=this.components[e+1],b[e]=c.x<d.x?{x1:c.x,y1:c.y,x2:d.x,y2:d.y}:
{x1:d.x,y1:d.y,x2:c.x,y2:c.y};return b.sort(function(a,b){return a.x1-b.x1})},splitWithSegment:function(a,b){for(var c=!(b&&!1===b.edge),d=b&&b.tolerance,e=[],f=this.getVertices(),g=[],h=[],j=!1,n,p,q,m={point:!0,tolerance:d},r=null,s=0,t=f.length-2;s<=t;++s)if(d=f[s],g.push(d.clone()),n=f[s+1],p={x1:d.x,y1:d.y,x2:n.x,y2:n.y},p=OpenLayers.Geometry.segmentsIntersect(a,p,m),p instanceof OpenLayers.Geometry.Point&&((q=p.x===a.x1&&p.y===a.y1||p.x===a.x2&&p.y===a.y2||p.equals(d)||p.equals(n)?!0:!1)||c))p.equals(h[h.length-
1])||h.push(p.clone()),!(0===s&&p.equals(d))&&!p.equals(n)&&(j=!0,p.equals(d)||g.push(p),e.push(new OpenLayers.Geometry.LineString(g)),g=[p.clone()]);j&&(g.push(n.clone()),e.push(new OpenLayers.Geometry.LineString(g)));if(0<h.length)var v=a.x1<a.x2?1:-1,u=a.y1<a.y2?1:-1,r={lines:e,points:h.sort(function(a,b){return v*a.x-v*b.x||u*a.y-u*b.y})};return r},split:function(a,b){var c=null,d=b&&b.mutual,e,f,g,h;if(a instanceof OpenLayers.Geometry.LineString){var j=this.getVertices(),n,p,q,m,r,s=[];g=[];
for(var t=0,v=j.length-2;t<=v;++t){n=j[t];p=j[t+1];q={x1:n.x,y1:n.y,x2:p.x,y2:p.y};h=h||[a];d&&s.push(n.clone());for(var u=0;u<h.length;++u)if(m=h[u].splitWithSegment(q,b))if(r=m.lines,0<r.length&&(r.unshift(u,1),Array.prototype.splice.apply(h,r),u+=r.length-2),d)for(var w=0,y=m.points.length;w<y;++w)r=m.points[w],r.equals(n)||(s.push(r),g.push(new OpenLayers.Geometry.LineString(s)),s=r.equals(p)?[]:[r.clone()])}d&&(0<g.length&&0<s.length)&&(s.push(p.clone()),g.push(new OpenLayers.Geometry.LineString(s)))}else c=
a.splitWith(this,b);h&&1<h.length?f=!0:h=[];g&&1<g.length?e=!0:g=[];if(f||e)c=d?[g,h]:h;return c},splitWith:function(a,b){return a.split(this,b)},getVertices:function(a){return!0===a?[this.components[0],this.components[this.components.length-1]]:!1===a?this.components.slice(1,this.components.length-1):this.components.slice()},distanceTo:function(a,b){var c=!(b&&!1===b.edge)&&b&&b.details,d,e={},f=Number.POSITIVE_INFINITY;if(a instanceof OpenLayers.Geometry.Point){for(var g=this.getSortedSegments(),
h=a.x,j=a.y,n,p=0,q=g.length;p<q;++p)if(n=g[p],d=OpenLayers.Geometry.distanceToSegment(a,n),d.distance<f){if(f=d.distance,e=d,0===f)break}else if(n.x2>h&&(j>n.y1&&j<n.y2||j<n.y1&&j>n.y2))break;e=c?{distance:e.distance,x0:e.x,y0:e.y,x1:h,y1:j}:e.distance}else if(a instanceof OpenLayers.Geometry.LineString){var g=this.getSortedSegments(),h=a.getSortedSegments(),m,r,s=h.length,t={point:!0},p=0,q=g.length;a:for(;p<q;++p){j=g[p];n=j.x1;r=j.y1;for(var v=0;v<s;++v)if(d=h[v],m=OpenLayers.Geometry.segmentsIntersect(j,
d,t)){f=0;e={distance:0,x0:m.x,y0:m.y,x1:m.x,y1:m.y};break a}else d=OpenLayers.Geometry.distanceToSegment({x:n,y:r},d),d.distance<f&&(f=d.distance,e={distance:f,x0:n,y0:r,x1:d.x,y1:d.y})}c||(e=e.distance);0!==f&&j&&(d=a.distanceTo(new OpenLayers.Geometry.Point(j.x2,j.y2),b),p=c?d.distance:d,p<f&&(e=c?{distance:f,x0:d.x1,y0:d.y1,x1:d.x0,y1:d.y0}:p))}else e=a.distanceTo(this,b),c&&(e={distance:e.distance,x0:e.x1,y0:e.y1,x1:e.x0,y1:e.y0});return e},simplify:function(a){if(this&&null!==this){var b=this.getVertices();
if(3>b.length)return this;var c=function(a,b,d,j){for(var n=0,p=0,q=b,m;q<d;q++){m=a[b];var r=a[d],s=a[q],s=Math.abs(0.5*(m.x*r.y+r.x*s.y+s.x*m.y-r.x*m.y-s.x*r.y-m.x*s.y));m=Math.sqrt(Math.pow(m.x-r.x,2)+Math.pow(m.y-r.y,2));m=2*(s/m);m>n&&(n=m,p=q)}n>j&&p!=b&&(e.push(p),c(a,b,p,j),c(a,p,d,j))},d=b.length-1,e=[];e.push(0);for(e.push(d);b[0].equals(b[d]);)d--,e.push(d);c(b,0,d,a);a=[];e.sort(function(a,b){return a-b});for(d=0;d<e.length;d++)a.push(b[e[d]]);return new OpenLayers.Geometry.LineString(a)}return this},
CLASS_NAME:"OpenLayers.Geometry.LineString"});
OpenLayers.Geometry.MultiLineString=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.LineString"],split:function(a,b){for(var c=null,d=b&&b.mutual,e,f,g,h,j=[],n=[a],p=0,q=this.components.length;p<q;++p){f=this.components[p];g=!1;for(var m=0;m<n.length;++m)if(e=f.split(n[m],b)){if(d){g=e[0];for(var r=0,s=g.length;r<s;++r)0===r&&j.length?j[j.length-1].addComponent(g[r]):j.push(new OpenLayers.Geometry.MultiLineString([g[r]]));g=!0;e=e[1]}if(e.length){e.unshift(m,
1);Array.prototype.splice.apply(n,e);break}}g||(j.length?j[j.length-1].addComponent(f.clone()):j=[new OpenLayers.Geometry.MultiLineString(f.clone())])}j&&1<j.length?g=!0:j=[];n&&1<n.length?h=!0:n=[];if(g||h)c=d?[j,n]:n;return c},splitWith:function(a,b){var c=null,d=b&&b.mutual,e,f,g,h,j,n;if(a instanceof OpenLayers.Geometry.LineString){n=[];j=[a];for(var p=0,q=this.components.length;p<q;++p){g=!1;f=this.components[p];for(var m=0;m<j.length;++m)if(e=j[m].split(f,b)){d&&(g=e[0],g.length&&(g.unshift(m,
1),Array.prototype.splice.apply(j,g),m+=g.length-2),e=e[1],0===e.length&&(e=[f.clone()]));g=0;for(var r=e.length;g<r;++g)0===g&&n.length?n[n.length-1].addComponent(e[g]):n.push(new OpenLayers.Geometry.MultiLineString([e[g]]));g=!0}g||(n.length?n[n.length-1].addComponent(f.clone()):n=[new OpenLayers.Geometry.MultiLineString([f.clone()])])}}else c=a.split(this);j&&1<j.length?h=!0:j=[];n&&1<n.length?g=!0:n=[];if(h||g)c=d?[j,n]:n;return c},CLASS_NAME:"OpenLayers.Geometry.MultiLineString"});
OpenLayers.Geometry.LinearRing=OpenLayers.Class(OpenLayers.Geometry.LineString,{componentTypes:["OpenLayers.Geometry.Point"],addComponent:function(a,b){var c=!1,d=this.components.pop();if(null!=b||!a.equals(d))c=OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,arguments);OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,[this.components[0]]);return c},removeComponent:function(a){var b=this.components&&3<this.components.length;b&&(this.components.pop(),OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this,
arguments),OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,[this.components[0]]));return b},move:function(a,b){for(var c=0,d=this.components.length;c<d-1;c++)this.components[c].move(a,b)},rotate:function(a,b){for(var c=0,d=this.components.length;c<d-1;++c)this.components[c].rotate(a,b)},resize:function(a,b,c){for(var d=0,e=this.components.length;d<e-1;++d)this.components[d].resize(a,b,c);return this},transform:function(a,b){if(a&&b){for(var c=0,d=this.components.length;c<d-1;c++)this.components[c].transform(a,
b);this.bounds=null}return this},getCentroid:function(){if(this.components){var a=this.components.length;if(0<a&&2>=a)return this.components[0].clone();if(2<a){var b=0,c=0,d=this.components[0].x,e=this.components[0].y,f=-1*this.getArea();if(0!=f){for(var g=0;g<a-1;g++)var h=this.components[g],j=this.components[g+1],b=b+(h.x+j.x-2*d)*((h.x-d)*(j.y-e)-(j.x-d)*(h.y-e)),c=c+(h.y+j.y-2*e)*((h.x-d)*(j.y-e)-(j.x-d)*(h.y-e));b=d+b/(6*f);a=e+c/(6*f)}else{for(g=0;g<a-1;g++)b+=this.components[g].x,c+=this.components[g].y;
b/=a-1;a=c/(a-1)}return new OpenLayers.Geometry.Point(b,a)}return null}},getArea:function(){var a=0;if(this.components&&2<this.components.length){for(var b=a=0,c=this.components.length;b<c-1;b++)var d=this.components[b],e=this.components[b+1],a=a+(d.x+e.x)*(e.y-d.y);a=-a/2}return a},getGeodesicArea:function(a){var b=this;if(a){var c=new OpenLayers.Projection("EPSG:4326");c.equals(a)||(b=this.clone().transform(a,c))}a=0;c=b.components&&b.components.length;if(2<c){for(var d,e,f=0;f<c-1;f++)d=b.components[f],
e=b.components[f+1],a+=OpenLayers.Util.rad(e.x-d.x)*(2+Math.sin(OpenLayers.Util.rad(d.y))+Math.sin(OpenLayers.Util.rad(e.y)));a=40680631590769*a/2}return a},containsPoint:function(a){for(var b=OpenLayers.Number.limitSigDigs,c=b(a.x,14),a=b(a.y,14),d=this.components.length-1,e,f,g,h,j,n=0,p=0;p<d;++p)if(e=this.components[p],g=b(e.x,14),e=b(e.y,14),f=this.components[p+1],h=b(f.x,14),f=b(f.y,14),e==f){if(a==e&&(g<=h&&c>=g&&c<=h||g>=h&&c<=g&&c>=h)){n=-1;break}}else{j=b((a-f)*((h-g)/(f-e))+h,14);if(j==
c&&(e<f&&a>=e&&a<=f||e>f&&a<=e&&a>=f)){n=-1;break}j<=c||g!=h&&(j<Math.min(g,h)||j>Math.max(g,h))||(e<f&&a>=e&&a<f||e>f&&a<e&&a>=f)&&++n}return-1==n?1:!!(n&1)},intersects:function(a){var b=!1;if("OpenLayers.Geometry.Point"==a.CLASS_NAME)b=this.containsPoint(a);else if("OpenLayers.Geometry.LineString"==a.CLASS_NAME)b=a.intersects(this);else if("OpenLayers.Geometry.LinearRing"==a.CLASS_NAME)b=OpenLayers.Geometry.LineString.prototype.intersects.apply(this,[a]);else for(var c=0,d=a.components.length;c<
d&&!(b=a.components[c].intersects(this));++c);return b},getVertices:function(a){return!0===a?[]:this.components.slice(0,this.components.length-1)},CLASS_NAME:"OpenLayers.Geometry.LinearRing"});
OpenLayers.Geometry.Polygon=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.LinearRing"],getArea:function(){var a=0;if(this.components&&0<this.components.length)for(var a=a+Math.abs(this.components[0].getArea()),b=1,c=this.components.length;b<c;b++)a-=Math.abs(this.components[b].getArea());return a},getGeodesicArea:function(a){var b=0;if(this.components&&0<this.components.length)for(var b=b+Math.abs(this.components[0].getGeodesicArea(a)),c=1,d=this.components.length;c<
d;c++)b-=Math.abs(this.components[c].getGeodesicArea(a));return b},containsPoint:function(a){var b=this.components.length,c=!1;if(0<b&&(c=this.components[0].containsPoint(a),1!==c&&c&&1<b))for(var d,e=1;e<b;++e)if(d=this.components[e].containsPoint(a)){c=1===d?1:!1;break}return c},intersects:function(a){var b=!1,c,d;if("OpenLayers.Geometry.Point"==a.CLASS_NAME)b=this.containsPoint(a);else if("OpenLayers.Geometry.LineString"==a.CLASS_NAME||"OpenLayers.Geometry.LinearRing"==a.CLASS_NAME){c=0;for(d=
this.components.length;c<d&&!(b=a.intersects(this.components[c]));++c);if(!b){c=0;for(d=a.components.length;c<d&&!(b=this.containsPoint(a.components[c]));++c);}}else{c=0;for(d=a.components.length;c<d&&!(b=this.intersects(a.components[c]));++c);}if(!b&&"OpenLayers.Geometry.Polygon"==a.CLASS_NAME){var e=this.components[0];c=0;for(d=e.components.length;c<d&&!(b=a.containsPoint(e.components[c]));++c);}return b},distanceTo:function(a,b){return b&&!1===b.edge&&this.intersects(a)?0:OpenLayers.Geometry.Collection.prototype.distanceTo.apply(this,
[a,b])},CLASS_NAME:"OpenLayers.Geometry.Polygon"});OpenLayers.Geometry.Polygon.createRegularPolygon=function(a,b,c,d){var e=Math.PI*(1/c-0.5);d&&(e+=d/180*Math.PI);for(var f,g=[],h=0;h<c;++h)f=e+2*h*Math.PI/c,d=a.x+b*Math.cos(f),f=a.y+b*Math.sin(f),g.push(new OpenLayers.Geometry.Point(d,f));a=new OpenLayers.Geometry.LinearRing(g);return new OpenLayers.Geometry.Polygon([a])};
OpenLayers.Geometry.MultiPolygon=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.Polygon"],CLASS_NAME:"OpenLayers.Geometry.MultiPolygon"});
OpenLayers.Format.GML=OpenLayers.Class(OpenLayers.Format.XML,{featureNS:"http://mapserver.gis.umn.edu/mapserver",featurePrefix:"feature",featureName:"featureMember",layerName:"features",geometryName:"geometry",collectionName:"FeatureCollection",gmlns:"http://www.opengis.net/gml",extractAttributes:!0,xy:!0,initialize:function(a){this.regExes={trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g};OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){"string"==
typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));for(var a=this.getElementsByTagNameNS(a.documentElement,this.gmlns,this.featureName),b=[],c=0;c<a.length;c++){var d=this.parseFeature(a[c]);d&&b.push(d)}return b},parseFeature:function(a){for(var b="MultiPolygon Polygon MultiLineString LineString MultiPoint Point Envelope".split(" "),c,d,e,f=0;f<b.length;++f)if(c=b[f],d=this.getElementsByTagNameNS(a,this.gmlns,c),0<d.length){if(e=this.parseGeometry[c.toLowerCase()])e=e.apply(this,
[d[0]]),this.internalProjection&&this.externalProjection&&e.transform(this.externalProjection,this.internalProjection);else throw new TypeError("Unsupported geometry type: "+c);break}var g;c=this.getElementsByTagNameNS(a,this.gmlns,"Box");for(f=0;f<c.length;++f)b=c[f],d=this.parseGeometry.box.apply(this,[b]),b=b.parentNode,"boundedBy"===(b.localName||b.nodeName.split(":").pop())?g=d:e=d.toGeometry();var h;this.extractAttributes&&(h=this.parseAttributes(a));h=new OpenLayers.Feature.Vector(e,h);h.bounds=
g;h.gml={featureType:a.firstChild.nodeName.split(":")[1],featureNS:a.firstChild.namespaceURI,featureNSPrefix:a.firstChild.prefix};for(var a=a.firstChild,j;a&&!(1==a.nodeType&&(j=a.getAttribute("fid")||a.getAttribute("id")));)a=a.nextSibling;h.fid=j;return h},parseGeometry:{point:function(a){var b,c;c=[];b=this.getElementsByTagNameNS(a,this.gmlns,"pos");0<b.length&&(c=b[0].firstChild.nodeValue,c=c.replace(this.regExes.trimSpace,""),c=c.split(this.regExes.splitSpace));0==c.length&&(b=this.getElementsByTagNameNS(a,
this.gmlns,"coordinates"),0<b.length&&(c=b[0].firstChild.nodeValue,c=c.replace(this.regExes.removeSpace,""),c=c.split(",")));0==c.length&&(b=this.getElementsByTagNameNS(a,this.gmlns,"coord"),0<b.length&&(a=this.getElementsByTagNameNS(b[0],this.gmlns,"X"),b=this.getElementsByTagNameNS(b[0],this.gmlns,"Y"),0<a.length&&0<b.length&&(c=[a[0].firstChild.nodeValue,b[0].firstChild.nodeValue])));2==c.length&&(c[2]=null);return this.xy?new OpenLayers.Geometry.Point(c[0],c[1],c[2]):new OpenLayers.Geometry.Point(c[1],
c[0],c[2])},multipoint:function(a){var a=this.getElementsByTagNameNS(a,this.gmlns,"Point"),b=[];if(0<a.length)for(var c,d=0;d<a.length;++d)(c=this.parseGeometry.point.apply(this,[a[d]]))&&b.push(c);return new OpenLayers.Geometry.MultiPoint(b)},linestring:function(a,b){var c,d;d=[];var e=[];c=this.getElementsByTagNameNS(a,this.gmlns,"posList");if(0<c.length){d=this.getChildValue(c[0]);d=d.replace(this.regExes.trimSpace,"");d=d.split(this.regExes.splitSpace);var f=parseInt(c[0].getAttribute("dimension")),
g,h,j;for(c=0;c<d.length/f;++c)g=c*f,h=d[g],j=d[g+1],g=2==f?null:d[g+2],this.xy?e.push(new OpenLayers.Geometry.Point(h,j,g)):e.push(new OpenLayers.Geometry.Point(j,h,g))}if(0==d.length&&(c=this.getElementsByTagNameNS(a,this.gmlns,"coordinates"),0<c.length)){d=this.getChildValue(c[0]);d=d.replace(this.regExes.trimSpace,"");d=d.replace(this.regExes.trimComma,",");f=d.split(this.regExes.splitSpace);for(c=0;c<f.length;++c)d=f[c].split(","),2==d.length&&(d[2]=null),this.xy?e.push(new OpenLayers.Geometry.Point(d[0],
d[1],d[2])):e.push(new OpenLayers.Geometry.Point(d[1],d[0],d[2]))}d=null;0!=e.length&&(d=b?new OpenLayers.Geometry.LinearRing(e):new OpenLayers.Geometry.LineString(e));return d},multilinestring:function(a){var a=this.getElementsByTagNameNS(a,this.gmlns,"LineString"),b=[];if(0<a.length)for(var c,d=0;d<a.length;++d)(c=this.parseGeometry.linestring.apply(this,[a[d]]))&&b.push(c);return new OpenLayers.Geometry.MultiLineString(b)},polygon:function(a){var a=this.getElementsByTagNameNS(a,this.gmlns,"LinearRing"),
b=[];if(0<a.length)for(var c,d=0;d<a.length;++d)(c=this.parseGeometry.linestring.apply(this,[a[d],!0]))&&b.push(c);return new OpenLayers.Geometry.Polygon(b)},multipolygon:function(a){var a=this.getElementsByTagNameNS(a,this.gmlns,"Polygon"),b=[];if(0<a.length)for(var c,d=0;d<a.length;++d)(c=this.parseGeometry.polygon.apply(this,[a[d]]))&&b.push(c);return new OpenLayers.Geometry.MultiPolygon(b)},envelope:function(a){var b=[],c,d,e=this.getElementsByTagNameNS(a,this.gmlns,"lowerCorner");if(0<e.length){c=
[];0<e.length&&(c=e[0].firstChild.nodeValue,c=c.replace(this.regExes.trimSpace,""),c=c.split(this.regExes.splitSpace));2==c.length&&(c[2]=null);var f=this.xy?new OpenLayers.Geometry.Point(c[0],c[1],c[2]):new OpenLayers.Geometry.Point(c[1],c[0],c[2])}a=this.getElementsByTagNameNS(a,this.gmlns,"upperCorner");if(0<a.length){c=[];0<a.length&&(c=a[0].firstChild.nodeValue,c=c.replace(this.regExes.trimSpace,""),c=c.split(this.regExes.splitSpace));2==c.length&&(c[2]=null);var g=this.xy?new OpenLayers.Geometry.Point(c[0],
c[1],c[2]):new OpenLayers.Geometry.Point(c[1],c[0],c[2])}f&&g&&(b.push(new OpenLayers.Geometry.Point(f.x,f.y)),b.push(new OpenLayers.Geometry.Point(g.x,f.y)),b.push(new OpenLayers.Geometry.Point(g.x,g.y)),b.push(new OpenLayers.Geometry.Point(f.x,g.y)),b.push(new OpenLayers.Geometry.Point(f.x,f.y)),b=new OpenLayers.Geometry.LinearRing(b),d=new OpenLayers.Geometry.Polygon([b]));return d},box:function(a){var b=this.getElementsByTagNameNS(a,this.gmlns,"coordinates"),c=a=null;0<b.length&&(b=b[0].firstChild.nodeValue,
b=b.split(" "),2==b.length&&(a=b[0].split(","),c=b[1].split(",")));if(null!==a&&null!==c)return new OpenLayers.Bounds(parseFloat(a[0]),parseFloat(a[1]),parseFloat(c[0]),parseFloat(c[1]))}},parseAttributes:function(a){for(var b={},a=a.firstChild,c,d,e;a;){if(1==a.nodeType){a=a.childNodes;for(c=0;c<a.length;++c)if(d=a[c],1==d.nodeType)if(e=d.childNodes,1==e.length){if(e=e[0],3==e.nodeType||4==e.nodeType)d=d.prefix?d.nodeName.split(":")[1]:d.nodeName,e=e.nodeValue.replace(this.regExes.trimSpace,""),
b[d]=e}else b[d.nodeName.split(":").pop()]=null;break}a=a.nextSibling}return b},write:function(a){OpenLayers.Util.isArray(a)||(a=[a]);for(var b=this.createElementNS("http://www.opengis.net/wfs","wfs:"+this.collectionName),c=0;c<a.length;c++)b.appendChild(this.createFeatureXML(a[c]));return OpenLayers.Format.XML.prototype.write.apply(this,[b])},createFeatureXML:function(a){var b=this.buildGeometryNode(a.geometry),c=this.createElementNS(this.featureNS,this.featurePrefix+":"+this.geometryName);c.appendChild(b);
var b=this.createElementNS(this.gmlns,"gml:"+this.featureName),d=this.createElementNS(this.featureNS,this.featurePrefix+":"+this.layerName);d.setAttribute("fid",a.fid||a.id);d.appendChild(c);for(var e in a.attributes){var c=this.createTextNode(a.attributes[e]),f=e.substring(e.lastIndexOf(":")+1),f=this.createElementNS(this.featureNS,this.featurePrefix+":"+f);f.appendChild(c);d.appendChild(f)}b.appendChild(d);return b},buildGeometryNode:function(a){this.externalProjection&&this.internalProjection&&
(a=a.clone(),a.transform(this.internalProjection,this.externalProjection));var b=a.CLASS_NAME,b=b.substring(b.lastIndexOf(".")+1);return this.buildGeometry[b.toLowerCase()].apply(this,[a])},buildGeometry:{point:function(a){var b=this.createElementNS(this.gmlns,"gml:Point");b.appendChild(this.buildCoordinatesNode(a));return b},multipoint:function(a){for(var b=this.createElementNS(this.gmlns,"gml:MultiPoint"),a=a.components,c,d,e=0;e<a.length;e++)c=this.createElementNS(this.gmlns,"gml:pointMember"),
d=this.buildGeometry.point.apply(this,[a[e]]),c.appendChild(d),b.appendChild(c);return b},linestring:function(a){var b=this.createElementNS(this.gmlns,"gml:LineString");b.appendChild(this.buildCoordinatesNode(a));return b},multilinestring:function(a){for(var b=this.createElementNS(this.gmlns,"gml:MultiLineString"),a=a.components,c,d,e=0;e<a.length;++e)c=this.createElementNS(this.gmlns,"gml:lineStringMember"),d=this.buildGeometry.linestring.apply(this,[a[e]]),c.appendChild(d),b.appendChild(c);return b},
linearring:function(a){var b=this.createElementNS(this.gmlns,"gml:LinearRing");b.appendChild(this.buildCoordinatesNode(a));return b},polygon:function(a){for(var b=this.createElementNS(this.gmlns,"gml:Polygon"),a=a.components,c,d,e=0;e<a.length;++e)c=0==e?"outerBoundaryIs":"innerBoundaryIs",c=this.createElementNS(this.gmlns,"gml:"+c),d=this.buildGeometry.linearring.apply(this,[a[e]]),c.appendChild(d),b.appendChild(c);return b},multipolygon:function(a){for(var b=this.createElementNS(this.gmlns,"gml:MultiPolygon"),
a=a.components,c,d,e=0;e<a.length;++e)c=this.createElementNS(this.gmlns,"gml:polygonMember"),d=this.buildGeometry.polygon.apply(this,[a[e]]),c.appendChild(d),b.appendChild(c);return b},bounds:function(a){var b=this.createElementNS(this.gmlns,"gml:Box");b.appendChild(this.buildCoordinatesNode(a));return b}},buildCoordinatesNode:function(a){var b=this.createElementNS(this.gmlns,"gml:coordinates");b.setAttribute("decimal",".");b.setAttribute("cs",",");b.setAttribute("ts"," ");var c=[];if(a instanceof
OpenLayers.Bounds)c.push(a.left+","+a.bottom),c.push(a.right+","+a.top);else for(var a=a.components?a.components:[a],d=0;d<a.length;d++)c.push(a[d].x+","+a[d].y);c=this.createTextNode(c.join(" "));b.appendChild(c);return b},CLASS_NAME:"OpenLayers.Format.GML"});OpenLayers.Format.GML||(OpenLayers.Format.GML={});
OpenLayers.Format.GML.Base=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",wfs:"http://www.opengis.net/wfs"},defaultPrefix:"gml",schemaLocation:null,featureType:null,featureNS:null,geometryName:"geometry",extractAttributes:!0,srsName:null,xy:!0,geometryTypes:null,singleFeatureType:null,regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g,featureMember:/^(.*:)?featureMembers?$/},
initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]);this.setGeometryTypes();a&&a.featureNS&&this.setNamespace("feature",a.featureNS);this.singleFeatureType=!a||"string"===typeof a.featureType},read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&&9==a.nodeType&&(a=a.documentElement);var b=[];this.readNode(a,{features:b},!0);if(0==b.length){var c=this.getElementsByTagNameNS(a,this.namespaces.gml,"featureMember");if(c.length)for(var a=
0,d=c.length;a<d;++a)this.readNode(c[a],{features:b},!0);else c=this.getElementsByTagNameNS(a,this.namespaces.gml,"featureMembers"),c.length&&this.readNode(c[0],{features:b},!0)}return b},readNode:function(a,b,c){!0===c&&!0===this.autoConfig&&(this.featureType=null,delete this.namespaceAlias[this.featureNS],delete this.namespaces.feature,this.featureNS=null);!this.featureNS&&(!(a.prefix in this.namespaces)&&a.parentNode.namespaceURI==this.namespaces.gml&&this.regExes.featureMember.test(a.parentNode.nodeName))&&
(this.featureType=a.nodeName.split(":").pop(),this.setNamespace("feature",a.namespaceURI),this.featureNS=a.namespaceURI,this.autoConfig=!0);return OpenLayers.Format.XML.prototype.readNode.apply(this,[a,b])},readers:{gml:{_inherit:function(){},featureMember:function(a,b){this.readChildNodes(a,b)},featureMembers:function(a,b){this.readChildNodes(a,b)},name:function(a,b){b.name=this.getChildValue(a)},boundedBy:function(a,b){var c={};this.readChildNodes(a,c);c.components&&0<c.components.length&&(b.bounds=
c.components[0])},Point:function(a,b){var c={points:[]};this.readChildNodes(a,c);b.components||(b.components=[]);b.components.push(c.points[0])},coordinates:function(a,b){for(var c=this.getChildValue(a).replace(this.regExes.trimSpace,""),c=c.replace(this.regExes.trimComma,","),c=c.split(this.regExes.splitSpace),d,e=c.length,f=Array(e),g=0;g<e;++g)d=c[g].split(","),f[g]=this.xy?new OpenLayers.Geometry.Point(d[0],d[1],d[2]):new OpenLayers.Geometry.Point(d[1],d[0],d[2]);b.points=f},coord:function(a,
b){var c={};this.readChildNodes(a,c);b.points||(b.points=[]);b.points.push(new OpenLayers.Geometry.Point(c.x,c.y,c.z))},X:function(a,b){b.x=this.getChildValue(a)},Y:function(a,b){b.y=this.getChildValue(a)},Z:function(a,b){b.z=this.getChildValue(a)},MultiPoint:function(a,b){var c={components:[]};this.readers.gml._inherit.apply(this,[a,c,b]);this.readChildNodes(a,c);b.components=[new OpenLayers.Geometry.MultiPoint(c.components)]},pointMember:function(a,b){this.readChildNodes(a,b)},LineString:function(a,
b){var c={};this.readers.gml._inherit.apply(this,[a,c,b]);this.readChildNodes(a,c);b.components||(b.components=[]);b.components.push(new OpenLayers.Geometry.LineString(c.points))},MultiLineString:function(a,b){var c={components:[]};this.readers.gml._inherit.apply(this,[a,c,b]);this.readChildNodes(a,c);b.components=[new OpenLayers.Geometry.MultiLineString(c.components)]},lineStringMember:function(a,b){this.readChildNodes(a,b)},Polygon:function(a,b){var c={outer:null,inner:[]};this.readers.gml._inherit.apply(this,
[a,c,b]);this.readChildNodes(a,c);c.inner.unshift(c.outer);b.components||(b.components=[]);b.components.push(new OpenLayers.Geometry.Polygon(c.inner))},LinearRing:function(a,b){var c={};this.readers.gml._inherit.apply(this,[a,c]);this.readChildNodes(a,c);b.components=[new OpenLayers.Geometry.LinearRing(c.points)]},MultiPolygon:function(a,b){var c={components:[]};this.readers.gml._inherit.apply(this,[a,c,b]);this.readChildNodes(a,c);b.components=[new OpenLayers.Geometry.MultiPolygon(c.components)]},
polygonMember:function(a,b){this.readChildNodes(a,b)},GeometryCollection:function(a,b){var c={components:[]};this.readers.gml._inherit.apply(this,[a,c,b]);this.readChildNodes(a,c);b.components=[new OpenLayers.Geometry.Collection(c.components)]},geometryMember:function(a,b){this.readChildNodes(a,b)}},feature:{"*":function(a,b){var c,d=a.localName||a.nodeName.split(":").pop();b.features?!this.singleFeatureType&&-1!==OpenLayers.Util.indexOf(this.featureType,d)?c="_typeName":d===this.featureType&&(c=
"_typeName"):0==a.childNodes.length||1==a.childNodes.length&&3==a.firstChild.nodeType?this.extractAttributes&&(c="_attribute"):c="_geometry";c&&this.readers.feature[c].apply(this,[a,b])},_typeName:function(a,b){var c={components:[],attributes:{}};this.readChildNodes(a,c);c.name&&(c.attributes.name=c.name);var d=new OpenLayers.Feature.Vector(c.components[0],c.attributes);this.singleFeatureType||(d.type=a.nodeName.split(":").pop(),d.namespace=a.namespaceURI);var e=a.getAttribute("fid")||this.getAttributeNS(a,
this.namespaces.gml,"id");e&&(d.fid=e);this.internalProjection&&(this.externalProjection&&d.geometry)&&d.geometry.transform(this.externalProjection,this.internalProjection);c.bounds&&(d.bounds=c.bounds);b.features.push(d)},_geometry:function(a,b){this.geometryName||(this.geometryName=a.nodeName.split(":").pop());this.readChildNodes(a,b)},_attribute:function(a,b){var c=a.localName||a.nodeName.split(":").pop(),d=this.getChildValue(a);b.attributes[c]=d}},wfs:{FeatureCollection:function(a,b){this.readChildNodes(a,
b)}}},write:function(a){var b;b=OpenLayers.Util.isArray(a)?"featureMembers":"featureMember";a=this.writeNode("gml:"+b,a);this.setAttributeNS(a,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[a])},writers:{gml:{featureMember:function(a){var b=this.createElementNSPlus("gml:featureMember");this.writeNode("feature:_typeName",a,b);return b},MultiPoint:function(a){for(var b=this.createElementNSPlus("gml:MultiPoint"),a=a.components||
[a],c=0,d=a.length;c<d;++c)this.writeNode("pointMember",a[c],b);return b},pointMember:function(a){var b=this.createElementNSPlus("gml:pointMember");this.writeNode("Point",a,b);return b},MultiLineString:function(a){for(var b=this.createElementNSPlus("gml:MultiLineString"),a=a.components||[a],c=0,d=a.length;c<d;++c)this.writeNode("lineStringMember",a[c],b);return b},lineStringMember:function(a){var b=this.createElementNSPlus("gml:lineStringMember");this.writeNode("LineString",a,b);return b},MultiPolygon:function(a){for(var b=
this.createElementNSPlus("gml:MultiPolygon"),a=a.components||[a],c=0,d=a.length;c<d;++c)this.writeNode("polygonMember",a[c],b);return b},polygonMember:function(a){var b=this.createElementNSPlus("gml:polygonMember");this.writeNode("Polygon",a,b);return b},GeometryCollection:function(a){for(var b=this.createElementNSPlus("gml:GeometryCollection"),c=0,d=a.components.length;c<d;++c)this.writeNode("geometryMember",a.components[c],b);return b},geometryMember:function(a){var b=this.createElementNSPlus("gml:geometryMember"),
a=this.writeNode("feature:_geometry",a);b.appendChild(a.firstChild);return b}},feature:{_typeName:function(a){var b=this.createElementNSPlus("feature:"+this.featureType,{attributes:{fid:a.fid}});a.geometry&&this.writeNode("feature:_geometry",a.geometry,b);for(var c in a.attributes){var d=a.attributes[c];null!=d&&this.writeNode("feature:_attribute",{name:c,value:d},b)}return b},_geometry:function(a){this.externalProjection&&this.internalProjection&&(a=a.clone().transform(this.internalProjection,this.externalProjection));
var b=this.createElementNSPlus("feature:"+this.geometryName),a=this.writeNode("gml:"+this.geometryTypes[a.CLASS_NAME],a,b);this.srsName&&a.setAttribute("srsName",this.srsName);return b},_attribute:function(a){return this.createElementNSPlus("feature:"+a.name,{value:a.value})}},wfs:{FeatureCollection:function(a){for(var b=this.createElementNSPlus("wfs:FeatureCollection"),c=0,d=a.length;c<d;++c)this.writeNode("gml:featureMember",a[c],b);return b}}},setGeometryTypes:function(){this.geometryTypes={"OpenLayers.Geometry.Point":"Point",
"OpenLayers.Geometry.MultiPoint":"MultiPoint","OpenLayers.Geometry.LineString":"LineString","OpenLayers.Geometry.MultiLineString":"MultiLineString","OpenLayers.Geometry.Polygon":"Polygon","OpenLayers.Geometry.MultiPolygon":"MultiPolygon","OpenLayers.Geometry.Collection":"GeometryCollection"}},CLASS_NAME:"OpenLayers.Format.GML.Base"});
OpenLayers.Format.GML.v3=OpenLayers.Class(OpenLayers.Format.GML.Base,{schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd",curve:!1,multiCurve:!0,surface:!1,multiSurface:!0,initialize:function(a){OpenLayers.Format.GML.Base.prototype.initialize.apply(this,[a])},readers:{gml:OpenLayers.Util.applyDefaults({_inherit:function(a,b,c){if(a=parseInt(a.getAttribute("srsDimension"),10)||c&&c.srsDimension)b.srsDimension=a},featureMembers:function(a,
b){this.readChildNodes(a,b)},Curve:function(a,b){var c={points:[]};this.readers.gml._inherit.apply(this,[a,c,b]);this.readChildNodes(a,c);b.components||(b.components=[]);b.components.push(new OpenLayers.Geometry.LineString(c.points))},segments:function(a,b){this.readChildNodes(a,b)},LineStringSegment:function(a,b){var c={};this.readChildNodes(a,c);c.points&&Array.prototype.push.apply(b.points,c.points)},pos:function(a,b){var c=this.getChildValue(a).replace(this.regExes.trimSpace,"").split(this.regExes.splitSpace),
c=this.xy?new OpenLayers.Geometry.Point(c[0],c[1],c[2]):new OpenLayers.Geometry.Point(c[1],c[0],c[2]);b.points=[c]},posList:function(a,b){for(var c=this.getChildValue(a).replace(this.regExes.trimSpace,"").split(this.regExes.splitSpace),d=b.srsDimension||parseInt(a.getAttribute("srsDimension")||a.getAttribute("dimension"),10)||2,e,f,g,h=Array(c.length/d),j=0,n=c.length;j<n;j+=d)e=c[j],f=c[j+1],g=2==d?void 0:c[j+2],h[j/d]=this.xy?new OpenLayers.Geometry.Point(e,f,g):new OpenLayers.Geometry.Point(f,
e,g);b.points=h},Surface:function(a,b){this.readChildNodes(a,b)},patches:function(a,b){this.readChildNodes(a,b)},PolygonPatch:function(a,b){this.readers.gml.Polygon.apply(this,[a,b])},exterior:function(a,b){var c={};this.readChildNodes(a,c);b.outer=c.components[0]},interior:function(a,b){var c={};this.readChildNodes(a,c);b.inner.push(c.components[0])},MultiCurve:function(a,b){var c={components:[]};this.readers.gml._inherit.apply(this,[a,c,b]);this.readChildNodes(a,c);0<c.components.length&&(b.components=
[new OpenLayers.Geometry.MultiLineString(c.components)])},curveMember:function(a,b){this.readChildNodes(a,b)},MultiSurface:function(a,b){var c={components:[]};this.readers.gml._inherit.apply(this,[a,c,b]);this.readChildNodes(a,c);0<c.components.length&&(b.components=[new OpenLayers.Geometry.MultiPolygon(c.components)])},surfaceMember:function(a,b){this.readChildNodes(a,b)},surfaceMembers:function(a,b){this.readChildNodes(a,b)},pointMembers:function(a,b){this.readChildNodes(a,b)},lineStringMembers:function(a,
b){this.readChildNodes(a,b)},polygonMembers:function(a,b){this.readChildNodes(a,b)},geometryMembers:function(a,b){this.readChildNodes(a,b)},Envelope:function(a,b){var c={points:Array(2)};this.readChildNodes(a,c);b.components||(b.components=[]);var d=c.points[0],c=c.points[1];b.components.push(new OpenLayers.Bounds(d.x,d.y,c.x,c.y))},lowerCorner:function(a,b){var c={};this.readers.gml.pos.apply(this,[a,c]);b.points[0]=c.points[0]},upperCorner:function(a,b){var c={};this.readers.gml.pos.apply(this,
[a,c]);b.points[1]=c.points[0]}},OpenLayers.Format.GML.Base.prototype.readers.gml),feature:OpenLayers.Format.GML.Base.prototype.readers.feature,wfs:OpenLayers.Format.GML.Base.prototype.readers.wfs},write:function(a){var b;b=OpenLayers.Util.isArray(a)?"featureMembers":"featureMember";a=this.writeNode("gml:"+b,a);this.setAttributeNS(a,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[a])},writers:{gml:OpenLayers.Util.applyDefaults({featureMembers:function(a){for(var b=
this.createElementNSPlus("gml:featureMembers"),c=0,d=a.length;c<d;++c)this.writeNode("feature:_typeName",a[c],b);return b},Point:function(a){var b=this.createElementNSPlus("gml:Point");this.writeNode("pos",a,b);return b},pos:function(a){return this.createElementNSPlus("gml:pos",{value:this.xy?a.x+" "+a.y:a.y+" "+a.x})},LineString:function(a){var b=this.createElementNSPlus("gml:LineString");this.writeNode("posList",a.components,b);return b},Curve:function(a){var b=this.createElementNSPlus("gml:Curve");
this.writeNode("segments",a,b);return b},segments:function(a){var b=this.createElementNSPlus("gml:segments");this.writeNode("LineStringSegment",a,b);return b},LineStringSegment:function(a){var b=this.createElementNSPlus("gml:LineStringSegment");this.writeNode("posList",a.components,b);return b},posList:function(a){for(var b=a.length,c=Array(b),d,e=0;e<b;++e)d=a[e],c[e]=this.xy?d.x+" "+d.y:d.y+" "+d.x;return this.createElementNSPlus("gml:posList",{value:c.join(" ")})},Surface:function(a){var b=this.createElementNSPlus("gml:Surface");
this.writeNode("patches",a,b);return b},patches:function(a){var b=this.createElementNSPlus("gml:patches");this.writeNode("PolygonPatch",a,b);return b},PolygonPatch:function(a){var b=this.createElementNSPlus("gml:PolygonPatch",{attributes:{interpolation:"planar"}});this.writeNode("exterior",a.components[0],b);for(var c=1,d=a.components.length;c<d;++c)this.writeNode("interior",a.components[c],b);return b},Polygon:function(a){var b=this.createElementNSPlus("gml:Polygon");this.writeNode("exterior",a.components[0],
b);for(var c=1,d=a.components.length;c<d;++c)this.writeNode("interior",a.components[c],b);return b},exterior:function(a){var b=this.createElementNSPlus("gml:exterior");this.writeNode("LinearRing",a,b);return b},interior:function(a){var b=this.createElementNSPlus("gml:interior");this.writeNode("LinearRing",a,b);return b},LinearRing:function(a){var b=this.createElementNSPlus("gml:LinearRing");this.writeNode("posList",a.components,b);return b},MultiCurve:function(a){for(var b=this.createElementNSPlus("gml:MultiCurve"),
a=a.components||[a],c=0,d=a.length;c<d;++c)this.writeNode("curveMember",a[c],b);return b},curveMember:function(a){var b=this.createElementNSPlus("gml:curveMember");this.curve?this.writeNode("Curve",a,b):this.writeNode("LineString",a,b);return b},MultiSurface:function(a){for(var b=this.createElementNSPlus("gml:MultiSurface"),a=a.components||[a],c=0,d=a.length;c<d;++c)this.writeNode("surfaceMember",a[c],b);return b},surfaceMember:function(a){var b=this.createElementNSPlus("gml:surfaceMember");this.surface?
this.writeNode("Surface",a,b):this.writeNode("Polygon",a,b);return b},Envelope:function(a){var b=this.createElementNSPlus("gml:Envelope");this.writeNode("lowerCorner",a,b);this.writeNode("upperCorner",a,b);this.srsName&&b.setAttribute("srsName",this.srsName);return b},lowerCorner:function(a){return this.createElementNSPlus("gml:lowerCorner",{value:this.xy?a.left+" "+a.bottom:a.bottom+" "+a.left})},upperCorner:function(a){return this.createElementNSPlus("gml:upperCorner",{value:this.xy?a.right+" "+
a.top:a.top+" "+a.right})}},OpenLayers.Format.GML.Base.prototype.writers.gml),feature:OpenLayers.Format.GML.Base.prototype.writers.feature,wfs:OpenLayers.Format.GML.Base.prototype.writers.wfs},setGeometryTypes:function(){this.geometryTypes={"OpenLayers.Geometry.Point":"Point","OpenLayers.Geometry.MultiPoint":"MultiPoint","OpenLayers.Geometry.LineString":!0===this.curve?"Curve":"LineString","OpenLayers.Geometry.MultiLineString":!1===this.multiCurve?"MultiLineString":"MultiCurve","OpenLayers.Geometry.Polygon":!0===
this.surface?"Surface":"Polygon","OpenLayers.Geometry.MultiPolygon":!1===this.multiSurface?"MultiPolygon":"MultiSurface","OpenLayers.Geometry.Collection":"GeometryCollection"}},CLASS_NAME:"OpenLayers.Format.GML.v3"});
OpenLayers.Format.Filter.v1_1_0=OpenLayers.Class(OpenLayers.Format.GML.v3,OpenLayers.Format.Filter.v1,{VERSION:"1.1.0",schemaLocation:"http://www.opengis.net/ogc/filter/1.1.0/filter.xsd",initialize:function(a){OpenLayers.Format.GML.v3.prototype.initialize.apply(this,[a])},readers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(a,b){var c=a.getAttribute("matchCase"),c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO,matchCase:!("false"===c||"0"===c)});this.readChildNodes(a,
c);b.filters.push(c)},PropertyIsNotEqualTo:function(a,b){var c=a.getAttribute("matchCase"),c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.NOT_EQUAL_TO,matchCase:!("false"===c||"0"===c)});this.readChildNodes(a,c);b.filters.push(c)},PropertyIsLike:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LIKE});this.readChildNodes(a,c);var d=a.getAttribute("wildCard"),e=a.getAttribute("singleChar"),f=a.getAttribute("escapeChar");c.value2regex(d,e,
f);b.filters.push(c)}},OpenLayers.Format.Filter.v1.prototype.readers.ogc),gml:OpenLayers.Format.GML.v3.prototype.readers.gml,feature:OpenLayers.Format.GML.v3.prototype.readers.feature},writers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsEqualTo",{attributes:{matchCase:a.matchCase}});this.writeNode("PropertyName",a,b);this.writeOgcExpression(a.value,b);return b},PropertyIsNotEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsNotEqualTo",
{attributes:{matchCase:a.matchCase}});this.writeNode("PropertyName",a,b);this.writeOgcExpression(a.value,b);return b},PropertyIsLike:function(a){var b=this.createElementNSPlus("ogc:PropertyIsLike",{attributes:{matchCase:a.matchCase,wildCard:"*",singleChar:".",escapeChar:"!"}});this.writeNode("PropertyName",a,b);this.writeNode("Literal",a.regex2value(),b);return b},BBOX:function(a){var b=this.createElementNSPlus("ogc:BBOX");a.property&&this.writeNode("PropertyName",a,b);var c=this.writeNode("gml:Envelope",
a.value);a.projection&&c.setAttribute("srsName",a.projection);b.appendChild(c);return b},SortBy:function(a){for(var b=this.createElementNSPlus("ogc:SortBy"),c=0,d=a.length;c<d;c++)this.writeNode("ogc:SortProperty",a[c],b);return b},SortProperty:function(a){var b=this.createElementNSPlus("ogc:SortProperty");this.writeNode("ogc:PropertyName",a,b);this.writeNode("ogc:SortOrder","DESC"==a.order?"DESC":"ASC",b);return b},SortOrder:function(a){return this.createElementNSPlus("ogc:SortOrder",{value:a})}},
OpenLayers.Format.Filter.v1.prototype.writers.ogc),gml:OpenLayers.Format.GML.v3.prototype.writers.gml,feature:OpenLayers.Format.GML.v3.prototype.writers.feature},writeSpatial:function(a,b){var c=this.createElementNSPlus("ogc:"+b);this.writeNode("PropertyName",a,c);if(a.value instanceof OpenLayers.Filter.Function)this.writeNode("Function",a.value,c);else{var d;d=a.value instanceof OpenLayers.Geometry?this.writeNode("feature:_geometry",a.value).firstChild:this.writeNode("gml:Envelope",a.value);a.projection&&
d.setAttribute("srsName",a.projection);c.appendChild(d)}return c},CLASS_NAME:"OpenLayers.Format.Filter.v1_1_0"});OpenLayers.Format.OWSCommon=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",getVersion:function(a){var b=this.version;b||((a=a.getAttribute("xmlns:ows"))&&"1.1"===a.substring(a.lastIndexOf("/")+1)&&(b="1.1.0"),b||(b=this.defaultVersion));return b},CLASS_NAME:"OpenLayers.Format.OWSCommon"});
OpenLayers.Format.OWSCommon.v1=OpenLayers.Class(OpenLayers.Format.XML,{regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},read:function(a,b){OpenLayers.Util.applyDefaults(b,this.options);var c={};this.readChildNodes(a,c);return c},readers:{ows:{Exception:function(a,b){var c={code:a.getAttribute("exceptionCode"),locator:a.getAttribute("locator"),texts:[]};b.exceptions.push(c);this.readChildNodes(a,c)},ExceptionText:function(a,b){var c=this.getChildValue(a);b.texts.push(c)},
ServiceIdentification:function(a,b){b.serviceIdentification={};this.readChildNodes(a,b.serviceIdentification)},Title:function(a,b){b.title=this.getChildValue(a)},Abstract:function(a,b){b["abstract"]=this.getChildValue(a)},Keywords:function(a,b){b.keywords={};this.readChildNodes(a,b.keywords)},Keyword:function(a,b){b[this.getChildValue(a)]=!0},ServiceType:function(a,b){b.serviceType={codeSpace:a.getAttribute("codeSpace"),value:this.getChildValue(a)}},ServiceTypeVersion:function(a,b){b.serviceTypeVersion=
this.getChildValue(a)},Fees:function(a,b){b.fees=this.getChildValue(a)},AccessConstraints:function(a,b){b.accessConstraints=this.getChildValue(a)},ServiceProvider:function(a,b){b.serviceProvider={};this.readChildNodes(a,b.serviceProvider)},ProviderName:function(a,b){b.providerName=this.getChildValue(a)},ProviderSite:function(a,b){b.providerSite=this.getAttributeNS(a,this.namespaces.xlink,"href")},ServiceContact:function(a,b){b.serviceContact={};this.readChildNodes(a,b.serviceContact)},IndividualName:function(a,
b){b.individualName=this.getChildValue(a)},PositionName:function(a,b){b.positionName=this.getChildValue(a)},ContactInfo:function(a,b){b.contactInfo={};this.readChildNodes(a,b.contactInfo)},Phone:function(a,b){b.phone={};this.readChildNodes(a,b.phone)},Voice:function(a,b){b.voice=this.getChildValue(a)},Address:function(a,b){b.address={};this.readChildNodes(a,b.address)},DeliveryPoint:function(a,b){b.deliveryPoint=this.getChildValue(a)},City:function(a,b){b.city=this.getChildValue(a)},AdministrativeArea:function(a,
b){b.administrativeArea=this.getChildValue(a)},PostalCode:function(a,b){b.postalCode=this.getChildValue(a)},Country:function(a,b){b.country=this.getChildValue(a)},ElectronicMailAddress:function(a,b){b.electronicMailAddress=this.getChildValue(a)},Role:function(a,b){b.role=this.getChildValue(a)},OperationsMetadata:function(a,b){b.operationsMetadata={};this.readChildNodes(a,b.operationsMetadata)},Operation:function(a,b){var c=a.getAttribute("name");b[c]={};this.readChildNodes(a,b[c])},DCP:function(a,
b){b.dcp={};this.readChildNodes(a,b.dcp)},HTTP:function(a,b){b.http={};this.readChildNodes(a,b.http)},Get:function(a,b){b.get||(b.get=[]);var c={url:this.getAttributeNS(a,this.namespaces.xlink,"href")};this.readChildNodes(a,c);b.get.push(c)},Post:function(a,b){b.post||(b.post=[]);var c={url:this.getAttributeNS(a,this.namespaces.xlink,"href")};this.readChildNodes(a,c);b.post.push(c)},Parameter:function(a,b){b.parameters||(b.parameters={});var c=a.getAttribute("name");b.parameters[c]={};this.readChildNodes(a,
b.parameters[c])},Constraint:function(a,b){b.constraints||(b.constraints={});var c=a.getAttribute("name");b.constraints[c]={};this.readChildNodes(a,b.constraints[c])},Value:function(a,b){b[this.getChildValue(a)]=!0},OutputFormat:function(a,b){b.formats.push({value:this.getChildValue(a)});this.readChildNodes(a,b)},WGS84BoundingBox:function(a,b){var c={};c.crs=a.getAttribute("crs");b.BoundingBox?b.BoundingBox.push(c):(b.projection=c.crs,c=b);this.readChildNodes(a,c)},BoundingBox:function(a,b){this.readers.ows.WGS84BoundingBox.apply(this,
[a,b])},LowerCorner:function(a,b){var c=this.getChildValue(a).replace(this.regExes.trimSpace,""),c=c.replace(this.regExes.trimComma,","),c=c.split(this.regExes.splitSpace);b.left=c[0];b.bottom=c[1]},UpperCorner:function(a,b){var c=this.getChildValue(a).replace(this.regExes.trimSpace,""),c=c.replace(this.regExes.trimComma,","),c=c.split(this.regExes.splitSpace);b.right=c[0];b.top=c[1];b.bounds=new OpenLayers.Bounds(b.left,b.bottom,b.right,b.top);delete b.left;delete b.bottom;delete b.right;delete b.top},
Language:function(a,b){b.language=this.getChildValue(a)}}},writers:{ows:{BoundingBox:function(a,b){var c=this.createElementNSPlus(b||"ows:BoundingBox",{attributes:{crs:a.projection}});this.writeNode("ows:LowerCorner",a,c);this.writeNode("ows:UpperCorner",a,c);return c},LowerCorner:function(a){return this.createElementNSPlus("ows:LowerCorner",{value:a.bounds.left+" "+a.bounds.bottom})},UpperCorner:function(a){return this.createElementNSPlus("ows:UpperCorner",{value:a.bounds.right+" "+a.bounds.top})},
Identifier:function(a){return this.createElementNSPlus("ows:Identifier",{value:a})},Title:function(a){return this.createElementNSPlus("ows:Title",{value:a})},Abstract:function(a){return this.createElementNSPlus("ows:Abstract",{value:a})},OutputFormat:function(a){return this.createElementNSPlus("ows:OutputFormat",{value:a})}}},CLASS_NAME:"OpenLayers.Format.OWSCommon.v1"});
OpenLayers.Format.OWSCommon.v1_0_0=OpenLayers.Class(OpenLayers.Format.OWSCommon.v1,{namespaces:{ows:"http://www.opengis.net/ows",xlink:"http://www.w3.org/1999/xlink"},readers:{ows:OpenLayers.Util.applyDefaults({ExceptionReport:function(a,b){b.success=!1;b.exceptionReport={version:a.getAttribute("version"),language:a.getAttribute("language"),exceptions:[]};this.readChildNodes(a,b.exceptionReport)}},OpenLayers.Format.OWSCommon.v1.prototype.readers.ows)},writers:{ows:OpenLayers.Format.OWSCommon.v1.prototype.writers.ows},
CLASS_NAME:"OpenLayers.Format.OWSCommon.v1_0_0"});
OpenLayers.Format.WFST.v1_1_0=OpenLayers.Class(OpenLayers.Format.Filter.v1_1_0,OpenLayers.Format.WFST.v1,{version:"1.1.0",schemaLocations:{wfs:"http://schemas.opengis.net/wfs/1.1.0/wfs.xsd"},initialize:function(a){OpenLayers.Format.Filter.v1_1_0.prototype.initialize.apply(this,[a]);OpenLayers.Format.WFST.v1.prototype.initialize.apply(this,[a])},readNode:function(a,b,c){return OpenLayers.Format.GML.v3.prototype.readNode.apply(this,arguments)},readers:{wfs:OpenLayers.Util.applyDefaults({FeatureCollection:function(a,b){b.numberOfFeatures=
parseInt(a.getAttribute("numberOfFeatures"));OpenLayers.Format.WFST.v1.prototype.readers.wfs.FeatureCollection.apply(this,arguments)},TransactionResponse:function(a,b){b.insertIds=[];b.success=!1;this.readChildNodes(a,b)},TransactionSummary:function(a,b){b.success=!0},InsertResults:function(a,b){this.readChildNodes(a,b)},Feature:function(a,b){var c={fids:[]};this.readChildNodes(a,c);b.insertIds.push(c.fids[0])}},OpenLayers.Format.WFST.v1.prototype.readers.wfs),gml:OpenLayers.Format.GML.v3.prototype.readers.gml,
feature:OpenLayers.Format.GML.v3.prototype.readers.feature,ogc:OpenLayers.Format.Filter.v1_1_0.prototype.readers.ogc,ows:OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows},writers:{wfs:OpenLayers.Util.applyDefaults({GetFeature:function(a){var b=OpenLayers.Format.WFST.v1.prototype.writers.wfs.GetFeature.apply(this,arguments);a&&this.setAttributes(b,{resultType:a.resultType,startIndex:a.startIndex,count:a.count});return b},Query:function(a){var a=OpenLayers.Util.extend({featureNS:this.featureNS,
featurePrefix:this.featurePrefix,featureType:this.featureType,srsName:this.srsName},a),b=a.featurePrefix,c=this.createElementNSPlus("wfs:Query",{attributes:{typeName:(b?b+":":"")+a.featureType,srsName:a.srsName}});a.featureNS&&c.setAttribute("xmlns:"+b,a.featureNS);if(a.propertyNames)for(var b=0,d=a.propertyNames.length;b<d;b++)this.writeNode("wfs:PropertyName",{property:a.propertyNames[b]},c);a.filter&&(OpenLayers.Format.WFST.v1_1_0.prototype.setFilterProperty.call(this,a.filter),this.writeNode("ogc:Filter",
a.filter,c));return c},PropertyName:function(a){return this.createElementNSPlus("wfs:PropertyName",{value:a.property})}},OpenLayers.Format.WFST.v1.prototype.writers.wfs),gml:OpenLayers.Format.GML.v3.prototype.writers.gml,feature:OpenLayers.Format.GML.v3.prototype.writers.feature,ogc:OpenLayers.Format.Filter.v1_1_0.prototype.writers.ogc},CLASS_NAME:"OpenLayers.Format.WFST.v1_1_0"});
OpenLayers.Format.JSON=OpenLayers.Class(OpenLayers.Format,{indent:"    ",space:" ",newline:"\n",level:0,pretty:!1,nativeJSON:function(){return!(!window.JSON||!("function"==typeof JSON.parse&&"function"==typeof JSON.stringify))}(),read:function(a,b){var c;if(this.nativeJSON)c=JSON.parse(a,b);else try{if(/^[\],:{}\s]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))&&(c=eval("("+a+")"),"function"===
typeof b)){var d=function(a,c){if(c&&"object"===typeof c)for(var e in c)c.hasOwnProperty(e)&&(c[e]=d(e,c[e]));return b(a,c)};c=d("",c)}}catch(e){}this.keepData&&(this.data=c);return c},write:function(a,b){this.pretty=!!b;var c=null,d=typeof a;if(this.serialize[d])try{c=!this.pretty&&this.nativeJSON?JSON.stringify(a):this.serialize[d].apply(this,[a])}catch(e){OpenLayers.Console.error("Trouble serializing: "+e)}return c},writeIndent:function(){var a=[];if(this.pretty)for(var b=0;b<this.level;++b)a.push(this.indent);
return a.join("")},writeNewline:function(){return this.pretty?this.newline:""},writeSpace:function(){return this.pretty?this.space:""},serialize:{object:function(a){if(null==a)return"null";if(a.constructor==Date)return this.serialize.date.apply(this,[a]);if(a.constructor==Array)return this.serialize.array.apply(this,[a]);var b=["{"];this.level+=1;var c,d,e,f=!1;for(c in a)a.hasOwnProperty(c)&&(d=OpenLayers.Format.JSON.prototype.write.apply(this,[c,this.pretty]),e=OpenLayers.Format.JSON.prototype.write.apply(this,
[a[c],this.pretty]),null!=d&&null!=e&&(f&&b.push(","),b.push(this.writeNewline(),this.writeIndent(),d,":",this.writeSpace(),e),f=!0));this.level-=1;b.push(this.writeNewline(),this.writeIndent(),"}");return b.join("")},array:function(a){var b,c=["["];this.level+=1;for(var d=0,e=a.length;d<e;++d)b=OpenLayers.Format.JSON.prototype.write.apply(this,[a[d],this.pretty]),null!=b&&(0<d&&c.push(","),c.push(this.writeNewline(),this.writeIndent(),b));this.level-=1;c.push(this.writeNewline(),this.writeIndent(),
"]");return c.join("")},string:function(a){var b={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return/["\\\x00-\x1f]/.test(a)?'"'+a.replace(/([\x00-\x1f\\"])/g,function(a,d){var e=b[d];if(e)return e;e=d.charCodeAt();return"\\u00"+Math.floor(e/16).toString(16)+(e%16).toString(16)})+'"':'"'+a+'"'},number:function(a){return isFinite(a)?String(a):"null"},"boolean":function(a){return String(a)},date:function(a){function b(a){return 10>a?"0"+a:a}return'"'+a.getFullYear()+
"-"+b(a.getMonth()+1)+"-"+b(a.getDate())+"T"+b(a.getHours())+":"+b(a.getMinutes())+":"+b(a.getSeconds())+'"'}},CLASS_NAME:"OpenLayers.Format.JSON"});
OpenLayers.Strategy=OpenLayers.Class({layer:null,options:null,active:null,autoActivate:!0,autoDestroy:!0,initialize:function(a){OpenLayers.Util.extend(this,a);this.options=a;this.active=!1},destroy:function(){this.deactivate();this.options=this.layer=null},setLayer:function(a){this.layer=a},activate:function(){return!this.active?this.active=!0:!1},deactivate:function(){return this.active?(this.active=!1,!0):!1},CLASS_NAME:"OpenLayers.Strategy"});
OpenLayers.Strategy.Filter=OpenLayers.Class(OpenLayers.Strategy,{filter:null,cache:null,caching:!1,activate:function(){var a=OpenLayers.Strategy.prototype.activate.apply(this,arguments);a&&(this.cache=[],this.layer.events.on({beforefeaturesadded:this.handleAdd,beforefeaturesremoved:this.handleRemove,scope:this}));return a},deactivate:function(){this.cache=null;this.layer&&this.layer.events&&this.layer.events.un({beforefeaturesadded:this.handleAdd,beforefeaturesremoved:this.handleRemove,scope:this});
return OpenLayers.Strategy.prototype.deactivate.apply(this,arguments)},handleAdd:function(a){if(!this.caching&&this.filter){var b=a.features;a.features=[];for(var c,d=0,e=b.length;d<e;++d)c=b[d],this.filter.evaluate(c)?a.features.push(c):this.cache.push(c)}},handleRemove:function(){this.caching||(this.cache=[])},setFilter:function(a){this.filter=a;a=this.cache;this.cache=[];this.handleAdd({features:this.layer.features});0<this.cache.length&&(this.caching=!0,this.layer.removeFeatures(this.cache.slice()),
this.caching=!1);0<a.length&&(a={features:a},this.handleAdd(a),0<a.features.length&&(this.caching=!0,this.layer.addFeatures(a.features),this.caching=!1))},CLASS_NAME:"OpenLayers.Strategy.Filter"});
OpenLayers.Layer.Image=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:!0,url:null,extent:null,size:null,tile:null,aspectRatio:null,initialize:function(a,b,c,d,e){this.url=b;this.maxExtent=this.extent=c;this.size=d;OpenLayers.Layer.prototype.initialize.apply(this,[a,e]);this.aspectRatio=this.extent.getHeight()/this.size.h/(this.extent.getWidth()/this.size.w)},destroy:function(){this.tile&&(this.removeTileMonitoringHooks(this.tile),this.tile.destroy(),this.tile=null);OpenLayers.Layer.prototype.destroy.apply(this,
arguments)},clone:function(a){null==a&&(a=new OpenLayers.Layer.Image(this.name,this.url,this.extent,this.size,this.getOptions()));return a=OpenLayers.Layer.prototype.clone.apply(this,[a])},setMap:function(a){null==this.options.maxResolution&&(this.options.maxResolution=this.aspectRatio*this.extent.getWidth()/this.size.w);OpenLayers.Layer.prototype.setMap.apply(this,arguments)},moveTo:function(a,b,c){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);var d=null==this.tile;if(b||d){this.setTileSize();
var e=this.map.getLayerPxFromLonLat({lon:this.extent.left,lat:this.extent.top});d?(this.tile=new OpenLayers.Tile.Image(this,e,this.extent,null,this.tileSize),this.addTileMonitoringHooks(this.tile)):(this.tile.size=this.tileSize.clone(),this.tile.position=e.clone());this.tile.draw()}},setTileSize:function(){var a=this.extent.getWidth()/this.map.getResolution(),b=this.extent.getHeight()/this.map.getResolution();this.tileSize=new OpenLayers.Size(a,b)},addTileMonitoringHooks:function(a){a.onLoadStart=
function(){this.events.triggerEvent("loadstart")};a.events.register("loadstart",this,a.onLoadStart);a.onLoadEnd=function(){this.events.triggerEvent("loadend")};a.events.register("loadend",this,a.onLoadEnd);a.events.register("unload",this,a.onLoadEnd)},removeTileMonitoringHooks:function(a){a.unload();a.events.un({loadstart:a.onLoadStart,loadend:a.onLoadEnd,unload:a.onLoadEnd,scope:this})},setUrl:function(a){this.url=a;this.tile.draw()},getURL:function(){return this.url},CLASS_NAME:"OpenLayers.Layer.Image"});
OpenLayers.Format.GPX=OpenLayers.Class(OpenLayers.Format.XML,{defaultDesc:"No description available",extractWaypoints:!0,extractTracks:!0,extractRoutes:!0,extractAttributes:!0,namespaces:{gpx:"http://www.topografix.com/GPX/1/1",xsi:"http://www.w3.org/2001/XMLSchema-instance"},schemaLocation:"http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd",creator:"OpenLayers",initialize:function(a){this.externalProjection=new OpenLayers.Projection("EPSG:4326");OpenLayers.Format.XML.prototype.initialize.apply(this,
[a])},read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b=[];if(this.extractTracks)for(var c=a.getElementsByTagName("trk"),d=0,e=c.length;d<e;d++){var f={};this.extractAttributes&&(f=this.parseAttributes(c[d]));for(var g=this.getElementsByTagNameNS(c[d],c[d].namespaceURI,"trkseg"),h=0,j=g.length;h<j;h++){var n=this.extractSegment(g[h],"trkpt");b.push(new OpenLayers.Feature.Vector(n,f))}}if(this.extractRoutes){e=a.getElementsByTagName("rte");c=0;for(d=
e.length;c<d;c++)f={},this.extractAttributes&&(f=this.parseAttributes(e[c])),g=this.extractSegment(e[c],"rtept"),b.push(new OpenLayers.Feature.Vector(g,f))}if(this.extractWaypoints){a=a.getElementsByTagName("wpt");c=0;for(e=a.length;c<e;c++)f={},this.extractAttributes&&(f=this.parseAttributes(a[c])),d=new OpenLayers.Geometry.Point(a[c].getAttribute("lon"),a[c].getAttribute("lat")),b.push(new OpenLayers.Feature.Vector(d,f))}if(this.internalProjection&&this.externalProjection){f=0;for(a=b.length;f<
a;f++)b[f].geometry.transform(this.externalProjection,this.internalProjection)}return b},extractSegment:function(a,b){for(var c=this.getElementsByTagNameNS(a,a.namespaceURI,b),d=[],e=0,f=c.length;e<f;e++)d.push(new OpenLayers.Geometry.Point(c[e].getAttribute("lon"),c[e].getAttribute("lat")));return new OpenLayers.Geometry.LineString(d)},parseAttributes:function(a){for(var b={},a=a.firstChild,c,d;a;){if(1==a.nodeType&&a.firstChild&&(c=a.firstChild,3==c.nodeType||4==c.nodeType))d=a.prefix?a.nodeName.split(":")[1]:
a.nodeName,"trkseg"!=d&&"rtept"!=d&&(b[d]=c.nodeValue);a=a.nextSibling}return b},write:function(a,b){var a=OpenLayers.Util.isArray(a)?a:[a],c=this.createElementNS(this.namespaces.gpx,"gpx");c.setAttribute("version","1.1");c.setAttribute("creator",this.creator);this.setAttributes(c,{"xsi:schemaLocation":this.schemaLocation});b&&"object"==typeof b&&c.appendChild(this.buildMetadataNode(b));for(var d=0,e=a.length;d<e;d++)c.appendChild(this.buildFeatureNode(a[d]));return OpenLayers.Format.XML.prototype.write.apply(this,
[c])},buildMetadataNode:function(a){for(var b=["name","desc","author"],c=this.createElementNS(this.namespaces.gpx,"metadata"),d=0;d<b.length;d++){var e=b[d];if(a[e]){var f=this.createElementNS(this.namespaces.gpx,e);f.appendChild(this.createTextNode(a[e]));c.appendChild(f)}}return c},buildFeatureNode:function(a){var b=a.geometry,b=b.clone();this.internalProjection&&this.externalProjection&&b.transform(this.internalProjection,this.externalProjection);if("OpenLayers.Geometry.Point"==b.CLASS_NAME){var c=
this.buildWptNode(b);this.appendAttributesNode(c,a);return c}c=this.createElementNS(this.namespaces.gpx,"trk");this.appendAttributesNode(c,a);for(var a=this.buildTrkSegNode(b),a=OpenLayers.Util.isArray(a)?a:[a],b=0,d=a.length;b<d;b++)c.appendChild(a[b]);return c},buildTrkSegNode:function(a){var b,c,d,e;if("OpenLayers.Geometry.LineString"==a.CLASS_NAME||"OpenLayers.Geometry.LinearRing"==a.CLASS_NAME){b=this.createElementNS(this.namespaces.gpx,"trkseg");c=0;for(d=a.components.length;c<d;c++)e=a.components[c],
b.appendChild(this.buildTrkPtNode(e));return b}b=[];c=0;for(d=a.components.length;c<d;c++)b.push(this.buildTrkSegNode(a.components[c]));return b},buildTrkPtNode:function(a){var b=this.createElementNS(this.namespaces.gpx,"trkpt");b.setAttribute("lon",a.x);b.setAttribute("lat",a.y);return b},buildWptNode:function(a){var b=this.createElementNS(this.namespaces.gpx,"wpt");b.setAttribute("lon",a.x);b.setAttribute("lat",a.y);return b},appendAttributesNode:function(a,b){var c=this.createElementNS(this.namespaces.gpx,
"name");c.appendChild(this.createTextNode(b.attributes.name||b.id));a.appendChild(c);c=this.createElementNS(this.namespaces.gpx,"desc");c.appendChild(this.createTextNode(b.attributes.description||this.defaultDesc));a.appendChild(c)},CLASS_NAME:"OpenLayers.Format.GPX"});
OpenLayers.Handler.Point=OpenLayers.Class(OpenLayers.Handler,{point:null,layer:null,multi:!1,citeCompliant:!1,mouseDown:!1,stoppedDown:null,lastDown:null,lastUp:null,persist:!1,stopDown:!1,stopUp:!1,layerOptions:null,pixelTolerance:5,lastTouchPx:null,initialize:function(a,b,c){if(!c||!c.layerOptions||!c.layerOptions.styleMap)this.style=OpenLayers.Util.extend(OpenLayers.Feature.Vector.style["default"],{});OpenLayers.Handler.prototype.initialize.apply(this,arguments)},activate:function(){if(!OpenLayers.Handler.prototype.activate.apply(this,
arguments))return!1;var a=OpenLayers.Util.extend({displayInLayerSwitcher:!1,calculateInRange:OpenLayers.Function.True,wrapDateLine:this.citeCompliant},this.layerOptions);this.layer=new OpenLayers.Layer.Vector(this.CLASS_NAME,a);this.map.addLayer(this.layer);return!0},createFeature:function(a){a=this.layer.getLonLatFromViewPortPx(a);a=new OpenLayers.Geometry.Point(a.lon,a.lat);this.point=new OpenLayers.Feature.Vector(a);this.callback("create",[this.point.geometry,this.point]);this.point.geometry.clearBounds();
this.layer.addFeatures([this.point],{silent:!0})},deactivate:function(){if(!OpenLayers.Handler.prototype.deactivate.apply(this,arguments))return!1;this.cancel();null!=this.layer.map&&(this.destroyFeature(!0),this.layer.destroy(!1));this.layer=null;return!0},destroyFeature:function(a){this.layer&&(a||!this.persist)&&this.layer.destroyFeatures();this.point=null},destroyPersistedFeature:function(){var a=this.layer;a&&1<a.features.length&&this.layer.features[0].destroy()},finalize:function(a){this.mouseDown=
!1;this.lastTouchPx=this.lastUp=this.lastDown=null;this.callback(a?"cancel":"done",[this.geometryClone()]);this.destroyFeature(a)},cancel:function(){this.finalize(!0)},click:function(a){OpenLayers.Event.stop(a);return!1},dblclick:function(a){OpenLayers.Event.stop(a);return!1},modifyFeature:function(a){this.point||this.createFeature(a);a=this.layer.getLonLatFromViewPortPx(a);this.point.geometry.x=a.lon;this.point.geometry.y=a.lat;this.callback("modify",[this.point.geometry,this.point,!1]);this.point.geometry.clearBounds();
this.drawFeature()},drawFeature:function(){this.layer.drawFeature(this.point,this.style)},getGeometry:function(){var a=this.point&&this.point.geometry;a&&this.multi&&(a=new OpenLayers.Geometry.MultiPoint([a]));return a},geometryClone:function(){var a=this.getGeometry();return a&&a.clone()},mousedown:function(a){return this.down(a)},touchstart:function(a){this.startTouch();this.lastTouchPx=a.xy;return this.down(a)},mousemove:function(a){return this.move(a)},touchmove:function(a){this.lastTouchPx=a.xy;
return this.move(a)},mouseup:function(a){return this.up(a)},touchend:function(a){a.xy=this.lastTouchPx;return this.up(a)},down:function(a){this.mouseDown=!0;this.lastDown=a.xy;this.touch||this.modifyFeature(a.xy);this.stoppedDown=this.stopDown;return!this.stopDown},move:function(a){!this.touch&&(!this.mouseDown||this.stoppedDown)&&this.modifyFeature(a.xy);return!0},up:function(a){this.mouseDown=!1;this.stoppedDown=this.stopDown;return this.checkModifiers(a)&&(!this.lastUp||!this.lastUp.equals(a.xy))&&
this.lastDown&&this.passesTolerance(this.lastDown,a.xy,this.pixelTolerance)?(this.touch&&this.modifyFeature(a.xy),this.persist&&this.destroyPersistedFeature(),this.lastUp=a.xy,this.finalize(),!this.stopUp):!0},mouseout:function(a){OpenLayers.Util.mouseLeft(a,this.map.viewPortDiv)&&(this.stoppedDown=this.stopDown,this.mouseDown=!1)},passesTolerance:function(a,b,c){var d=!0;null!=c&&a&&b&&a.distanceTo(b)>c&&(d=!1);return d},CLASS_NAME:"OpenLayers.Handler.Point"});
OpenLayers.Handler.Path=OpenLayers.Class(OpenLayers.Handler.Point,{line:null,maxVertices:null,doubleTouchTolerance:20,freehand:!1,freehandToggle:"shiftKey",timerId:null,redoStack:null,createFeature:function(a){a=this.layer.getLonLatFromViewPortPx(a);a=new OpenLayers.Geometry.Point(a.lon,a.lat);this.point=new OpenLayers.Feature.Vector(a);this.line=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString([this.point.geometry]));this.callback("create",[this.point.geometry,this.getSketch()]);
this.point.geometry.clearBounds();this.layer.addFeatures([this.line,this.point],{silent:!0})},destroyFeature:function(a){OpenLayers.Handler.Point.prototype.destroyFeature.call(this,a);this.line=null},destroyPersistedFeature:function(){var a=this.layer;a&&2<a.features.length&&this.layer.features[0].destroy()},removePoint:function(){this.point&&this.layer.removeFeatures([this.point])},addPoint:function(a){this.layer.removeFeatures([this.point]);a=this.layer.getLonLatFromViewPortPx(a);this.point=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(a.lon,
a.lat));this.line.geometry.addComponent(this.point.geometry,this.line.geometry.components.length);this.layer.addFeatures([this.point]);this.callback("point",[this.point.geometry,this.getGeometry()]);this.callback("modify",[this.point.geometry,this.getSketch()]);this.drawFeature();delete this.redoStack},insertXY:function(a,b){this.line.geometry.addComponent(new OpenLayers.Geometry.Point(a,b),this.getCurrentPointIndex());this.drawFeature();delete this.redoStack},insertDeltaXY:function(a,b){var c=this.getCurrentPointIndex()-
1;(c=this.line.geometry.components[c])&&(!isNaN(c.x)&&!isNaN(c.y))&&this.insertXY(c.x+a,c.y+b)},insertDirectionLength:function(a,b){var a=a*(Math.PI/180),c=b*Math.cos(a),d=b*Math.sin(a);this.insertDeltaXY(c,d)},insertDeflectionLength:function(a,b){var c=this.getCurrentPointIndex()-1;if(0<c){var d=this.line.geometry.components[c],c=this.line.geometry.components[c-1],d=Math.atan2(d.y-c.y,d.x-c.x);this.insertDirectionLength(180*d/Math.PI+a,b)}},getCurrentPointIndex:function(){return this.line.geometry.components.length-
1},undo:function(){var a=this.line.geometry,b=a.components,c=this.getCurrentPointIndex()-1,d=b[c],e=a.removeComponent(d);e&&(this.touch&&0<c&&(b=a.components,a=b[c-1],c=this.getCurrentPointIndex(),b=b[c],b.x=a.x,b.y=a.y),this.redoStack||(this.redoStack=[]),this.redoStack.push(d),this.drawFeature());return e},redo:function(){var a=this.redoStack&&this.redoStack.pop();a&&(this.line.geometry.addComponent(a,this.getCurrentPointIndex()),this.drawFeature());return!!a},freehandMode:function(a){return this.freehandToggle&&
a[this.freehandToggle]?!this.freehand:this.freehand},modifyFeature:function(a,b){this.line||this.createFeature(a);var c=this.layer.getLonLatFromViewPortPx(a);this.point.geometry.x=c.lon;this.point.geometry.y=c.lat;this.callback("modify",[this.point.geometry,this.getSketch(),b]);this.point.geometry.clearBounds();this.drawFeature()},drawFeature:function(){this.layer.drawFeature(this.line,this.style);this.layer.drawFeature(this.point,this.style)},getSketch:function(){return this.line},getGeometry:function(){var a=
this.line&&this.line.geometry;a&&this.multi&&(a=new OpenLayers.Geometry.MultiLineString([a]));return a},touchstart:function(a){if(this.timerId&&this.passesTolerance(this.lastTouchPx,a.xy,this.doubleTouchTolerance))return this.finishGeometry(),window.clearTimeout(this.timerId),this.timerId=null,!1;this.timerId&&(window.clearTimeout(this.timerId),this.timerId=null);this.timerId=window.setTimeout(OpenLayers.Function.bind(function(){this.timerId=null},this),300);return OpenLayers.Handler.Point.prototype.touchstart.call(this,
a)},down:function(a){var b=this.stopDown;this.freehandMode(a)&&(b=!0,this.touch&&(this.modifyFeature(a.xy,!!this.lastUp),OpenLayers.Event.stop(a)));!this.touch&&(!this.lastDown||!this.passesTolerance(this.lastDown,a.xy,this.pixelTolerance))&&this.modifyFeature(a.xy,!!this.lastUp);this.mouseDown=!0;this.lastDown=a.xy;this.stoppedDown=b;return!b},move:function(a){if(this.stoppedDown&&this.freehandMode(a))return this.persist&&this.destroyPersistedFeature(),this.maxVertices&&this.line&&this.line.geometry.components.length===
this.maxVertices?(this.removePoint(),this.finalize()):this.addPoint(a.xy),!1;!this.touch&&(!this.mouseDown||this.stoppedDown)&&this.modifyFeature(a.xy,!!this.lastUp);return!0},up:function(a){if(this.mouseDown&&(!this.lastUp||!this.lastUp.equals(a.xy)))this.stoppedDown&&this.freehandMode(a)?(this.persist&&this.destroyPersistedFeature(),this.removePoint(),this.finalize()):this.passesTolerance(this.lastDown,a.xy,this.pixelTolerance)&&(this.touch&&this.modifyFeature(a.xy),null==this.lastUp&&this.persist&&
this.destroyPersistedFeature(),this.addPoint(a.xy),this.lastUp=a.xy,this.line.geometry.components.length===this.maxVertices+1&&this.finishGeometry());this.stoppedDown=this.stopDown;this.mouseDown=!1;return!this.stopUp},finishGeometry:function(){this.line.geometry.removeComponent(this.line.geometry.components[this.line.geometry.components.length-1]);this.removePoint();this.finalize()},dblclick:function(a){this.freehandMode(a)||this.finishGeometry();return!1},CLASS_NAME:"OpenLayers.Handler.Path"});
OpenLayers.Handler.Polygon=OpenLayers.Class(OpenLayers.Handler.Path,{holeModifier:null,drawingHole:!1,polygon:null,createFeature:function(a){a=this.layer.getLonLatFromViewPortPx(a);a=new OpenLayers.Geometry.Point(a.lon,a.lat);this.point=new OpenLayers.Feature.Vector(a);this.line=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LinearRing([this.point.geometry]));this.polygon=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon([this.line.geometry]));this.callback("create",[this.point.geometry,
this.getSketch()]);this.point.geometry.clearBounds();this.layer.addFeatures([this.polygon,this.point],{silent:!0})},addPoint:function(a){if(!this.drawingHole&&this.holeModifier&&this.evt&&this.evt[this.holeModifier])for(var b=this.point.geometry,c=this.control.layer.features,d,e=c.length-1;0<=e;--e)if(d=c[e].geometry,(d instanceof OpenLayers.Geometry.Polygon||d instanceof OpenLayers.Geometry.MultiPolygon)&&d.intersects(b)){b=c[e];this.control.layer.removeFeatures([b],{silent:!0});this.control.layer.events.registerPriority("sketchcomplete",
this,this.finalizeInteriorRing);this.control.layer.events.registerPriority("sketchmodified",this,this.enforceTopology);b.geometry.addComponent(this.line.geometry);this.polygon=b;this.drawingHole=!0;break}OpenLayers.Handler.Path.prototype.addPoint.apply(this,arguments)},getCurrentPointIndex:function(){return this.line.geometry.components.length-2},enforceTopology:function(a){var a=a.vertex,b=this.line.geometry.components;this.polygon.geometry.intersects(a)||(b=b[b.length-3],a.x=b.x,a.y=b.y)},finishGeometry:function(){this.line.geometry.removeComponent(this.line.geometry.components[this.line.geometry.components.length-
2]);this.removePoint();this.finalize()},finalizeInteriorRing:function(){var a=this.line.geometry,b=0!==a.getArea();if(b){for(var c=this.polygon.geometry.components,d=c.length-2;0<=d;--d)if(a.intersects(c[d])){b=!1;break}if(b){d=c.length-2;a:for(;0<d;--d)for(var e=c[d].components,f=0,g=e.length;f<g;++f)if(a.containsPoint(e[f])){b=!1;break a}}}b?this.polygon.state!==OpenLayers.State.INSERT&&(this.polygon.state=OpenLayers.State.UPDATE):this.polygon.geometry.removeComponent(a);this.restoreFeature();return!1},
cancel:function(){this.drawingHole&&(this.polygon.geometry.removeComponent(this.line.geometry),this.restoreFeature(!0));return OpenLayers.Handler.Path.prototype.cancel.apply(this,arguments)},restoreFeature:function(a){this.control.layer.events.unregister("sketchcomplete",this,this.finalizeInteriorRing);this.control.layer.events.unregister("sketchmodified",this,this.enforceTopology);this.layer.removeFeatures([this.polygon],{silent:!0});this.control.layer.addFeatures([this.polygon],{silent:!0});this.drawingHole=
!1;a||this.control.layer.events.triggerEvent("sketchcomplete",{feature:this.polygon})},destroyFeature:function(a){OpenLayers.Handler.Path.prototype.destroyFeature.call(this,a);this.polygon=null},drawFeature:function(){this.layer.drawFeature(this.polygon,this.style);this.layer.drawFeature(this.point,this.style)},getSketch:function(){return this.polygon},getGeometry:function(){var a=this.polygon&&this.polygon.geometry;a&&this.multi&&(a=new OpenLayers.Geometry.MultiPolygon([a]));return a},CLASS_NAME:"OpenLayers.Handler.Polygon"});
OpenLayers.Renderer=OpenLayers.Class({container:null,root:null,extent:null,locked:!1,size:null,resolution:null,map:null,featureDx:0,initialize:function(a,b){this.container=OpenLayers.Util.getElement(a);OpenLayers.Util.extend(this,b)},destroy:function(){this.map=this.resolution=this.size=this.extent=this.container=null},supported:function(){return!1},setExtent:function(a,b){this.extent=a.clone();if(this.map.baseLayer&&this.map.baseLayer.wrapDateLine){var c=a.getWidth()/this.map.getExtent().getWidth(),
a=a.scale(1/c);this.extent=a.wrapDateLine(this.map.getMaxExtent()).scale(c)}b&&(this.resolution=null);return!0},setSize:function(a){this.size=a.clone();this.resolution=null},getResolution:function(){return this.resolution=this.resolution||this.map.getResolution()},drawFeature:function(a,b){null==b&&(b=a.style);if(a.geometry){var c=a.geometry.getBounds();if(c){var d;this.map.baseLayer&&this.map.baseLayer.wrapDateLine&&(d=this.map.getMaxExtent());c.intersectsBounds(this.extent,{worldBounds:d})?this.calculateFeatureDx(c,
d):b={display:"none"};c=this.drawGeometry(a.geometry,b,a.id);if("none"!=b.display&&b.label&&!1!==c){d=a.geometry.getCentroid();if(b.labelXOffset||b.labelYOffset){var e=isNaN(b.labelXOffset)?0:b.labelXOffset,f=isNaN(b.labelYOffset)?0:b.labelYOffset,g=this.getResolution();d.move(e*g,f*g)}this.drawText(a.id,b,d)}else this.removeText(a.id);return c}}},calculateFeatureDx:function(a,b){this.featureDx=0;if(b){var c=b.getWidth();this.featureDx=Math.round(((a.left+a.right)/2-(this.extent.left+this.extent.right)/
2)/c)*c}},drawGeometry:function(){},drawText:function(){},removeText:function(){},clear:function(){},getFeatureIdFromEvent:function(){},eraseFeatures:function(a){OpenLayers.Util.isArray(a)||(a=[a]);for(var b=0,c=a.length;b<c;++b){var d=a[b];this.eraseGeometry(d.geometry,d.id);this.removeText(d.id)}},eraseGeometry:function(){},moveRoot:function(){},getRenderLayerId:function(){return this.container.id},applyDefaultSymbolizer:function(a){var b=OpenLayers.Util.extend({},OpenLayers.Renderer.defaultSymbolizer);
!1===a.stroke&&(delete b.strokeWidth,delete b.strokeColor);!1===a.fill&&delete b.fillColor;OpenLayers.Util.extend(b,a);return b},CLASS_NAME:"OpenLayers.Renderer"});OpenLayers.Renderer.defaultSymbolizer={fillColor:"#000000",strokeColor:"#000000",strokeWidth:2,fillOpacity:1,strokeOpacity:1,pointRadius:0,labelAlign:"cm"};
OpenLayers.Renderer.symbol={star:[350,75,379,161,469,161,397,215,423,301,350,250,277,301,303,215,231,161,321,161,350,75],cross:[4,0,6,0,6,4,10,4,10,6,6,6,6,10,4,10,4,6,0,6,0,4,4,4,4,0],x:[0,0,25,0,50,35,75,0,100,0,65,50,100,100,75,100,50,65,25,100,0,100,35,50,0,0],square:[0,0,0,1,1,1,1,0,0,0],triangle:[0,10,10,10,5,0,0,10]};
OpenLayers.Renderer.Canvas=OpenLayers.Class(OpenLayers.Renderer,{hitDetection:!0,hitOverflow:0,canvas:null,features:null,pendingRedraw:!1,cachedSymbolBounds:{},initialize:function(a,b){OpenLayers.Renderer.prototype.initialize.apply(this,arguments);this.root=document.createElement("canvas");this.container.appendChild(this.root);this.canvas=this.root.getContext("2d");this.features={};this.hitDetection&&(this.hitCanvas=document.createElement("canvas"),this.hitContext=this.hitCanvas.getContext("2d"))},
setExtent:function(){OpenLayers.Renderer.prototype.setExtent.apply(this,arguments);return!1},eraseGeometry:function(a,b){this.eraseFeatures(this.features[b][0])},supported:function(){return OpenLayers.CANVAS_SUPPORTED},setSize:function(a){this.size=a.clone();var b=this.root;b.style.width=a.w+"px";b.style.height=a.h+"px";b.width=a.w;b.height=a.h;this.resolution=null;this.hitDetection&&(b=this.hitCanvas,b.style.width=a.w+"px",b.style.height=a.h+"px",b.width=a.w,b.height=a.h)},drawFeature:function(a,
b){var c;if(a.geometry){b=this.applyDefaultSymbolizer(b||a.style);c=a.geometry.getBounds();var d;this.map.baseLayer&&this.map.baseLayer.wrapDateLine&&(d=this.map.getMaxExtent());d=c&&c.intersectsBounds(this.extent,{worldBounds:d});(c="none"!==b.display&&!!c&&d)?this.features[a.id]=[a,b]:delete this.features[a.id];this.pendingRedraw=!0}this.pendingRedraw&&!this.locked&&(this.redraw(),this.pendingRedraw=!1);return c},drawGeometry:function(a,b,c){var d=a.CLASS_NAME;if("OpenLayers.Geometry.Collection"==
d||"OpenLayers.Geometry.MultiPoint"==d||"OpenLayers.Geometry.MultiLineString"==d||"OpenLayers.Geometry.MultiPolygon"==d)for(d=0;d<a.components.length;d++)this.drawGeometry(a.components[d],b,c);else switch(a.CLASS_NAME){case "OpenLayers.Geometry.Point":this.drawPoint(a,b,c);break;case "OpenLayers.Geometry.LineString":this.drawLineString(a,b,c);break;case "OpenLayers.Geometry.LinearRing":this.drawLinearRing(a,b,c);break;case "OpenLayers.Geometry.Polygon":this.drawPolygon(a,b,c)}},drawExternalGraphic:function(a,
b,c){var d=new Image,e=b.title||b.graphicTitle;e&&(d.title=e);var f=b.graphicWidth||b.graphicHeight,g=b.graphicHeight||b.graphicWidth,f=f?f:2*b.pointRadius,g=g?g:2*b.pointRadius,h=void 0!=b.graphicXOffset?b.graphicXOffset:-(0.5*f),j=void 0!=b.graphicYOffset?b.graphicYOffset:-(0.5*g),n=b.graphicOpacity||b.fillOpacity;d.onload=OpenLayers.Function.bind(function(){if(this.features[c]){var b=this.getLocalXY(a),e=b[0],b=b[1];if(!isNaN(e)&&!isNaN(b)){var e=e+h|0,b=b+j|0,m=this.canvas;m.globalAlpha=n;var r=
OpenLayers.Renderer.Canvas.drawImageScaleFactor||(OpenLayers.Renderer.Canvas.drawImageScaleFactor=/android 2.1/.test(navigator.userAgent.toLowerCase())?320/window.screen.width:1);m.drawImage(d,e*r,b*r,f*r,g*r);this.hitDetection&&(this.setHitContextStyle("fill",c),this.hitContext.fillRect(e,b,f,g))}}},this);d.src=b.externalGraphic},drawNamedSymbol:function(a,b,c){var d,e,f,g;f=Math.PI/180;var h=OpenLayers.Renderer.symbol[b.graphicName];if(!h)throw Error(b.graphicName+" is not a valid symbol name");
if(h.length&&!(2>h.length)&&(a=this.getLocalXY(a),e=a[0],g=a[1],!isNaN(e)&&!isNaN(g))){this.canvas.lineCap="round";this.canvas.lineJoin="round";this.hitDetection&&(this.hitContext.lineCap="round",this.hitContext.lineJoin="round");if(b.graphicName in this.cachedSymbolBounds)d=this.cachedSymbolBounds[b.graphicName];else{d=new OpenLayers.Bounds;for(a=0;a<h.length;a+=2)d.extend(new OpenLayers.LonLat(h[a],h[a+1]));this.cachedSymbolBounds[b.graphicName]=d}this.canvas.save();this.hitDetection&&this.hitContext.save();
this.canvas.translate(e,g);this.hitDetection&&this.hitContext.translate(e,g);a=f*b.rotation;isNaN(a)||(this.canvas.rotate(a),this.hitDetection&&this.hitContext.rotate(a));f=2*b.pointRadius/Math.max(d.getWidth(),d.getHeight());this.canvas.scale(f,f);this.hitDetection&&this.hitContext.scale(f,f);a=d.getCenterLonLat().lon;d=d.getCenterLonLat().lat;this.canvas.translate(-a,-d);this.hitDetection&&this.hitContext.translate(-a,-d);g=b.strokeWidth;b.strokeWidth=g/f;if(!1!==b.fill){this.setCanvasStyle("fill",
b);this.canvas.beginPath();for(a=0;a<h.length;a+=2)d=h[a],e=h[a+1],0==a&&this.canvas.moveTo(d,e),this.canvas.lineTo(d,e);this.canvas.closePath();this.canvas.fill();if(this.hitDetection){this.setHitContextStyle("fill",c,b);this.hitContext.beginPath();for(a=0;a<h.length;a+=2)d=h[a],e=h[a+1],0==a&&this.canvas.moveTo(d,e),this.hitContext.lineTo(d,e);this.hitContext.closePath();this.hitContext.fill()}}if(!1!==b.stroke){this.setCanvasStyle("stroke",b);this.canvas.beginPath();for(a=0;a<h.length;a+=2)d=h[a],
e=h[a+1],0==a&&this.canvas.moveTo(d,e),this.canvas.lineTo(d,e);this.canvas.closePath();this.canvas.stroke();if(this.hitDetection){this.setHitContextStyle("stroke",c,b,f);this.hitContext.beginPath();for(a=0;a<h.length;a+=2)d=h[a],e=h[a+1],0==a&&this.hitContext.moveTo(d,e),this.hitContext.lineTo(d,e);this.hitContext.closePath();this.hitContext.stroke()}}b.strokeWidth=g;this.canvas.restore();this.hitDetection&&this.hitContext.restore();this.setCanvasStyle("reset")}},setCanvasStyle:function(a,b){"fill"===
a?(this.canvas.globalAlpha=b.fillOpacity,this.canvas.fillStyle=b.fillColor):"stroke"===a?(this.canvas.globalAlpha=b.strokeOpacity,this.canvas.strokeStyle=b.strokeColor,this.canvas.lineWidth=b.strokeWidth):(this.canvas.globalAlpha=0,this.canvas.lineWidth=1)},featureIdToHex:function(a){a=Number(a.split("_").pop())+1;16777216<=a&&(this.hitOverflow=a-16777215,a=a%16777216+1);var a="000000"+a.toString(16),b=a.length;return a="#"+a.substring(b-6,b)},setHitContextStyle:function(a,b,c,d){b=this.featureIdToHex(b);
"fill"==a?(this.hitContext.globalAlpha=1,this.hitContext.fillStyle=b):"stroke"==a?(this.hitContext.globalAlpha=1,this.hitContext.strokeStyle=b,"undefined"===typeof d?this.hitContext.lineWidth=c.strokeWidth+2:isNaN(d)||(this.hitContext.lineWidth=c.strokeWidth+2/d)):(this.hitContext.globalAlpha=0,this.hitContext.lineWidth=1)},drawPoint:function(a,b,c){if(!1!==b.graphic)if(b.externalGraphic)this.drawExternalGraphic(a,b,c);else if(b.graphicName&&"circle"!=b.graphicName)this.drawNamedSymbol(a,b,c);else{var d=
this.getLocalXY(a),a=d[0],d=d[1];if(!isNaN(a)&&!isNaN(d)){var e=2*Math.PI,f=b.pointRadius;!1!==b.fill&&(this.setCanvasStyle("fill",b),this.canvas.beginPath(),this.canvas.arc(a,d,f,0,e,!0),this.canvas.fill(),this.hitDetection&&(this.setHitContextStyle("fill",c,b),this.hitContext.beginPath(),this.hitContext.arc(a,d,f,0,e,!0),this.hitContext.fill()));!1!==b.stroke&&(this.setCanvasStyle("stroke",b),this.canvas.beginPath(),this.canvas.arc(a,d,f,0,e,!0),this.canvas.stroke(),this.hitDetection&&(this.setHitContextStyle("stroke",
c,b),this.hitContext.beginPath(),this.hitContext.arc(a,d,f,0,e,!0),this.hitContext.stroke()),this.setCanvasStyle("reset"))}}},drawLineString:function(a,b,c){b=OpenLayers.Util.applyDefaults({fill:!1},b);this.drawLinearRing(a,b,c)},drawLinearRing:function(a,b,c){!1!==b.fill&&(this.setCanvasStyle("fill",b),this.renderPath(this.canvas,a,b,c,"fill"),this.hitDetection&&(this.setHitContextStyle("fill",c,b),this.renderPath(this.hitContext,a,b,c,"fill")));!1!==b.stroke&&(this.setCanvasStyle("stroke",b),this.renderPath(this.canvas,
a,b,c,"stroke"),this.hitDetection&&(this.setHitContextStyle("stroke",c,b),this.renderPath(this.hitContext,a,b,c,"stroke")));this.setCanvasStyle("reset")},renderPath:function(a,b,c,d,e){b=b.components;c=b.length;a.beginPath();var d=this.getLocalXY(b[0]),f=d[1];if(!isNaN(d[0])&&!isNaN(f)){a.moveTo(d[0],d[1]);for(d=1;d<c;++d)f=this.getLocalXY(b[d]),a.lineTo(f[0],f[1]);"fill"===e?a.fill():a.stroke()}},drawPolygon:function(a,b,c){var a=a.components,d=a.length;this.drawLinearRing(a[0],b,c);for(var e=1;e<
d;++e)this.canvas.globalCompositeOperation="destination-out",this.hitDetection&&(this.hitContext.globalCompositeOperation="destination-out"),this.drawLinearRing(a[e],OpenLayers.Util.applyDefaults({stroke:!1,fillOpacity:1},b),c),this.canvas.globalCompositeOperation="source-over",this.hitDetection&&(this.hitContext.globalCompositeOperation="source-over"),this.drawLinearRing(a[e],OpenLayers.Util.applyDefaults({fill:!1},b),c)},drawText:function(a,b){var c=this.getLocalXY(a);this.setCanvasStyle("reset");
this.canvas.fillStyle=b.fontColor;this.canvas.globalAlpha=b.fontOpacity||1;var d=[b.fontStyle?b.fontStyle:"normal","normal",b.fontWeight?b.fontWeight:"normal",b.fontSize?b.fontSize:"1em",b.fontFamily?b.fontFamily:"sans-serif"].join(" "),e=b.label.split("\n"),f=e.length;if(this.canvas.fillText){this.canvas.font=d;this.canvas.textAlign=OpenLayers.Renderer.Canvas.LABEL_ALIGN[b.labelAlign[0]]||"center";this.canvas.textBaseline=OpenLayers.Renderer.Canvas.LABEL_ALIGN[b.labelAlign[1]]||"middle";var g=OpenLayers.Renderer.Canvas.LABEL_FACTOR[b.labelAlign[1]];
null==g&&(g=-0.5);d=this.canvas.measureText("Mg").height||this.canvas.measureText("xx").width;c[1]+=d*g*(f-1);for(g=0;g<f;g++)b.labelOutlineWidth&&(this.canvas.save(),this.canvas.globalAlpha=b.labelOutlineOpacity||b.fontOpacity||1,this.canvas.strokeStyle=b.labelOutlineColor,this.canvas.lineWidth=b.labelOutlineWidth,this.canvas.strokeText(e[g],c[0],c[1]+d*g+1),this.canvas.restore()),this.canvas.fillText(e[g],c[0],c[1]+d*g)}else if(this.canvas.mozDrawText){this.canvas.mozTextStyle=d;var h=OpenLayers.Renderer.Canvas.LABEL_FACTOR[b.labelAlign[0]];
null==h&&(h=-0.5);g=OpenLayers.Renderer.Canvas.LABEL_FACTOR[b.labelAlign[1]];null==g&&(g=-0.5);d=this.canvas.mozMeasureText("xx");c[1]+=d*(1+g*f);for(g=0;g<f;g++){var j=c[0]+h*this.canvas.mozMeasureText(e[g]),n=c[1]+g*d;this.canvas.translate(j,n);this.canvas.mozDrawText(e[g]);this.canvas.translate(-j,-n)}}this.setCanvasStyle("reset")},getLocalXY:function(a){var b=this.getResolution(),c=this.extent;return[(a.x-this.featureDx)/b+-c.left/b,c.top/b-a.y/b]},clear:function(){var a=this.root.height,b=this.root.width;
this.canvas.clearRect(0,0,b,a);this.features={};this.hitDetection&&this.hitContext.clearRect(0,0,b,a)},getFeatureIdFromEvent:function(a){var b;if(this.hitDetection&&"none"!==this.root.style.display&&!this.map.dragging&&(a=a.xy,a=this.hitContext.getImageData(a.x|0,a.y|0,1,1).data,255===a[3]&&(a=a[2]+256*(a[1]+256*a[0])))){a="OpenLayers_Feature_Vector_"+(a-1+this.hitOverflow);try{b=this.features[a][0]}catch(c){}}return b},eraseFeatures:function(a){OpenLayers.Util.isArray(a)||(a=[a]);for(var b=0;b<a.length;++b)delete this.features[a[b].id];
this.redraw()},redraw:function(){if(!this.locked){var a=this.root.height,b=this.root.width;this.canvas.clearRect(0,0,b,a);this.hitDetection&&this.hitContext.clearRect(0,0,b,a);var a=[],c,d,e=this.map.baseLayer&&this.map.baseLayer.wrapDateLine&&this.map.getMaxExtent(),f;for(f in this.features)this.features.hasOwnProperty(f)&&(b=this.features[f][0],c=b.geometry,this.calculateFeatureDx(c.getBounds(),e),d=this.features[f][1],this.drawGeometry(c,d,b.id),d.label&&a.push([b,d]));b=0;for(c=a.length;b<c;++b)f=
a[b],this.drawText(f[0].geometry.getCentroid(),f[1])}},CLASS_NAME:"OpenLayers.Renderer.Canvas"});OpenLayers.Renderer.Canvas.LABEL_ALIGN={l:"left",r:"right",t:"top",b:"bottom"};OpenLayers.Renderer.Canvas.LABEL_FACTOR={l:0,r:-1,t:0,b:-1};OpenLayers.Renderer.Canvas.drawImageScaleFactor=null;
OpenLayers.Handler.Keyboard=OpenLayers.Class(OpenLayers.Handler,{KEY_EVENTS:["keydown","keyup"],eventListener:null,observeElement:null,initialize:function(a,b,c){OpenLayers.Handler.prototype.initialize.apply(this,arguments);this.eventListener=OpenLayers.Function.bindAsEventListener(this.handleKeyEvent,this)},destroy:function(){this.deactivate();this.eventListener=null;OpenLayers.Handler.prototype.destroy.apply(this,arguments)},activate:function(){if(OpenLayers.Handler.prototype.activate.apply(this,
arguments)){this.observeElement=this.observeElement||document;for(var a=0,b=this.KEY_EVENTS.length;a<b;a++)OpenLayers.Event.observe(this.observeElement,this.KEY_EVENTS[a],this.eventListener);return!0}return!1},deactivate:function(){var a=!1;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){for(var a=0,b=this.KEY_EVENTS.length;a<b;a++)OpenLayers.Event.stopObserving(this.observeElement,this.KEY_EVENTS[a],this.eventListener);a=!0}return a},handleKeyEvent:function(a){this.checkModifiers(a)&&
this.callback(a.type,[a])},CLASS_NAME:"OpenLayers.Handler.Keyboard"});
OpenLayers.Control.ModifyFeature=OpenLayers.Class(OpenLayers.Control,{documentDrag:!1,geometryTypes:null,clickout:!0,toggle:!0,standalone:!1,layer:null,feature:null,vertex:null,vertices:null,virtualVertices:null,handlers:null,deleteCodes:null,virtualStyle:null,vertexRenderIntent:null,mode:null,createVertices:!0,modified:!1,radiusHandle:null,dragHandle:null,onModificationStart:function(){},onModification:function(){},onModificationEnd:function(){},initialize:function(a,b){b=b||{};this.layer=a;this.vertices=
[];this.virtualVertices=[];this.virtualStyle=OpenLayers.Util.extend({},this.layer.style||this.layer.styleMap.createSymbolizer(null,b.vertexRenderIntent));this.virtualStyle.fillOpacity=0.3;this.virtualStyle.strokeOpacity=0.3;this.deleteCodes=[46,68];this.mode=OpenLayers.Control.ModifyFeature.RESHAPE;OpenLayers.Control.prototype.initialize.apply(this,[b]);OpenLayers.Util.isArray(this.deleteCodes)||(this.deleteCodes=[this.deleteCodes]);var c={documentDrag:this.documentDrag,stopDown:!1};this.handlers=
{keyboard:new OpenLayers.Handler.Keyboard(this,{keydown:this.handleKeypress}),drag:new OpenLayers.Handler.Drag(this,{down:function(){this.vertex=null;var a=this.layer.getFeatureFromEvent(this.handlers.drag.evt);a?this.dragStart(a):this.clickout&&(this._unselect=this.feature)},move:function(a){delete this._unselect;this.vertex&&this.dragVertex(this.vertex,a)},up:function(){this.handlers.drag.stopDown=!1;this._unselect&&(this.unselectFeature(this._unselect),delete this._unselect)},done:function(){this.vertex&&
this.dragComplete(this.vertex)}},c)}},destroy:function(){this.map&&this.map.events.un({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this});this.layer=null;OpenLayers.Control.prototype.destroy.apply(this,[])},activate:function(){this.moveLayerToTop();this.map.events.on({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this});return this.handlers.keyboard.activate()&&this.handlers.drag.activate()&&OpenLayers.Control.prototype.activate.apply(this,arguments)},
deactivate:function(){var a=!1;OpenLayers.Control.prototype.deactivate.apply(this,arguments)&&(this.moveLayerBack(),this.map.events.un({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this}),this.layer.removeFeatures(this.vertices,{silent:!0}),this.layer.removeFeatures(this.virtualVertices,{silent:!0}),this.vertices=[],this.handlers.drag.deactivate(),this.handlers.keyboard.deactivate(),(a=this.feature)&&(a.geometry&&a.layer)&&this.unselectFeature(a),a=!0);return a},beforeSelectFeature:function(a){return this.layer.events.triggerEvent("beforefeaturemodified",
{feature:a})},selectFeature:function(a){if(!(this.feature===a||this.geometryTypes&&-1==OpenLayers.Util.indexOf(this.geometryTypes,a.geometry.CLASS_NAME))){!1!==this.beforeSelectFeature(a)&&(this.feature&&this.unselectFeature(this.feature),this.feature=a,this.layer.selectedFeatures.push(a),this.layer.drawFeature(a,"select"),this.modified=!1,this.resetVertices(),this.onModificationStart(this.feature));var b=a.modified;if(a.geometry&&(!b||!b.geometry))this._originalGeometry=a.geometry.clone()}},unselectFeature:function(a){this.layer.removeFeatures(this.vertices,
{silent:!0});this.vertices=[];this.layer.destroyFeatures(this.virtualVertices,{silent:!0});this.virtualVertices=[];this.dragHandle&&(this.layer.destroyFeatures([this.dragHandle],{silent:!0}),delete this.dragHandle);this.radiusHandle&&(this.layer.destroyFeatures([this.radiusHandle],{silent:!0}),delete this.radiusHandle);this.layer.drawFeature(this.feature,"default");this.feature=null;OpenLayers.Util.removeItem(this.layer.selectedFeatures,a);this.onModificationEnd(a);this.layer.events.triggerEvent("afterfeaturemodified",
{feature:a,modified:this.modified});this.modified=!1},dragStart:function(a){var b="OpenLayers.Geometry.Point"==a.geometry.CLASS_NAME;if(!this.standalone&&(!a._sketch&&b||!a._sketch))this.toggle&&this.feature===a&&(this._unselect=a),this.selectFeature(a);if(a._sketch||b)this.vertex=a,this.handlers.drag.stopDown=!0},dragVertex:function(a,b){var c=this.map.getLonLatFromViewPortPx(b),d=a.geometry;d.move(c.lon-d.x,c.lat-d.y);this.modified=!0;"OpenLayers.Geometry.Point"==this.feature.geometry.CLASS_NAME?
this.layer.events.triggerEvent("vertexmodified",{vertex:a.geometry,feature:this.feature,pixel:b}):(a._index?(a.geometry.parent.addComponent(a.geometry,a._index),delete a._index,OpenLayers.Util.removeItem(this.virtualVertices,a),this.vertices.push(a)):a==this.dragHandle?(this.layer.removeFeatures(this.vertices,{silent:!0}),this.vertices=[],this.radiusHandle&&(this.layer.destroyFeatures([this.radiusHandle],{silent:!0}),this.radiusHandle=null)):a!==this.radiusHandle&&this.layer.events.triggerEvent("vertexmodified",
{vertex:a.geometry,feature:this.feature,pixel:b}),0<this.virtualVertices.length&&(this.layer.destroyFeatures(this.virtualVertices,{silent:!0}),this.virtualVertices=[]),this.layer.drawFeature(this.feature,this.standalone?void 0:"select"));this.layer.drawFeature(a)},dragComplete:function(){this.resetVertices();this.setFeatureState();this.onModification(this.feature);this.layer.events.triggerEvent("featuremodified",{feature:this.feature})},setFeatureState:function(){if(this.feature.state!=OpenLayers.State.INSERT&&
this.feature.state!=OpenLayers.State.DELETE&&(this.feature.state=OpenLayers.State.UPDATE,this.modified&&this._originalGeometry)){var a=this.feature;a.modified=OpenLayers.Util.extend(a.modified,{geometry:this._originalGeometry});delete this._originalGeometry}},resetVertices:function(){0<this.vertices.length&&(this.layer.removeFeatures(this.vertices,{silent:!0}),this.vertices=[]);0<this.virtualVertices.length&&(this.layer.removeFeatures(this.virtualVertices,{silent:!0}),this.virtualVertices=[]);this.dragHandle&&
(this.layer.destroyFeatures([this.dragHandle],{silent:!0}),this.dragHandle=null);this.radiusHandle&&(this.layer.destroyFeatures([this.radiusHandle],{silent:!0}),this.radiusHandle=null);this.feature&&"OpenLayers.Geometry.Point"!=this.feature.geometry.CLASS_NAME&&(this.mode&OpenLayers.Control.ModifyFeature.DRAG&&this.collectDragHandle(),this.mode&(OpenLayers.Control.ModifyFeature.ROTATE|OpenLayers.Control.ModifyFeature.RESIZE)&&this.collectRadiusHandle(),this.mode&OpenLayers.Control.ModifyFeature.RESHAPE&&
(this.mode&OpenLayers.Control.ModifyFeature.RESIZE||this.collectVertices()))},handleKeypress:function(a){var b=a.keyCode;if(this.feature&&-1!=OpenLayers.Util.indexOf(this.deleteCodes,b)&&(b=this.layer.getFeatureFromEvent(this.handlers.drag.evt))&&-1!=OpenLayers.Util.indexOf(this.vertices,b)&&!this.handlers.drag.dragging&&b.geometry.parent)b.geometry.parent.removeComponent(b.geometry),this.layer.events.triggerEvent("vertexremoved",{vertex:b.geometry,feature:this.feature,pixel:a.xy}),this.layer.drawFeature(this.feature,
this.standalone?void 0:"select"),this.modified=!0,this.resetVertices(),this.setFeatureState(),this.onModification(this.feature),this.layer.events.triggerEvent("featuremodified",{feature:this.feature})},collectVertices:function(){function a(c){var d,e,f;if("OpenLayers.Geometry.Point"==c.CLASS_NAME)e=new OpenLayers.Feature.Vector(c),e._sketch=!0,e.renderIntent=b.vertexRenderIntent,b.vertices.push(e);else{f=c.components.length;"OpenLayers.Geometry.LinearRing"==c.CLASS_NAME&&(f-=1);for(d=0;d<f;++d)e=
c.components[d],"OpenLayers.Geometry.Point"==e.CLASS_NAME?(e=new OpenLayers.Feature.Vector(e),e._sketch=!0,e.renderIntent=b.vertexRenderIntent,b.vertices.push(e)):a(e);if(b.createVertices&&"OpenLayers.Geometry.MultiPoint"!=c.CLASS_NAME){d=0;for(f=c.components.length;d<f-1;++d){e=c.components[d];var g=c.components[d+1];"OpenLayers.Geometry.Point"==e.CLASS_NAME&&"OpenLayers.Geometry.Point"==g.CLASS_NAME&&(e=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point((e.x+g.x)/2,(e.y+g.y)/2),null,b.virtualStyle),
e.geometry.parent=c,e._index=d+1,e._sketch=!0,b.virtualVertices.push(e))}}}}this.vertices=[];this.virtualVertices=[];var b=this;a.call(this,this.feature.geometry);this.layer.addFeatures(this.virtualVertices,{silent:!0});this.layer.addFeatures(this.vertices,{silent:!0})},collectDragHandle:function(){var a=this.feature.geometry,b=a.getBounds().getCenterLonLat(),b=new OpenLayers.Geometry.Point(b.lon,b.lat),c=new OpenLayers.Feature.Vector(b);b.move=function(b,c){OpenLayers.Geometry.Point.prototype.move.call(this,
b,c);a.move(b,c)};c._sketch=!0;this.dragHandle=c;this.dragHandle.renderIntent=this.vertexRenderIntent;this.layer.addFeatures([this.dragHandle],{silent:!0})},collectRadiusHandle:function(){var a=this.feature.geometry,b=a.getBounds(),c=b.getCenterLonLat(),d=new OpenLayers.Geometry.Point(c.lon,c.lat),b=new OpenLayers.Geometry.Point(b.right,b.bottom),c=new OpenLayers.Feature.Vector(b),e=this.mode&OpenLayers.Control.ModifyFeature.RESIZE,f=this.mode&OpenLayers.Control.ModifyFeature.RESHAPE,g=this.mode&
OpenLayers.Control.ModifyFeature.ROTATE;b.move=function(b,c){OpenLayers.Geometry.Point.prototype.move.call(this,b,c);var n=this.x-d.x,p=this.y-d.y,q=n-b,m=p-c;if(g){var r=Math.atan2(m,q),r=Math.atan2(p,n)-r,r=r*(180/Math.PI);a.rotate(r,d)}if(e){var s;f?(p/=m,s=n/q/p):(q=Math.sqrt(q*q+m*m),p=Math.sqrt(n*n+p*p)/q);a.resize(p,d,s)}};c._sketch=!0;this.radiusHandle=c;this.radiusHandle.renderIntent=this.vertexRenderIntent;this.layer.addFeatures([this.radiusHandle],{silent:!0})},setMap:function(a){this.handlers.drag.setMap(a);
OpenLayers.Control.prototype.setMap.apply(this,arguments)},handleMapEvents:function(a){("removelayer"==a.type||"order"==a.property)&&this.moveLayerToTop()},moveLayerToTop:function(){var a=Math.max(this.map.Z_INDEX_BASE.Feature-1,this.layer.getZIndex())+1;this.layer.setZIndex(a)},moveLayerBack:function(){var a=this.layer.getZIndex()-1;a>=this.map.Z_INDEX_BASE.Feature?this.layer.setZIndex(a):this.map.setLayerZIndex(this.layer,this.map.getLayerIndex(this.layer))},CLASS_NAME:"OpenLayers.Control.ModifyFeature"});
OpenLayers.Control.ModifyFeature.RESHAPE=1;OpenLayers.Control.ModifyFeature.RESIZE=2;OpenLayers.Control.ModifyFeature.ROTATE=4;OpenLayers.Control.ModifyFeature.DRAG=8;
OpenLayers.Layer.XYZ=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,sphericalMercator:!1,zoomOffset:0,serverResolutions:null,initialize:function(a,b,c){if(c&&c.sphericalMercator||this.sphericalMercator)c=OpenLayers.Util.extend({projection:"EPSG:900913",numZoomLevels:19},c);OpenLayers.Layer.Grid.prototype.initialize.apply(this,[a||this.name,b||this.url,{},c])},clone:function(a){null==a&&(a=new OpenLayers.Layer.XYZ(this.name,this.url,this.getOptions()));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,
[a])},getURL:function(a){var a=this.getXYZ(a),b=this.url;OpenLayers.Util.isArray(b)&&(b=this.selectUrl(""+a.x+a.y+a.z,b));return OpenLayers.String.format(b,a)},getXYZ:function(a){var b=this.getServerResolution(),c=Math.round((a.left-this.maxExtent.left)/(b*this.tileSize.w)),a=Math.round((this.maxExtent.top-a.top)/(b*this.tileSize.h)),b=this.getServerZoom();if(this.wrapDateLine)var d=Math.pow(2,b),c=(c%d+d)%d;return{x:c,y:a,z:b}},setMap:function(a){OpenLayers.Layer.Grid.prototype.setMap.apply(this,
arguments);this.tileOrigin||(this.tileOrigin=new OpenLayers.LonLat(this.maxExtent.left,this.maxExtent.bottom))},CLASS_NAME:"OpenLayers.Layer.XYZ"});
OpenLayers.Layer.Bing=OpenLayers.Class(OpenLayers.Layer.XYZ,{key:null,serverResolutions:[156543.03390625,78271.516953125,39135.7584765625,19567.87923828125,9783.939619140625,4891.9698095703125,2445.9849047851562,1222.9924523925781,611.4962261962891,305.74811309814453,152.87405654907226,76.43702827453613,38.218514137268066,19.109257068634033,9.554628534317017,4.777314267158508,2.388657133579254,1.194328566789627,0.5971642833948135,0.29858214169740677,0.14929107084870338,0.07464553542435169],attributionTemplate:'<span class="olBingAttribution ${type}"><div><a target="_blank" href="http://www.bing.com/maps/"><img src="${logo}" /></a></div>${copyrights}<a style="white-space: nowrap" target="_blank" href="http://www.microsoft.com/maps/product/terms.html">Terms of Use</a></span>',
metadata:null,protocolRegex:/^http:/i,type:"Road",culture:"en-US",metadataParams:null,tileOptions:null,protocol:~window.location.href.indexOf("http")?"":"http:",initialize:function(a){a=OpenLayers.Util.applyDefaults({sphericalMercator:!0},a);OpenLayers.Layer.XYZ.prototype.initialize.apply(this,[a.name||"Bing "+(a.type||this.type),null,a]);this.tileOptions=OpenLayers.Util.extend({crossOriginKeyword:"anonymous"},this.options.tileOptions);this.loadMetadata()},loadMetadata:function(){this._callbackId=
"_callback_"+this.id.replace(/\./g,"_");window[this._callbackId]=OpenLayers.Function.bind(OpenLayers.Layer.Bing.processMetadata,this);var a=OpenLayers.Util.applyDefaults({key:this.key,jsonp:this._callbackId,include:"ImageryProviders"},this.metadataParams),a=this.protocol+"//dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.type+"?"+OpenLayers.Util.getParameterString(a),b=document.createElement("script");b.type="text/javascript";b.src=a;b.id=this._callbackId;document.getElementsByTagName("head")[0].appendChild(b)},
initLayer:function(){var a=this.metadata.resourceSets[0].resources[0],b=a.imageUrl.replace("{quadkey}","${quadkey}"),b=b.replace("{culture}",this.culture),b=b.replace(this.protocolRegex,this.protocol);this.url=[];for(var c=0;c<a.imageUrlSubdomains.length;++c)this.url.push(b.replace("{subdomain}",a.imageUrlSubdomains[c]));this.addOptions({maxResolution:Math.min(this.serverResolutions[a.zoomMin],this.maxResolution||Number.POSITIVE_INFINITY),numZoomLevels:Math.min(a.zoomMax+1-a.zoomMin,this.numZoomLevels)},
!0);this.isBaseLayer||this.redraw();this.updateAttribution()},getURL:function(a){if(this.url){for(var b=this.getXYZ(a),a=b.x,c=b.y,b=b.z,d=[],e=b;0<e;--e){var f="0",g=1<<e-1;0!=(a&g)&&f++;0!=(c&g)&&(f++,f++);d.push(f)}d=d.join("");a=this.selectUrl(""+a+c+b,this.url);return OpenLayers.String.format(a,{quadkey:d})}},updateAttribution:function(){var a=this.metadata;if(a.resourceSets&&this.map&&this.map.center){var b=a.resourceSets[0].resources[0],c=this.map.getExtent().transform(this.map.getProjectionObject(),
new OpenLayers.Projection("EPSG:4326")),d=b.imageryProviders||[],e=OpenLayers.Util.indexOf(this.serverResolutions,this.getServerResolution()),b="",f,g,h,j,n,p,q;g=0;for(h=d.length;g<h;++g){f=d[g];j=0;for(n=f.coverageAreas.length;j<n;++j)q=f.coverageAreas[j],p=OpenLayers.Bounds.fromArray(q.bbox,!0),c.intersectsBounds(p)&&(e<=q.zoomMax&&e>=q.zoomMin)&&(b+=f.attribution+" ")}a=a.brandLogoUri.replace(this.protocolRegex,this.protocol);this.attribution=OpenLayers.String.format(this.attributionTemplate,
{type:this.type.toLowerCase(),logo:a,copyrights:b});this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"attribution"})}},setMap:function(){OpenLayers.Layer.XYZ.prototype.setMap.apply(this,arguments);this.map.events.register("moveend",this,this.updateAttribution)},clone:function(a){null==a&&(a=new OpenLayers.Layer.Bing(this.options));return a=OpenLayers.Layer.XYZ.prototype.clone.apply(this,[a])},destroy:function(){this.map&&this.map.events.unregister("moveend",this,this.updateAttribution);
OpenLayers.Layer.XYZ.prototype.destroy.apply(this,arguments)},CLASS_NAME:"OpenLayers.Layer.Bing"});OpenLayers.Layer.Bing.processMetadata=function(a){this.metadata=a;this.initLayer();a=document.getElementById(this._callbackId);a.parentNode.removeChild(a);window[this._callbackId]=void 0;delete this._callbackId};OpenLayers.ProxyHost="";OpenLayers.Request||(OpenLayers.Request={});
OpenLayers.Util.extend(OpenLayers.Request,{DEFAULT_CONFIG:{method:"GET",url:window.location.href,async:!0,user:void 0,password:void 0,params:null,proxy:OpenLayers.ProxyHost,headers:{},data:null,callback:function(){},success:null,failure:null,scope:null},URL_SPLIT_REGEX:/([^:]*:)\/\/([^:]*:?[^@]*@)?([^:\/\?]*):?([^\/\?]*)/,events:new OpenLayers.Events(this),makeSameOrigin:function(a,b){var c=0!==a.indexOf("http"),d=!c&&a.match(this.URL_SPLIT_REGEX);if(d){var e=window.location,c=d[1]==e.protocol&&d[3]==
e.hostname,d=d[4],e=e.port;if(80!=d&&""!=d||"80"!=e&&""!=e)c=c&&d==e}c||b&&(a="function"==typeof b?b(a):b+encodeURIComponent(a));return a},issue:function(a){var b=OpenLayers.Util.extend(this.DEFAULT_CONFIG,{proxy:OpenLayers.ProxyHost}),a=a||{};a.headers=a.headers||{};a=OpenLayers.Util.applyDefaults(a,b);a.headers=OpenLayers.Util.applyDefaults(a.headers,b.headers);var b=!1,c;for(c in a.headers)a.headers.hasOwnProperty(c)&&"x-requested-with"===c.toLowerCase()&&(b=!0);!1===b&&(a.headers["X-Requested-With"]=
"XMLHttpRequest");var d=new OpenLayers.Request.XMLHttpRequest,e=OpenLayers.Util.urlAppend(a.url,OpenLayers.Util.getParameterString(a.params||{})),e=OpenLayers.Request.makeSameOrigin(e,a.proxy);d.open(a.method,e,a.async,a.user,a.password);for(var f in a.headers)d.setRequestHeader(f,a.headers[f]);var g=this.events,h=this;d.onreadystatechange=function(){d.readyState==OpenLayers.Request.XMLHttpRequest.DONE&&!1!==g.triggerEvent("complete",{request:d,config:a,requestUrl:e})&&h.runCallbacks({request:d,config:a,
requestUrl:e})};!1===a.async?d.send(a.data):window.setTimeout(function(){0!==d.readyState&&d.send(a.data)},0);return d},runCallbacks:function(a){var b=a.request,c=a.config,d=c.scope?OpenLayers.Function.bind(c.callback,c.scope):c.callback,e;c.success&&(e=c.scope?OpenLayers.Function.bind(c.success,c.scope):c.success);var f;c.failure&&(f=c.scope?OpenLayers.Function.bind(c.failure,c.scope):c.failure);"file:"==OpenLayers.Util.createUrlObject(c.url).protocol&&b.responseText&&(b.status=200);d(b);if(!b.status||
200<=b.status&&300>b.status)this.events.triggerEvent("success",a),e&&e(b);if(b.status&&(200>b.status||300<=b.status))this.events.triggerEvent("failure",a),f&&f(b)},GET:function(a){a=OpenLayers.Util.extend(a,{method:"GET"});return OpenLayers.Request.issue(a)},POST:function(a){a=OpenLayers.Util.extend(a,{method:"POST"});a.headers=a.headers?a.headers:{};"CONTENT-TYPE"in OpenLayers.Util.upperCaseObject(a.headers)||(a.headers["Content-Type"]="application/xml");return OpenLayers.Request.issue(a)},PUT:function(a){a=
OpenLayers.Util.extend(a,{method:"PUT"});a.headers=a.headers?a.headers:{};"CONTENT-TYPE"in OpenLayers.Util.upperCaseObject(a.headers)||(a.headers["Content-Type"]="application/xml");return OpenLayers.Request.issue(a)},DELETE:function(a){a=OpenLayers.Util.extend(a,{method:"DELETE"});return OpenLayers.Request.issue(a)},HEAD:function(a){a=OpenLayers.Util.extend(a,{method:"HEAD"});return OpenLayers.Request.issue(a)},OPTIONS:function(a){a=OpenLayers.Util.extend(a,{method:"OPTIONS"});return OpenLayers.Request.issue(a)}});
(function(){function a(){this._object=f&&!j?new f:new window.ActiveXObject("Microsoft.XMLHTTP");this._listeners=[]}function b(){return new a}function c(a){b.onreadystatechange&&b.onreadystatechange.apply(a);a.dispatchEvent({type:"readystatechange",bubbles:!1,cancelable:!1,timeStamp:new Date+0})}function d(a){try{a.responseText=a._object.responseText}catch(b){}try{var c;var d=a._object,e=d.responseXML,f=d.responseText;h&&(f&&e&&!e.documentElement&&d.getResponseHeader("Content-Type").match(/[^\/]+\/[^\+]+\+xml/))&&
(e=new window.ActiveXObject("Microsoft.XMLDOM"),e.async=!1,e.validateOnParse=!1,e.loadXML(f));c=e&&(h&&0!=e.parseError||!e.documentElement||e.documentElement&&"parsererror"==e.documentElement.tagName)?null:e;a.responseXML=c}catch(g){}try{a.status=a._object.status}catch(j){}try{a.statusText=a._object.statusText}catch(u){}}function e(a){a._object.onreadystatechange=new window.Function}var f=window.XMLHttpRequest,g=!!window.controllers,h=window.document.all&&!window.opera,j=h&&window.navigator.userAgent.match(/MSIE 7.0/);
b.prototype=a.prototype;g&&f.wrapped&&(b.wrapped=f.wrapped);b.UNSENT=0;b.OPENED=1;b.HEADERS_RECEIVED=2;b.LOADING=3;b.DONE=4;b.prototype.readyState=b.UNSENT;b.prototype.responseText="";b.prototype.responseXML=null;b.prototype.status=0;b.prototype.statusText="";b.prototype.priority="NORMAL";b.prototype.onreadystatechange=null;b.onreadystatechange=null;b.onopen=null;b.onsend=null;b.onabort=null;b.prototype.open=function(a,f,j,m,r){delete this._headers;3>arguments.length&&(j=!0);this._async=j;var s=this,
t=this.readyState,v;h&&j&&(v=function(){t!=b.DONE&&(e(s),s.abort())},window.attachEvent("onunload",v));b.onopen&&b.onopen.apply(this,arguments);4<arguments.length?this._object.open(a,f,j,m,r):3<arguments.length?this._object.open(a,f,j,m):this._object.open(a,f,j);this.readyState=b.OPENED;c(this);this._object.onreadystatechange=function(){if(!g||j)s.readyState=s._object.readyState,d(s),s._aborted?s.readyState=b.UNSENT:(s.readyState==b.DONE&&(delete s._data,e(s),h&&j&&window.detachEvent("onunload",v)),
t!=s.readyState&&c(s),t=s.readyState)}};b.prototype.send=function(a){b.onsend&&b.onsend.apply(this,arguments);arguments.length||(a=null);a&&a.nodeType&&(a=window.XMLSerializer?(new window.XMLSerializer).serializeToString(a):a.xml,this._headers["Content-Type"]||this._object.setRequestHeader("Content-Type","application/xml"));this._data=a;a:if(this._object.send(this._data),g&&!this._async){this.readyState=b.OPENED;for(d(this);this.readyState<b.DONE;)if(this.readyState++,c(this),this._aborted)break a}};
b.prototype.abort=function(){b.onabort&&b.onabort.apply(this,arguments);this.readyState>b.UNSENT&&(this._aborted=!0);this._object.abort();e(this);this.readyState=b.UNSENT;delete this._data};b.prototype.getAllResponseHeaders=function(){return this._object.getAllResponseHeaders()};b.prototype.getResponseHeader=function(a){return this._object.getResponseHeader(a)};b.prototype.setRequestHeader=function(a,b){this._headers||(this._headers={});this._headers[a]=b;return this._object.setRequestHeader(a,b)};
b.prototype.addEventListener=function(a,b,c){for(var d=0,e;e=this._listeners[d];d++)if(e[0]==a&&e[1]==b&&e[2]==c)return;this._listeners.push([a,b,c])};b.prototype.removeEventListener=function(a,b,c){for(var d=0,e;(e=this._listeners[d])&&!(e[0]==a&&e[1]==b&&e[2]==c);d++);e&&this._listeners.splice(d,1)};b.prototype.dispatchEvent=function(a){a={type:a.type,target:this,currentTarget:this,eventPhase:2,bubbles:a.bubbles,cancelable:a.cancelable,timeStamp:a.timeStamp,stopPropagation:function(){},preventDefault:function(){},
initEvent:function(){}};"readystatechange"==a.type&&this.onreadystatechange&&(this.onreadystatechange.handleEvent||this.onreadystatechange).apply(this,[a]);for(var b=0,c;c=this._listeners[b];b++)c[0]==a.type&&!c[2]&&(c[1].handleEvent||c[1]).apply(this,[a])};b.prototype.toString=function(){return"[object XMLHttpRequest]"};b.toString=function(){return"[XMLHttpRequest]"};window.Function.prototype.apply||(window.Function.prototype.apply=function(a,b){b||(b=[]);a.__func=this;a.__func(b[0],b[1],b[2],b[3],
b[4]);delete a.__func});OpenLayers.Request||(OpenLayers.Request={});OpenLayers.Request.XMLHttpRequest=b})();
OpenLayers.Format.OpenSearchDescription=OpenLayers.Class(OpenLayers.Format.XML,{xmlns:"http://a9.com/-/spec/opensearch/1.1/",geons:"http://a9.com/-/opensearch/extensions/geo/1.0/",initialize:function(a){this.regExes={extractParams:/\{(\w|:)+\??\}/g,trimCurly:/(^\{|\??\}$)/g};this.mimeTypes={"application/vnd.google-earth.kml+xml":"KML","application/atom+xml":"Atom","application/rss+xml":"GeoRSS","application/json":"GeoJSON"};OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){var b=
{};"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var c=this.getElementsByTagNameNS(a,"*","ShortName")[0];b.name=this.getChildValue(c)||"[no name]";c=this.getElementsByTagNameNS(a,"*","Url");b.formats=[];for(var d=0,e=c.length;d<e;d++){var f={},g=c[d].getAttribute("type"),g=this.mimeTypes[g],h=c[d].getAttribute("rel");h&&("jeobdesc"===h||"mspdesc"===h||"mapshup"===h)?b.MDescriptionUrl=c[d].getAttribute("template"):g&&(f.URLTemplate=c[d].getAttribute("template"),b.formats[g]=
f)}c=this.getElementsByTagNameNS(a,"*","Attribution")[0];b.attribution=this.getChildValue(c);a=this.getElementsByTagNameNS(a,"*","Image")[0];b.icon=this.getChildValue(a);return b},parseURLTemplate:function(a){var b={},a=a.match(this.regExes.extractParams);if(!a)return b;for(var c=0,d=a.length;c<d;c++){var e=a[c].replace(this.regExes.trimCurly,"");b[e]=""}return b},CLASS_NAME:"OpenLayers.Format.OpenSearchDescription"});
OpenLayers.Handler.MouseWheel=OpenLayers.Class(OpenLayers.Handler,{wheelListener:null,interval:0,maxDelta:Number.POSITIVE_INFINITY,delta:0,cumulative:!0,initialize:function(a,b,c){OpenLayers.Handler.prototype.initialize.apply(this,arguments);this.wheelListener=OpenLayers.Function.bindAsEventListener(this.onWheelEvent,this)},destroy:function(){OpenLayers.Handler.prototype.destroy.apply(this,arguments);this.wheelListener=null},onWheelEvent:function(a){if(this.map&&this.checkModifiers(a)){for(var b=
!1,c=!1,d=!1,e=OpenLayers.Event.element(a);null!=e&&!d&&!b;){if(!b)try{var f,b=(f=e.currentStyle?e.currentStyle.overflow:document.defaultView.getComputedStyle(e,null).getPropertyValue("overflow"))&&"auto"==f||"scroll"==f}catch(g){}if(!c&&(c=OpenLayers.Element.hasClass(e,"olScrollable"),!c))for(var d=0,h=this.map.layers.length;d<h;d++){var j=this.map.layers[d];if(e==j.div||e==j.pane){c=!0;break}}d=e==this.map.div;e=e.parentNode}if(!b&&d){if(c)if(b=0,a.wheelDelta?(b=a.wheelDelta,0===b%160&&(b*=0.75),
b/=120):a.detail&&(b=-(a.detail/Math.abs(a.detail))),this.delta+=b,window.clearTimeout(this._timeoutId),this.interval&&Math.abs(this.delta)<this.maxDelta){var n=OpenLayers.Util.extend({},a);this._timeoutId=window.setTimeout(OpenLayers.Function.bind(function(){this.wheelZoom(n)},this),this.interval)}else this.wheelZoom(a);OpenLayers.Event.stop(a)}}},wheelZoom:function(a){var b=this.delta;this.delta=0;b&&(a.xy=this.map.events.getMousePosition(a),0>b?this.callback("down",[a,this.cumulative?Math.max(-this.maxDelta,
b):-1]):this.callback("up",[a,this.cumulative?Math.min(this.maxDelta,b):1]))},activate:function(a){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){var b=this.wheelListener;OpenLayers.Event.observe(window,"DOMMouseScroll",b);OpenLayers.Event.observe(window,"mousewheel",b);OpenLayers.Event.observe(document,"mousewheel",b);return!0}return!1},deactivate:function(a){if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){var b=this.wheelListener;OpenLayers.Event.stopObserving(window,
"DOMMouseScroll",b);OpenLayers.Event.stopObserving(window,"mousewheel",b);OpenLayers.Event.stopObserving(document,"mousewheel",b);return!0}return!1},CLASS_NAME:"OpenLayers.Handler.MouseWheel"});OpenLayers.Format.WMSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.1",profile:null,CLASS_NAME:"OpenLayers.Format.WMSCapabilities"});
OpenLayers.Format.WMSCapabilities.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{wms:"http://www.opengis.net/wms",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"wms",read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b=a;a&&9==a.nodeType&&(a=a.documentElement);var c={};this.readNode(a,c);void 0===c.service&&(a=new OpenLayers.Format.OGCExceptionReport,c.error=a.read(b));return c},readers:{wms:{Service:function(a,
b){b.service={};this.readChildNodes(a,b.service)},Name:function(a,b){b.name=this.getChildValue(a)},Title:function(a,b){b.title=this.getChildValue(a)},Abstract:function(a,b){b["abstract"]=this.getChildValue(a)},BoundingBox:function(a){var b={};b.bbox=[parseFloat(a.getAttribute("minx")),parseFloat(a.getAttribute("miny")),parseFloat(a.getAttribute("maxx")),parseFloat(a.getAttribute("maxy"))];a={x:parseFloat(a.getAttribute("resx")),y:parseFloat(a.getAttribute("resy"))};if(!isNaN(a.x)||!isNaN(a.y))b.res=
a;return b},OnlineResource:function(a,b){b.href=this.getAttributeNS(a,this.namespaces.xlink,"href")},ContactInformation:function(a,b){b.contactInformation={};this.readChildNodes(a,b.contactInformation)},ContactPersonPrimary:function(a,b){b.personPrimary={};this.readChildNodes(a,b.personPrimary)},ContactPerson:function(a,b){b.person=this.getChildValue(a)},ContactOrganization:function(a,b){b.organization=this.getChildValue(a)},ContactPosition:function(a,b){b.position=this.getChildValue(a)},ContactAddress:function(a,
b){b.contactAddress={};this.readChildNodes(a,b.contactAddress)},AddressType:function(a,b){b.type=this.getChildValue(a)},Address:function(a,b){b.address=this.getChildValue(a)},City:function(a,b){b.city=this.getChildValue(a)},StateOrProvince:function(a,b){b.stateOrProvince=this.getChildValue(a)},PostCode:function(a,b){b.postcode=this.getChildValue(a)},Country:function(a,b){b.country=this.getChildValue(a)},ContactVoiceTelephone:function(a,b){b.phone=this.getChildValue(a)},ContactFacsimileTelephone:function(a,
b){b.fax=this.getChildValue(a)},ContactElectronicMailAddress:function(a,b){b.email=this.getChildValue(a)},Fees:function(a,b){var c=this.getChildValue(a);c&&"none"!=c.toLowerCase()&&(b.fees=c)},AccessConstraints:function(a,b){var c=this.getChildValue(a);c&&"none"!=c.toLowerCase()&&(b.accessConstraints=c)},Capability:function(a,b){b.capability={nestedLayers:[],layers:[]};this.readChildNodes(a,b.capability)},Request:function(a,b){b.request={};this.readChildNodes(a,b.request)},GetCapabilities:function(a,
b){b.getcapabilities={formats:[]};this.readChildNodes(a,b.getcapabilities)},Format:function(a,b){OpenLayers.Util.isArray(b.formats)?b.formats.push(this.getChildValue(a)):b.format=this.getChildValue(a)},DCPType:function(a,b){this.readChildNodes(a,b)},HTTP:function(a,b){this.readChildNodes(a,b)},Get:function(a,b){b.get={};this.readChildNodes(a,b.get);b.href||(b.href=b.get.href)},Post:function(a,b){b.post={};this.readChildNodes(a,b.post);b.href||(b.href=b.get.href)},GetMap:function(a,b){b.getmap={formats:[]};
this.readChildNodes(a,b.getmap)},GetFeatureInfo:function(a,b){b.getfeatureinfo={formats:[]};this.readChildNodes(a,b.getfeatureinfo)},Exception:function(a,b){b.exception={formats:[]};this.readChildNodes(a,b.exception)},Layer:function(a,b){var c,d;b.capability?(d=b.capability,c=b):d=b;var e=a.getAttributeNode("queryable"),f=e&&e.specified?a.getAttribute("queryable"):null,g=(e=a.getAttributeNode("cascaded"))&&e.specified?a.getAttribute("cascaded"):null,e=(e=a.getAttributeNode("opaque"))&&e.specified?
a.getAttribute("opaque"):null,h=a.getAttribute("noSubsets"),j=a.getAttribute("fixedWidth"),n=a.getAttribute("fixedHeight"),p=c||{},q=OpenLayers.Util.extend;c={nestedLayers:[],styles:c?[].concat(c.styles):[],srs:c?q({},p.srs):{},metadataURLs:[],bbox:c?q({},p.bbox):{},llbbox:p.llbbox,dimensions:c?q({},p.dimensions):{},authorityURLs:c?q({},p.authorityURLs):{},identifiers:{},keywords:[],queryable:f&&""!==f?"1"===f||"true"===f:p.queryable||!1,cascaded:null!==g?parseInt(g):p.cascaded||0,opaque:e?"1"===
e||"true"===e:p.opaque||!1,noSubsets:null!==h?"1"===h||"true"===h:p.noSubsets||!1,fixedWidth:null!=j?parseInt(j):p.fixedWidth||0,fixedHeight:null!=n?parseInt(n):p.fixedHeight||0,minScale:p.minScale,maxScale:p.maxScale,attribution:p.attribution};b.nestedLayers.push(c);c.capability=d;this.readChildNodes(a,c);delete c.capability;c.name&&(f=c.name.split(":"),g=d.request,e=g.getfeatureinfo,0<f.length&&(c.prefix=f[0]),d.layers.push(c),void 0===c.formats&&(c.formats=g.getmap.formats),void 0===c.infoFormats&&
e&&(c.infoFormats=e.formats))},Attribution:function(a,b){b.attribution={};this.readChildNodes(a,b.attribution)},LogoURL:function(a,b){b.logo={width:a.getAttribute("width"),height:a.getAttribute("height")};this.readChildNodes(a,b.logo)},Style:function(a,b){var c={};b.styles.push(c);this.readChildNodes(a,c)},LegendURL:function(a,b){var c={width:a.getAttribute("width"),height:a.getAttribute("height")};b.legend=c;this.readChildNodes(a,c)},MetadataURL:function(a,b){var c={type:a.getAttribute("type")};
b.metadataURLs.push(c);this.readChildNodes(a,c)},DataURL:function(a,b){b.dataURL={};this.readChildNodes(a,b.dataURL)},FeatureListURL:function(a,b){b.featureListURL={};this.readChildNodes(a,b.featureListURL)},AuthorityURL:function(a,b){var c=a.getAttribute("name"),d={};this.readChildNodes(a,d);b.authorityURLs[c]=d.href},Identifier:function(a,b){var c=a.getAttribute("authority");b.identifiers[c]=this.getChildValue(a)},KeywordList:function(a,b){this.readChildNodes(a,b)},SRS:function(a,b){b.srs[this.getChildValue(a)]=
!0}}},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1"});
OpenLayers.Format.WMSCapabilities.v1_3=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1,{readers:{wms:OpenLayers.Util.applyDefaults({WMS_Capabilities:function(a,b){this.readChildNodes(a,b)},LayerLimit:function(a,b){b.layerLimit=parseInt(this.getChildValue(a))},MaxWidth:function(a,b){b.maxWidth=parseInt(this.getChildValue(a))},MaxHeight:function(a,b){b.maxHeight=parseInt(this.getChildValue(a))},BoundingBox:function(a,b){var c=OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms.BoundingBox.apply(this,[a,
b]);c.srs=a.getAttribute("CRS");b.bbox[c.srs]=c},CRS:function(a,b){this.readers.wms.SRS.apply(this,[a,b])},EX_GeographicBoundingBox:function(a,b){b.llbbox=[];this.readChildNodes(a,b.llbbox)},westBoundLongitude:function(a,b){b[0]=this.getChildValue(a)},eastBoundLongitude:function(a,b){b[2]=this.getChildValue(a)},southBoundLatitude:function(a,b){b[1]=this.getChildValue(a)},northBoundLatitude:function(a,b){b[3]=this.getChildValue(a)},MinScaleDenominator:function(a,b){b.maxScale=parseFloat(this.getChildValue(a)).toPrecision(16)},
MaxScaleDenominator:function(a,b){b.minScale=parseFloat(this.getChildValue(a)).toPrecision(16)},Dimension:function(a,b){var c={name:a.getAttribute("name").toLowerCase(),units:a.getAttribute("units"),unitsymbol:a.getAttribute("unitSymbol"),nearestVal:"1"===a.getAttribute("nearestValue"),multipleVal:"1"===a.getAttribute("multipleValues"),"default":a.getAttribute("default")||"",current:"1"===a.getAttribute("current"),values:this.getChildValue(a).split(",")};b.dimensions[c.name]=c},Keyword:function(a,
b){var c={value:this.getChildValue(a),vocabulary:a.getAttribute("vocabulary")};b.keywords&&b.keywords.push(c)}},OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms),sld:{UserDefinedSymbolization:function(a,b){this.readers.wms.UserDefinedSymbolization.apply(this,[a,b]);b.userSymbols.inlineFeature=1==parseInt(a.getAttribute("InlineFeature"));b.userSymbols.remoteWCS=1==parseInt(a.getAttribute("RemoteWCS"))},DescribeLayer:function(a,b){this.readers.wms.DescribeLayer.apply(this,[a,b])},GetLegendGraphic:function(a,
b){this.readers.wms.GetLegendGraphic.apply(this,[a,b])}}},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_3"});OpenLayers.Format.WMSCapabilities.v1_3_0=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_3,{version:"1.3.0",CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_3_0"});
OpenLayers.Format.GML.v2=OpenLayers.Class(OpenLayers.Format.GML.Base,{schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/2.1.2/feature.xsd",initialize:function(a){OpenLayers.Format.GML.Base.prototype.initialize.apply(this,[a])},readers:{gml:OpenLayers.Util.applyDefaults({outerBoundaryIs:function(a,b){var c={};this.readChildNodes(a,c);b.outer=c.components[0]},innerBoundaryIs:function(a,b){var c={};this.readChildNodes(a,c);b.inner.push(c.components[0])},Box:function(a,b){var c=
{};this.readChildNodes(a,c);b.components||(b.components=[]);var d=c.points[0],c=c.points[1];b.components.push(new OpenLayers.Bounds(d.x,d.y,c.x,c.y))}},OpenLayers.Format.GML.Base.prototype.readers.gml),feature:OpenLayers.Format.GML.Base.prototype.readers.feature,wfs:OpenLayers.Format.GML.Base.prototype.readers.wfs},write:function(a){var b;b=OpenLayers.Util.isArray(a)?"wfs:FeatureCollection":"gml:featureMember";a=this.writeNode(b,a);this.setAttributeNS(a,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);
return OpenLayers.Format.XML.prototype.write.apply(this,[a])},writers:{gml:OpenLayers.Util.applyDefaults({Point:function(a){var b=this.createElementNSPlus("gml:Point");this.writeNode("coordinates",[a],b);return b},coordinates:function(a){for(var b=a.length,c=Array(b),d,e=0;e<b;++e)d=a[e],c[e]=this.xy?d.x+","+d.y:d.y+","+d.x,void 0!=d.z&&(c[e]+=","+d.z);return this.createElementNSPlus("gml:coordinates",{attributes:{decimal:".",cs:",",ts:" "},value:1==b?c[0]:c.join(" ")})},LineString:function(a){var b=
this.createElementNSPlus("gml:LineString");this.writeNode("coordinates",a.components,b);return b},Polygon:function(a){var b=this.createElementNSPlus("gml:Polygon");this.writeNode("outerBoundaryIs",a.components[0],b);for(var c=1;c<a.components.length;++c)this.writeNode("innerBoundaryIs",a.components[c],b);return b},outerBoundaryIs:function(a){var b=this.createElementNSPlus("gml:outerBoundaryIs");this.writeNode("LinearRing",a,b);return b},innerBoundaryIs:function(a){var b=this.createElementNSPlus("gml:innerBoundaryIs");
this.writeNode("LinearRing",a,b);return b},LinearRing:function(a){var b=this.createElementNSPlus("gml:LinearRing");this.writeNode("coordinates",a.components,b);return b},Box:function(a){var b=this.createElementNSPlus("gml:Box");this.writeNode("coordinates",[{x:a.left,y:a.bottom},{x:a.right,y:a.top}],b);this.srsName&&b.setAttribute("srsName",this.srsName);return b}},OpenLayers.Format.GML.Base.prototype.writers.gml),feature:OpenLayers.Format.GML.Base.prototype.writers.feature,wfs:OpenLayers.Format.GML.Base.prototype.writers.wfs},
CLASS_NAME:"OpenLayers.Format.GML.v2"});
OpenLayers.Format.Filter.v1_0_0=OpenLayers.Class(OpenLayers.Format.GML.v2,OpenLayers.Format.Filter.v1,{VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/ogc/filter/1.0.0/filter.xsd",initialize:function(a){OpenLayers.Format.GML.v2.prototype.initialize.apply(this,[a])},readers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO});this.readChildNodes(a,c);b.filters.push(c)},PropertyIsNotEqualTo:function(a,
b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.NOT_EQUAL_TO});this.readChildNodes(a,c);b.filters.push(c)},PropertyIsLike:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LIKE});this.readChildNodes(a,c);var d=a.getAttribute("wildCard"),e=a.getAttribute("singleChar"),f=a.getAttribute("escape");c.value2regex(d,e,f);b.filters.push(c)}},OpenLayers.Format.Filter.v1.prototype.readers.ogc),gml:OpenLayers.Format.GML.v2.prototype.readers.gml,
feature:OpenLayers.Format.GML.v2.prototype.readers.feature},writers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsEqualTo");this.writeNode("PropertyName",a,b);this.writeOgcExpression(a.value,b);return b},PropertyIsNotEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsNotEqualTo");this.writeNode("PropertyName",a,b);this.writeOgcExpression(a.value,b);return b},PropertyIsLike:function(a){var b=this.createElementNSPlus("ogc:PropertyIsLike",
{attributes:{wildCard:"*",singleChar:".",escape:"!"}});this.writeNode("PropertyName",a,b);this.writeNode("Literal",a.regex2value(),b);return b},BBOX:function(a){var b=this.createElementNSPlus("ogc:BBOX");a.property&&this.writeNode("PropertyName",a,b);var c=this.writeNode("gml:Box",a.value,b);a.projection&&c.setAttribute("srsName",a.projection);return b}},OpenLayers.Format.Filter.v1.prototype.writers.ogc),gml:OpenLayers.Format.GML.v2.prototype.writers.gml,feature:OpenLayers.Format.GML.v2.prototype.writers.feature},
writeSpatial:function(a,b){var c=this.createElementNSPlus("ogc:"+b);this.writeNode("PropertyName",a,c);if(a.value instanceof OpenLayers.Filter.Function)this.writeNode("Function",a.value,c);else{var d;d=a.value instanceof OpenLayers.Geometry?this.writeNode("feature:_geometry",a.value).firstChild:this.writeNode("gml:Box",a.value);a.projection&&d.setAttribute("srsName",a.projection);c.appendChild(d)}return c},CLASS_NAME:"OpenLayers.Format.Filter.v1_0_0"});
OpenLayers.Format.WFST.v1_0_0=OpenLayers.Class(OpenLayers.Format.Filter.v1_0_0,OpenLayers.Format.WFST.v1,{version:"1.0.0",srsNameInQuery:!1,schemaLocations:{wfs:"http://schemas.opengis.net/wfs/1.0.0/WFS-transaction.xsd"},initialize:function(a){OpenLayers.Format.Filter.v1_0_0.prototype.initialize.apply(this,[a]);OpenLayers.Format.WFST.v1.prototype.initialize.apply(this,[a])},readNode:function(a,b,c){return OpenLayers.Format.GML.v2.prototype.readNode.apply(this,arguments)},readers:{wfs:OpenLayers.Util.applyDefaults({WFS_TransactionResponse:function(a,
b){b.insertIds=[];b.success=!1;this.readChildNodes(a,b)},InsertResult:function(a,b){var c={fids:[]};this.readChildNodes(a,c);b.insertIds=b.insertIds.concat(c.fids)},TransactionResult:function(a,b){this.readChildNodes(a,b)},Status:function(a,b){this.readChildNodes(a,b)},SUCCESS:function(a,b){b.success=!0}},OpenLayers.Format.WFST.v1.prototype.readers.wfs),gml:OpenLayers.Format.GML.v2.prototype.readers.gml,feature:OpenLayers.Format.GML.v2.prototype.readers.feature,ogc:OpenLayers.Format.Filter.v1_0_0.prototype.readers.ogc},
writers:{wfs:OpenLayers.Util.applyDefaults({Query:function(a){var a=OpenLayers.Util.extend({featureNS:this.featureNS,featurePrefix:this.featurePrefix,featureType:this.featureType,srsName:this.srsName,srsNameInQuery:this.srsNameInQuery},a),b=a.featurePrefix,c=this.createElementNSPlus("wfs:Query",{attributes:{typeName:(b?b+":":"")+a.featureType}});a.srsNameInQuery&&a.srsName&&c.setAttribute("srsName",a.srsName);a.featureNS&&c.setAttribute("xmlns:"+b,a.featureNS);if(a.propertyNames)for(var b=0,d=a.propertyNames.length;b<
d;b++)this.writeNode("ogc:PropertyName",{property:a.propertyNames[b]},c);a.filter&&(this.setFilterProperty(a.filter),this.writeNode("ogc:Filter",a.filter,c));return c}},OpenLayers.Format.WFST.v1.prototype.writers.wfs),gml:OpenLayers.Format.GML.v2.prototype.writers.gml,feature:OpenLayers.Format.GML.v2.prototype.writers.feature,ogc:OpenLayers.Format.Filter.v1_0_0.prototype.writers.ogc},CLASS_NAME:"OpenLayers.Format.WFST.v1_0_0"});
OpenLayers.ElementsIndexer=OpenLayers.Class({maxZIndex:null,order:null,indices:null,compare:null,initialize:function(a){this.compare=a?OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_Y_ORDER:OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_DRAWING_ORDER;this.clear()},insert:function(a){this.exists(a)&&this.remove(a);var b=a.id;this.determineZIndex(a);for(var c=-1,d=this.order.length,e;1<d-c;)e=parseInt((c+d)/2),0<this.compare(this,a,OpenLayers.Util.getElement(this.order[e]))?c=e:d=e;this.order.splice(d,
0,b);this.indices[b]=this.getZIndex(a);return this.getNextElement(d)},remove:function(a){var a=a.id,b=OpenLayers.Util.indexOf(this.order,a);0<=b&&(this.order.splice(b,1),delete this.indices[a],this.maxZIndex=0<this.order.length?this.indices[this.order[this.order.length-1]]:0)},clear:function(){this.order=[];this.indices={};this.maxZIndex=0},exists:function(a){return null!=this.indices[a.id]},getZIndex:function(a){return a._style.graphicZIndex},determineZIndex:function(a){var b=a._style.graphicZIndex;
null==b?(b=this.maxZIndex,a._style.graphicZIndex=b):b>this.maxZIndex&&(this.maxZIndex=b)},getNextElement:function(a){a+=1;if(a<this.order.length){var b=OpenLayers.Util.getElement(this.order[a]);void 0==b&&(b=this.getNextElement(a));return b}return null},CLASS_NAME:"OpenLayers.ElementsIndexer"});
OpenLayers.ElementsIndexer.IndexingMethods={Z_ORDER:function(a,b,c){var b=a.getZIndex(b),d=0;c&&(a=a.getZIndex(c),d=b-a);return d},Z_ORDER_DRAWING_ORDER:function(a,b,c){a=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(a,b,c);c&&0==a&&(a=1);return a},Z_ORDER_Y_ORDER:function(a,b,c){a=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(a,b,c);c&&0===a&&(b=c._boundsBottom-b._boundsBottom,a=0===b?1:b);return a}};
OpenLayers.Renderer.Elements=OpenLayers.Class(OpenLayers.Renderer,{rendererRoot:null,root:null,vectorRoot:null,textRoot:null,xmlns:null,xOffset:0,indexer:null,BACKGROUND_ID_SUFFIX:"_background",LABEL_ID_SUFFIX:"_label",LABEL_OUTLINE_SUFFIX:"_outline",initialize:function(a,b){OpenLayers.Renderer.prototype.initialize.apply(this,arguments);this.rendererRoot=this.createRenderRoot();this.root=this.createRoot("_root");this.vectorRoot=this.createRoot("_vroot");this.textRoot=this.createRoot("_troot");this.root.appendChild(this.vectorRoot);
this.root.appendChild(this.textRoot);this.rendererRoot.appendChild(this.root);this.container.appendChild(this.rendererRoot);if(b&&(b.zIndexing||b.yOrdering))this.indexer=new OpenLayers.ElementsIndexer(b.yOrdering)},destroy:function(){this.clear();this.xmlns=this.root=this.rendererRoot=null;OpenLayers.Renderer.prototype.destroy.apply(this,arguments)},clear:function(){var a,b=this.vectorRoot;if(b)for(;a=b.firstChild;)b.removeChild(a);if(b=this.textRoot)for(;a=b.firstChild;)b.removeChild(a);this.indexer&&
this.indexer.clear()},setExtent:function(a,b){var c=OpenLayers.Renderer.prototype.setExtent.apply(this,arguments),d=this.getResolution();if(this.map.baseLayer&&this.map.baseLayer.wrapDateLine){var e,f=a.getWidth()/this.map.getExtent().getWidth(),a=a.scale(1/f),f=this.map.getMaxExtent();f.right>a.left&&f.right<a.right?e=!0:f.left>a.left&&f.left<a.right&&(e=!1);if(e!==this.rightOfDateLine||b)c=!1,this.xOffset=!0===e?f.getWidth()/d:0;this.rightOfDateLine=e}return c},getNodeType:function(){},drawGeometry:function(a,
b,c){var d=a.CLASS_NAME,e=!0;if("OpenLayers.Geometry.Collection"==d||"OpenLayers.Geometry.MultiPoint"==d||"OpenLayers.Geometry.MultiLineString"==d||"OpenLayers.Geometry.MultiPolygon"==d){for(var d=0,f=a.components.length;d<f;d++)e=this.drawGeometry(a.components[d],b,c)&&e;return e}d=e=!1;"none"!=b.display&&(b.backgroundGraphic?this.redrawBackgroundNode(a.id,a,b,c):d=!0,e=this.redrawNode(a.id,a,b,c));if(!1==e&&(b=document.getElementById(a.id)))b._style.backgroundGraphic&&(d=!0),b.parentNode.removeChild(b);
d&&(b=document.getElementById(a.id+this.BACKGROUND_ID_SUFFIX))&&b.parentNode.removeChild(b);return e},redrawNode:function(a,b,c,d){c=this.applyDefaultSymbolizer(c);a=this.nodeFactory(a,this.getNodeType(b,c));a._featureId=d;a._boundsBottom=b.getBounds().bottom;a._geometryClass=b.CLASS_NAME;a._style=c;b=this.drawGeometryNode(a,b,c);if(!1===b)return!1;a=b.node;this.indexer?(c=this.indexer.insert(a))?this.vectorRoot.insertBefore(a,c):this.vectorRoot.appendChild(a):a.parentNode!==this.vectorRoot&&this.vectorRoot.appendChild(a);
this.postDraw(a);return b.complete},redrawBackgroundNode:function(a,b,c){c=OpenLayers.Util.extend({},c);c.externalGraphic=c.backgroundGraphic;c.graphicXOffset=c.backgroundXOffset;c.graphicYOffset=c.backgroundYOffset;c.graphicZIndex=c.backgroundGraphicZIndex;c.graphicWidth=c.backgroundWidth||c.graphicWidth;c.graphicHeight=c.backgroundHeight||c.graphicHeight;c.backgroundGraphic=null;c.backgroundXOffset=null;c.backgroundYOffset=null;c.backgroundGraphicZIndex=null;return this.redrawNode(a+this.BACKGROUND_ID_SUFFIX,
b,c,null)},drawGeometryNode:function(a,b,c){var c=c||a._style,d={isFilled:void 0===c.fill?!0:c.fill,isStroked:void 0===c.stroke?!!c.strokeWidth:c.stroke},e;switch(b.CLASS_NAME){case "OpenLayers.Geometry.Point":!1===c.graphic&&(d.isFilled=!1,d.isStroked=!1);e=this.drawPoint(a,b);break;case "OpenLayers.Geometry.LineString":d.isFilled=!1;e=this.drawLineString(a,b);break;case "OpenLayers.Geometry.LinearRing":e=this.drawLinearRing(a,b);break;case "OpenLayers.Geometry.Polygon":e=this.drawPolygon(a,b);break;
case "OpenLayers.Geometry.Rectangle":e=this.drawRectangle(a,b)}a._options=d;return!1!=e?{node:this.setStyle(a,c,d,b),complete:e}:!1},postDraw:function(){},drawPoint:function(){},drawLineString:function(){},drawLinearRing:function(){},drawPolygon:function(){},drawRectangle:function(){},drawCircle:function(){},removeText:function(a){var b=document.getElementById(a+this.LABEL_ID_SUFFIX);b&&this.textRoot.removeChild(b);(a=document.getElementById(a+this.LABEL_OUTLINE_SUFFIX))&&this.textRoot.removeChild(a)},
getFeatureIdFromEvent:function(a){var b=a.target,c=b&&b.correspondingUseElement;return(c?c:b||a.srcElement)._featureId},eraseGeometry:function(a,b){if("OpenLayers.Geometry.MultiPoint"==a.CLASS_NAME||"OpenLayers.Geometry.MultiLineString"==a.CLASS_NAME||"OpenLayers.Geometry.MultiPolygon"==a.CLASS_NAME||"OpenLayers.Geometry.Collection"==a.CLASS_NAME)for(var c=0,d=a.components.length;c<d;c++)this.eraseGeometry(a.components[c],b);else if((c=OpenLayers.Util.getElement(a.id))&&c.parentNode)c.geometry&&(c.geometry.destroy(),
c.geometry=null),c.parentNode.removeChild(c),this.indexer&&this.indexer.remove(c),c._style.backgroundGraphic&&(c=OpenLayers.Util.getElement(a.id+this.BACKGROUND_ID_SUFFIX))&&c.parentNode&&c.parentNode.removeChild(c)},nodeFactory:function(a,b){var c=OpenLayers.Util.getElement(a);c?this.nodeTypeCompare(c,b)||(c.parentNode.removeChild(c),c=this.nodeFactory(a,b)):c=this.createNode(b,a);return c},nodeTypeCompare:function(){},createNode:function(){},moveRoot:function(a){var b=this.root;a.root.parentNode==
this.rendererRoot&&(b=a.root);b.parentNode.removeChild(b);a.rendererRoot.appendChild(b)},getRenderLayerId:function(){return this.root.parentNode.parentNode.id},isComplexSymbol:function(a){return"circle"!=a&&!!a},CLASS_NAME:"OpenLayers.Renderer.Elements"});
OpenLayers.Layer.TMS=OpenLayers.Class(OpenLayers.Layer.Grid,{serviceVersion:"1.0.0",layername:null,type:null,isBaseLayer:!0,tileOrigin:null,serverResolutions:null,zoomOffset:0,initialize:function(a,b,c){var d=[];d.push(a,b,{},c);OpenLayers.Layer.Grid.prototype.initialize.apply(this,d)},clone:function(a){null==a&&(a=new OpenLayers.Layer.TMS(this.name,this.url,this.getOptions()));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a])},getURL:function(a){var a=this.adjustBounds(a),b=this.getServerResolution(),
c=Math.round((a.left-this.tileOrigin.lon)/(b*this.tileSize.w)),a=Math.round((a.bottom-this.tileOrigin.lat)/(b*this.tileSize.h)),b=this.getServerZoom(),c=this.serviceVersion+"/"+this.layername+"/"+b+"/"+c+"/"+a+"."+this.type,a=this.url;OpenLayers.Util.isArray(a)&&(a=this.selectUrl(c,a));return a+c},setMap:function(a){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments);this.tileOrigin||(this.tileOrigin=new OpenLayers.LonLat(this.map.maxExtent.left,this.map.maxExtent.bottom))},CLASS_NAME:"OpenLayers.Layer.TMS"});
OpenLayers.Strategy.Fixed=OpenLayers.Class(OpenLayers.Strategy,{preload:!1,activate:function(){var a=OpenLayers.Strategy.prototype.activate.apply(this,arguments);if(a)if(this.layer.events.on({refresh:this.load,scope:this}),!0==this.layer.visibility||this.preload)this.load();else this.layer.events.on({visibilitychanged:this.load,scope:this});return a},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);a&&this.layer.events.un({refresh:this.load,visibilitychanged:this.load,
scope:this});return a},load:function(a){var b=this.layer;b.events.triggerEvent("loadstart",{filter:b.filter});b.protocol.read(OpenLayers.Util.applyDefaults({callback:this.merge,filter:b.filter,scope:this},a));b.events.un({visibilitychanged:this.load,scope:this})},merge:function(a){var b=this.layer;b.destroyFeatures();var c=a.features;if(c&&0<c.length){var d=b.projection,e=b.map.getProjectionObject();if(!e.equals(d))for(var f,g=0,h=c.length;g<h;++g)(f=c[g].geometry)&&f.transform(d,e);b.addFeatures(c)}b.events.triggerEvent("loadend",
{response:a})},CLASS_NAME:"OpenLayers.Strategy.Fixed"});OpenLayers.Format.WFSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.0",CLASS_NAME:"OpenLayers.Format.WFSCapabilities"});
OpenLayers.Format.WFSCapabilities.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{wfs:"http://www.opengis.net/wfs",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",ows:"http://www.opengis.net/ows"},errorProperty:"featureTypeList",defaultPrefix:"wfs",read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&&9==a.nodeType&&(a=a.documentElement);var b={};this.readNode(a,b);return b},readers:{wfs:{WFS_Capabilities:function(a,
b){this.readChildNodes(a,b)},FeatureTypeList:function(a,b){b.featureTypeList={featureTypes:[]};this.readChildNodes(a,b.featureTypeList)},FeatureType:function(a,b){var c={};this.readChildNodes(a,c);b.featureTypes.push(c)},Name:function(a,b){var c=this.getChildValue(a);c&&(c=c.split(":"),b.name=c.pop(),0<c.length&&(b.featureNS=this.lookupNamespaceURI(a,c[0])))},Title:function(a,b){var c=this.getChildValue(a);c&&(b.title=c)},Abstract:function(a,b){var c=this.getChildValue(a);c&&(b["abstract"]=c)}}},
CLASS_NAME:"OpenLayers.Format.WFSCapabilities.v1"});OpenLayers.Format.WFSCapabilities.v1_1_0=OpenLayers.Class(OpenLayers.Format.WFSCapabilities.v1,{regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},readers:{wfs:OpenLayers.Util.applyDefaults({DefaultSRS:function(a,b){var c=this.getChildValue(a);c&&(b.srs=c)}},OpenLayers.Format.WFSCapabilities.v1.prototype.readers.wfs),ows:OpenLayers.Format.OWSCommon.v1.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WFSCapabilities.v1_1_0"});
OpenLayers.Protocol=OpenLayers.Class({format:null,options:null,autoDestroy:!0,defaultFilter:null,initialize:function(a){a=a||{};OpenLayers.Util.extend(this,a);this.options=a},mergeWithDefaultFilter:function(a){return a&&this.defaultFilter?new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND,filters:[this.defaultFilter,a]}):a||this.defaultFilter||void 0},destroy:function(){this.format=this.options=null},read:function(a){a=a||{};a.filter=this.mergeWithDefaultFilter(a.filter)},create:function(){},
update:function(){},"delete":function(){},commit:function(){},abort:function(){},createCallback:function(a,b,c){return OpenLayers.Function.bind(function(){a.apply(this,[b,c])},this)},CLASS_NAME:"OpenLayers.Protocol"});OpenLayers.Protocol.Response=OpenLayers.Class({code:null,requestType:null,last:!0,features:null,data:null,reqFeatures:null,priv:null,error:null,initialize:function(a){OpenLayers.Util.extend(this,a)},success:function(){return 0<this.code},CLASS_NAME:"OpenLayers.Protocol.Response"});
OpenLayers.Protocol.Response.SUCCESS=1;OpenLayers.Protocol.Response.FAILURE=0;OpenLayers.Protocol.WFS=function(a){var a=OpenLayers.Util.applyDefaults(a,OpenLayers.Protocol.WFS.DEFAULTS),b=OpenLayers.Protocol.WFS["v"+a.version.replace(/\./g,"_")];if(!b)throw"Unsupported WFS version: "+a.version;return new b(a)};
OpenLayers.Protocol.WFS.fromWMSLayer=function(a,b){var c,d;c=a.params.LAYERS;c=(OpenLayers.Util.isArray(c)?c[0]:c).split(":");1<c.length&&(d=c[0]);c=c.pop();d={url:a.url,featureType:c,featurePrefix:d,srsName:a.projection&&a.projection.getCode()||a.map&&a.map.getProjectionObject().getCode(),version:"1.1.0"};return new OpenLayers.Protocol.WFS(OpenLayers.Util.applyDefaults(b,d))};OpenLayers.Protocol.WFS.DEFAULTS={version:"1.0.0"};
OpenLayers.Format.KML=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{kml:"http://www.opengis.net/kml/2.2",gx:"http://www.google.com/kml/ext/2.2"},kmlns:"http://earth.google.com/kml/2.0",placemarksDesc:"No description available",foldersName:"OpenLayers export",foldersDesc:"Exported on "+new Date,extractAttributes:!0,kvpAttributes:!1,extractStyles:!1,extractTracks:!1,trackAttributes:null,internalns:null,features:null,styles:null,styleBaseUrl:"",fetched:null,maxDepth:0,initialize:function(a){this.regExes=
{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g,kmlColor:/(\w{2})(\w{2})(\w{2})(\w{2})/,kmlIconPalette:/root:\/\/icons\/palette-(\d+)(\.\w+)/,straightBracket:/\$\[(.*?)\]/g};this.externalProjection=new OpenLayers.Projection("EPSG:4326");OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){this.features=[];this.styles={};this.fetched={};return this.parseData(a,{depth:0,styleBaseUrl:this.styleBaseUrl})},parseData:function(a,b){"string"==typeof a&&
(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));for(var c=["Link","NetworkLink","Style","StyleMap","Placemark"],d=0,e=c.length;d<e;++d){var f=c[d],g=this.getElementsByTagNameNS(a,"*",f);if(0!=g.length)switch(f.toLowerCase()){case "link":case "networklink":this.parseLinks(g,b);break;case "style":this.extractStyles&&this.parseStyles(g,b);break;case "stylemap":this.extractStyles&&this.parseStyleMaps(g,b);break;case "placemark":this.parseFeatures(g,b)}}return this.features},parseLinks:function(a,
b){if(b.depth>=this.maxDepth)return!1;var c=OpenLayers.Util.extend({},b);c.depth++;for(var d=0,e=a.length;d<e;d++){var f=this.parseProperty(a[d],"*","href");f&&!this.fetched[f]&&(this.fetched[f]=!0,(f=this.fetchLink(f))&&this.parseData(f,c))}},fetchLink:function(a){if(a=OpenLayers.Request.GET({url:a,async:!1}))return a.responseText},parseStyles:function(a,b){for(var c=0,d=a.length;c<d;c++){var e=this.parseStyle(a[c]);e&&(this.styles[(b.styleBaseUrl||"")+"#"+e.id]=e)}},parseKmlColor:function(a){var b=
null;a&&(a=a.match(this.regExes.kmlColor))&&(b={color:"#"+a[4]+a[3]+a[2],opacity:parseInt(a[1],16)/255});return b},parseStyle:function(a){for(var b={},c=["LineStyle","PolyStyle","IconStyle","BalloonStyle","LabelStyle"],d,e,f=0,g=c.length;f<g;++f)if(d=c[f],e=this.getElementsByTagNameNS(a,"*",d)[0])switch(d.toLowerCase()){case "linestyle":d=this.parseProperty(e,"*","color");if(d=this.parseKmlColor(d))b.strokeColor=d.color,b.strokeOpacity=d.opacity;(d=this.parseProperty(e,"*","width"))&&(b.strokeWidth=
d);break;case "polystyle":d=this.parseProperty(e,"*","color");if(d=this.parseKmlColor(d))b.fillOpacity=d.opacity,b.fillColor=d.color;"0"==this.parseProperty(e,"*","fill")&&(b.fillColor="none");"0"==this.parseProperty(e,"*","outline")&&(b.strokeWidth="0");break;case "iconstyle":var h=parseFloat(this.parseProperty(e,"*","scale")||1);d=32*h;var j=32*h,n=this.getElementsByTagNameNS(e,"*","Icon")[0];if(n){var p=this.parseProperty(n,"*","href");if(p){var q=this.parseProperty(n,"*","w"),m=this.parseProperty(n,
"*","h");OpenLayers.String.startsWith(p,"http://maps.google.com/mapfiles/kml")&&(!q&&!m)&&(m=q=64,h/=2);q=q||m;m=m||q;q&&(d=parseInt(q)*h);m&&(j=parseInt(m)*h);if(m=p.match(this.regExes.kmlIconPalette))q=m[1],m=m[2],p=this.parseProperty(n,"*","x"),n=this.parseProperty(n,"*","y"),p="http://maps.google.com/mapfiles/kml/pal"+q+"/icon"+(8*(n?7-n/32:7)+(p?p/32:0))+m;b.graphicOpacity=1;b.externalGraphic=p}}if(e=this.getElementsByTagNameNS(e,"*","hotSpot")[0])p=parseFloat(e.getAttribute("x")),n=parseFloat(e.getAttribute("y")),
q=e.getAttribute("xunits"),"pixels"==q?b.graphicXOffset=-p*h:"insetPixels"==q?b.graphicXOffset=-d+p*h:"fraction"==q&&(b.graphicXOffset=-d*p),e=e.getAttribute("yunits"),"pixels"==e?b.graphicYOffset=-j+n*h+1:"insetPixels"==e?b.graphicYOffset=-(n*h)+1:"fraction"==e&&(b.graphicYOffset=-j*(1-n)+1);b.graphicWidth=d;b.graphicHeight=j;break;case "balloonstyle":(e=OpenLayers.Util.getXmlNodeValue(e))&&(b.balloonStyle=e.replace(this.regExes.straightBracket,"${$1}"));break;case "labelstyle":if(d=this.parseProperty(e,
"*","color"),d=this.parseKmlColor(d))b.fontColor=d.color,b.fontOpacity=d.opacity}!b.strokeColor&&b.fillColor&&(b.strokeColor=b.fillColor);if((a=a.getAttribute("id"))&&b)b.id=a;return b},parseStyleMaps:function(a,b){for(var c=0,d=a.length;c<d;c++)for(var e=a[c],f=this.getElementsByTagNameNS(e,"*","Pair"),e=e.getAttribute("id"),g=0,h=f.length;g<h;g++){var j=f[g],n=this.parseProperty(j,"*","key");(j=this.parseProperty(j,"*","styleUrl"))&&"normal"==n&&(this.styles[(b.styleBaseUrl||"")+"#"+e]=this.styles[(b.styleBaseUrl||
"")+j])}},parseFeatures:function(a,b){for(var c=[],d=0,e=a.length;d<e;d++){var f=a[d],g=this.parseFeature.apply(this,[f]);if(g){this.extractStyles&&(g.attributes&&g.attributes.styleUrl)&&(g.style=this.getStyle(g.attributes.styleUrl,b));if(this.extractStyles){var h=this.getElementsByTagNameNS(f,"*","Style")[0];if(h&&(h=this.parseStyle(h)))g.style=OpenLayers.Util.extend(g.style,h)}if(this.extractTracks){if((f=this.getElementsByTagNameNS(f,this.namespaces.gx,"Track"))&&0<f.length)g={features:[],feature:g},
this.readNode(f[0],g),0<g.features.length&&c.push.apply(c,g.features)}else c.push(g)}else throw"Bad Placemark: "+d;}this.features=this.features.concat(c)},readers:{kml:{when:function(a,b){b.whens.push(OpenLayers.Date.parse(this.getChildValue(a)))},_trackPointAttribute:function(a,b){var c=a.nodeName.split(":").pop();b.attributes[c].push(this.getChildValue(a))}},gx:{Track:function(a,b){var c={whens:[],points:[],angles:[]};if(this.trackAttributes){var d;c.attributes={};for(var e=0,f=this.trackAttributes.length;e<
f;++e)d=this.trackAttributes[e],c.attributes[d]=[],d in this.readers.kml||(this.readers.kml[d]=this.readers.kml._trackPointAttribute)}this.readChildNodes(a,c);if(c.whens.length!==c.points.length)throw Error("gx:Track with unequal number of when ("+c.whens.length+") and gx:coord ("+c.points.length+") elements.");var g=0<c.angles.length;if(g&&c.whens.length!==c.angles.length)throw Error("gx:Track with unequal number of when ("+c.whens.length+") and gx:angles ("+c.angles.length+") elements.");for(var h,
e=0,f=c.whens.length;e<f;++e){h=b.feature.clone();h.fid=b.feature.fid||b.feature.id;d=c.points[e];h.geometry=d;"z"in d&&(h.attributes.altitude=d.z);this.internalProjection&&this.externalProjection&&h.geometry.transform(this.externalProjection,this.internalProjection);if(this.trackAttributes)for(var j=0,n=this.trackAttributes.length;j<n;++j)d=this.trackAttributes[j],h.attributes[d]=c.attributes[d][e];h.attributes.when=c.whens[e];h.attributes.trackId=b.feature.id;g&&(d=c.angles[e],h.attributes.heading=
parseFloat(d[0]),h.attributes.tilt=parseFloat(d[1]),h.attributes.roll=parseFloat(d[2]));b.features.push(h)}},coord:function(a,b){var c=this.getChildValue(a).replace(this.regExes.trimSpace,"").split(/\s+/),d=new OpenLayers.Geometry.Point(c[0],c[1]);2<c.length&&(d.z=parseFloat(c[2]));b.points.push(d)},angles:function(a,b){var c=this.getChildValue(a).replace(this.regExes.trimSpace,"").split(/\s+/);b.angles.push(c)}}},parseFeature:function(a){for(var b=["MultiGeometry","Polygon","LineString","Point"],
c,d,e,f=0,g=b.length;f<g;++f)if(c=b[f],this.internalns=a.namespaceURI?a.namespaceURI:this.kmlns,d=this.getElementsByTagNameNS(a,this.internalns,c),0<d.length){if(b=this.parseGeometry[c.toLowerCase()])e=b.apply(this,[d[0]]),this.internalProjection&&this.externalProjection&&e.transform(this.externalProjection,this.internalProjection);else throw new TypeError("Unsupported geometry type: "+c);break}var h;this.extractAttributes&&(h=this.parseAttributes(a));c=new OpenLayers.Feature.Vector(e,h);a=a.getAttribute("id")||
a.getAttribute("name");null!=a&&(c.fid=a);return c},getStyle:function(a,b){var c=OpenLayers.Util.removeTail(a),d=OpenLayers.Util.extend({},b);d.depth++;d.styleBaseUrl=c;!this.styles[a]&&!OpenLayers.String.startsWith(a,"#")&&d.depth<=this.maxDepth&&!this.fetched[c]&&(c=this.fetchLink(c))&&this.parseData(c,d);return OpenLayers.Util.extend({},this.styles[a])},parseGeometry:{point:function(a){var b=this.getElementsByTagNameNS(a,this.internalns,"coordinates"),a=[];if(0<b.length)var c=b[0].firstChild.nodeValue,
c=c.replace(this.regExes.removeSpace,""),a=c.split(",");b=null;if(1<a.length)2==a.length&&(a[2]=null),b=new OpenLayers.Geometry.Point(a[0],a[1],a[2]);else throw"Bad coordinate string: "+c;return b},linestring:function(a,b){var c=this.getElementsByTagNameNS(a,this.internalns,"coordinates"),d=null;if(0<c.length){for(var c=this.getChildValue(c[0]),c=c.replace(this.regExes.trimSpace,""),c=c.replace(this.regExes.trimComma,","),d=c.split(this.regExes.splitSpace),e=d.length,f=Array(e),g,h,j=0;j<e;++j)if(g=
d[j].split(","),h=g.length,1<h)2==g.length&&(g[2]=null),f[j]=new OpenLayers.Geometry.Point(g[0],g[1],g[2]);else throw"Bad LineString point coordinates: "+d[j];if(e)d=b?new OpenLayers.Geometry.LinearRing(f):new OpenLayers.Geometry.LineString(f);else throw"Bad LineString coordinates: "+c;}return d},polygon:function(a){var a=this.getElementsByTagNameNS(a,this.internalns,"LinearRing"),b=a.length,c=Array(b);if(0<b)for(var d=0,e=a.length;d<e;++d)if(b=this.parseGeometry.linestring.apply(this,[a[d],!0]))c[d]=
b;else throw"Bad LinearRing geometry: "+d;return new OpenLayers.Geometry.Polygon(c)},multigeometry:function(a){for(var b,c=[],d=a.childNodes,e=0,f=d.length;e<f;++e)a=d[e],1==a.nodeType&&(b=a.prefix?a.nodeName.split(":")[1]:a.nodeName,(b=this.parseGeometry[b.toLowerCase()])&&c.push(b.apply(this,[a])));return new OpenLayers.Geometry.Collection(c)}},parseAttributes:function(a){var b={},c=a.getElementsByTagName("ExtendedData");c.length&&(b=this.parseExtendedData(c[0]));for(var d,e,f,a=a.childNodes,c=
0,g=a.length;c<g;++c)if(d=a[c],1==d.nodeType&&(e=d.childNodes,1<=e.length&&3>=e.length)){switch(e.length){case 1:f=e[0];break;case 2:f=e[0];e=e[1];f=3==f.nodeType||4==f.nodeType?f:e;break;default:f=e[1]}if(3==f.nodeType||4==f.nodeType)if(d=d.prefix?d.nodeName.split(":")[1]:d.nodeName,f=OpenLayers.Util.getXmlNodeValue(f))f=f.replace(this.regExes.trimSpace,""),b[d]=f}return b},parseExtendedData:function(a){var b={},c,d,e,f,g=a.getElementsByTagName("Data");c=0;for(d=g.length;c<d;c++){e=g[c];f=e.getAttribute("name");
var h={},j=e.getElementsByTagName("value");j.length&&(h.value=this.getChildValue(j[0]));this.kvpAttributes?b[f]=h.value:(e=e.getElementsByTagName("displayName"),e.length&&(h.displayName=this.getChildValue(e[0])),b[f]=h)}a=a.getElementsByTagName("SimpleData");c=0;for(d=a.length;c<d;c++)h={},e=a[c],f=e.getAttribute("name"),h.value=this.getChildValue(e),this.kvpAttributes?b[f]=h.value:(h.displayName=f,b[f]=h);return b},parseProperty:function(a,b,c){var d,a=this.getElementsByTagNameNS(a,b,c);try{d=OpenLayers.Util.getXmlNodeValue(a[0])}catch(e){d=
null}return d},write:function(a){OpenLayers.Util.isArray(a)||(a=[a]);for(var b=this.createElementNS(this.kmlns,"kml"),c=this.createFolderXML(),d=0,e=a.length;d<e;++d)c.appendChild(this.createPlacemarkXML(a[d]));b.appendChild(c);return OpenLayers.Format.XML.prototype.write.apply(this,[b])},createFolderXML:function(){var a=this.createElementNS(this.kmlns,"Folder");if(this.foldersName){var b=this.createElementNS(this.kmlns,"name"),c=this.createTextNode(this.foldersName);b.appendChild(c);a.appendChild(b)}this.foldersDesc&&
(b=this.createElementNS(this.kmlns,"description"),c=this.createTextNode(this.foldersDesc),b.appendChild(c),a.appendChild(b));return a},createPlacemarkXML:function(a){var b=this.createElementNS(this.kmlns,"name"),c=a.style&&a.style.label?a.style.label:a.id;b.appendChild(this.createTextNode(a.attributes.name||c));var d=this.createElementNS(this.kmlns,"description");d.appendChild(this.createTextNode(a.attributes.description||this.placemarksDesc));c=this.createElementNS(this.kmlns,"Placemark");null!=
a.fid&&c.setAttribute("id",a.fid);c.appendChild(b);c.appendChild(d);b=this.buildGeometryNode(a.geometry);c.appendChild(b);a.attributes&&(a=this.buildExtendedData(a.attributes))&&c.appendChild(a);return c},buildGeometryNode:function(a){var b=a.CLASS_NAME,b=b.substring(b.lastIndexOf(".")+1),b=this.buildGeometry[b.toLowerCase()],c=null;b&&(c=b.apply(this,[a]));return c},buildGeometry:{point:function(a){var b=this.createElementNS(this.kmlns,"Point");b.appendChild(this.buildCoordinatesNode(a));return b},
multipoint:function(a){return this.buildGeometry.collection.apply(this,[a])},linestring:function(a){var b=this.createElementNS(this.kmlns,"LineString");b.appendChild(this.buildCoordinatesNode(a));return b},multilinestring:function(a){return this.buildGeometry.collection.apply(this,[a])},linearring:function(a){var b=this.createElementNS(this.kmlns,"LinearRing");b.appendChild(this.buildCoordinatesNode(a));return b},polygon:function(a){for(var b=this.createElementNS(this.kmlns,"Polygon"),a=a.components,
c,d,e=0,f=a.length;e<f;++e)c=0==e?"outerBoundaryIs":"innerBoundaryIs",c=this.createElementNS(this.kmlns,c),d=this.buildGeometry.linearring.apply(this,[a[e]]),c.appendChild(d),b.appendChild(c);return b},multipolygon:function(a){return this.buildGeometry.collection.apply(this,[a])},collection:function(a){for(var b=this.createElementNS(this.kmlns,"MultiGeometry"),c,d=0,e=a.components.length;d<e;++d)(c=this.buildGeometryNode.apply(this,[a.components[d]]))&&b.appendChild(c);return b}},buildCoordinatesNode:function(a){var b=
this.createElementNS(this.kmlns,"coordinates"),c;if(c=a.components){for(var d=c.length,e=Array(d),f=0;f<d;++f)a=c[f],e[f]=this.buildCoordinates(a);c=e.join(" ")}else c=this.buildCoordinates(a);c=this.createTextNode(c);b.appendChild(c);return b},buildCoordinates:function(a){this.internalProjection&&this.externalProjection&&(a=a.clone(),a.transform(this.internalProjection,this.externalProjection));return a.x+","+a.y},buildExtendedData:function(a){var b=this.createElementNS(this.kmlns,"ExtendedData"),
c;for(c in a)if(a[c]&&"name"!=c&&"description"!=c&&"styleUrl"!=c){var d=this.createElementNS(this.kmlns,"Data");d.setAttribute("name",c);var e=this.createElementNS(this.kmlns,"value");if("object"==typeof a[c]){if(a[c].value&&e.appendChild(this.createTextNode(a[c].value)),a[c].displayName){var f=this.createElementNS(this.kmlns,"displayName");f.appendChild(this.getXMLDoc().createCDATASection(a[c].displayName));d.appendChild(f)}}else e.appendChild(this.createTextNode(a[c]));d.appendChild(e);b.appendChild(d)}return this.isSimpleContent(b)?
null:b},CLASS_NAME:"OpenLayers.Format.KML"});
OpenLayers.Format.WMSCapabilities.v1_1=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1,{readers:{wms:OpenLayers.Util.applyDefaults({WMT_MS_Capabilities:function(a,b){this.readChildNodes(a,b)},Keyword:function(a,b){b.keywords&&b.keywords.push(this.getChildValue(a))},DescribeLayer:function(a,b){b.describelayer={formats:[]};this.readChildNodes(a,b.describelayer)},GetLegendGraphic:function(a,b){b.getlegendgraphic={formats:[]};this.readChildNodes(a,b.getlegendgraphic)},GetStyles:function(a,b){b.getstyles=
{formats:[]};this.readChildNodes(a,b.getstyles)},PutStyles:function(a,b){b.putstyles={formats:[]};this.readChildNodes(a,b.putstyles)},UserDefinedSymbolization:function(a,b){var c={supportSLD:1==parseInt(a.getAttribute("SupportSLD")),userLayer:1==parseInt(a.getAttribute("UserLayer")),userStyle:1==parseInt(a.getAttribute("UserStyle")),remoteWFS:1==parseInt(a.getAttribute("RemoteWFS"))};b.userSymbols=c},LatLonBoundingBox:function(a,b){b.llbbox=[parseFloat(a.getAttribute("minx")),parseFloat(a.getAttribute("miny")),
parseFloat(a.getAttribute("maxx")),parseFloat(a.getAttribute("maxy"))]},BoundingBox:function(a,b){var c=OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms.BoundingBox.apply(this,[a,b]);c.srs=a.getAttribute("SRS");b.bbox[c.srs]=c},ScaleHint:function(a,b){var c=a.getAttribute("min"),d=a.getAttribute("max"),e=Math.pow(2,0.5),f=OpenLayers.INCHES_PER_UNIT.m;0!=c&&(b.maxScale=parseFloat((c/e*f*OpenLayers.DOTS_PER_INCH).toPrecision(13)));d!=Number.POSITIVE_INFINITY&&(b.minScale=parseFloat((d/e*f*
OpenLayers.DOTS_PER_INCH).toPrecision(13)))},Dimension:function(a,b){var c={name:a.getAttribute("name").toLowerCase(),units:a.getAttribute("units"),unitsymbol:a.getAttribute("unitSymbol")};b.dimensions[c.name]=c},Extent:function(a,b){var c=a.getAttribute("name").toLowerCase();if(c in b.dimensions){c=b.dimensions[c];c.nearestVal="1"===a.getAttribute("nearestValue");c.multipleVal="1"===a.getAttribute("multipleValues");c.current="1"===a.getAttribute("current");c["default"]=a.getAttribute("default")||
"";var d=this.getChildValue(a);c.values=d.split(",")}}},OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms)},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1"});OpenLayers.Format.WMSCapabilities.v1_1_0=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1,{version:"1.1.0",readers:{wms:OpenLayers.Util.applyDefaults({SRS:function(a,b){for(var c=this.getChildValue(a).split(/ +/),d=0,e=c.length;d<e;d++)b.srs[c[d]]=!0}},OpenLayers.Format.WMSCapabilities.v1_1.prototype.readers.wms)},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1_0"});
OpenLayers.Strategy.BBOX=OpenLayers.Class(OpenLayers.Strategy,{bounds:null,resolution:null,ratio:2,resFactor:null,response:null,activate:function(){var a=OpenLayers.Strategy.prototype.activate.call(this);a&&(this.layer.events.on({moveend:this.update,refresh:this.update,visibilitychanged:this.update,scope:this}),this.update());return a},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);a&&this.layer.events.un({moveend:this.update,refresh:this.update,visibilitychanged:this.update,
scope:this});return a},update:function(a){var b=this.getMapBounds();if(null!==b&&(a&&a.force||this.layer.visibility&&this.layer.calculateInRange()&&this.invalidBounds(b)))this.calculateBounds(b),this.resolution=this.layer.map.getResolution(),this.triggerRead(a)},getMapBounds:function(){if(null===this.layer.map)return null;var a=this.layer.map.getExtent();a&&!this.layer.projection.equals(this.layer.map.getProjectionObject())&&(a=a.clone().transform(this.layer.map.getProjectionObject(),this.layer.projection));
return a},invalidBounds:function(a){a||(a=this.getMapBounds());a=!this.bounds||!this.bounds.containsBounds(a);!a&&this.resFactor&&(a=this.resolution/this.layer.map.getResolution(),a=a>=this.resFactor||a<=1/this.resFactor);return a},calculateBounds:function(a){a||(a=this.getMapBounds());var b=a.getCenterLonLat(),c=a.getWidth()*this.ratio,a=a.getHeight()*this.ratio;this.bounds=new OpenLayers.Bounds(b.lon-c/2,b.lat-a/2,b.lon+c/2,b.lat+a/2)},triggerRead:function(a){this.response&&!(a&&!0===a.noAbort)&&
(this.layer.protocol.abort(this.response),this.layer.events.triggerEvent("loadend"));var b={filter:this.createFilter()};this.layer.events.triggerEvent("loadstart",b);this.response=this.layer.protocol.read(OpenLayers.Util.applyDefaults({filter:b.filter,callback:this.merge,scope:this},a))},createFilter:function(){var a=new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.BBOX,value:this.bounds,projection:this.layer.projection});this.layer.filter&&(a=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND,
filters:[this.layer.filter,a]}));return a},merge:function(a){this.layer.destroyFeatures();if(a.success()){var b=a.features;if(b&&0<b.length){var c=this.layer.projection,d=this.layer.map.getProjectionObject();if(!d.equals(c))for(var e,f=0,g=b.length;f<g;++f)(e=b[f].geometry)&&e.transform(c,d);this.layer.addFeatures(b)}}else this.bounds=null;this.response=null;this.layer.events.triggerEvent("loadend",{response:a})},CLASS_NAME:"OpenLayers.Strategy.BBOX"});
OpenLayers.Handler.Feature=OpenLayers.Class(OpenLayers.Handler,{EVENTMAP:{click:{"in":"click",out:"clickout"},mousemove:{"in":"over",out:"out"},dblclick:{"in":"dblclick",out:null},mousedown:{"in":null,out:null},mouseup:{"in":null,out:null},touchstart:{"in":"click",out:"clickout"}},feature:null,lastFeature:null,down:null,up:null,clickTolerance:4,geometryTypes:null,stopClick:!0,stopDown:!0,stopUp:!1,initialize:function(a,b,c,d){OpenLayers.Handler.prototype.initialize.apply(this,[a,c,d]);this.layer=
b},touchstart:function(a){this.startTouch();return OpenLayers.Event.isMultiTouch(a)?!0:this.mousedown(a)},touchmove:function(a){OpenLayers.Event.preventDefault(a)},mousedown:function(a){if(OpenLayers.Event.isLeftClick(a)||OpenLayers.Event.isSingleTouch(a))this.down=a.xy;return this.handle(a)?!this.stopDown:!0},mouseup:function(a){this.up=a.xy;return this.handle(a)?!this.stopUp:!0},click:function(a){return this.handle(a)?!this.stopClick:!0},mousemove:function(a){if(!this.callbacks.over&&!this.callbacks.out)return!0;
this.handle(a);return!0},dblclick:function(a){return!this.handle(a)},geometryTypeMatches:function(a){return null==this.geometryTypes||-1<OpenLayers.Util.indexOf(this.geometryTypes,a.geometry.CLASS_NAME)},handle:function(a){this.feature&&!this.feature.layer&&(this.feature=null);var b=a.type,c=!1,d=!!this.feature,e="click"==b||"dblclick"==b||"touchstart"==b;if((this.feature=this.layer.getFeatureFromEvent(a))&&!this.feature.layer)this.feature=null;this.lastFeature&&!this.lastFeature.layer&&(this.lastFeature=
null);this.feature?("touchstart"===b&&OpenLayers.Event.preventDefault(a),a=this.feature!=this.lastFeature,this.geometryTypeMatches(this.feature)?(d&&a?(this.lastFeature&&this.triggerCallback(b,"out",[this.lastFeature]),this.triggerCallback(b,"in",[this.feature])):(!d||e)&&this.triggerCallback(b,"in",[this.feature]),this.lastFeature=this.feature,c=!0):(this.lastFeature&&(d&&a||e)&&this.triggerCallback(b,"out",[this.lastFeature]),this.feature=null)):this.lastFeature&&(d||e)&&this.triggerCallback(b,
"out",[this.lastFeature]);return c},triggerCallback:function(a,b,c){if(b=this.EVENTMAP[a][b])"click"==a&&this.up&&this.down?(Math.sqrt(Math.pow(this.up.x-this.down.x,2)+Math.pow(this.up.y-this.down.y,2))<=this.clickTolerance&&this.callback(b,c),this.up=this.down=null):this.callback(b,c)},activate:function(){var a=!1;OpenLayers.Handler.prototype.activate.apply(this,arguments)&&(this.moveLayerToTop(),this.map.events.on({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this}),
a=!0);return a},deactivate:function(){var a=!1;OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.moveLayerBack(),this.up=this.down=this.lastFeature=this.feature=null,this.map.events.un({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this}),a=!0);return a},handleMapEvents:function(a){("removelayer"==a.type||"order"==a.property)&&this.moveLayerToTop()},moveLayerToTop:function(){var a=Math.max(this.map.Z_INDEX_BASE.Feature-1,this.layer.getZIndex())+1;this.layer.setZIndex(a)},
moveLayerBack:function(){var a=this.layer.getZIndex()-1;a>=this.map.Z_INDEX_BASE.Feature?this.layer.setZIndex(a):this.map.setLayerZIndex(this.layer,this.map.getLayerIndex(this.layer))},CLASS_NAME:"OpenLayers.Handler.Feature"});
OpenLayers.StyleMap=OpenLayers.Class({styles:null,extendDefault:!0,initialize:function(a,b){this.styles={"default":new OpenLayers.Style(OpenLayers.Feature.Vector.style["default"]),select:new OpenLayers.Style(OpenLayers.Feature.Vector.style.select),temporary:new OpenLayers.Style(OpenLayers.Feature.Vector.style.temporary),"delete":new OpenLayers.Style(OpenLayers.Feature.Vector.style["delete"])};if(a instanceof OpenLayers.Style)this.styles["default"]=a,this.styles.select=a,this.styles.temporary=a,this.styles["delete"]=
a;else if("object"==typeof a)for(var c in a)if(a[c]instanceof OpenLayers.Style)this.styles[c]=a[c];else if("object"==typeof a[c])this.styles[c]=new OpenLayers.Style(a[c]);else{this.styles["default"]=new OpenLayers.Style(a);this.styles.select=new OpenLayers.Style(a);this.styles.temporary=new OpenLayers.Style(a);this.styles["delete"]=new OpenLayers.Style(a);break}OpenLayers.Util.extend(this,b)},destroy:function(){for(var a in this.styles)this.styles[a].destroy();this.styles=null},createSymbolizer:function(a,
b){a||(a=new OpenLayers.Feature.Vector);this.styles[b]||(b="default");a.renderIntent=b;var c={};this.extendDefault&&"default"!=b&&(c=this.styles["default"].createSymbolizer(a));return OpenLayers.Util.extend(c,this.styles[b].createSymbolizer(a))},addUniqueValueRules:function(a,b,c,d){var e=[],f;for(f in c)e.push(new OpenLayers.Rule({symbolizer:c[f],context:d,filter:new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO,property:b,value:f})}));this.styles[a].addRules(e)},CLASS_NAME:"OpenLayers.StyleMap"});
OpenLayers.Layer.Vector=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:!1,isFixed:!1,features:null,filter:null,selectedFeatures:null,unrenderedFeatures:null,reportError:!0,style:null,styleMap:null,strategies:null,protocol:null,renderers:["SVG","VML","Canvas"],renderer:null,rendererOptions:null,geometryType:null,drawn:!1,ratio:1,initialize:function(a,b){OpenLayers.Layer.prototype.initialize.apply(this,arguments);(!this.renderer||!this.renderer.supported())&&this.assignRenderer();if(!this.renderer||
!this.renderer.supported())this.renderer=null,this.displayError();this.styleMap||(this.styleMap=new OpenLayers.StyleMap);this.features=[];this.selectedFeatures=[];this.unrenderedFeatures={};if(this.strategies)for(var c=0,d=this.strategies.length;c<d;c++)this.strategies[c].setLayer(this)},destroy:function(){if(this.strategies){var a,b,c;b=0;for(c=this.strategies.length;b<c;b++)a=this.strategies[b],a.autoDestroy&&a.destroy();this.strategies=null}this.protocol&&(this.protocol.autoDestroy&&this.protocol.destroy(),
this.protocol=null);this.destroyFeatures();this.unrenderedFeatures=this.selectedFeatures=this.features=null;this.renderer&&this.renderer.destroy();this.drawn=this.geometryType=this.renderer=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(a){null==a&&(a=new OpenLayers.Layer.Vector(this.name,this.getOptions()));for(var a=OpenLayers.Layer.prototype.clone.apply(this,[a]),b=this.features,c=b.length,d=Array(c),e=0;e<c;++e)d[e]=b[e].clone();a.features=d;return a},refresh:function(a){this.calculateInRange()&&
this.visibility&&this.events.triggerEvent("refresh",a)},assignRenderer:function(){for(var a=0,b=this.renderers.length;a<b;a++){var c=this.renderers[a];if((c="function"==typeof c?c:OpenLayers.Renderer[c])&&c.prototype.supported()){this.renderer=new c(this.div,this.rendererOptions);break}}},displayError:function(){this.reportError&&OpenLayers.Console.userError(OpenLayers.i18n("browserNotSupported",{renderers:this.renderers.join("\n")}))},setMap:function(a){OpenLayers.Layer.prototype.setMap.apply(this,
arguments);if(this.renderer){this.renderer.map=this.map;var b=this.map.getSize();b.w*=this.ratio;b.h*=this.ratio;this.renderer.setSize(b)}else this.map.removeLayer(this)},afterAdd:function(){if(this.strategies){var a,b,c;b=0;for(c=this.strategies.length;b<c;b++)a=this.strategies[b],a.autoActivate&&a.activate()}},removeMap:function(){this.drawn=!1;if(this.strategies){var a,b,c;b=0;for(c=this.strategies.length;b<c;b++)a=this.strategies[b],a.autoActivate&&a.deactivate()}},onMapResize:function(){OpenLayers.Layer.prototype.onMapResize.apply(this,
arguments);var a=this.map.getSize();a.w*=this.ratio;a.h*=this.ratio;this.renderer.setSize(a)},moveTo:function(a,b,c){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);var d=!0;if(!c){this.renderer.root.style.visibility="hidden";var d=this.map.getSize(),e=d.w,d=d.h,e=e/2*this.ratio-e/2,d=d/2*this.ratio-d/2,e=e+this.map.layerContainerOriginPx.x,e=-Math.round(e),d=d+this.map.layerContainerOriginPx.y,d=-Math.round(d);this.div.style.left=e+"px";this.div.style.top=d+"px";e=this.map.getExtent().scale(this.ratio);
d=this.renderer.setExtent(e,b);this.renderer.root.style.visibility="visible";!0===OpenLayers.IS_GECKO&&(this.div.scrollLeft=this.div.scrollLeft);if(!b&&d)for(var f in this.unrenderedFeatures)e=this.unrenderedFeatures[f],this.drawFeature(e)}if(!this.drawn||b||!d){this.drawn=!0;f=0;for(d=this.features.length;f<d;f++)this.renderer.locked=f!==d-1,e=this.features[f],this.drawFeature(e)}},display:function(a){OpenLayers.Layer.prototype.display.apply(this,arguments);var b=this.div.style.display;b!=this.renderer.root.style.display&&
(this.renderer.root.style.display=b)},addFeatures:function(a,b){OpenLayers.Util.isArray(a)||(a=[a]);var c=!b||!b.silent;if(c){var d={features:a};if(!1===this.events.triggerEvent("beforefeaturesadded",d))return;a=d.features}for(var d=[],e=0,f=a.length;e<f;e++){this.renderer.locked=e!=a.length-1?!0:!1;var g=a[e];if(this.geometryType&&!(g.geometry instanceof this.geometryType))throw new TypeError("addFeatures: component should be an "+this.geometryType.prototype.CLASS_NAME);g.layer=this;!g.style&&this.style&&
(g.style=OpenLayers.Util.extend({},this.style));if(c){if(!1===this.events.triggerEvent("beforefeatureadded",{feature:g}))continue;this.preFeatureInsert(g)}d.push(g);this.features.push(g);this.drawFeature(g);c&&(this.events.triggerEvent("featureadded",{feature:g}),this.onFeatureInsert(g))}c&&this.events.triggerEvent("featuresadded",{features:d})},removeFeatures:function(a,b){if(a&&0!==a.length){if(a===this.features)return this.removeAllFeatures(b);OpenLayers.Util.isArray(a)||(a=[a]);a===this.selectedFeatures&&
(a=a.slice());var c=!b||!b.silent;c&&this.events.triggerEvent("beforefeaturesremoved",{features:a});for(var d=a.length-1;0<=d;d--){this.renderer.locked=0!=d&&a[d-1].geometry?!0:!1;var e=a[d];delete this.unrenderedFeatures[e.id];c&&this.events.triggerEvent("beforefeatureremoved",{feature:e});this.features=OpenLayers.Util.removeItem(this.features,e);e.layer=null;e.geometry&&this.renderer.eraseFeatures(e);-1!=OpenLayers.Util.indexOf(this.selectedFeatures,e)&&OpenLayers.Util.removeItem(this.selectedFeatures,
e);c&&this.events.triggerEvent("featureremoved",{feature:e})}c&&this.events.triggerEvent("featuresremoved",{features:a})}},removeAllFeatures:function(a){var a=!a||!a.silent,b=this.features;a&&this.events.triggerEvent("beforefeaturesremoved",{features:b});for(var c,d=b.length-1;0<=d;d--)c=b[d],a&&this.events.triggerEvent("beforefeatureremoved",{feature:c}),c.layer=null,a&&this.events.triggerEvent("featureremoved",{feature:c});this.renderer.clear();this.features=[];this.unrenderedFeatures={};this.selectedFeatures=
[];a&&this.events.triggerEvent("featuresremoved",{features:b})},destroyFeatures:function(a,b){void 0==a&&(a=this.features);if(a){this.removeFeatures(a,b);for(var c=a.length-1;0<=c;c--)a[c].destroy()}},drawFeature:function(a,b){if(this.drawn){if("object"!=typeof b){!b&&a.state===OpenLayers.State.DELETE&&(b="delete");var c=b||a.renderIntent;(b=a.style||this.style)||(b=this.styleMap.createSymbolizer(a,c))}c=this.renderer.drawFeature(a,b);!1===c||null===c?this.unrenderedFeatures[a.id]=a:delete this.unrenderedFeatures[a.id]}},
eraseFeatures:function(a){this.renderer.eraseFeatures(a)},getFeatureFromEvent:function(a){if(!this.renderer)throw Error("getFeatureFromEvent called on layer with no renderer. This usually means you destroyed a layer, but not some handler which is associated with it.");var b=null;(a=this.renderer.getFeatureIdFromEvent(a))&&(b="string"===typeof a?this.getFeatureById(a):a);return b},getFeatureBy:function(a,b){for(var c=null,d=0,e=this.features.length;d<e;++d)if(this.features[d][a]==b){c=this.features[d];
break}return c},getFeatureById:function(a){return this.getFeatureBy("id",a)},getFeatureByFid:function(a){return this.getFeatureBy("fid",a)},getFeaturesByAttribute:function(a,b){var c,d,e=this.features.length,f=[];for(c=0;c<e;c++)(d=this.features[c])&&d.attributes&&d.attributes[a]===b&&f.push(d);return f},onFeatureInsert:function(){},preFeatureInsert:function(){},getDataExtent:function(){var a=null,b=this.features;if(b&&0<b.length)for(var c=null,d=0,e=b.length;d<e;d++)if(c=b[d].geometry)null===a&&
(a=new OpenLayers.Bounds),a.extend(c.getBounds());return a},CLASS_NAME:"OpenLayers.Layer.Vector"});
OpenLayers.Layer.Vector.RootContainer=OpenLayers.Class(OpenLayers.Layer.Vector,{displayInLayerSwitcher:!1,layers:null,display:function(){},getFeatureFromEvent:function(a){for(var b=this.layers,c,d=0;d<b.length;d++)if(c=b[d].getFeatureFromEvent(a))return c},setMap:function(a){OpenLayers.Layer.Vector.prototype.setMap.apply(this,arguments);this.collectRoots();a.events.register("changelayer",this,this.handleChangeLayer)},removeMap:function(a){a.events.unregister("changelayer",this,this.handleChangeLayer);
this.resetRoots();OpenLayers.Layer.Vector.prototype.removeMap.apply(this,arguments)},collectRoots:function(){for(var a,b=0;b<this.map.layers.length;++b)a=this.map.layers[b],-1!=OpenLayers.Util.indexOf(this.layers,a)&&a.renderer.moveRoot(this.renderer)},resetRoots:function(){for(var a,b=0;b<this.layers.length;++b)a=this.layers[b],this.renderer&&a.renderer.getRenderLayerId()==this.id&&this.renderer.moveRoot(a.renderer)},handleChangeLayer:function(a){var b=a.layer;"order"==a.property&&-1!=OpenLayers.Util.indexOf(this.layers,
b)&&(this.resetRoots(),this.collectRoots())},CLASS_NAME:"OpenLayers.Layer.Vector.RootContainer"});
OpenLayers.Control.SelectFeature=OpenLayers.Class(OpenLayers.Control,{multipleKey:null,toggleKey:null,multiple:!1,clickout:!0,toggle:!1,hover:!1,highlightOnly:!1,box:!1,onBeforeSelect:function(){},onSelect:function(){},onUnselect:function(){},scope:null,geometryTypes:null,layer:null,layers:null,callbacks:null,selectStyle:null,renderIntent:"select",handlers:null,initialize:function(a,b){OpenLayers.Control.prototype.initialize.apply(this,[b]);null===this.scope&&(this.scope=this);this.initLayer(a);var c=
{click:this.clickFeature,clickout:this.clickoutFeature};this.hover&&(c.over=this.overFeature,c.out=this.outFeature);this.callbacks=OpenLayers.Util.extend(c,this.callbacks);this.handlers={feature:new OpenLayers.Handler.Feature(this,this.layer,this.callbacks,{geometryTypes:this.geometryTypes})};this.box&&(this.handlers.box=new OpenLayers.Handler.Box(this,{done:this.selectBox},{boxDivClassName:"olHandlerBoxSelectFeature"}))},initLayer:function(a){OpenLayers.Util.isArray(a)?(this.layers=a,this.layer=
new OpenLayers.Layer.Vector.RootContainer(this.id+"_container",{layers:a})):this.layer=a},destroy:function(){this.active&&this.layers&&this.map.removeLayer(this.layer);OpenLayers.Control.prototype.destroy.apply(this,arguments);this.layers&&this.layer.destroy()},activate:function(){this.active||(this.layers&&this.map.addLayer(this.layer),this.handlers.feature.activate(),this.box&&this.handlers.box&&this.handlers.box.activate());return OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){this.active&&
(this.handlers.feature.deactivate(),this.handlers.box&&this.handlers.box.deactivate(),this.layers&&this.map.removeLayer(this.layer));return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},unselectAll:function(a){var b=this.layers||[this.layer],c,d,e,f;for(e=0;e<b.length;++e)if(c=b[e],f=0,null!=c.selectedFeatures)for(;c.selectedFeatures.length>f;)d=c.selectedFeatures[f],!a||a.except!=d?this.unselect(d):++f},clickFeature:function(a){this.hover||(-1<OpenLayers.Util.indexOf(a.layer.selectedFeatures,
a)?this.toggleSelect()?this.unselect(a):this.multipleSelect()||this.unselectAll({except:a}):(this.multipleSelect()||this.unselectAll({except:a}),this.select(a)))},multipleSelect:function(){return this.multiple||this.handlers.feature.evt&&this.handlers.feature.evt[this.multipleKey]},toggleSelect:function(){return this.toggle||this.handlers.feature.evt&&this.handlers.feature.evt[this.toggleKey]},clickoutFeature:function(){!this.hover&&this.clickout&&this.unselectAll()},overFeature:function(a){var b=
a.layer;this.hover&&(this.highlightOnly?this.highlight(a):-1==OpenLayers.Util.indexOf(b.selectedFeatures,a)&&this.select(a))},outFeature:function(a){if(this.hover)if(this.highlightOnly){if(a._lastHighlighter==this.id)if(a._prevHighlighter&&a._prevHighlighter!=this.id){delete a._lastHighlighter;var b=this.map.getControl(a._prevHighlighter);b&&b.highlight(a)}else this.unhighlight(a)}else this.unselect(a)},highlight:function(a){var b=a.layer;!1!==this.events.triggerEvent("beforefeaturehighlighted",{feature:a})&&
(a._prevHighlighter=a._lastHighlighter,a._lastHighlighter=this.id,b.drawFeature(a,this.selectStyle||this.renderIntent),this.events.triggerEvent("featurehighlighted",{feature:a}))},unhighlight:function(a){var b=a.layer;void 0==a._prevHighlighter?delete a._lastHighlighter:(a._prevHighlighter!=this.id&&(a._lastHighlighter=a._prevHighlighter),delete a._prevHighlighter);b.drawFeature(a,a.style||a.layer.style||"default");this.events.triggerEvent("featureunhighlighted",{feature:a})},select:function(a){var b=
this.onBeforeSelect.call(this.scope,a),c=a.layer;!1!==b&&(b=c.events.triggerEvent("beforefeatureselected",{feature:a}),!1!==b&&(c.selectedFeatures.push(a),this.highlight(a),this.handlers.feature.lastFeature||(this.handlers.feature.lastFeature=c.selectedFeatures[0]),c.events.triggerEvent("featureselected",{feature:a}),this.onSelect.call(this.scope,a)))},unselect:function(a){var b=a.layer;this.unhighlight(a);OpenLayers.Util.removeItem(b.selectedFeatures,a);b.events.triggerEvent("featureunselected",
{feature:a});this.onUnselect.call(this.scope,a)},selectBox:function(a){if(a instanceof OpenLayers.Bounds){var b=this.map.getLonLatFromPixel({x:a.left,y:a.bottom}),a=this.map.getLonLatFromPixel({x:a.right,y:a.top}),b=new OpenLayers.Bounds(b.lon,b.lat,a.lon,a.lat);this.multipleSelect()||this.unselectAll();a=this.multiple;this.multiple=!0;var c=this.layers||[this.layer];this.events.triggerEvent("boxselectionstart",{layers:c});for(var d,e=0;e<c.length;++e){d=c[e];for(var f=0,g=d.features.length;f<g;++f){var h=
d.features[f];h.getVisibility()&&(null==this.geometryTypes||-1<OpenLayers.Util.indexOf(this.geometryTypes,h.geometry.CLASS_NAME))&&b.toGeometry().intersects(h.geometry)&&-1==OpenLayers.Util.indexOf(d.selectedFeatures,h)&&this.select(h)}}this.multiple=a;this.events.triggerEvent("boxselectionend",{layers:c})}},setMap:function(a){this.handlers.feature.setMap(a);this.box&&this.handlers.box.setMap(a);OpenLayers.Control.prototype.setMap.apply(this,arguments)},setLayer:function(a){var b=this.active;this.unselectAll();
this.deactivate();this.layers&&(this.layer.destroy(),this.layers=null);this.initLayer(a);this.handlers.feature.layer=this.layer;b&&this.activate()},CLASS_NAME:"OpenLayers.Control.SelectFeature"});
OpenLayers.Format.OWSCommon.v1_1_0=OpenLayers.Class(OpenLayers.Format.OWSCommon.v1,{namespaces:{ows:"http://www.opengis.net/ows/1.1",xlink:"http://www.w3.org/1999/xlink"},readers:{ows:OpenLayers.Util.applyDefaults({ExceptionReport:function(a,b){b.exceptionReport={version:a.getAttribute("version"),language:a.getAttribute("xml:lang"),exceptions:[]};this.readChildNodes(a,b.exceptionReport)},AllowedValues:function(a,b){b.allowedValues={};this.readChildNodes(a,b.allowedValues)},AnyValue:function(a,b){b.anyValue=
!0},DataType:function(a,b){b.dataType=this.getChildValue(a)},Range:function(a,b){b.range={};this.readChildNodes(a,b.range)},MinimumValue:function(a,b){b.minValue=this.getChildValue(a)},MaximumValue:function(a,b){b.maxValue=this.getChildValue(a)},Identifier:function(a,b){b.identifier=this.getChildValue(a)},SupportedCRS:function(a,b){b.supportedCRS=this.getChildValue(a)}},OpenLayers.Format.OWSCommon.v1.prototype.readers.ows)},writers:{ows:OpenLayers.Util.applyDefaults({Range:function(a){var b=this.createElementNSPlus("ows:Range",
{attributes:{"ows:rangeClosure":a.closure}});this.writeNode("ows:MinimumValue",a.minValue,b);this.writeNode("ows:MaximumValue",a.maxValue,b);return b},MinimumValue:function(a){return this.createElementNSPlus("ows:MinimumValue",{value:a})},MaximumValue:function(a){return this.createElementNSPlus("ows:MaximumValue",{value:a})},Value:function(a){return this.createElementNSPlus("ows:Value",{value:a})}},OpenLayers.Format.OWSCommon.v1.prototype.writers.ows)},CLASS_NAME:"OpenLayers.Format.OWSCommon.v1_1_0"});
OpenLayers.Control.Attribution=OpenLayers.Class(OpenLayers.Control,{separator:", ",template:"${layers}",destroy:function(){this.map.events.un({removelayer:this.updateAttribution,addlayer:this.updateAttribution,changelayer:this.updateAttribution,changebaselayer:this.updateAttribution,scope:this});OpenLayers.Control.prototype.destroy.apply(this,arguments)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.map.events.on({changebaselayer:this.updateAttribution,changelayer:this.updateAttribution,
addlayer:this.updateAttribution,removelayer:this.updateAttribution,scope:this});this.updateAttribution();return this.div},updateAttribution:function(){var a=[];if(this.map&&this.map.layers){for(var b=0,c=this.map.layers.length;b<c;b++){var d=this.map.layers[b];d.attribution&&d.getVisibility()&&-1===OpenLayers.Util.indexOf(a,d.attribution)&&a.push(d.attribution)}this.div.innerHTML=OpenLayers.String.format(this.template,{layers:a.join(this.separator)})}},CLASS_NAME:"OpenLayers.Control.Attribution"});
OpenLayers.Kinetic=OpenLayers.Class({threshold:0,deceleration:0.0035,nbPoints:100,delay:200,points:void 0,timerId:void 0,initialize:function(a){OpenLayers.Util.extend(this,a)},begin:function(){OpenLayers.Animation.stop(this.timerId);this.timerId=void 0;this.points=[]},update:function(a){this.points.unshift({xy:a,tick:(new Date).getTime()});this.points.length>this.nbPoints&&this.points.pop()},end:function(a){for(var b,c=(new Date).getTime(),d=0,e=this.points.length,f;d<e;d++){f=this.points[d];if(c-
f.tick>this.delay)break;b=f}if(b&&(d=(new Date).getTime()-b.tick,c=Math.sqrt(Math.pow(a.x-b.xy.x,2)+Math.pow(a.y-b.xy.y,2)),d=c/d,!(0==d||d<this.threshold)))return c=Math.asin((a.y-b.xy.y)/c),b.xy.x<=a.x&&(c=Math.PI-c),{speed:d,theta:c}},move:function(a,b){var c=a.speed,d=Math.cos(a.theta),e=-Math.sin(a.theta),f=(new Date).getTime(),g=0,h=0;this.timerId=OpenLayers.Animation.start(OpenLayers.Function.bind(function(){if(null!=this.timerId){var a=(new Date).getTime()-f,n=-this.deceleration*Math.pow(a,
2)/2+c*a,p=n*d,n=n*e,q,m;q=!1;0>=-this.deceleration*a+c&&(OpenLayers.Animation.stop(this.timerId),this.timerId=null,q=!0);a=p-g;m=n-h;g=p;h=n;b(a,m,q)}},this))},CLASS_NAME:"OpenLayers.Kinetic"});
OpenLayers.Handler.Box=OpenLayers.Class(OpenLayers.Handler,{dragHandler:null,boxDivClassName:"olHandlerBoxZoomBox",boxOffsets:null,initialize:function(a,b,c){OpenLayers.Handler.prototype.initialize.apply(this,arguments);this.dragHandler=new OpenLayers.Handler.Drag(this,{down:this.startBox,move:this.moveBox,out:this.removeBox,up:this.endBox},{keyMask:this.keyMask})},destroy:function(){OpenLayers.Handler.prototype.destroy.apply(this,arguments);this.dragHandler&&(this.dragHandler.destroy(),this.dragHandler=
null)},setMap:function(a){OpenLayers.Handler.prototype.setMap.apply(this,arguments);this.dragHandler&&this.dragHandler.setMap(a)},startBox:function(){this.callback("start",[]);this.zoomBox=OpenLayers.Util.createDiv("zoomBox",{x:-9999,y:-9999});this.zoomBox.className=this.boxDivClassName;this.zoomBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1;this.map.viewPortDiv.appendChild(this.zoomBox);OpenLayers.Element.addClass(this.map.viewPortDiv,"olDrawBox")},moveBox:function(a){var b=this.dragHandler.start.x,
c=this.dragHandler.start.y,d=Math.abs(b-a.x),e=Math.abs(c-a.y),f=this.getBoxOffsets();this.zoomBox.style.width=d+f.width+1+"px";this.zoomBox.style.height=e+f.height+1+"px";this.zoomBox.style.left=(a.x<b?b-d-f.left:b-f.left)+"px";this.zoomBox.style.top=(a.y<c?c-e-f.top:c-f.top)+"px"},endBox:function(a){var b;if(5<Math.abs(this.dragHandler.start.x-a.x)||5<Math.abs(this.dragHandler.start.y-a.y)){var c=this.dragHandler.start;b=Math.min(c.y,a.y);var d=Math.max(c.y,a.y),e=Math.min(c.x,a.x),a=Math.max(c.x,
a.x);b=new OpenLayers.Bounds(e,d,a,b)}else b=this.dragHandler.start.clone();this.removeBox();this.callback("done",[b])},removeBox:function(){this.map.viewPortDiv.removeChild(this.zoomBox);this.boxOffsets=this.zoomBox=null;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDrawBox")},activate:function(){return OpenLayers.Handler.prototype.activate.apply(this,arguments)?(this.dragHandler.activate(),!0):!1},deactivate:function(){return OpenLayers.Handler.prototype.deactivate.apply(this,arguments)?
(this.dragHandler.deactivate()&&this.zoomBox&&this.removeBox(),!0):!1},getBoxOffsets:function(){if(!this.boxOffsets){var a=document.createElement("div");a.style.position="absolute";a.style.border="1px solid black";a.style.width="3px";document.body.appendChild(a);var b=3==a.clientWidth;document.body.removeChild(a);var a=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-left-width")),c=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-right-width")),d=parseInt(OpenLayers.Element.getStyle(this.zoomBox,
"border-top-width")),e=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-bottom-width"));this.boxOffsets={left:a,right:c,top:d,bottom:e,width:!1===b?a+c:0,height:!1===b?d+e:0}}return this.boxOffsets},CLASS_NAME:"OpenLayers.Handler.Box"});
OpenLayers.Control.ZoomBox=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,out:!1,keyMask:null,alwaysZoom:!1,zoomOnClick:!0,draw:function(){this.handler=new OpenLayers.Handler.Box(this,{done:this.zoomBox},{keyMask:this.keyMask})},zoomBox:function(a){if(a instanceof OpenLayers.Bounds){var b,c=a.getCenterPixel();if(this.out){b=Math.min(this.map.size.h/(a.bottom-a.top),this.map.size.w/(a.right-a.left));var d=this.map.getExtent(),e=this.map.getLonLatFromPixel(c),f=e.lon-d.getWidth()/
2*b,a=e.lon+d.getWidth()/2*b,g=e.lat-d.getHeight()/2*b;b=e.lat+d.getHeight()/2*b;b=new OpenLayers.Bounds(f,g,a,b)}else f=this.map.getLonLatFromPixel({x:a.left,y:a.bottom}),a=this.map.getLonLatFromPixel({x:a.right,y:a.top}),b=new OpenLayers.Bounds(f.lon,f.lat,a.lon,a.lat);f=this.map.getZoom();g=this.map.getSize();a=g.w/2;g=g.h/2;b=this.map.getZoomForExtent(b);d=this.map.getResolution();e=this.map.getResolutionForZoom(b);d==e?this.map.setCenter(this.map.getLonLatFromPixel(c)):this.map.zoomTo(b,{x:(d*
c.x-e*a)/(d-e),y:(d*c.y-e*g)/(d-e)});f==this.map.getZoom()&&!0==this.alwaysZoom&&this.map.zoomTo(f+(this.out?-1:1))}else this.zoomOnClick&&(this.out?this.map.zoomTo(this.map.getZoom()-1,a):this.map.zoomTo(this.map.getZoom()+1,a))},CLASS_NAME:"OpenLayers.Control.ZoomBox"});
OpenLayers.Control.DragPan=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,panned:!1,interval:1,documentDrag:!1,kinetic:null,enableKinetic:!1,kineticInterval:10,draw:function(){if(this.enableKinetic){var a={interval:this.kineticInterval};"object"===typeof this.enableKinetic&&(a=OpenLayers.Util.extend(a,this.enableKinetic));this.kinetic=new OpenLayers.Kinetic(a)}this.handler=new OpenLayers.Handler.Drag(this,{move:this.panMap,done:this.panMapDone,down:this.panMapStart,up:this.panMapUp},
{interval:this.interval,documentDrag:this.documentDrag})},panMapUp:function(){},panMapStart:function(){this.kinetic&&this.kinetic.begin()},panMap:function(a){this.kinetic&&this.kinetic.update(a);this.panned=!0;this.map.pan(this.handler.last.x-a.x,this.handler.last.y-a.y,{dragging:!0,animate:!1})},panMapDone:function(a){if(this.panned){var b=null;this.kinetic&&(b=this.kinetic.end(a));this.map.pan(this.handler.last.x-a.x,this.handler.last.y-a.y,{dragging:!!b,animate:!1});if(b){var c=this;this.kinetic.move(b,
function(a,b,f){c.map.pan(a,b,{dragging:!f,animate:!1})})}this.panned=!1}},CLASS_NAME:"OpenLayers.Control.DragPan"});
OpenLayers.Control.Navigation=OpenLayers.Class(OpenLayers.Control,{dragPan:null,dragPanOptions:null,pinchZoom:null,pinchZoomOptions:null,documentDrag:!1,zoomBox:null,zoomBoxEnabled:!0,zoomWheelEnabled:!0,mouseWheelOptions:null,handleRightClicks:!1,zoomBoxKeyMask:OpenLayers.Handler.MOD_SHIFT,autoActivate:!0,initialize:function(a){this.handlers={};OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.deactivate();this.dragPan&&this.dragPan.destroy();this.dragPan=null;
this.zoomBox&&this.zoomBox.destroy();this.zoomBox=null;this.pinchZoom&&this.pinchZoom.destroy();this.pinchZoom=null;OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){this.dragPan.activate();this.zoomWheelEnabled&&this.handlers.wheel.activate();this.handlers.click.activate();this.zoomBoxEnabled&&this.zoomBox.activate();this.pinchZoom&&this.pinchZoom.activate();return OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){this.pinchZoom&&this.pinchZoom.deactivate();
this.zoomBox.deactivate();this.dragPan.deactivate();this.handlers.click.deactivate();this.handlers.wheel.deactivate();return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},draw:function(){this.handleRightClicks&&(this.map.viewPortDiv.oncontextmenu=OpenLayers.Function.False);this.handlers.click=new OpenLayers.Handler.Click(this,{click:this.defaultClick,dblclick:this.defaultDblClick,dblrightclick:this.defaultDblRightClick},{"double":!0,stopDouble:!0});this.dragPan=new OpenLayers.Control.DragPan(OpenLayers.Util.extend({map:this.map,
documentDrag:this.documentDrag},this.dragPanOptions));this.zoomBox=new OpenLayers.Control.ZoomBox({map:this.map,keyMask:this.zoomBoxKeyMask});this.dragPan.draw();this.zoomBox.draw();this.handlers.wheel=new OpenLayers.Handler.MouseWheel(this,{up:this.wheelUp,down:this.wheelDown},OpenLayers.Util.extend(this.map.fractionalZoom?{}:{cumulative:!1,interval:50,maxDelta:6},this.mouseWheelOptions));OpenLayers.Control.PinchZoom&&(this.pinchZoom=new OpenLayers.Control.PinchZoom(OpenLayers.Util.extend({map:this.map},
this.pinchZoomOptions)))},defaultClick:function(a){a.lastTouches&&2==a.lastTouches.length&&this.map.zoomOut()},defaultDblClick:function(a){this.map.zoomTo(this.map.zoom+1,a.xy)},defaultDblRightClick:function(a){this.map.zoomTo(this.map.zoom-1,a.xy)},wheelChange:function(a,b){this.map.fractionalZoom||(b=Math.round(b));var c=this.map.getZoom(),d;d=Math.max(c+b,0);d=Math.min(d,this.map.getNumZoomLevels());d!==c&&this.map.zoomTo(d,a.xy)},wheelUp:function(a,b){this.wheelChange(a,b||1)},wheelDown:function(a,
b){this.wheelChange(a,b||-1)},disableZoomBox:function(){this.zoomBoxEnabled=!1;this.zoomBox.deactivate()},enableZoomBox:function(){this.zoomBoxEnabled=!0;this.active&&this.zoomBox.activate()},disableZoomWheel:function(){this.zoomWheelEnabled=!1;this.handlers.wheel.deactivate()},enableZoomWheel:function(){this.zoomWheelEnabled=!0;this.active&&this.handlers.wheel.activate()},CLASS_NAME:"OpenLayers.Control.Navigation"});
OpenLayers.Layer.WMS=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{service:"WMS",version:"1.1.1",request:"GetMap",styles:"",format:"image/jpeg"},isBaseLayer:!0,encodeBBOX:!1,noMagic:!1,yx:{},initialize:function(a,b,c,d){var e=[],c=OpenLayers.Util.upperCaseObject(c);1.3<=parseFloat(c.VERSION)&&!c.EXCEPTIONS&&(c.EXCEPTIONS="INIMAGE");e.push(a,b,c,d);OpenLayers.Layer.Grid.prototype.initialize.apply(this,e);OpenLayers.Util.applyDefaults(this.params,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS));
if(!this.noMagic&&this.params.TRANSPARENT&&"true"==this.params.TRANSPARENT.toString().toLowerCase()){if(null==d||!d.isBaseLayer)this.isBaseLayer=!1;"image/jpeg"==this.params.FORMAT&&(this.params.FORMAT=OpenLayers.Util.alphaHack()?"image/gif":"image/png")}},clone:function(a){null==a&&(a=new OpenLayers.Layer.WMS(this.name,this.url,this.params,this.getOptions()));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a])},reverseAxisOrder:function(){var a=this.projection.getCode();return 1.3<=parseFloat(this.params.VERSION)&&
!!(this.yx[a]||OpenLayers.Projection.defaults[a]&&OpenLayers.Projection.defaults[a].yx)},getURL:function(a){var a=this.adjustBounds(a),b=this.getImageSize(),c={},d=this.reverseAxisOrder();c.BBOX=this.encodeBBOX?a.toBBOX(null,d):a.toArray(d);c.WIDTH=b.w;c.HEIGHT=b.h;return this.getFullRequestString(c)},mergeNewParams:function(a){a=[OpenLayers.Util.upperCaseObject(a)];return OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,a)},getFullRequestString:function(a,b){var c=this.map.getProjectionObject(),
c=this.projection&&this.projection.equals(c)?this.projection.getCode():c.getCode(),c="none"==c?null:c;1.3<=parseFloat(this.params.VERSION)?this.params.CRS=c:this.params.SRS=c;"boolean"==typeof this.params.TRANSPARENT&&(a.TRANSPARENT=this.params.TRANSPARENT?"TRUE":"FALSE");return OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,arguments)},CLASS_NAME:"OpenLayers.Layer.WMS"});
OpenLayers.Renderer.SVG=OpenLayers.Class(OpenLayers.Renderer.Elements,{xmlns:"http://www.w3.org/2000/svg",xlinkns:"http://www.w3.org/1999/xlink",MAX_PIXEL:15E3,translationParameters:null,symbolMetrics:null,initialize:function(a){this.supported()&&(OpenLayers.Renderer.Elements.prototype.initialize.apply(this,arguments),this.translationParameters={x:0,y:0},this.symbolMetrics={})},supported:function(){return document.implementation&&(document.implementation.hasFeature("org.w3c.svg","1.0")||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#SVG",
"1.1")||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"))},inValidRange:function(a,b,c){a+=c?0:this.translationParameters.x;b+=c?0:this.translationParameters.y;return a>=-this.MAX_PIXEL&&a<=this.MAX_PIXEL&&b>=-this.MAX_PIXEL&&b<=this.MAX_PIXEL},setExtent:function(a,b){var c=OpenLayers.Renderer.Elements.prototype.setExtent.apply(this,arguments),d=this.getResolution(),e=-a.left/d,d=a.top/d;if(b)return this.left=e,this.top=d,this.rendererRoot.setAttributeNS(null,
"viewBox","0 0 "+this.size.w+" "+this.size.h),this.translate(this.xOffset,0),!0;(e=this.translate(e-this.left+this.xOffset,d-this.top))||this.setExtent(a,!0);return c&&e},translate:function(a,b){if(this.inValidRange(a,b,!0)){var c="";if(a||b)c="translate("+a+","+b+")";this.root.setAttributeNS(null,"transform",c);this.translationParameters={x:a,y:b};return!0}return!1},setSize:function(a){OpenLayers.Renderer.prototype.setSize.apply(this,arguments);this.rendererRoot.setAttributeNS(null,"width",this.size.w);
this.rendererRoot.setAttributeNS(null,"height",this.size.h)},getNodeType:function(a,b){var c=null;switch(a.CLASS_NAME){case "OpenLayers.Geometry.Point":c=b.externalGraphic?"image":this.isComplexSymbol(b.graphicName)?"svg":"circle";break;case "OpenLayers.Geometry.Rectangle":c="rect";break;case "OpenLayers.Geometry.LineString":c="polyline";break;case "OpenLayers.Geometry.LinearRing":c="polygon";break;case "OpenLayers.Geometry.Polygon":case "OpenLayers.Geometry.Curve":c="path"}return c},setStyle:function(a,
b,c){var b=b||a._style,c=c||a._options,d=b.title||b.graphicTitle;if(d){a.setAttributeNS(null,"title",d);var e=a.getElementsByTagName("title");0<e.length?e[0].firstChild.textContent=d:(e=this.nodeFactory(null,"title"),e.textContent=d,a.appendChild(e))}var e=parseFloat(a.getAttributeNS(null,"r")),d=1,f;if("OpenLayers.Geometry.Point"==a._geometryClass&&e){a.style.visibility="";if(!1===b.graphic)a.style.visibility="hidden";else if(b.externalGraphic){f=this.getPosition(a);b.graphicWidth&&b.graphicHeight&&
a.setAttributeNS(null,"preserveAspectRatio","none");var e=b.graphicWidth||b.graphicHeight,g=b.graphicHeight||b.graphicWidth,e=e?e:2*b.pointRadius,g=g?g:2*b.pointRadius,h=void 0!=b.graphicYOffset?b.graphicYOffset:-(0.5*g),j=b.graphicOpacity||b.fillOpacity;a.setAttributeNS(null,"x",(f.x+(void 0!=b.graphicXOffset?b.graphicXOffset:-(0.5*e))).toFixed());a.setAttributeNS(null,"y",(f.y+h).toFixed());a.setAttributeNS(null,"width",e);a.setAttributeNS(null,"height",g);a.setAttributeNS(this.xlinkns,"xlink:href",
b.externalGraphic);a.setAttributeNS(null,"style","opacity: "+j);a.onclick=OpenLayers.Event.preventDefault}else if(this.isComplexSymbol(b.graphicName)){var e=3*b.pointRadius,g=2*e,n=this.importSymbol(b.graphicName);f=this.getPosition(a);d=3*this.symbolMetrics[n.id][0]/g;h=a.parentNode;j=a.nextSibling;h&&h.removeChild(a);a.firstChild&&a.removeChild(a.firstChild);a.appendChild(n.firstChild.cloneNode(!0));a.setAttributeNS(null,"viewBox",n.getAttributeNS(null,"viewBox"));a.setAttributeNS(null,"width",
g);a.setAttributeNS(null,"height",g);a.setAttributeNS(null,"x",f.x-e);a.setAttributeNS(null,"y",f.y-e);j?h.insertBefore(a,j):h&&h.appendChild(a)}else a.setAttributeNS(null,"r",b.pointRadius);e=b.rotation;if((void 0!==e||void 0!==a._rotation)&&f)a._rotation=e,e|=0,"svg"!==a.nodeName?a.setAttributeNS(null,"transform","rotate("+e+" "+f.x+" "+f.y+")"):(f=this.symbolMetrics[n.id],a.firstChild.setAttributeNS(null,"transform","rotate("+e+" "+f[1]+" "+f[2]+")"))}c.isFilled?(a.setAttributeNS(null,"fill",b.fillColor),
a.setAttributeNS(null,"fill-opacity",b.fillOpacity)):a.setAttributeNS(null,"fill","none");c.isStroked?(a.setAttributeNS(null,"stroke",b.strokeColor),a.setAttributeNS(null,"stroke-opacity",b.strokeOpacity),a.setAttributeNS(null,"stroke-width",b.strokeWidth*d),a.setAttributeNS(null,"stroke-linecap",b.strokeLinecap||"round"),a.setAttributeNS(null,"stroke-linejoin","round"),b.strokeDashstyle&&a.setAttributeNS(null,"stroke-dasharray",this.dashStyle(b,d))):a.setAttributeNS(null,"stroke","none");b.pointerEvents&&
a.setAttributeNS(null,"pointer-events",b.pointerEvents);null!=b.cursor&&a.setAttributeNS(null,"cursor",b.cursor);return a},dashStyle:function(a,b){var c=a.strokeWidth*b,d=a.strokeDashstyle;switch(d){case "solid":return"none";case "dot":return[1,4*c].join();case "dash":return[4*c,4*c].join();case "dashdot":return[4*c,4*c,1,4*c].join();case "longdash":return[8*c,4*c].join();case "longdashdot":return[8*c,4*c,1,4*c].join();default:return OpenLayers.String.trim(d).replace(/\s+/g,",")}},createNode:function(a,
b){var c=document.createElementNS(this.xmlns,a);b&&c.setAttributeNS(null,"id",b);return c},nodeTypeCompare:function(a,b){return b==a.nodeName},createRenderRoot:function(){var a=this.nodeFactory(this.container.id+"_svgRoot","svg");a.style.display="block";return a},createRoot:function(a){return this.nodeFactory(this.container.id+a,"g")},createDefs:function(){var a=this.nodeFactory(this.container.id+"_defs","defs");this.rendererRoot.appendChild(a);return a},drawPoint:function(a,b){return this.drawCircle(a,
b,1)},drawCircle:function(a,b,c){var d=this.getResolution(),e=(b.x-this.featureDx)/d+this.left,b=this.top-b.y/d;return this.inValidRange(e,b)?(a.setAttributeNS(null,"cx",e),a.setAttributeNS(null,"cy",b),a.setAttributeNS(null,"r",c),a):!1},drawLineString:function(a,b){var c=this.getComponentsString(b.components);return c.path?(a.setAttributeNS(null,"points",c.path),c.complete?a:null):!1},drawLinearRing:function(a,b){var c=this.getComponentsString(b.components);return c.path?(a.setAttributeNS(null,
"points",c.path),c.complete?a:null):!1},drawPolygon:function(a,b){for(var c="",d=!0,e=!0,f,g,h=0,j=b.components.length;h<j;h++)c+=" M",f=this.getComponentsString(b.components[h].components," "),(g=f.path)?(c+=" "+g,e=f.complete&&e):d=!1;return d?(a.setAttributeNS(null,"d",c+" z"),a.setAttributeNS(null,"fill-rule","evenodd"),e?a:null):!1},drawRectangle:function(a,b){var c=this.getResolution(),d=(b.x-this.featureDx)/c+this.left,e=this.top-b.y/c;return this.inValidRange(d,e)?(a.setAttributeNS(null,"x",
d),a.setAttributeNS(null,"y",e),a.setAttributeNS(null,"width",b.width/c),a.setAttributeNS(null,"height",b.height/c),a):!1},drawText:function(a,b,c){var d=!!b.labelOutlineWidth;if(d){var e=OpenLayers.Util.extend({},b);e.fontColor=e.labelOutlineColor;e.fontStrokeColor=e.labelOutlineColor;e.fontStrokeWidth=b.labelOutlineWidth;b.labelOutlineOpacity&&(e.fontOpacity=b.labelOutlineOpacity);delete e.labelOutlineWidth;this.drawText(a,e,c)}var f=this.getResolution(),e=(c.x-this.featureDx)/f+this.left,g=c.y/
f-this.top,d=d?this.LABEL_OUTLINE_SUFFIX:this.LABEL_ID_SUFFIX,f=this.nodeFactory(a+d,"text");f.setAttributeNS(null,"x",e);f.setAttributeNS(null,"y",-g);b.fontColor&&f.setAttributeNS(null,"fill",b.fontColor);b.fontStrokeColor&&f.setAttributeNS(null,"stroke",b.fontStrokeColor);b.fontStrokeWidth&&f.setAttributeNS(null,"stroke-width",b.fontStrokeWidth);b.fontOpacity&&f.setAttributeNS(null,"opacity",b.fontOpacity);b.fontFamily&&f.setAttributeNS(null,"font-family",b.fontFamily);b.fontSize&&f.setAttributeNS(null,
"font-size",b.fontSize);b.fontWeight&&f.setAttributeNS(null,"font-weight",b.fontWeight);b.fontStyle&&f.setAttributeNS(null,"font-style",b.fontStyle);!0===b.labelSelect?(f.setAttributeNS(null,"pointer-events","visible"),f._featureId=a):f.setAttributeNS(null,"pointer-events","none");g=b.labelAlign||OpenLayers.Renderer.defaultSymbolizer.labelAlign;f.setAttributeNS(null,"text-anchor",OpenLayers.Renderer.SVG.LABEL_ALIGN[g[0]]||"middle");!0===OpenLayers.IS_GECKO&&f.setAttributeNS(null,"dominant-baseline",
OpenLayers.Renderer.SVG.LABEL_ALIGN[g[1]]||"central");for(var h=b.label.split("\n"),j=h.length;f.childNodes.length>j;)f.removeChild(f.lastChild);for(var n=0;n<j;n++){var p=this.nodeFactory(a+d+"_tspan_"+n,"tspan");!0===b.labelSelect&&(p._featureId=a,p._geometry=c,p._geometryClass=c.CLASS_NAME);!1===OpenLayers.IS_GECKO&&p.setAttributeNS(null,"baseline-shift",OpenLayers.Renderer.SVG.LABEL_VSHIFT[g[1]]||"-35%");p.setAttribute("x",e);if(0==n){var q=OpenLayers.Renderer.SVG.LABEL_VFACTOR[g[1]];null==q&&
(q=-0.5);p.setAttribute("dy",q*(j-1)+"em")}else p.setAttribute("dy","1em");p.textContent=""===h[n]?" ":h[n];p.parentNode||f.appendChild(p)}f.parentNode||this.textRoot.appendChild(f)},getComponentsString:function(a,b){for(var c=[],d=!0,e=a.length,f=[],g,h=0;h<e;h++)g=a[h],c.push(g),(g=this.getShortString(g))?f.push(g):(0<h&&this.getShortString(a[h-1])&&f.push(this.clipLine(a[h],a[h-1])),h<e-1&&this.getShortString(a[h+1])&&f.push(this.clipLine(a[h],a[h+1])),d=!1);return{path:f.join(b||","),complete:d}},
clipLine:function(a,b){if(b.equals(a))return"";var c=this.getResolution(),d=this.MAX_PIXEL-this.translationParameters.x,e=this.MAX_PIXEL-this.translationParameters.y,f=(b.x-this.featureDx)/c+this.left,g=this.top-b.y/c,h=(a.x-this.featureDx)/c+this.left,c=this.top-a.y/c,j;if(h<-d||h>d)j=(c-g)/(h-f),h=0>h?-d:d,c=g+(h-f)*j;if(c<-e||c>e)j=(h-f)/(c-g),c=0>c?-e:e,h=f+(c-g)*j;return h+","+c},getShortString:function(a){var b=this.getResolution(),c=(a.x-this.featureDx)/b+this.left,a=this.top-a.y/b;return this.inValidRange(c,
a)?c+","+a:!1},getPosition:function(a){return{x:parseFloat(a.getAttributeNS(null,"cx")),y:parseFloat(a.getAttributeNS(null,"cy"))}},importSymbol:function(a){this.defs||(this.defs=this.createDefs());var b=this.container.id+"-"+a,c=document.getElementById(b);if(null!=c)return c;var d=OpenLayers.Renderer.symbol[a];if(!d)throw Error(a+" is not a valid symbol name");var a=this.nodeFactory(b,"symbol"),e=this.nodeFactory(null,"polygon");a.appendChild(e);for(var c=new OpenLayers.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,
0,0),f=[],g,h,j=0;j<d.length;j+=2)g=d[j],h=d[j+1],c.left=Math.min(c.left,g),c.bottom=Math.min(c.bottom,h),c.right=Math.max(c.right,g),c.top=Math.max(c.top,h),f.push(g,",",h);e.setAttributeNS(null,"points",f.join(" "));d=c.getWidth();e=c.getHeight();a.setAttributeNS(null,"viewBox",[c.left-d,c.bottom-e,3*d,3*e].join(" "));this.symbolMetrics[b]=[Math.max(d,e),c.getCenterLonLat().lon,c.getCenterLonLat().lat];this.defs.appendChild(a);return a},getFeatureIdFromEvent:function(a){var b=OpenLayers.Renderer.Elements.prototype.getFeatureIdFromEvent.apply(this,
arguments);b||(b=a.target,b=b.parentNode&&b!=this.rendererRoot?b.parentNode._featureId:void 0);return b},CLASS_NAME:"OpenLayers.Renderer.SVG"});OpenLayers.Renderer.SVG.LABEL_ALIGN={l:"start",r:"end",b:"bottom",t:"hanging"};OpenLayers.Renderer.SVG.LABEL_VSHIFT={t:"-70%",b:"0"};OpenLayers.Renderer.SVG.LABEL_VFACTOR={t:0,b:-1};OpenLayers.Renderer.SVG.preventDefault=function(a){OpenLayers.Event.preventDefault(a)};
OpenLayers.Control.ScaleLine=OpenLayers.Class(OpenLayers.Control,{maxWidth:100,topOutUnits:"km",topInUnits:"m",bottomOutUnits:"mi",bottomInUnits:"ft",eTop:null,eBottom:null,geodesic:!1,draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.eTop||(this.eTop=document.createElement("div"),this.eTop.className=this.displayClass+"Top",this.div.appendChild(this.eTop),this.eTop.style.visibility=""==this.topOutUnits||""==this.topInUnits?"hidden":"visible",this.eBottom=document.createElement("div"),
this.eBottom.className=this.displayClass+"Bottom",this.div.appendChild(this.eBottom),this.eBottom.style.visibility=""==this.bottomOutUnits||""==this.bottomInUnits?"hidden":"visible");this.map.events.register("moveend",this,this.update);this.update();return this.div},getBarLen:function(a){var b=parseInt(Math.log(a)/Math.log(10)),b=Math.pow(10,b),a=parseInt(a/b);return(5<a?5:2<a?2:1)*b},update:function(){var a=this.map.getResolution();if(a){var b=this.map.getUnits(),c=OpenLayers.INCHES_PER_UNIT,d=this.maxWidth*
a*c[b],e=1;!0===this.geodesic&&(e=(this.map.getGeodesicPixelSize().w||1E-6)*this.maxWidth/(d/c.km),d*=e);var f,g;1E5<d?(f=this.topOutUnits,g=this.bottomOutUnits):(f=this.topInUnits,g=this.bottomInUnits);var h=d/c[f],j=d/c[g],d=this.getBarLen(h),n=this.getBarLen(j),h=d/c[b]*c[f],j=n/c[b]*c[g],b=h/a/e,a=j/a/e;"visible"==this.eBottom.style.visibility&&(this.eBottom.style.width=Math.round(a)+"px",this.eBottom.innerHTML=n+" "+g);"visible"==this.eTop.style.visibility&&(this.eTop.style.width=Math.round(b)+
"px",this.eTop.innerHTML=d+" "+f)}},CLASS_NAME:"OpenLayers.Control.ScaleLine"});
OpenLayers.Format.WKT=OpenLayers.Class(OpenLayers.Format,{initialize:function(a){this.regExes={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/};OpenLayers.Format.prototype.initialize.apply(this,[a])},read:function(a){var b,c,a=a.replace(/[\n\r]/g," ");if(c=this.regExes.typeStr.exec(a))if(a=c[1].toLowerCase(),c=c[2],this.parse[a]&&(b=this.parse[a].apply(this,[c])),this.internalProjection&&this.externalProjection)if(b&&
"OpenLayers.Feature.Vector"==b.CLASS_NAME)b.geometry.transform(this.externalProjection,this.internalProjection);else if(b&&"geometrycollection"!=a&&"object"==typeof b){a=0;for(c=b.length;a<c;a++)b[a].geometry.transform(this.externalProjection,this.internalProjection)}return b},write:function(a){var b,c;a.constructor==Array?c=!0:(a=[a],c=!1);var d=[];c&&d.push("GEOMETRYCOLLECTION(");for(var e=0,f=a.length;e<f;++e)c&&0<e&&d.push(","),b=a[e].geometry,d.push(this.extractGeometry(b));c&&d.push(")");return d.join("")},
extractGeometry:function(a){var b=a.CLASS_NAME.split(".")[2].toLowerCase();if(!this.extract[b])return null;this.internalProjection&&this.externalProjection&&(a=a.clone(),a.transform(this.internalProjection,this.externalProjection));return("collection"==b?"GEOMETRYCOLLECTION":b.toUpperCase())+"("+this.extract[b].apply(this,[a])+")"},extract:{point:function(a){return a.x+" "+a.y},multipoint:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push("("+this.extract.point.apply(this,[a.components[c]])+
")");return b.join(",")},linestring:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push(this.extract.point.apply(this,[a.components[c]]));return b.join(",")},multilinestring:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push("("+this.extract.linestring.apply(this,[a.components[c]])+")");return b.join(",")},polygon:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push("("+this.extract.linestring.apply(this,[a.components[c]])+")");return b.join(",")},multipolygon:function(a){for(var b=
[],c=0,d=a.components.length;c<d;++c)b.push("("+this.extract.polygon.apply(this,[a.components[c]])+")");return b.join(",")},collection:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push(this.extractGeometry.apply(this,[a.components[c]]));return b.join(",")}},parse:{point:function(a){a=OpenLayers.String.trim(a).split(this.regExes.spaces);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(a[0],a[1]))},multipoint:function(a){for(var b=OpenLayers.String.trim(a).split(","),
c=[],d=0,e=b.length;d<e;++d)a=b[d].replace(this.regExes.trimParens,"$1"),c.push(this.parse.point.apply(this,[a]).geometry);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiPoint(c))},linestring:function(a){for(var a=OpenLayers.String.trim(a).split(","),b=[],c=0,d=a.length;c<d;++c)b.push(this.parse.point.apply(this,[a[c]]).geometry);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(b))},multilinestring:function(a){for(var b=OpenLayers.String.trim(a).split(this.regExes.parenComma),
c=[],d=0,e=b.length;d<e;++d)a=b[d].replace(this.regExes.trimParens,"$1"),c.push(this.parse.linestring.apply(this,[a]).geometry);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiLineString(c))},polygon:function(a){for(var b,a=OpenLayers.String.trim(a).split(this.regExes.parenComma),c=[],d=0,e=a.length;d<e;++d)b=a[d].replace(this.regExes.trimParens,"$1"),b=this.parse.linestring.apply(this,[b]).geometry,b=new OpenLayers.Geometry.LinearRing(b.components),c.push(b);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon(c))},
multipolygon:function(a){for(var b=OpenLayers.String.trim(a).split(this.regExes.doubleParenComma),c=[],d=0,e=b.length;d<e;++d)a=b[d].replace(this.regExes.trimParens,"$1"),c.push(this.parse.polygon.apply(this,[a]).geometry);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiPolygon(c))},geometrycollection:function(a){for(var a=a.replace(/,\s*([A-Za-z])/g,"|$1"),a=OpenLayers.String.trim(a).split("|"),b=[],c=0,d=a.length;c<d;++c)b.push(OpenLayers.Format.WKT.prototype.read.apply(this,[a[c]]));
return b}},CLASS_NAME:"OpenLayers.Format.WKT"});
OpenLayers.Format.GeoJSON=OpenLayers.Class(OpenLayers.Format.JSON,{ignoreExtraDims:!1,read:function(a,b,c){var b=b?b:"FeatureCollection",d=null,e=null;if(e="string"==typeof a?OpenLayers.Format.JSON.prototype.read.apply(this,[a,c]):a)if("string"!=typeof e.type)OpenLayers.Console.error("Bad GeoJSON - no type: "+a);else{if(this.isValidType(e,b))switch(b){case "Geometry":try{d=this.parseGeometry(e)}catch(f){OpenLayers.Console.error(f)}break;case "Feature":try{d=this.parseFeature(e),d.type="Feature"}catch(g){OpenLayers.Console.error(g)}break;
case "FeatureCollection":switch(d=[],e.type){case "Feature":try{d.push(this.parseFeature(e))}catch(h){d=null,OpenLayers.Console.error(h)}break;case "FeatureCollection":a=0;for(b=e.features.length;a<b;++a)try{d.push(this.parseFeature(e.features[a]))}catch(j){d=null,OpenLayers.Console.error(j)}break;default:try{var n=this.parseGeometry(e);d.push(new OpenLayers.Feature.Vector(n))}catch(p){d=null,OpenLayers.Console.error(p)}}}}else OpenLayers.Console.error("Bad JSON: "+a);return d},isValidType:function(a,
b){var c=!1;switch(b){case "Geometry":-1==OpenLayers.Util.indexOf("Point MultiPoint LineString MultiLineString Polygon MultiPolygon Box GeometryCollection".split(" "),a.type)?OpenLayers.Console.error("Unsupported geometry type: "+a.type):c=!0;break;case "FeatureCollection":c=!0;break;default:a.type==b?c=!0:OpenLayers.Console.error("Cannot convert types from "+a.type+" to "+b)}return c},parseFeature:function(a){var b,c,d;c=a.properties?a.properties:{};d=a.geometry&&a.geometry.bbox||a.bbox;try{b=this.parseGeometry(a.geometry)}catch(e){throw e;
}b=new OpenLayers.Feature.Vector(b,c);d&&(b.bounds=OpenLayers.Bounds.fromArray(d));a.id&&(b.fid=a.id);return b},parseGeometry:function(a){if(null==a)return null;var b,c=!1;if("GeometryCollection"==a.type){if(!OpenLayers.Util.isArray(a.geometries))throw"GeometryCollection must have geometries array: "+a;b=a.geometries.length;for(var c=Array(b),d=0;d<b;++d)c[d]=this.parseGeometry.apply(this,[a.geometries[d]]);b=new OpenLayers.Geometry.Collection(c);c=!0}else{if(!OpenLayers.Util.isArray(a.coordinates))throw"Geometry must have coordinates array: "+
a;if(!this.parseCoords[a.type.toLowerCase()])throw"Unsupported geometry type: "+a.type;try{b=this.parseCoords[a.type.toLowerCase()].apply(this,[a.coordinates])}catch(e){throw e;}}this.internalProjection&&(this.externalProjection&&!c)&&b.transform(this.externalProjection,this.internalProjection);return b},parseCoords:{point:function(a){if(!1==this.ignoreExtraDims&&2!=a.length)throw"Only 2D points are supported: "+a;return new OpenLayers.Geometry.Point(a[0],a[1])},multipoint:function(a){for(var b=[],
c=null,d=0,e=a.length;d<e;++d){try{c=this.parseCoords.point.apply(this,[a[d]])}catch(f){throw f;}b.push(c)}return new OpenLayers.Geometry.MultiPoint(b)},linestring:function(a){for(var b=[],c=null,d=0,e=a.length;d<e;++d){try{c=this.parseCoords.point.apply(this,[a[d]])}catch(f){throw f;}b.push(c)}return new OpenLayers.Geometry.LineString(b)},multilinestring:function(a){for(var b=[],c=null,d=0,e=a.length;d<e;++d){try{c=this.parseCoords.linestring.apply(this,[a[d]])}catch(f){throw f;}b.push(c)}return new OpenLayers.Geometry.MultiLineString(b)},
polygon:function(a){for(var b=[],c,d,e=0,f=a.length;e<f;++e){try{d=this.parseCoords.linestring.apply(this,[a[e]])}catch(g){throw g;}c=new OpenLayers.Geometry.LinearRing(d.components);b.push(c)}return new OpenLayers.Geometry.Polygon(b)},multipolygon:function(a){for(var b=[],c=null,d=0,e=a.length;d<e;++d){try{c=this.parseCoords.polygon.apply(this,[a[d]])}catch(f){throw f;}b.push(c)}return new OpenLayers.Geometry.MultiPolygon(b)},box:function(a){if(2!=a.length)throw"GeoJSON box coordinates must have 2 elements";
return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(a[0][0],a[0][1]),new OpenLayers.Geometry.Point(a[1][0],a[0][1]),new OpenLayers.Geometry.Point(a[1][0],a[1][1]),new OpenLayers.Geometry.Point(a[0][0],a[1][1]),new OpenLayers.Geometry.Point(a[0][0],a[0][1])])])}},write:function(a,b){var c={type:null};if(OpenLayers.Util.isArray(a)){c.type="FeatureCollection";var d=a.length;c.features=Array(d);for(var e=0;e<d;++e){var f=a[e];if(!f instanceof OpenLayers.Feature.Vector)throw"FeatureCollection only supports collections of features: "+
f;c.features[e]=this.extract.feature.apply(this,[f])}}else 0==a.CLASS_NAME.indexOf("OpenLayers.Geometry")?c=this.extract.geometry.apply(this,[a]):a instanceof OpenLayers.Feature.Vector&&(c=this.extract.feature.apply(this,[a]),a.layer&&a.layer.projection&&(c.crs=this.createCRSObject(a)));return OpenLayers.Format.JSON.prototype.write.apply(this,[c,b])},createCRSObject:function(a){var a=a.layer.projection.toString(),b={};a.match(/epsg:/i)&&(a=parseInt(a.substring(a.indexOf(":")+1)),b=4326==a?{type:"name",
properties:{name:"urn:ogc:def:crs:OGC:1.3:CRS84"}}:{type:"name",properties:{name:"EPSG:"+a}});return b},extract:{feature:function(a){var b=this.extract.geometry.apply(this,[a.geometry]),b={type:"Feature",properties:a.attributes,geometry:b};null!=a.fid&&(b.id=a.fid);return b},geometry:function(a){if(null==a)return null;this.internalProjection&&this.externalProjection&&(a=a.clone(),a.transform(this.internalProjection,this.externalProjection));var b=a.CLASS_NAME.split(".")[2],a=this.extract[b.toLowerCase()].apply(this,
[a]);return"Collection"==b?{type:"GeometryCollection",geometries:a}:{type:b,coordinates:a}},point:function(a){return[a.x,a.y]},multipoint:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push(this.extract.point.apply(this,[a.components[c]]));return b},linestring:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push(this.extract.point.apply(this,[a.components[c]]));return b},multilinestring:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push(this.extract.linestring.apply(this,
[a.components[c]]));return b},polygon:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push(this.extract.linestring.apply(this,[a.components[c]]));return b},multipolygon:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push(this.extract.polygon.apply(this,[a.components[c]]));return b},collection:function(a){for(var b=a.components.length,c=Array(b),d=0;d<b;++d)c[d]=this.extract.geometry.apply(this,[a.components[d]]);return c}},CLASS_NAME:"OpenLayers.Format.GeoJSON"});
OpenLayers.Protocol.WFS.v1=OpenLayers.Class(OpenLayers.Protocol,{version:null,srsName:"EPSG:4326",featureType:null,featureNS:null,geometryName:"the_geom",schema:null,featurePrefix:"feature",formatOptions:null,readFormat:null,readOptions:null,initialize:function(a){OpenLayers.Protocol.prototype.initialize.apply(this,[a]);a.format||(this.format=OpenLayers.Format.WFST(OpenLayers.Util.extend({version:this.version,featureType:this.featureType,featureNS:this.featureNS,featurePrefix:this.featurePrefix,geometryName:this.geometryName,
srsName:this.srsName,schema:this.schema},this.formatOptions)));!a.geometryName&&1<parseFloat(this.format.version)&&this.setGeometryName(null)},destroy:function(){this.options&&!this.options.format&&this.format.destroy();this.format=null;OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(a){OpenLayers.Protocol.prototype.read.apply(this,arguments);a=OpenLayers.Util.extend({},a);OpenLayers.Util.applyDefaults(a,this.options||{});var b=new OpenLayers.Protocol.Response({requestType:"read"}),
c=OpenLayers.Format.XML.prototype.write.apply(this.format,[this.format.writeNode("wfs:GetFeature",a)]);b.priv=OpenLayers.Request.POST({url:a.url,callback:this.createCallback(this.handleRead,b,a),params:a.params,headers:a.headers,data:c});return b},setFeatureType:function(a){this.featureType=a;this.format.featureType=a},setGeometryName:function(a){this.geometryName=a;this.format.geometryName=a},handleRead:function(a,b){b=OpenLayers.Util.extend({},b);OpenLayers.Util.applyDefaults(b,this.options);if(b.callback){var c=
a.priv;200<=c.status&&300>c.status?(c=this.parseResponse(c,b.readOptions))&&!1!==c.success?(b.readOptions&&"object"==b.readOptions.output?OpenLayers.Util.extend(a,c):a.features=c,a.code=OpenLayers.Protocol.Response.SUCCESS):(a.code=OpenLayers.Protocol.Response.FAILURE,a.error=c):a.code=OpenLayers.Protocol.Response.FAILURE;b.callback.call(b.scope,a)}},parseResponse:function(a,b){var c=a.responseXML;if(!c||!c.documentElement)c=a.responseText;if(!c||0>=c.length)return null;c=null!==this.readFormat?this.readFormat.read(c):
this.format.read(c,b);if(!this.featureNS){var d=this.readFormat||this.format;this.featureNS=d.featureNS;d.autoConfig=!1;this.geometryName||this.setGeometryName(d.geometryName)}return c},commit:function(a,b){b=OpenLayers.Util.extend({},b);OpenLayers.Util.applyDefaults(b,this.options);var c=new OpenLayers.Protocol.Response({requestType:"commit",reqFeatures:a});c.priv=OpenLayers.Request.POST({url:b.url,headers:b.headers,data:this.format.write(a,b),callback:this.createCallback(this.handleCommit,c,b)});
return c},handleCommit:function(a,b){if(b.callback){var c=a.priv,d=c.responseXML;if(!d||!d.documentElement)d=c.responseText;c=this.format.read(d)||{};a.insertIds=c.insertIds||[];c.success?a.code=OpenLayers.Protocol.Response.SUCCESS:(a.code=OpenLayers.Protocol.Response.FAILURE,a.error=c);b.callback.call(b.scope,a)}},filterDelete:function(a,b){b=OpenLayers.Util.extend({},b);OpenLayers.Util.applyDefaults(b,this.options);new OpenLayers.Protocol.Response({requestType:"commit"});var c=this.format.createElementNSPlus("wfs:Transaction",
{attributes:{service:"WFS",version:this.version}}),d=this.format.createElementNSPlus("wfs:Delete",{attributes:{typeName:(b.featureNS?this.featurePrefix+":":"")+b.featureType}});b.featureNS&&d.setAttribute("xmlns:"+this.featurePrefix,b.featureNS);var e=this.format.writeNode("ogc:Filter",a);d.appendChild(e);c.appendChild(d);c=OpenLayers.Format.XML.prototype.write.apply(this.format,[c]);return OpenLayers.Request.POST({url:this.url,callback:b.callback||function(){},data:c})},abort:function(a){a&&a.priv.abort()},
CLASS_NAME:"OpenLayers.Protocol.WFS.v1"});
OpenLayers.Format.WMTSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",yx:{"urn:ogc:def:crs:EPSG::4326":!0},createLayer:function(a,b){if(!("layer"in b))throw Error("Missing property 'layer' in configuration.");for(var c=a.contents,d,e=0,f=c.layers.length;e<f;++e)if(c.layers[e].identifier===b.layer){d=c.layers[e];break}if(!d)throw Error("Layer not found");var g=b.format;!g&&(d.formats&&d.formats.length)&&(g=d.formats[0]);var h;b.matrixSet?h=c.tileMatrixSets[b.matrixSet]:
1<=d.tileMatrixSetLinks.length&&(h=c.tileMatrixSets[d.tileMatrixSetLinks[0].tileMatrixSet]);if(!h)throw Error("matrixSet not found");for(var j,e=0,f=d.styles.length;e<f&&!(j=d.styles[e],j.isDefault);++e);c=b.requestEncoding;if(!c&&(c="KVP",a.operationsMetadata.GetTile.dcp.http)){var n=a.operationsMetadata.GetTile.dcp.http;if(n.get[0].constraints&&(n=n.get[0].constraints.GetEncoding.allowedValues,!n.KVP&&(n.REST||n.RESTful)))c="REST"}var n=[],p=b.params||{};delete b.params;for(var q=0,m=d.dimensions.length;q<
m;q++){var r=d.dimensions[q];n.push(r.identifier);p.hasOwnProperty(r.identifier)||(p[r.identifier]=r["default"])}var q=b.projection||h.supportedCRS.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"),m=b.units||("EPSG:4326"===q?"degrees":"m"),r=[],s;for(s in h.matrixIds)h.matrixIds.hasOwnProperty(s)&&r.push(2.8E-4*h.matrixIds[s].scaleDenominator/OpenLayers.METERS_PER_INCH/OpenLayers.INCHES_PER_UNIT[m]);if("REST"===c&&d.resourceUrls){s=[];for(var f=0,t=d.resourceUrls.length;f<t;++f)e=d.resourceUrls[f],
e.format===g&&"tile"===e.resourceType&&s.push(e.template)}else{t=a.operationsMetadata.GetTile.dcp.http.get;s=[];for(var v,e=0,f=t.length;e<f;e++)v=t[e].constraints,(!v||v&&v.GetEncoding.allowedValues[c])&&s.push(t[e].url)}return new OpenLayers.Layer.WMTS(OpenLayers.Util.applyDefaults(b,{url:s,requestEncoding:c,name:d.title,style:j.identifier,format:g,matrixIds:h.matrixIds,matrixSet:h.identifier,projection:q,units:m,resolutions:!1===b.isBaseLayer?void 0:r,serverResolutions:r,tileFullExtent:h.bounds,
dimensions:n,params:p}))},CLASS_NAME:"OpenLayers.Format.WMTSCapabilities"});
OpenLayers.Format.Atom=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{atom:"http://www.w3.org/2005/Atom",georss:"http://www.georss.org/georss",georss10:"http://www.georss.org/georss/10"},feedTitle:"untitled",defaultEntryTitle:"untitled",gmlParser:null,xy:!1,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));return this.parseFeatures(a)},write:function(a){var b;if(a instanceof
Array){b=this.createElementNSPlus("atom:feed");b.appendChild(this.createElementNSPlus("atom:title",{value:this.feedTitle}));for(var c=0,d=a.length;c<d;c++)b.appendChild(this.buildEntryNode(a[c]))}else b=this.buildEntryNode(a);return OpenLayers.Format.XML.prototype.write.apply(this,[b])},buildContentNode:function(a){var b=this.createElementNSPlus("atom:content",{attributes:{type:a.type||null}});if(a.src)b.setAttribute("src",a.src);else if("text"==a.type||null==a.type)b.appendChild(this.createTextNode(a.value));
else if("html"==a.type){if("string"!=typeof a.value)throw"HTML content must be in form of an escaped string";b.appendChild(this.createTextNode(a.value))}else"xhtml"==a.type?b.appendChild(a.value):"xhtml"==a.type||a.type.match(/(\+|\/)xml$/)?b.appendChild(a.value):b.appendChild(this.createTextNode(a.value));return b},buildEntryNode:function(a){var b=a.attributes,c=b.atom||{},d=this.createElementNSPlus("atom:entry");if(c.authors)for(var e=c.authors instanceof Array?c.authors:[c.authors],f=0,g=e.length;f<
g;f++)d.appendChild(this.buildPersonConstructNode("author",e[f]));if(c.categories)for(var e=c.categories instanceof Array?c.categories:[c.categories],h,f=0,g=e.length;f<g;f++)h=e[f],d.appendChild(this.createElementNSPlus("atom:category",{attributes:{term:h.term,scheme:h.scheme||null,label:h.label||null}}));c.content&&d.appendChild(this.buildContentNode(c.content));if(c.contributors){e=c.contributors instanceof Array?c.contributors:[c.contributors];f=0;for(g=e.length;f<g;f++)d.appendChild(this.buildPersonConstructNode("contributor",
e[f]))}a.fid&&d.appendChild(this.createElementNSPlus("atom:id",{value:a.fid}));if(c.links){e=c.links instanceof Array?c.links:[c.links];f=0;for(g=e.length;f<g;f++)h=e[f],d.appendChild(this.createElementNSPlus("atom:link",{attributes:{href:h.href,rel:h.rel||null,type:h.type||null,hreflang:h.hreflang||null,title:h.title||null,length:h.length||null}}))}c.published&&d.appendChild(this.createElementNSPlus("atom:published",{value:c.published}));c.rights&&d.appendChild(this.createElementNSPlus("atom:rights",
{value:c.rights}));if(c.summary||b.description)d.appendChild(this.createElementNSPlus("atom:summary",{value:c.summary||b.description}));d.appendChild(this.createElementNSPlus("atom:title",{value:c.title||b.title||this.defaultEntryTitle}));c.updated&&d.appendChild(this.createElementNSPlus("atom:updated",{value:c.updated}));a.geometry&&(b=this.createElementNSPlus("georss:where"),b.appendChild(this.buildGeometryNode(a.geometry)),d.appendChild(b));return d},initGmlParser:function(){this.gmlParser=new OpenLayers.Format.GML.v3({xy:this.xy,
featureNS:"http://example.com#feature",internalProjection:this.internalProjection,externalProjection:this.externalProjection})},buildGeometryNode:function(a){this.gmlParser||this.initGmlParser();return this.gmlParser.writeNode("feature:_geometry",a).firstChild},buildPersonConstructNode:function(a,b){var c=["uri","email"],d=this.createElementNSPlus("atom:"+a);d.appendChild(this.createElementNSPlus("atom:name",{value:b.name}));for(var e=0,f=c.length;e<f;e++)b[c[e]]&&d.appendChild(this.createElementNSPlus("atom:"+
c[e],{value:b[c[e]]}));return d},getFirstChildValue:function(a,b,c,d){return(a=this.getElementsByTagNameNS(a,b,c))&&0<a.length?this.getChildValue(a[0],d):d},parseFeature:function(a){var b={},c=null,d=null,e=null,f=this.namespaces.atom;this.parsePersonConstructs(a,"author",b);d=this.getElementsByTagNameNS(a,f,"category");0<d.length&&(b.categories=[]);for(var g=0,h=d.length;g<h;g++){c={};c.term=d[g].getAttribute("term");if(e=d[g].getAttribute("scheme"))c.scheme=e;if(e=d[g].getAttribute("label"))c.label=
e;b.categories.push(c)}d=this.getElementsByTagNameNS(a,f,"content");if(0<d.length){c={};if(e=d[0].getAttribute("type"))c.type=e;(e=d[0].getAttribute("src"))?c.src=e:(c.value="text"==c.type||"html"==c.type||null==c.type?this.getFirstChildValue(a,f,"content",null):"xhtml"==c.type||c.type.match(/(\+|\/)xml$/)?this.getChildEl(d[0]):this.getFirstChildValue(a,f,"content",null),b.content=c)}this.parsePersonConstructs(a,"contributor",b);b.id=this.getFirstChildValue(a,f,"id",null);d=this.getElementsByTagNameNS(a,
f,"link");0<d.length&&(b.links=Array(d.length));for(var j=["rel","type","hreflang","title","length"],g=0,h=d.length;g<h;g++){c={};c.href=d[g].getAttribute("href");for(var n=0,p=j.length;n<p;n++)(e=d[g].getAttribute(j[n]))&&(c[j[n]]=e);b.links[g]=c}if(c=this.getFirstChildValue(a,f,"published",null))b.published=c;if(c=this.getFirstChildValue(a,f,"rights",null))b.rights=c;if(c=this.getFirstChildValue(a,f,"summary",null))b.summary=c;b.title=this.getFirstChildValue(a,f,"title",null);b.updated=this.getFirstChildValue(a,
f,"updated",null);c={title:b.title,description:b.summary,atom:b};a=this.parseLocations(a)[0];a=new OpenLayers.Feature.Vector(a,c);a.fid=b.id;return a},parseFeatures:function(a){var b=[],c=this.getElementsByTagNameNS(a,this.namespaces.atom,"entry");0==c.length&&(c=[a]);for(var a=0,d=c.length;a<d;a++)b.push(this.parseFeature(c[a]));return b},parseLocations:function(a){var b=this.namespaces.georss,c=this.namespaces.georss10,d={components:[]},e=this.getElementsByTagNameNS(a,b,"where");if(!e||0==e.length)e=
this.getElementsByTagNameNS(a,c,"where");if(e&&0<e.length){this.gmlParser||this.initGmlParser();for(var f=0,g=e.length;f<g;f++)this.gmlParser.readChildNodes(e[f],d)}d=d.components;e=this.getElementsByTagNameNS(a,b,"point");if(!e||0==e.length)e=this.getElementsByTagNameNS(a,c,"point");if(e&&0<e.length){f=0;for(g=e.length;f<g;f++){var h=OpenLayers.String.trim(e[f].firstChild.nodeValue).split(/\s+/);2!=h.length&&(h=OpenLayers.String.trim(e[f].firstChild.nodeValue).split(/\s*,\s*/));d.push(new OpenLayers.Geometry.Point(parseFloat(h[1]),
parseFloat(h[0])))}}var j=this.getElementsByTagNameNS(a,b,"line");if(!j||0==j.length)j=this.getElementsByTagNameNS(a,c,"line");if(j&&0<j.length)for(var n,f=0,g=j.length;f<g;f++){e=OpenLayers.String.trim(j[f].firstChild.nodeValue).split(/\s+/);n=[];for(var p=0,q=e.length;p<q;p+=2)h=new OpenLayers.Geometry.Point(parseFloat(e[p+1]),parseFloat(e[p])),n.push(h);d.push(new OpenLayers.Geometry.LineString(n))}j=this.getElementsByTagNameNS(a,b,"polygon");if(!j||0==j.length)j=this.getElementsByTagNameNS(a,
c,"polygon");if(j&&0<j.length){f=0;for(g=j.length;f<g;f++){e=OpenLayers.String.trim(j[f].firstChild.nodeValue).split(/\s+/);n=[];p=0;for(q=e.length;p<q;p+=2)h=new OpenLayers.Geometry.Point(parseFloat(e[p+1]),parseFloat(e[p])),n.push(h);d.push(new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(n)]))}}b=this.getElementsByTagNameNS(a,b,"box");if(!b||0==b.length)b=this.getElementsByTagNameNS(a,c,"box");if(b&&0<b.length){f=0;for(g=b.length;f<g;f++)a=OpenLayers.String.trim(b[f].firstChild.nodeValue).split(/\s+/),
4!=a.length&&(a=OpenLayers.String.trim(b[f].firstChild.nodeValue).split(/\s*,\s*/)),d.push((new OpenLayers.Bounds(parseFloat(a[1]),parseFloat(a[0]),parseFloat(a[3]),parseFloat(a[2]))).toGeometry())}if(this.internalProjection&&this.externalProjection){f=0;for(g=d.length;f<g;f++)d[f]&&d[f].transform(this.externalProjection,this.internalProjection)}return d},parsePersonConstructs:function(a,b,c){for(var d=[],e=this.namespaces.atom,a=this.getElementsByTagNameNS(a,e,b),f=["uri","email"],g=0,h=a.length;g<
h;g++){var j={};j.name=this.getFirstChildValue(a[g],e,"name",null);for(var n=0,p=f.length;n<p;n++){var q=this.getFirstChildValue(a[g],e,f[n],null);q&&(j[f[n]]=q)}d.push(j)}0<d.length&&(c[b+"s"]=d)},CLASS_NAME:"OpenLayers.Format.Atom"});
OpenLayers.Layer.Google.v3={DEFAULTS:{sphericalMercator:!0,projection:"EPSG:900913"},animationEnabled:!0,loadMapObject:function(){this.type||(this.type=google.maps.MapTypeId.ROADMAP);var a,b=OpenLayers.Layer.Google.cache[this.map.id];b?(a=b.mapObject,++b.count):(a=this.map.getCenter(),b=document.createElement("div"),b.className="olForeignContainer",b.style.width="100%",b.style.height="100%",a=new google.maps.Map(b,{center:a?new google.maps.LatLng(a.lat,a.lon):new google.maps.LatLng(0,0),zoom:this.map.getZoom()||
0,mapTypeId:this.type,disableDefaultUI:!0,keyboardShortcuts:!1,draggable:!1,disableDoubleClickZoom:!0,scrollwheel:!1,streetViewControl:!1}),b=document.createElement("div"),b.style.width="100%",b.style.height="100%",a.controls[google.maps.ControlPosition.TOP_LEFT].push(b),b={googleControl:b,mapObject:a,count:1},OpenLayers.Layer.Google.cache[this.map.id]=b);this.mapObject=a;this.setGMapVisibility(this.visibility)},onMapResize:function(){this.visibility&&google.maps.event.trigger(this.mapObject,"resize")},
setGMapVisibility:function(a){var b=OpenLayers.Layer.Google.cache[this.map.id],c=this.map;if(b){for(var d=this.type,e=c.layers,f,g=e.length-1;0<=g;--g)if(f=e[g],f instanceof OpenLayers.Layer.Google&&!0===f.visibility&&!0===f.inRange){d=f.type;a=!0;break}e=this.mapObject.getDiv();if(!0===a){if(e.parentNode!==c.div)if(b.rendered)c.div.appendChild(e),b.googleControl.appendChild(c.viewPortDiv),google.maps.event.trigger(this.mapObject,"resize");else{var h=this;google.maps.event.addListenerOnce(this.mapObject,
"tilesloaded",function(){b.rendered=!0;h.setGMapVisibility(h.getVisibility());h.moveTo(h.map.getCenter())})}this.mapObject.setMapTypeId(d)}else b.googleControl.hasChildNodes()&&(c.div.appendChild(c.viewPortDiv),c.div.removeChild(e))}},getMapContainer:function(){return this.mapObject.getDiv()},getMapObjectBoundsFromOLBounds:function(a){var b=null;null!=a&&(b=this.sphericalMercator?this.inverseMercator(a.bottom,a.left):new OpenLayers.LonLat(a.bottom,a.left),a=this.sphericalMercator?this.inverseMercator(a.top,
a.right):new OpenLayers.LonLat(a.top,a.right),b=new google.maps.LatLngBounds(new google.maps.LatLng(b.lat,b.lon),new google.maps.LatLng(a.lat,a.lon)));return b},getMapObjectLonLatFromMapObjectPixel:function(a){var b=this.map.getSize(),c=this.getLongitudeFromMapObjectLonLat(this.mapObject.center),d=this.getLatitudeFromMapObjectLonLat(this.mapObject.center),e=this.map.getResolution(),a=new OpenLayers.LonLat(c+(a.x-b.w/2)*e,d-(a.y-b.h/2)*e);this.wrapDateLine&&(a=a.wrapDateLine(this.maxExtent));return this.getMapObjectLonLatFromLonLat(a.lon,
a.lat)},getMapObjectPixelFromMapObjectLonLat:function(a){var b=this.getLongitudeFromMapObjectLonLat(a),a=this.getLatitudeFromMapObjectLonLat(a),c=this.map.getResolution(),d=this.map.getExtent();return this.getMapObjectPixelFromXY(1/c*(b-d.left),1/c*(d.top-a))},setMapObjectCenter:function(a,b){if(!1===this.animationEnabled&&b!=this.mapObject.zoom){var c=this.getMapContainer();google.maps.event.addListenerOnce(this.mapObject,"idle",function(){c.style.visibility=""});c.style.visibility="hidden"}this.mapObject.setOptions({center:a,
zoom:b})},getMapObjectZoomFromMapObjectBounds:function(a){return this.mapObject.getBoundsZoomLevel(a)},getMapObjectLonLatFromLonLat:function(a,b){var c;this.sphericalMercator?(c=this.inverseMercator(a,b),c=new google.maps.LatLng(c.lat,c.lon)):c=new google.maps.LatLng(b,a);return c},getMapObjectPixelFromXY:function(a,b){return new google.maps.Point(a,b)}};
OpenLayers.Control.Measure=OpenLayers.Class(OpenLayers.Control,{callbacks:null,displaySystem:"metric",geodesic:!1,displaySystemUnits:{geographic:["dd"],english:["mi","ft","in"],metric:["km","m"]},partialDelay:300,delayedTrigger:null,persist:!1,immediate:!1,initialize:function(a,b){OpenLayers.Control.prototype.initialize.apply(this,[b]);var c={done:this.measureComplete,point:this.measurePartial};this.immediate&&(c.modify=this.measureImmediate);this.callbacks=OpenLayers.Util.extend(c,this.callbacks);
this.handlerOptions=OpenLayers.Util.extend({persist:this.persist},this.handlerOptions);this.handler=new a(this,this.callbacks,this.handlerOptions)},deactivate:function(){this.cancelDelay();return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},cancel:function(){this.cancelDelay();this.handler.cancel()},setImmediate:function(a){(this.immediate=a)?this.callbacks.modify=this.measureImmediate:delete this.callbacks.modify},updateHandler:function(a,b){var c=this.active;c&&this.deactivate();
this.handler=new a(this,this.callbacks,b);c&&this.activate()},measureComplete:function(a){this.cancelDelay();this.measure(a,"measure")},measurePartial:function(a,b){this.cancelDelay();b=b.clone();this.handler.freehandMode(this.handler.evt)?this.measure(b,"measurepartial"):this.delayedTrigger=window.setTimeout(OpenLayers.Function.bind(function(){this.delayedTrigger=null;this.measure(b,"measurepartial")},this),this.partialDelay)},measureImmediate:function(a,b,c){c&&!this.handler.freehandMode(this.handler.evt)&&
(this.cancelDelay(),this.measure(b.geometry,"measurepartial"))},cancelDelay:function(){null!==this.delayedTrigger&&(window.clearTimeout(this.delayedTrigger),this.delayedTrigger=null)},measure:function(a,b){var c,d;-1<a.CLASS_NAME.indexOf("LineString")?(c=this.getBestLength(a),d=1):(c=this.getBestArea(a),d=2);this.events.triggerEvent(b,{measure:c[0],units:c[1],order:d,geometry:a})},getBestArea:function(a){for(var b=this.displaySystemUnits[this.displaySystem],c,d,e=0,f=b.length;e<f&&!(c=b[e],d=this.getArea(a,
c),1<d);++e);return[d,c]},getArea:function(a,b){var c,d;this.geodesic?(c=a.getGeodesicArea(this.map.getProjectionObject()),d="m"):(c=a.getArea(),d=this.map.getUnits());var e=OpenLayers.INCHES_PER_UNIT[b];e&&(c*=Math.pow(OpenLayers.INCHES_PER_UNIT[d]/e,2));return c},getBestLength:function(a){for(var b=this.displaySystemUnits[this.displaySystem],c,d,e=0,f=b.length;e<f&&!(c=b[e],d=this.getLength(a,c),1<d);++e);return[d,c]},getLength:function(a,b){var c,d;this.geodesic?(c=a.getGeodesicLength(this.map.getProjectionObject()),
d="m"):(c=a.getLength(),d=this.map.getUnits());var e=OpenLayers.INCHES_PER_UNIT[b];e&&(c*=OpenLayers.INCHES_PER_UNIT[d]/e);return c},CLASS_NAME:"OpenLayers.Control.Measure"});
OpenLayers.Format.WMTSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.OWSCommon.v1_1_0,{version:"1.0.0",namespaces:{ows:"http://www.opengis.net/ows/1.1",wmts:"http://www.opengis.net/wmts/1.0",xlink:"http://www.w3.org/1999/xlink"},yx:null,defaultPrefix:"wmts",initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]);this.options=a;a=OpenLayers.Util.extend({},OpenLayers.Format.WMTSCapabilities.prototype.yx);this.yx=OpenLayers.Util.extend(a,this.yx)},read:function(a){"string"==
typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&&9==a.nodeType&&(a=a.documentElement);var b={};this.readNode(a,b);b.version=this.version;return b},readers:{wmts:{Capabilities:function(a,b){this.readChildNodes(a,b)},Contents:function(a,b){b.contents={};b.contents.layers=[];b.contents.tileMatrixSets={};this.readChildNodes(a,b.contents)},Layer:function(a,b){var c={styles:[],formats:[],dimensions:[],tileMatrixSetLinks:[],layers:[]};this.readChildNodes(a,c);b.layers.push(c)},Style:function(a,
b){var c={};c.isDefault="true"===a.getAttribute("isDefault");this.readChildNodes(a,c);b.styles.push(c)},Format:function(a,b){b.formats.push(this.getChildValue(a))},TileMatrixSetLink:function(a,b){var c={};this.readChildNodes(a,c);b.tileMatrixSetLinks.push(c)},TileMatrixSet:function(a,b){if(b.layers){var c={matrixIds:[]};this.readChildNodes(a,c);b.tileMatrixSets[c.identifier]=c}else b.tileMatrixSet=this.getChildValue(a)},TileMatrix:function(a,b){var c={supportedCRS:b.supportedCRS};this.readChildNodes(a,
c);b.matrixIds.push(c)},ScaleDenominator:function(a,b){b.scaleDenominator=parseFloat(this.getChildValue(a))},TopLeftCorner:function(a,b){var c=this.getChildValue(a).split(" "),d;b.supportedCRS&&(d=b.supportedCRS.replace(/urn:ogc:def:crs:(\w+):.+:(\w+)$/,"urn:ogc:def:crs:$1::$2"),d=!!this.yx[d]);b.topLeftCorner=d?new OpenLayers.LonLat(c[1],c[0]):new OpenLayers.LonLat(c[0],c[1])},TileWidth:function(a,b){b.tileWidth=parseInt(this.getChildValue(a))},TileHeight:function(a,b){b.tileHeight=parseInt(this.getChildValue(a))},
MatrixWidth:function(a,b){b.matrixWidth=parseInt(this.getChildValue(a))},MatrixHeight:function(a,b){b.matrixHeight=parseInt(this.getChildValue(a))},ResourceURL:function(a,b){b.resourceUrl=b.resourceUrl||{};var c=a.getAttribute("resourceType");b.resourceUrls||(b.resourceUrls=[]);c=b.resourceUrl[c]={format:a.getAttribute("format"),template:a.getAttribute("template"),resourceType:c};b.resourceUrls.push(c)},WSDL:function(a,b){b.wsdl={};b.wsdl.href=a.getAttribute("xlink:href")},ServiceMetadataURL:function(a,
b){b.serviceMetadataUrl={};b.serviceMetadataUrl.href=a.getAttribute("xlink:href")},LegendURL:function(a,b){b.legend={};b.legend.href=a.getAttribute("xlink:href");b.legend.format=a.getAttribute("format")},Dimension:function(a,b){var c={values:[]};this.readChildNodes(a,c);b.dimensions.push(c)},Default:function(a,b){b["default"]=this.getChildValue(a)},Value:function(a,b){b.values.push(this.getChildValue(a))}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WMTSCapabilities.v1_0_0"});
OpenLayers.Strategy.Cluster=OpenLayers.Class(OpenLayers.Strategy,{distance:20,threshold:null,features:null,clusters:null,clustering:!1,resolution:null,activate:function(){var a=OpenLayers.Strategy.prototype.activate.call(this);if(a)this.layer.events.on({beforefeaturesadded:this.cacheFeatures,moveend:this.cluster,scope:this});return a},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);a&&(this.clearCache(),this.layer.events.un({beforefeaturesadded:this.cacheFeatures,moveend:this.cluster,
scope:this}));return a},cacheFeatures:function(a){var b=!0;this.clustering||(this.clearCache(),this.features=a.features,this.cluster(),b=!1);return b},clearCache:function(){this.features=null},cluster:function(a){if((!a||a.zoomChanged||a&&a.recluster)&&this.features){var b=this.layer.map.getResolution();if(b!=this.resolution||!this.clustersExist()||a&&a.recluster){this.resolution=b;for(var a=[],c,d,e,b=0;b<this.features.length;++b)if(c=this.features[b],c.geometry){d=!1;for(var f=a.length-1;0<=f;--f)if(e=
a[f],this.shouldCluster(e,c)){this.addToCluster(e,c);d=!0;break}d||a.push(this.createCluster(this.features[b]))}this.layer.removeAllFeatures();if(0<a.length){if(1<this.threshold){c=a.slice();a=[];b=0;for(e=c.length;b<e;++b)d=c[b],d.attributes.count<this.threshold?Array.prototype.push.apply(a,d.cluster):a.push(d)}this.clustering=!0;this.layer.addFeatures(a);this.clustering=!1}this.clusters=a}}},recluster:function(){this.cluster({recluster:!0})},clustersExist:function(){var a=!1;if(this.clusters&&0<
this.clusters.length&&this.clusters.length==this.layer.features.length)for(var a=!0,b=0;b<this.clusters.length;++b)if(this.clusters[b]!=this.layer.features[b]){a=!1;break}return a},shouldCluster:function(a,b){var c=a.geometry.getBounds().getCenterLonLat(),d=b.geometry.getBounds().getCenterLonLat();return Math.sqrt(Math.pow(c.lon-d.lon,2)+Math.pow(c.lat-d.lat,2))/this.resolution<=this.distance},addToCluster:function(a,b){a.cluster.push(b);a.attributes.count+=1},createCluster:function(a){var b=a.geometry.getBounds().getCenterLonLat(),
b=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(b.lon,b.lat),{count:1});b.cluster=[a];return b},CLASS_NAME:"OpenLayers.Strategy.Cluster"});
OpenLayers.Strategy.PolygonCluster=OpenLayers.Class(OpenLayers.Strategy.Cluster,{cluster:function(a){if((!a||a.zoomChanged||a&&a.recluster)&&this.features){var b=this.layer.map.getResolution();if(b!==this.resolution||!this.clustersExist()||a&&a.recluster){this.resolution=b;for(var a=[],c,d,e,b=0;b<this.features.length;++b)if(c=this.features[b],c.layer||(c.layer=this.layer),c.geometry){d=!1;for(var f=a.length-1;0<=f;--f)if(e=a[f],this.shouldCluster(e,c)){this.addToCluster(e,c);d=!0;break}d||a.push(this.createCluster(c))}this.layer.removeAllFeatures();
if(0<a.length){if(1<this.threshold){c=a.slice();a=[];b=0;for(e=c.length;b<e;++b)d=c[b],d.attributes.count<this.threshold?Array.prototype.push.apply(a,d.cluster):a.push(d)}this.clustering=!0;this.layer.addFeatures(a);this.layer._M&&(this.layer._M.clusterType="Polygon");this.clustering=!1}this.clusters=a}}},recluster:function(){this.cluster({recluster:!0})},shouldCluster:function(a,b){var c=a.geometry.getBounds(),d=b.geometry.getBounds();return!c||!d?!1:c.equals(d)},createCluster:function(a){var b=
a.geometry.getBounds().toGeometry(),b=new OpenLayers.Feature.Vector(b,{count:1});b.layer=this.layer;b.cluster=[a];return b},addToCluster:function(a,b){a.cluster.push(b);a.attributes.count+=1},CLASS_NAME:"OpenLayers.Strategy.PolygonCluster"});
OpenLayers.Control.DrawFeature=OpenLayers.Class(OpenLayers.Control,{layer:null,callbacks:null,multi:!1,featureAdded:function(){},initialize:function(a,b,c){OpenLayers.Control.prototype.initialize.apply(this,[c]);this.callbacks=OpenLayers.Util.extend({done:this.drawFeature,modify:function(a,b){this.layer.events.triggerEvent("sketchmodified",{vertex:a,feature:b})},create:function(a,b){this.layer.events.triggerEvent("sketchstarted",{vertex:a,feature:b})}},this.callbacks);this.layer=a;this.handlerOptions=
this.handlerOptions||{};this.handlerOptions.layerOptions=OpenLayers.Util.applyDefaults(this.handlerOptions.layerOptions,{renderers:a.renderers,rendererOptions:a.rendererOptions});"multi"in this.handlerOptions||(this.handlerOptions.multi=this.multi);if(a=this.layer.styleMap&&this.layer.styleMap.styles.temporary)this.handlerOptions.layerOptions=OpenLayers.Util.applyDefaults(this.handlerOptions.layerOptions,{styleMap:new OpenLayers.StyleMap({"default":a})});this.handler=new b(this,this.callbacks,this.handlerOptions)},
drawFeature:function(a){a=new OpenLayers.Feature.Vector(a);!1!==this.layer.events.triggerEvent("sketchcomplete",{feature:a})&&(a.state=OpenLayers.State.INSERT,this.layer.addFeatures([a]),this.featureAdded(a),this.events.triggerEvent("featureadded",{feature:a}))},insertXY:function(a,b){this.handler&&this.handler.line&&this.handler.insertXY(a,b)},insertDeltaXY:function(a,b){this.handler&&this.handler.line&&this.handler.insertDeltaXY(a,b)},insertDirectionLength:function(a,b){this.handler&&this.handler.line&&
this.handler.insertDirectionLength(a,b)},insertDeflectionLength:function(a,b){this.handler&&this.handler.line&&this.handler.insertDeflectionLength(a,b)},undo:function(){return this.handler.undo&&this.handler.undo()},redo:function(){return this.handler.redo&&this.handler.redo()},finishSketch:function(){this.handler.finishGeometry()},cancel:function(){this.handler.cancel()},CLASS_NAME:"OpenLayers.Control.DrawFeature"});
OpenLayers.Rule=OpenLayers.Class({id:null,name:null,title:null,description:null,context:null,filter:null,elseFilter:!1,symbolizer:null,symbolizers:null,minScaleDenominator:null,maxScaleDenominator:null,initialize:function(a){this.symbolizer={};OpenLayers.Util.extend(this,a);this.symbolizers&&delete this.symbolizer;this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var a in this.symbolizer)this.symbolizer[a]=null;this.symbolizer=null;delete this.symbolizers},evaluate:function(a){var b=
this.getContext(a),c=!0;if(this.minScaleDenominator||this.maxScaleDenominator)var d=a.layer.map.getScale();this.minScaleDenominator&&(c=d>=OpenLayers.Style.createLiteral(this.minScaleDenominator,b));c&&this.maxScaleDenominator&&(c=d<OpenLayers.Style.createLiteral(this.maxScaleDenominator,b));c&&this.filter&&(c="OpenLayers.Filter.FeatureId"==this.filter.CLASS_NAME?this.filter.evaluate(a):this.filter.evaluate(b));return c},getContext:function(a){var b=this.context;b||(b=a.attributes||a.data);"function"==
typeof this.context&&(b=this.context(a));return b},clone:function(){var a=OpenLayers.Util.extend({},this);if(this.symbolizers){var b=this.symbolizers.length;a.symbolizers=Array(b);for(var c=0;c<b;++c)a.symbolizers[c]=this.symbolizers[c].clone()}else{a.symbolizer={};for(var d in this.symbolizer)b=this.symbolizer[d],c=typeof b,"object"===c?a.symbolizer[d]=OpenLayers.Util.extend({},b):"string"===c&&(a.symbolizer[d]=b)}a.filter=this.filter&&this.filter.clone();a.context=this.context&&OpenLayers.Util.extend({},
this.context);return new OpenLayers.Rule(a)},CLASS_NAME:"OpenLayers.Rule"});
OpenLayers.Handler.Pinch=OpenLayers.Class(OpenLayers.Handler,{started:!1,stopDown:!1,pinching:!1,last:null,start:null,touchstart:function(a){var b=!0;this.pinching=!1;if(OpenLayers.Event.isMultiTouch(a))this.started=!0,this.last=this.start={distance:this.getDistance(a.touches),delta:0,scale:1},this.callback("start",[a,this.start]),b=!this.stopDown;else{if(this.started)return!1;this.started=!1;this.last=this.start=null}OpenLayers.Event.preventDefault(a);return b},touchmove:function(a){if(this.started&&
OpenLayers.Event.isMultiTouch(a)){this.pinching=!0;var b=this.getPinchData(a);this.callback("move",[a,b]);this.last=b;OpenLayers.Event.stop(a)}else if(this.started)return!1;return!0},touchend:function(a){return this.started&&!OpenLayers.Event.isMultiTouch(a)?(this.pinching=this.started=!1,this.callback("done",[a,this.start,this.last]),this.last=this.start=null,!1):!0},activate:function(){var a=!1;OpenLayers.Handler.prototype.activate.apply(this,arguments)&&(this.pinching=!1,a=!0);return a},deactivate:function(){var a=
!1;OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.pinching=this.started=!1,this.last=this.start=null,a=!0);return a},getDistance:function(a){var b=a[0],a=a[1];return Math.sqrt(Math.pow(b.olClientX-a.olClientX,2)+Math.pow(b.olClientY-a.olClientY,2))},getPinchData:function(a){a=this.getDistance(a.touches);return{distance:a,delta:this.last.distance-a,scale:a/this.start.distance}},CLASS_NAME:"OpenLayers.Handler.Pinch"});
OpenLayers.Handler.Hover=OpenLayers.Class(OpenLayers.Handler,{delay:500,pixelTolerance:null,stopMove:!1,px:null,timerId:null,mousemove:function(a){this.passesTolerance(a.xy)&&(this.clearTimer(),this.callback("move",[a]),this.px=a.xy,a=OpenLayers.Util.extend({},a),this.timerId=window.setTimeout(OpenLayers.Function.bind(this.delayedCall,this,a),this.delay));return!this.stopMove},mouseout:function(a){OpenLayers.Util.mouseLeft(a,this.map.viewPortDiv)&&(this.clearTimer(),this.callback("move",[a]));return!0},
passesTolerance:function(a){var b=!0;this.pixelTolerance&&this.px&&Math.sqrt(Math.pow(this.px.x-a.x,2)+Math.pow(this.px.y-a.y,2))<this.pixelTolerance&&(b=!1);return b},clearTimer:function(){null!=this.timerId&&(window.clearTimeout(this.timerId),this.timerId=null)},delayedCall:function(a){this.callback("pause",[a])},deactivate:function(){var a=!1;OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.clearTimer(),a=!0);return a},CLASS_NAME:"OpenLayers.Handler.Hover"});
OpenLayers.Format.WFSDescribeFeatureType=OpenLayers.Class(OpenLayers.Format.XML,{regExes:{trimSpace:/^\s*|\s*$/g},namespaces:{xsd:"http://www.w3.org/2001/XMLSchema"},readers:{xsd:{schema:function(a,b){var c=[],d={},e,f;this.readChildNodes(a,{complexTypes:c,customTypes:d});var g=a.attributes,h,j;e=0;for(f=g.length;e<f;++e)h=g[e],j=h.name,0===j.indexOf("xmlns")?this.setNamespace(j.split(":")[1]||"",h.value):b[j]=h.value;b.featureTypes=c;b.targetPrefix=this.namespaceAlias[b.targetNamespace];e=0;for(f=
c.length;e<f;++e)g=c[e],h=d[g.typeName],d[g.typeName]&&(g.typeName=h.name)},complexType:function(a,b){var c={typeName:a.getAttribute("name")};this.readChildNodes(a,c);b.complexTypes.push(c)},complexContent:function(a,b){this.readChildNodes(a,b)},extension:function(a,b){this.readChildNodes(a,b)},sequence:function(a,b){var c={elements:[]};this.readChildNodes(a,c);b.properties=c.elements},element:function(a,b){var c;if(b.elements){var d={};c=a.attributes;for(var e,f=0,g=c.length;f<g;++f)e=c[f],d[e.name]=
e.value;c=d.type;c||(c={},this.readChildNodes(a,c),d.restriction=c,d.type=c.base);d.localType=(c.base||c).split(":").pop();b.elements.push(d);this.readChildNodes(a,d)}b.complexTypes&&(c=a.getAttribute("type"),d=c.split(":").pop(),b.customTypes[d]={name:a.getAttribute("name"),type:c})},annotation:function(a,b){b.annotation={};this.readChildNodes(a,b.annotation)},appinfo:function(a,b){b.appinfo||(b.appinfo=[]);b.appinfo.push(this.getChildValue(a))},documentation:function(a,b){b.documentation||(b.documentation=
[]);var c=this.getChildValue(a);b.documentation.push({lang:a.getAttribute("xml:lang"),textContent:c.replace(this.regExes.trimSpace,"")})},simpleType:function(a,b){this.readChildNodes(a,b)},restriction:function(a,b){b.base=a.getAttribute("base");this.readRestriction(a,b)}}},readRestriction:function(a,b){for(var c=a.childNodes,d,e,f=0,g=c.length;f<g;++f)d=c[f],1==d.nodeType&&(e=d.nodeName.split(":").pop(),d=d.getAttribute("value"),b[e]?("string"==typeof b[e]&&(b[e]=[b[e]]),b[e].push(d)):b[e]=d)},read:function(a){"string"==
typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&&9==a.nodeType&&(a=a.documentElement);var b={};if("ExceptionReport"===a.nodeName.split(":").pop()){var c=new OpenLayers.Format.OGCExceptionReport;b.error=c.read(a)}else this.readNode(a,b);return b},CLASS_NAME:"OpenLayers.Format.WFSDescribeFeatureType"});
OpenLayers.Control.Geolocate=OpenLayers.Class(OpenLayers.Control,{geolocation:null,available:"geolocation"in navigator,bind:!0,watch:!1,geolocationOptions:null,destroy:function(){this.deactivate();OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){this.available&&!this.geolocation&&(this.geolocation=navigator.geolocation);return!this.geolocation?(this.events.triggerEvent("locationuncapable"),!1):OpenLayers.Control.prototype.activate.apply(this,arguments)?(this.watch?this.watchId=
this.geolocation.watchPosition(OpenLayers.Function.bind(this.geolocate,this),OpenLayers.Function.bind(this.failure,this),this.geolocationOptions):this.getCurrentLocation(),!0):!1},deactivate:function(){this.active&&null!==this.watchId&&this.geolocation.clearWatch(this.watchId);return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},geolocate:function(a){var b=(new OpenLayers.LonLat(a.coords.longitude,a.coords.latitude)).transform(new OpenLayers.Projection("EPSG:4326"),this.map.getProjectionObject());
this.bind&&this.map.setCenter(b);this.events.triggerEvent("locationupdated",{position:a,point:new OpenLayers.Geometry.Point(b.lon,b.lat)})},getCurrentLocation:function(){if(!this.active||this.watch)return!1;this.geolocation.getCurrentPosition(OpenLayers.Function.bind(this.geolocate,this),OpenLayers.Function.bind(this.failure,this),this.geolocationOptions);return!0},failure:function(a){this.events.triggerEvent("locationfailed",{error:a})},CLASS_NAME:"OpenLayers.Control.Geolocate"});
OpenLayers.Tile.UTFGrid=OpenLayers.Class(OpenLayers.Tile,{url:null,utfgridResolution:2,json:null,format:null,destroy:function(){this.clear();OpenLayers.Tile.prototype.destroy.apply(this,arguments)},draw:function(){var a=OpenLayers.Tile.prototype.draw.apply(this,arguments);if(a)if(this.isLoading?(this.abortLoading(),this.events.triggerEvent("reload")):(this.isLoading=!0,this.events.triggerEvent("loadstart")),this.url=this.layer.getURL(this.bounds),this.layer.useJSONP){var b=new OpenLayers.Protocol.Script({url:this.url,
callback:function(a){this.isLoading=!1;this.events.triggerEvent("loadend");this.json=a.data},scope:this});b.read();this.request=b}else this.request=OpenLayers.Request.GET({url:this.url,callback:function(a){this.isLoading=!1;this.events.triggerEvent("loadend");200===a.status&&this.parseData(a.responseText)},scope:this});else this.unload();return a},abortLoading:function(){this.request&&(this.request.abort(),delete this.request);this.isLoading=!1},getFeatureInfo:function(a,b){var c=null;if(this.json){var d=
this.getFeatureId(a,b);null!==d&&(c={id:d,data:this.json.data[d]})}return c},getFeatureId:function(a,b){var c=null;if(this.json){var d=this.utfgridResolution,d=this.json.grid[Math.floor(b/d)].charCodeAt(Math.floor(a/d)),d=this.indexFromCharCode(d),e=this.json.keys;!isNaN(d)&&d in e&&(c=e[d])}return c},indexFromCharCode:function(a){93<=a&&a--;35<=a&&a--;return a-32},parseData:function(a){this.format||(this.format=new OpenLayers.Format.JSON);this.json=this.format.read(a)},clear:function(){this.json=
null},CLASS_NAME:"OpenLayers.Tile.UTFGrid"});OpenLayers.Protocol.WFS.v1_0_0=OpenLayers.Class(OpenLayers.Protocol.WFS.v1,{version:"1.0.0",CLASS_NAME:"OpenLayers.Protocol.WFS.v1_0_0"});
OpenLayers.Format.GeoRSS=OpenLayers.Class(OpenLayers.Format.XML,{rssns:"http://backend.userland.com/rss2",featureNS:"http://mapserver.gis.umn.edu/mapserver",georssns:"http://www.georss.org/georss",geons:"http://www.w3.org/2003/01/geo/wgs84_pos#",featureTitle:"Untitled",featureDescription:"No Description",gmlParser:null,xy:!1,createGeometryFromItem:function(a){var b=this.getElementsByTagNameNS(a,this.georssns,"point"),c=this.getElementsByTagNameNS(a,this.geons,"lat"),d=this.getElementsByTagNameNS(a,
this.geons,"long"),e=this.getElementsByTagNameNS(a,this.georssns,"line"),f=this.getElementsByTagNameNS(a,this.georssns,"polygon"),g=this.getElementsByTagNameNS(a,this.georssns,"where"),a=this.getElementsByTagNameNS(a,this.georssns,"box");if(0<b.length||0<c.length&&0<d.length){0<b.length?(c=OpenLayers.String.trim(b[0].firstChild.nodeValue).split(/\s+/),2!=c.length&&(c=OpenLayers.String.trim(b[0].firstChild.nodeValue).split(/\s*,\s*/))):c=[parseFloat(c[0].firstChild.nodeValue),parseFloat(d[0].firstChild.nodeValue)];
var h=new OpenLayers.Geometry.Point(c[1],c[0])}else if(0<e.length){c=OpenLayers.String.trim(this.getChildValue(e[0])).split(/\s+/);d=[];e=0;for(f=c.length;e<f;e+=2)b=new OpenLayers.Geometry.Point(c[e+1],c[e]),d.push(b);h=new OpenLayers.Geometry.LineString(d)}else if(0<f.length){c=OpenLayers.String.trim(this.getChildValue(f[0])).split(/\s+/);d=[];e=0;for(f=c.length;e<f;e+=2)b=new OpenLayers.Geometry.Point(c[e+1],c[e]),d.push(b);h=new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(d)])}else 0<
g.length?(this.gmlParser||(this.gmlParser=new OpenLayers.Format.GML({xy:this.xy})),h=this.gmlParser.parseFeature(g[0]).geometry):0<a.length&&(c=OpenLayers.String.trim(a[0].firstChild.nodeValue).split(/\s+/),d=[],3<c.length&&(b=new OpenLayers.Geometry.Point(c[1],c[0]),d.push(b),b=new OpenLayers.Geometry.Point(c[1],c[2]),d.push(b),b=new OpenLayers.Geometry.Point(c[3],c[2]),d.push(b),b=new OpenLayers.Geometry.Point(c[3],c[0]),d.push(b),b=new OpenLayers.Geometry.Point(c[1],c[0]),d.push(b)),h=new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(d)]));
h&&(this.internalProjection&&this.externalProjection)&&h.transform(this.externalProjection,this.internalProjection);return h},createFeatureFromItem:function(a){var b=this.createGeometryFromItem(a),c=this._getChildValue(a,"*","title",this.featureTitle),d=this._getChildValue(a,"*","description",this._getChildValue(a,"*","content",this._getChildValue(a,"*","summary",this.featureDescription))),e=this._getChildValue(a,"*","link");if(!e)try{e=this.getElementsByTagNameNS(a,"*","link")[0].getAttribute("href")}catch(f){e=
null}a=this._getChildValue(a,"*","id",null);b=new OpenLayers.Feature.Vector(b,{title:c,description:d,link:e});b.fid=a;return b},_getChildValue:function(a,b,c,d){return(a=this.getElementsByTagNameNS(a,b,c))&&a[0]&&a[0].firstChild&&a[0].firstChild.nodeValue?this.getChildValue(a[0]):void 0==d?"":d},read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b=null,b=this.getElementsByTagNameNS(a,"*","item");0==b.length&&(b=this.getElementsByTagNameNS(a,"*","entry"));
for(var a=b.length,c=Array(a),d=0;d<a;d++)c[d]=this.createFeatureFromItem(b[d]);return c},write:function(a){var b;if(OpenLayers.Util.isArray(a)){b=this.createElementNS(this.rssns,"rss");for(var c=0,d=a.length;c<d;c++)b.appendChild(this.createFeatureXML(a[c]))}else b=this.createFeatureXML(a);return OpenLayers.Format.XML.prototype.write.apply(this,[b])},createFeatureXML:function(a){var b=this.buildGeometryNode(a.geometry),c=this.createElementNS(this.rssns,"item"),d=this.createElementNS(this.rssns,"title");
d.appendChild(this.createTextNode(a.attributes.title?a.attributes.title:""));var e=this.createElementNS(this.rssns,"description");e.appendChild(this.createTextNode(a.attributes.description?a.attributes.description:""));c.appendChild(d);c.appendChild(e);a.attributes.link&&(d=this.createElementNS(this.rssns,"link"),d.appendChild(this.createTextNode(a.attributes.link)),c.appendChild(d));for(var f in a.attributes)"link"==f||("title"==f||"description"==f)||(d=this.createTextNode(a.attributes[f]),e=f,-1!=
f.search(":")&&(e=f.split(":")[1]),e=this.createElementNS(this.featureNS,"feature:"+e),e.appendChild(d),c.appendChild(e));c.appendChild(b);return c},buildGeometryNode:function(a){this.internalProjection&&this.externalProjection&&(a=a.clone(),a.transform(this.internalProjection,this.externalProjection));var b;if("OpenLayers.Geometry.Polygon"==a.CLASS_NAME)b=this.createElementNS(this.georssns,"georss:polygon"),b.appendChild(this.buildCoordinatesNode(a.components[0]));else if("OpenLayers.Geometry.LineString"==
a.CLASS_NAME)b=this.createElementNS(this.georssns,"georss:line"),b.appendChild(this.buildCoordinatesNode(a));else if("OpenLayers.Geometry.Point"==a.CLASS_NAME)b=this.createElementNS(this.georssns,"georss:point"),b.appendChild(this.buildCoordinatesNode(a));else throw"Couldn't parse "+a.CLASS_NAME;return b},buildCoordinatesNode:function(a){var b=null;a.components&&(b=a.components);if(b){for(var a=b.length,c=Array(a),d=0;d<a;d++)c[d]=b[d].y+" "+b[d].x;b=c.join(" ")}else b=a.y+" "+a.x;return this.createTextNode(b)},
CLASS_NAME:"OpenLayers.Format.GeoRSS"});
OpenLayers.Control.PinchZoom=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,pinchOrigin:null,currentCenter:null,autoActivate:!0,preserveCenter:!1,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,arguments);this.handler=new OpenLayers.Handler.Pinch(this,{start:this.pinchStart,move:this.pinchMove,done:this.pinchDone},this.handlerOptions)},pinchStart:function(a){this.currentCenter=this.pinchOrigin=a=this.preserveCenter?this.map.getPixelFromLonLat(this.map.getCenter()):
a.xy},pinchMove:function(a,b){var c=b.scale,d=this.map.layerContainerOriginPx,e=this.pinchOrigin,f=this.preserveCenter?this.map.getPixelFromLonLat(this.map.getCenter()):a.xy,g=Math.round(d.x+f.x-e.x+(c-1)*(d.x-e.x)),d=Math.round(d.y+f.y-e.y+(c-1)*(d.y-e.y));this.map.applyTransform(g,d,c);this.currentCenter=f},pinchDone:function(a,b,c){this.map.applyTransform();a=this.map.getZoomForResolution(this.map.getResolution()/c.scale,!0);if(a!==this.map.getZoom()||!this.currentCenter.equals(this.pinchOrigin)){var b=
this.map.getResolutionForZoom(a),c=this.map.getLonLatFromPixel(this.pinchOrigin),d=this.currentCenter,e=this.map.getSize();c.lon+=b*(e.w/2-d.x);c.lat-=b*(e.h/2-d.y);this.map.div.clientWidth=this.map.div.clientWidth;this.map.setCenter(c,a)}},CLASS_NAME:"OpenLayers.Control.PinchZoom"});
OpenLayers.Control.TouchNavigation=OpenLayers.Class(OpenLayers.Control,{dragPan:null,dragPanOptions:null,pinchZoom:null,pinchZoomOptions:null,clickHandlerOptions:null,documentDrag:!1,autoActivate:!0,initialize:function(a){this.handlers={};OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.deactivate();this.dragPan&&this.dragPan.destroy();this.dragPan=null;this.pinchZoom&&(this.pinchZoom.destroy(),delete this.pinchZoom);OpenLayers.Control.prototype.destroy.apply(this,
arguments)},activate:function(){return OpenLayers.Control.prototype.activate.apply(this,arguments)?(this.dragPan.activate(),this.handlers.click.activate(),this.pinchZoom.activate(),!0):!1},deactivate:function(){return OpenLayers.Control.prototype.deactivate.apply(this,arguments)?(this.dragPan.deactivate(),this.handlers.click.deactivate(),this.pinchZoom.deactivate(),!0):!1},draw:function(){var a={click:this.defaultClick,dblclick:this.defaultDblClick},b=OpenLayers.Util.extend({"double":!0,stopDouble:!0,
pixelTolerance:2},this.clickHandlerOptions);this.handlers.click=new OpenLayers.Handler.Click(this,a,b);this.dragPan=new OpenLayers.Control.DragPan(OpenLayers.Util.extend({map:this.map,documentDrag:this.documentDrag},this.dragPanOptions));this.dragPan.draw();this.pinchZoom=new OpenLayers.Control.PinchZoom(OpenLayers.Util.extend({map:this.map},this.pinchZoomOptions))},defaultClick:function(a){a.lastTouches&&2==a.lastTouches.length&&this.map.zoomOut()},defaultDblClick:function(a){this.map.zoomTo(this.map.zoom+
1,a.xy)},CLASS_NAME:"OpenLayers.Control.TouchNavigation"});
OpenLayers.Format.WFSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.WFSCapabilities.v1,{readers:{wfs:OpenLayers.Util.applyDefaults({Service:function(a,b){b.service={};this.readChildNodes(a,b.service)},Fees:function(a,b){var c=this.getChildValue(a);c&&"none"!=c.toLowerCase()&&(b.fees=c)},AccessConstraints:function(a,b){var c=this.getChildValue(a);c&&"none"!=c.toLowerCase()&&(b.accessConstraints=c)},OnlineResource:function(a,b){var c=this.getChildValue(a);c&&"none"!=c.toLowerCase()&&(b.onlineResource=
c)},Keywords:function(a,b){var c=this.getChildValue(a);c&&"none"!=c.toLowerCase()&&(b.keywords=c.split(", "))},Capability:function(a,b){b.capability={};this.readChildNodes(a,b.capability)},Request:function(a,b){b.request={};this.readChildNodes(a,b.request)},GetFeature:function(a,b){b.getfeature={href:{},formats:[]};this.readChildNodes(a,b.getfeature)},ResultFormat:function(a,b){for(var c=a.childNodes,d,e=0;e<c.length;e++)d=c[e],1==d.nodeType&&b.formats.push(d.nodeName)},DCPType:function(a,b){this.readChildNodes(a,
b)},HTTP:function(a,b){this.readChildNodes(a,b.href)},Get:function(a,b){b.get=a.getAttribute("onlineResource")},Post:function(a,b){b.post=a.getAttribute("onlineResource")},SRS:function(a,b){var c=this.getChildValue(a);c&&(b.srs=c)}},OpenLayers.Format.WFSCapabilities.v1.prototype.readers.wfs)},CLASS_NAME:"OpenLayers.Format.WFSCapabilities.v1_0_0"});
OpenLayers.Protocol.Script=OpenLayers.Class(OpenLayers.Protocol,{url:null,params:null,callback:null,callbackTemplate:"OpenLayers.Protocol.Script.registry.${id}",callbackKey:"callback",callbackPrefix:"",scope:null,format:null,pendingRequests:null,srsInBBOX:!1,initialize:function(a){a=a||{};this.params={};this.pendingRequests={};OpenLayers.Protocol.prototype.initialize.apply(this,arguments);this.format||(this.format=new OpenLayers.Format.GeoJSON);if(!this.filterToParams&&OpenLayers.Format.QueryStringFilter){var b=
new OpenLayers.Format.QueryStringFilter({srsInBBOX:this.srsInBBOX});this.filterToParams=function(a,d){return b.write(a,d)}}},read:function(a){OpenLayers.Protocol.prototype.read.apply(this,arguments);a=OpenLayers.Util.applyDefaults(a,this.options);a.params=OpenLayers.Util.applyDefaults(a.params,this.options.params);a.filter&&this.filterToParams&&(a.params=this.filterToParams(a.filter,a.params));var b=new OpenLayers.Protocol.Response({requestType:"read"}),c=this.createRequest(a.url,a.params,OpenLayers.Function.bind(function(c){b.data=
c;this.handleRead(b,a)},this));b.priv=c;return b},createRequest:function(a,b,c){var c=OpenLayers.Protocol.Script.register(c),d=OpenLayers.String.format(this.callbackTemplate,{id:c}),b=OpenLayers.Util.extend({},b);b[this.callbackKey]=this.callbackPrefix+d;a=OpenLayers.Util.urlAppend(a,OpenLayers.Util.getParameterString(b));b=document.createElement("script");b.type="text/javascript";b.src=a;b.id="OpenLayers_Protocol_Script_"+c;this.pendingRequests[b.id]=b;document.getElementsByTagName("head")[0].appendChild(b);
return b},destroyRequest:function(a){OpenLayers.Protocol.Script.unregister(a.id.split("_").pop());delete this.pendingRequests[a.id];a.parentNode&&a.parentNode.removeChild(a)},handleRead:function(a,b){this.handleResponse(a,b)},handleResponse:function(a,b){b.callback&&(a.data?(a.features=this.parseFeatures(a.data),a.code=OpenLayers.Protocol.Response.SUCCESS):a.code=OpenLayers.Protocol.Response.FAILURE,this.destroyRequest(a.priv),b.callback.call(b.scope,a))},parseFeatures:function(a){return this.format.read(a)},
abort:function(a){if(a)this.destroyRequest(a.priv);else for(var b in this.pendingRequests)this.destroyRequest(this.pendingRequests[b])},destroy:function(){this.abort();delete this.params;delete this.format;OpenLayers.Protocol.prototype.destroy.apply(this)},CLASS_NAME:"OpenLayers.Protocol.Script"});(function(){var a=OpenLayers.Protocol.Script,b=0;a.registry={};a.register=function(c){var d="c"+ ++b;a.registry[d]=function(){c.apply(this,arguments)};return d};a.unregister=function(b){delete a.registry[b]}})();
OpenLayers.Handler.RegularPolygon=OpenLayers.Class(OpenLayers.Handler.Drag,{sides:4,radius:null,snapAngle:null,snapToggle:"shiftKey",layerOptions:null,persist:!1,irregular:!1,citeCompliant:!1,angle:null,fixedRadius:!1,feature:null,layer:null,origin:null,initialize:function(a,b,c){if(!c||!c.layerOptions||!c.layerOptions.styleMap)this.style=OpenLayers.Util.extend(OpenLayers.Feature.Vector.style["default"],{});OpenLayers.Handler.Drag.prototype.initialize.apply(this,[a,b,c]);this.options=c?c:{}},setOptions:function(a){OpenLayers.Util.extend(this.options,
a);OpenLayers.Util.extend(this,a)},activate:function(){var a=!1;OpenLayers.Handler.Drag.prototype.activate.apply(this,arguments)&&(a=OpenLayers.Util.extend({displayInLayerSwitcher:!1,calculateInRange:OpenLayers.Function.True,wrapDateLine:this.citeCompliant},this.layerOptions),this.layer=new OpenLayers.Layer.Vector(this.CLASS_NAME,a),this.map.addLayer(this.layer),a=!0);return a},deactivate:function(){var a=!1;OpenLayers.Handler.Drag.prototype.deactivate.apply(this,arguments)&&(this.dragging&&this.cancel(),
null!=this.layer.map&&(this.layer.destroy(!1),this.feature&&this.feature.destroy()),this.feature=this.layer=null,a=!0);return a},down:function(a){this.fixedRadius=!!this.radius;a=this.layer.getLonLatFromViewPortPx(a.xy);this.origin=new OpenLayers.Geometry.Point(a.lon,a.lat);if(!this.fixedRadius||this.irregular)this.radius=this.map.getResolution();this.persist&&this.clear();this.feature=new OpenLayers.Feature.Vector;this.createGeometry();this.callback("create",[this.origin,this.feature]);this.layer.addFeatures([this.feature],
{silent:!0});this.layer.drawFeature(this.feature,this.style)},move:function(a){var b=this.layer.getLonLatFromViewPortPx(a.xy),b=new OpenLayers.Geometry.Point(b.lon,b.lat);this.irregular?(a=Math.sqrt(2)*Math.abs(b.y-this.origin.y)/2,this.radius=Math.max(this.map.getResolution()/2,a)):this.fixedRadius?this.origin=b:(this.calculateAngle(b,a),this.radius=Math.max(this.map.getResolution()/2,b.distanceTo(this.origin)));this.modifyGeometry();if(this.irregular){var a=b.x-this.origin.x,b=b.y-this.origin.y,
c;c=0==b?a/(this.radius*Math.sqrt(2)):a/b;this.feature.geometry.resize(1,this.origin,c);this.feature.geometry.move(a/2,b/2)}this.layer.drawFeature(this.feature,this.style)},up:function(a){this.finalize();this.start==this.last&&this.callback("done",[a.xy])},out:function(){this.finalize()},createGeometry:function(){this.angle=Math.PI*(1/this.sides-0.5);this.snapAngle&&(this.angle+=this.snapAngle*(Math.PI/180));this.feature.geometry=OpenLayers.Geometry.Polygon.createRegularPolygon(this.origin,this.radius,
this.sides,this.snapAngle)},modifyGeometry:function(){var a,b,c=this.feature.geometry.components[0];c.components.length!=this.sides+1&&(this.createGeometry(),c=this.feature.geometry.components[0]);for(var d=0;d<this.sides;++d)b=c.components[d],a=this.angle+2*d*Math.PI/this.sides,b.x=this.origin.x+this.radius*Math.cos(a),b.y=this.origin.y+this.radius*Math.sin(a),b.clearBounds()},calculateAngle:function(a,b){var c=Math.atan2(a.y-this.origin.y,a.x-this.origin.x);if(this.snapAngle&&this.snapToggle&&!b[this.snapToggle]){var d=
Math.PI/180*this.snapAngle;this.angle=Math.round(c/d)*d}else this.angle=c},cancel:function(){this.callback("cancel",null);this.finalize()},finalize:function(){this.origin=null;this.radius=this.options.radius},clear:function(){this.layer&&(this.layer.renderer.clear(),this.layer.destroyFeatures())},callback:function(a){this.callbacks[a]&&this.callbacks[a].apply(this.control,[this.feature.geometry.clone()]);!this.persist&&("done"==a||"cancel"==a)&&this.clear()},CLASS_NAME:"OpenLayers.Handler.RegularPolygon"});
OpenLayers.Renderer.VML=OpenLayers.Class(OpenLayers.Renderer.Elements,{xmlns:"urn:schemas-microsoft-com:vml",symbolCache:{},offset:null,initialize:function(a){if(this.supported()){if(!document.namespaces.olv){document.namespaces.add("olv",this.xmlns);for(var b=document.createStyleSheet(),c="shape rect oval fill stroke imagedata group textbox".split(" "),d=0,e=c.length;d<e;d++)b.addRule("olv\\:"+c[d],"behavior: url(#default#VML); position: absolute; display: inline-block;")}OpenLayers.Renderer.Elements.prototype.initialize.apply(this,
arguments)}},supported:function(){return!!document.namespaces},setExtent:function(a,b){var c=OpenLayers.Renderer.Elements.prototype.setExtent.apply(this,arguments),d=this.getResolution(),e=a.left/d|0,d=a.top/d-this.size.h|0;b||!this.offset?(this.offset={x:e,y:d},d=e=0):(e-=this.offset.x,d-=this.offset.y);this.root.coordorigin=e-this.xOffset+" "+d;for(var e=[this.root,this.vectorRoot,this.textRoot],f=0,g=e.length;f<g;++f)d=e[f],d.coordsize=this.size.w+" "+this.size.h;this.root.style.flip="y";return c},
setSize:function(a){OpenLayers.Renderer.prototype.setSize.apply(this,arguments);for(var b=[this.rendererRoot,this.root,this.vectorRoot,this.textRoot],c=this.size.w+"px",d=this.size.h+"px",e,f=0,g=b.length;f<g;++f)e=b[f],e.style.width=c,e.style.height=d},getNodeType:function(a,b){var c=null;switch(a.CLASS_NAME){case "OpenLayers.Geometry.Point":c=b.externalGraphic?"olv:rect":this.isComplexSymbol(b.graphicName)?"olv:shape":"olv:oval";break;case "OpenLayers.Geometry.Rectangle":c="olv:rect";break;case "OpenLayers.Geometry.LineString":case "OpenLayers.Geometry.LinearRing":case "OpenLayers.Geometry.Polygon":case "OpenLayers.Geometry.Curve":c=
"olv:shape"}return c},setStyle:function(a,b,c,d){var b=b||a._style,c=c||a._options,e=b.fillColor,f=b.title||b.graphicTitle;f&&(a.title=f);if("OpenLayers.Geometry.Point"===a._geometryClass)if(b.externalGraphic){c.isFilled=!0;var e=b.graphicWidth||b.graphicHeight,f=b.graphicHeight||b.graphicWidth,e=e?e:2*b.pointRadius,f=f?f:2*b.pointRadius,g=this.getResolution(),h=void 0!=b.graphicXOffset?b.graphicXOffset:-(0.5*e),j=void 0!=b.graphicYOffset?b.graphicYOffset:-(0.5*f);a.style.left=((d.x-this.featureDx)/
g-this.offset.x+h|0)+"px";a.style.top=(d.y/g-this.offset.y-(j+f)|0)+"px";a.style.width=e+"px";a.style.height=f+"px";a.style.flip="y";e="none";c.isStroked=!1}else this.isComplexSymbol(b.graphicName)?(f=this.importSymbol(b.graphicName),a.path=f.path,a.coordorigin=f.left+","+f.bottom,f=f.size,a.coordsize=f+","+f,this.drawCircle(a,d,b.pointRadius),a.style.flip="y"):this.drawCircle(a,d,b.pointRadius);c.isFilled?a.fillcolor=e:a.filled="false";d=a.getElementsByTagName("fill");d=0==d.length?null:d[0];if(c.isFilled){d||
(d=this.createNode("olv:fill",a.id+"_fill"));d.opacity=b.fillOpacity;if("OpenLayers.Geometry.Point"===a._geometryClass&&b.externalGraphic&&(b.graphicOpacity&&(d.opacity=b.graphicOpacity),d.src=b.externalGraphic,d.type="frame",!b.graphicWidth||!b.graphicHeight))d.aspect="atmost";d.parentNode!=a&&a.appendChild(d)}else d&&a.removeChild(d);e=b.rotation;if(void 0!==e||void 0!==a._rotation)a._rotation=e,b.externalGraphic?(this.graphicRotate(a,h,j,b),d.opacity=0):"OpenLayers.Geometry.Point"===a._geometryClass&&
(a.style.rotation=e||0);h=a.getElementsByTagName("stroke");h=0==h.length?null:h[0];c.isStroked?(h||(h=this.createNode("olv:stroke",a.id+"_stroke"),a.appendChild(h)),h.on=!0,h.color=b.strokeColor,h.weight=b.strokeWidth+"px",h.opacity=b.strokeOpacity,h.endcap="butt"==b.strokeLinecap?"flat":b.strokeLinecap||"round",b.strokeDashstyle&&(h.dashstyle=this.dashStyle(b))):(a.stroked=!1,h&&(h.on=!1));"inherit"!=b.cursor&&null!=b.cursor&&(a.style.cursor=b.cursor);return a},graphicRotate:function(a,b,c,d){var d=
d||a._style,e=d.rotation||0,f,g;if(!d.graphicWidth||!d.graphicHeight){var h=new Image;h.onreadystatechange=OpenLayers.Function.bind(function(){if("complete"==h.readyState||"interactive"==h.readyState)f=h.width/h.height,g=Math.max(2*d.pointRadius,d.graphicWidth||0,d.graphicHeight||0),b*=f,d.graphicWidth=g*f,d.graphicHeight=g,this.graphicRotate(a,b,c,d)},this);h.src=d.externalGraphic}else{g=Math.max(d.graphicWidth,d.graphicHeight);f=d.graphicWidth/d.graphicHeight;var j=Math.round(d.graphicWidth||g*
f),n=Math.round(d.graphicHeight||g);a.style.width=j+"px";a.style.height=n+"px";var p=document.getElementById(a.id+"_image");p||(p=this.createNode("olv:imagedata",a.id+"_image"),a.appendChild(p));p.style.width=j+"px";p.style.height=n+"px";p.src=d.externalGraphic;p.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='', sizingMethod='scale')";p=e*Math.PI/180;e=Math.sin(p);p=Math.cos(p);e="progid:DXImageTransform.Microsoft.Matrix(M11="+p+",M12="+-e+",M21="+e+",M22="+p+",SizingMethod='auto expand')\n";
(p=d.graphicOpacity||d.fillOpacity)&&1!=p&&(e+="progid:DXImageTransform.Microsoft.BasicImage(opacity="+p+")\n");a.style.filter=e;e=new OpenLayers.Geometry.Point(-b,-c);j=(new OpenLayers.Bounds(0,0,j,n)).toGeometry();j.rotate(d.rotation,e);j=j.getBounds();a.style.left=Math.round(parseInt(a.style.left)+j.left)+"px";a.style.top=Math.round(parseInt(a.style.top)-j.bottom)+"px"}},postDraw:function(a){a.style.visibility="visible";var b=a._style.fillColor,c=a._style.strokeColor;"none"==b&&a.fillcolor!=b&&
(a.fillcolor=b);"none"==c&&a.strokecolor!=c&&(a.strokecolor=c)},setNodeDimension:function(a,b){var c=b.getBounds();if(c){var d=this.getResolution(),c=new OpenLayers.Bounds((c.left-this.featureDx)/d-this.offset.x|0,c.bottom/d-this.offset.y|0,(c.right-this.featureDx)/d-this.offset.x|0,c.top/d-this.offset.y|0);a.style.left=c.left+"px";a.style.top=c.top+"px";a.style.width=c.getWidth()+"px";a.style.height=c.getHeight()+"px";a.coordorigin=c.left+" "+c.top;a.coordsize=c.getWidth()+" "+c.getHeight()}},dashStyle:function(a){a=
a.strokeDashstyle;switch(a){case "solid":case "dot":case "dash":case "dashdot":case "longdash":case "longdashdot":return a;default:return a=a.split(/[ ,]/),2==a.length?1*a[0]>=2*a[1]?"longdash":1==a[0]||1==a[1]?"dot":"dash":4==a.length?1*a[0]>=2*a[1]?"longdashdot":"dashdot":"solid"}},createNode:function(a,b){var c=document.createElement(a);b&&(c.id=b);c.unselectable="on";c.onselectstart=OpenLayers.Function.False;return c},nodeTypeCompare:function(a,b){var c=b,d=c.indexOf(":");-1!=d&&(c=c.substr(d+
1));var e=a.nodeName,d=e.indexOf(":");-1!=d&&(e=e.substr(d+1));return c==e},createRenderRoot:function(){return this.nodeFactory(this.container.id+"_vmlRoot","div")},createRoot:function(a){return this.nodeFactory(this.container.id+a,"olv:group")},drawPoint:function(a,b){return this.drawCircle(a,b,1)},drawCircle:function(a,b,c){if(!isNaN(b.x)&&!isNaN(b.y)){var d=this.getResolution();a.style.left=((b.x-this.featureDx)/d-this.offset.x|0)-c+"px";a.style.top=(b.y/d-this.offset.y|0)-c+"px";b=2*c;a.style.width=
b+"px";a.style.height=b+"px";return a}return!1},drawLineString:function(a,b){return this.drawLine(a,b,!1)},drawLinearRing:function(a,b){return this.drawLine(a,b,!0)},drawLine:function(a,b,c){this.setNodeDimension(a,b);for(var d=this.getResolution(),e=b.components.length,f=Array(e),g,h,j=0;j<e;j++)g=b.components[j],h=(g.x-this.featureDx)/d-this.offset.x|0,g=g.y/d-this.offset.y|0,f[j]=" "+h+","+g+" l ";a.path="m"+f.join("")+(c?" x e":" e");return a},drawPolygon:function(a,b){this.setNodeDimension(a,
b);var c=this.getResolution(),d=[],e,f,g,h,j,n,p,q,m,r;e=0;for(f=b.components.length;e<f;e++){d.push("m");g=b.components[e].components;h=0===e;n=j=null;p=0;for(q=g.length;p<q;p++)m=g[p],r=(m.x-this.featureDx)/c-this.offset.x|0,m=m.y/c-this.offset.y|0,r=" "+r+","+m,d.push(r),0==p&&d.push(" l"),h||(j?j!=r&&(n?n!=r&&(h=!0):n=r):j=r);d.push(h?" x ":" ")}d.push("e");a.path=d.join("");return a},drawRectangle:function(a,b){var c=this.getResolution();a.style.left=((b.x-this.featureDx)/c-this.offset.x|0)+
"px";a.style.top=(b.y/c-this.offset.y|0)+"px";a.style.width=(b.width/c|0)+"px";a.style.height=(b.height/c|0)+"px";return a},drawText:function(a,b,c){var d=this.nodeFactory(a+this.LABEL_ID_SUFFIX,"olv:rect"),e=this.nodeFactory(a+this.LABEL_ID_SUFFIX+"_textbox","olv:textbox"),f=this.getResolution();d.style.left=((c.x-this.featureDx)/f-this.offset.x|0)+"px";d.style.top=(c.y/f-this.offset.y|0)+"px";d.style.flip="y";e.innerText=b.label;"inherit"!=b.cursor&&null!=b.cursor&&(e.style.cursor=b.cursor);b.fontColor&&
(e.style.color=b.fontColor);b.fontOpacity&&(e.style.filter="alpha(opacity="+100*b.fontOpacity+")");b.fontFamily&&(e.style.fontFamily=b.fontFamily);b.fontSize&&(e.style.fontSize=b.fontSize);b.fontWeight&&(e.style.fontWeight=b.fontWeight);b.fontStyle&&(e.style.fontStyle=b.fontStyle);!0===b.labelSelect&&(d._featureId=a,e._featureId=a,e._geometry=c,e._geometryClass=c.CLASS_NAME);e.style.whiteSpace="nowrap";e.inset="1px,0px,0px,0px";d.parentNode||(d.appendChild(e),this.textRoot.appendChild(d));b=b.labelAlign||
"cm";1==b.length&&(b+="m");a=e.clientWidth*OpenLayers.Renderer.VML.LABEL_SHIFT[b.substr(0,1)];e=e.clientHeight*OpenLayers.Renderer.VML.LABEL_SHIFT[b.substr(1,1)];d.style.left=parseInt(d.style.left)-a-1+"px";d.style.top=parseInt(d.style.top)+e+"px"},moveRoot:function(a){var b=this.map.getLayer(a.container.id);b instanceof OpenLayers.Layer.Vector.RootContainer&&(b=this.map.getLayer(this.container.id));b&&b.renderer.clear();OpenLayers.Renderer.Elements.prototype.moveRoot.apply(this,arguments);b&&b.redraw()},
importSymbol:function(a){var b=this.container.id+"-"+a,c=this.symbolCache[b];if(c)return c;c=OpenLayers.Renderer.symbol[a];if(!c)throw Error(a+" is not a valid symbol name");for(var a=new OpenLayers.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0),d=["m"],e=0;e<c.length;e+=2){var f=c[e],g=c[e+1];a.left=Math.min(a.left,f);a.bottom=Math.min(a.bottom,g);a.right=Math.max(a.right,f);a.top=Math.max(a.top,g);d.push(f);d.push(g);0==e&&d.push("l")}d.push("x e");c=d.join(" ");d=(a.getWidth()-a.getHeight())/2;
0<d?(a.bottom-=d,a.top+=d):(a.left+=d,a.right-=d);c={path:c,size:a.getWidth(),left:a.left,bottom:a.bottom};return this.symbolCache[b]=c},CLASS_NAME:"OpenLayers.Renderer.VML"});OpenLayers.Renderer.VML.LABEL_SHIFT={l:0,c:0.5,r:1,t:0,m:0.5,b:1};
OpenLayers.Protocol.HTTP=OpenLayers.Class(OpenLayers.Protocol,{url:null,headers:null,params:null,callback:null,scope:null,readWithPOST:!1,updateWithPOST:!1,deleteWithPOST:!1,wildcarded:!1,srsInBBOX:!1,initialize:function(a){a=a||{};this.params={};this.headers={};OpenLayers.Protocol.prototype.initialize.apply(this,arguments);if(!this.filterToParams&&OpenLayers.Format.QueryStringFilter){var b=new OpenLayers.Format.QueryStringFilter({wildcarded:this.wildcarded,srsInBBOX:this.srsInBBOX});this.filterToParams=
function(a,d){return b.write(a,d)}}},destroy:function(){this.headers=this.params=null;OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(a){OpenLayers.Protocol.prototype.read.apply(this,arguments);a=a||{};a.params=OpenLayers.Util.applyDefaults(a.params,this.options.params);a=OpenLayers.Util.applyDefaults(a,this.options);a.filter&&this.filterToParams&&(a.params=this.filterToParams(a.filter,a.params));var b=void 0!==a.readWithPOST?a.readWithPOST:this.readWithPOST,c=new OpenLayers.Protocol.Response({requestType:"read"});
b?(b=a.headers||{},b["Content-Type"]="application/x-www-form-urlencoded",c.priv=OpenLayers.Request.POST({url:a.url,callback:this.createCallback(this.handleRead,c,a),data:OpenLayers.Util.getParameterString(a.params),headers:b})):c.priv=OpenLayers.Request.GET({url:a.url,callback:this.createCallback(this.handleRead,c,a),params:a.params,headers:a.headers});return c},handleRead:function(a,b){this.handleResponse(a,b)},create:function(a,b){var b=OpenLayers.Util.applyDefaults(b,this.options),c=new OpenLayers.Protocol.Response({reqFeatures:a,
requestType:"create"});c.priv=OpenLayers.Request.POST({url:b.url,callback:this.createCallback(this.handleCreate,c,b),headers:b.headers,data:this.format.write(a)});return c},handleCreate:function(a,b){this.handleResponse(a,b)},update:function(a,b){var b=b||{},c=b.url||a.url||this.options.url+"/"+a.fid,b=OpenLayers.Util.applyDefaults(b,this.options),d=new OpenLayers.Protocol.Response({reqFeatures:a,requestType:"update"});d.priv=OpenLayers.Request[this.updateWithPOST?"POST":"PUT"]({url:c,callback:this.createCallback(this.handleUpdate,
d,b),headers:b.headers,data:this.format.write(a)});return d},handleUpdate:function(a,b){this.handleResponse(a,b)},"delete":function(a,b){var b=b||{},c=b.url||a.url||this.options.url+"/"+a.fid,b=OpenLayers.Util.applyDefaults(b,this.options),d=new OpenLayers.Protocol.Response({reqFeatures:a,requestType:"delete"}),e=this.deleteWithPOST?"POST":"DELETE",c={url:c,callback:this.createCallback(this.handleDelete,d,b),headers:b.headers};this.deleteWithPOST&&(c.data=this.format.write(a));d.priv=OpenLayers.Request[e](c);
return d},handleDelete:function(a,b){this.handleResponse(a,b)},handleResponse:function(a,b){var c=a.priv;b.callback&&(200<=c.status&&300>c.status?("delete"!=a.requestType&&(a.features=this.parseFeatures(c)),a.code=OpenLayers.Protocol.Response.SUCCESS):a.code=OpenLayers.Protocol.Response.FAILURE,b.callback.call(b.scope,a))},parseFeatures:function(a){var b=a.responseXML;if(!b||!b.documentElement)b=a.responseText;return!b||0>=b.length?null:this.format.read(b)},commit:function(a,b){function c(a){for(var b=
a.features?a.features.length:0,c=Array(b),e=0;e<b;++e)c[e]=a.features[e].fid;s.insertIds=c;d.apply(this,[a])}function d(a){this.callUserCallback(a,b);r=r&&a.success();f++;f>=m&&b.callback&&(s.code=r?OpenLayers.Protocol.Response.SUCCESS:OpenLayers.Protocol.Response.FAILURE,b.callback.apply(b.scope,[s]))}var b=OpenLayers.Util.applyDefaults(b,this.options),e=[],f=0,g={};g[OpenLayers.State.INSERT]=[];g[OpenLayers.State.UPDATE]=[];g[OpenLayers.State.DELETE]=[];for(var h,j,n=[],p=0,q=a.length;p<q;++p)if(h=
a[p],j=g[h.state])j.push(h),n.push(h);var m=(0<g[OpenLayers.State.INSERT].length?1:0)+g[OpenLayers.State.UPDATE].length+g[OpenLayers.State.DELETE].length,r=!0,s=new OpenLayers.Protocol.Response({reqFeatures:n});h=g[OpenLayers.State.INSERT];0<h.length&&e.push(this.create(h,OpenLayers.Util.applyDefaults({callback:c,scope:this},b.create)));h=g[OpenLayers.State.UPDATE];for(p=h.length-1;0<=p;--p)e.push(this.update(h[p],OpenLayers.Util.applyDefaults({callback:d,scope:this},b.update)));h=g[OpenLayers.State.DELETE];
for(p=h.length-1;0<=p;--p)e.push(this["delete"](h[p],OpenLayers.Util.applyDefaults({callback:d,scope:this},b["delete"])));return e},abort:function(a){a&&a.priv.abort()},callUserCallback:function(a,b){var c=b[a.requestType];c&&c.callback&&c.callback.call(c.scope,a)},CLASS_NAME:"OpenLayers.Protocol.HTTP"});
OpenLayers.Layer.UTFGrid=OpenLayers.Class(OpenLayers.Layer.XYZ,{isBaseLayer:!1,projection:new OpenLayers.Projection("EPSG:900913"),useJSONP:!1,tileClass:OpenLayers.Tile.UTFGrid,initialize:function(a){OpenLayers.Layer.Grid.prototype.initialize.apply(this,[a.name,a.url,{},a]);this.tileOptions=OpenLayers.Util.extend({utfgridResolution:this.utfgridResolution},this.tileOptions)},createBackBuffer:function(){},clone:function(a){null==a&&(a=new OpenLayers.Layer.UTFGrid(this.getOptions()));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,
[a])},getFeatureInfo:function(a){var b=null;(a=this.getTileData(a))&&a.tile&&(b=a.tile.getFeatureInfo(a.i,a.j));return b},getFeatureId:function(a){var b=null,a=this.getTileData(a);a.tile&&(b=a.tile.getFeatureId(a.i,a.j));return b},CLASS_NAME:"OpenLayers.Layer.UTFGrid"});
OpenLayers.Control.UTFGrid=OpenLayers.Class(OpenLayers.Control,{autoActivate:!0,layers:null,defaultHandlerOptions:{delay:300,pixelTolerance:4,stopMove:!1,single:!0,"double":!1,stopSingle:!1,stopDouble:!1},handlerMode:"click",setHandler:function(a){this.handlerMode=a;this.resetHandler()},resetHandler:function(){this.handler&&(this.handler.deactivate(),this.handler.destroy(),this.handler=null);"hover"==this.handlerMode?this.handler=new OpenLayers.Handler.Hover(this,{pause:this.handleEvent,move:this.reset},
this.handlerOptions):"click"==this.handlerMode?this.handler=new OpenLayers.Handler.Click(this,{click:this.handleEvent},this.handlerOptions):"move"==this.handlerMode&&(this.handler=new OpenLayers.Handler.Hover(this,{pause:this.handleEvent,move:this.handleEvent},this.handlerOptions));return this.handler?!0:!1},initialize:function(a){a=a||{};a.handlerOptions=a.handlerOptions||this.defaultHandlerOptions;OpenLayers.Control.prototype.initialize.apply(this,[a]);this.resetHandler()},handleEvent:function(a){if(null==
a)this.reset();else{var b=this.map.getLonLatFromPixel(a.xy);if(b){var c=this.findLayers();if(0<c.length){for(var d={},e,f,g=0,h=c.length;g<h;g++)e=c[g],f=OpenLayers.Util.indexOf(this.map.layers,e),d[f]=e.getFeatureInfo(b);this.callback(d,b,a.xy)}}}},callback:function(){},reset:function(){this.callback(null)},findLayers:function(){for(var a=this.layers||this.map.layers,b=[],c,d=a.length-1;0<=d;--d)c=a[d],c instanceof OpenLayers.Layer.UTFGrid&&b.push(c);return b},CLASS_NAME:"OpenLayers.Control.UTFGrid"});
OpenLayers.Protocol.WFS.v1_1_0=OpenLayers.Class(OpenLayers.Protocol.WFS.v1,{version:"1.1.0",initialize:function(a){OpenLayers.Protocol.WFS.v1.prototype.initialize.apply(this,arguments);this.outputFormat&&!this.readFormat&&("gml2"==this.outputFormat.toLowerCase()?this.readFormat=new OpenLayers.Format.GML.v2({featureType:this.featureType,featureNS:this.featureNS,geometryName:this.geometryName}):"json"==this.outputFormat.toLowerCase()&&(this.readFormat=new OpenLayers.Format.GeoJSON))},CLASS_NAME:"OpenLayers.Protocol.WFS.v1_1_0"});
OpenLayers.Format.WMSCapabilities.v1_1_1=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1,{version:"1.1.1",readers:{wms:OpenLayers.Util.applyDefaults({SRS:function(a,b){b.srs[this.getChildValue(a)]=!0}},OpenLayers.Format.WMSCapabilities.v1_1.prototype.readers.wms)},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1_1"});
(function(a,b){a.M={VERSION_NUMBER:"mapshup 2.5",Plugins:{},load:function(b){var d=null,e=this,f=e.Util.extractKVP(a.location.href),b=b||{};void 0===e.Config&&(alert("GRAVE : no configuration file defined. Load aborted"),exit());e.Config.panels=e.Config.panels||{};$.extend(e.Config.panels,{south:e.Config.panels.south||{},side:e.Config.panels.side||{}});if(a.location.hash){var g,h,j=a.location.hash.split(":");try{g=e.Map.Util.Geohash.decode(j[0]),f.lon=g.lon,f.lat=g.lat,h=parseInt(j[1]),f.zoom=!isNaN(h)?
h:9}catch(n){}}0===$("#mapshup").length&&(alert('GRAVE : no <div id="mapshup"> defined. Load aborted'),exit());$("#mapshup").append('<div id="wcontainer"><div id="mapcontainer"><div id="map"></div></div></div>');e.$header=e.Util.$$("#theBar",$("#mapshup")).addClass("shadow").html('<div class="container"><div class="logo hover"><a href="http://www.mapshup.info" target="_blank">mapshup</a></div><div class="searchBar"></div><div class="leftBar"></div><div class="userBar"></div></div>');e.$map=$("#map");
e.$mcontainer=$("#mapcontainer");e.$container=$("#wcontainer");e.events=new e.Events;e.tooltip=new e.Tooltip;e.activity=new e.Activity;e.mask=new e.Mask;e.TimeLine&&(e.timeLine=new e.TimeLine(e.Config.general.timeLine));e.sidePanel=new e.SidePanel({over:e.Config.panels.side.over,position:e.Config.panels.side.position,w:e.Config.panels.side.w});e.southPanel=new e.SouthPanel({over:e.Config.panels.south.over,h:e.Config.panels.south.h});if(f.uid)e.Util.ajax({url:e.Util.proxify(e.Util.getAbsoluteUrl(e.Config.general.getContextServiceUrl)+
f.uid),async:!0,dataType:"json",success:function(a){a&&a.contexts&&a.contexts[0]&&(d=JSON.parse(a.contexts[0].context));e.setLang(f,{context:d,i18n:b.i18n})},error:function(){e.Util.message("Error : context is not loaded");e.setLang(f,{i18n:b.i18n})}},{title:e.Util._("Load context"),cancel:!0});else if(f.layers)try{var p=JSON.parse(decodeURIComponent(f.layers.replace(a.location.hash,"")));$.isArray(p)||(p=[p]);i=0;for(l=p.length;i<l;i++)e.Config.add("layers",p[i]);e.setLang(f,{i18n:b.i18n})}catch(q){M.Util.message("Error : cannot read input layer"),
e.setLang(f,{i18n:b.i18n})}else e.setLang(f,{i18n:b.i18n})},setLang:function(a,d){var e,f=-1,g=-1,h=this,j=h.Config.i18n,d=d||{};a.lang&&(j.lang=a.lang);j.langs=j.langs||["en","fr"];h.i18n=[];if(!j.lang||"auto"===j.lang)try{j.lang=b.language}catch(n){j.lang=b.browserLanguage}for(e=j.langs.length;e--;)if(j.langs[e]===j.lang){f=0;break}if(-1===f){g=-1;void 0!==j.lang&&(j.lang=j.lang.substring(0,2));for(e=j.langs.length;e--;)if(j.langs[e]===j.lang){g=0;break}-1===g&&(j.lang=j.langs[0])}$.ajax({url:h.Config.general.rootUrl+
j.path+"/"+j.lang+".js",async:!0,dataType:"script",success:function(){if(d.i18n&&d.i18n[j.lang])for(var b in d.i18n[j.lang])M.i18n[b]=d.i18n[j.lang][b];h.init(a,d.context)},error:function(){$.ajax({url:h.Config.general.rootUrl+j.path+"/en.js",async:!0,dataType:"script",success:function(){j.lang="en";h.init(a,d.context)}})}})},init:function(b,d){var e,f,g,h,j,n,p=this,q=p.Config;d&&d.location&&(q.general.location=d.location);b&&(q.general.location={bg:p.Util.getPropertyValue(b,"bg",q.general.location.bg),
lon:p.Util.getPropertyValue(b,"lon",q.general.location.lon),lat:p.Util.getPropertyValue(b,"lat",q.general.location.lat),zoom:p.Util.getPropertyValue(b,"zoom",q.general.location.zoom)});p.menu=new p.Menu;p.Map.init(q);d&&d.layers&&q.update(d.layers);p.plugins=[];e=0;for(g=q.plugins.length;e<g;e++)h=q.plugins[e].name,j=q.plugins[e].options||{},(n=(new Function("return M.Plugins."+h+" ? new M.Plugins."+h+"() : null;"))())&&n.init(j)&&(p.plugins[h]=n);e=0;for(g=q.layers.length;e<g;e++)q.layers[e].type&&
p.Map.layerTypes[q.layers[e].type]&&p.Map.addLayer(q.layers[e],{noDeletionCheck:!0,initial:!0});q.general.location.bg&&(e=p.Map.Util.getLayerByMID(q.general.location.bg))&&e.isBaseLayer&&p.Map.setBaseLayer(e);p._wd={w:a.innerWidth,h:a.innerHeight};p.$mcontainer.css({width:p.$mcontainer.width(),height:p.$mcontainer.height()});$(a).bind("resize",function(){clearTimeout(f);f=setTimeout(function(){$("#mapshup").hasClass("noResizeWidth")||p.$mcontainer.css({width:p.$mcontainer.width()+(a.innerWidth-p._wd.w)});
$("#mapshup").hasClass("noResizeHeight")||p.$mcontainer.css({height:p.$mcontainer.height()+(a.innerHeight-p._wd.h)});p._wd={w:a.innerWidth,h:a.innerHeight};p.events.trigger("resizeend")},100)});setTimeout(function(){p.events.trigger("resizeend")},1E3);$(a).bind("drop dragover",function(a){a.preventDefault();return!1})},remove:function(a){if(!a)return!1;a.$d&&a.$d.remove();this.events.unRegister(a);this.Map.events.unRegister(a);for(var b in a)a.hasOwnProperty(b)&&delete a[b];return!0}}})(window,navigator);
(function(a){a=a||{};a.Config={general:{location:{lon:0,lat:0,zoom:0}},groups:[],i18n:{},layers:[],mapOptions:{projection:new OpenLayers.Projection("EPSG:3857"),displayProjection:new OpenLayers.Projection("EPSG:4326"),numZoomLevels:22},plugins:[],upload:{},add:function(a,c){var d=this[a];$.isArray(d)&&(c&&this.get(a,"name",c.name)&&this.remove(a,c.name),d.push(c))},extend:function(a,c){var d,e,f;d=0;for(e=this.plugins.length;d<e;d++)this.plugins[d].name===a&&(f=this.plugins[d],f.options=f.options||
{},$.extend(f.options,c))},get:function(a,c,d){a=this[a];if($.isArray(a))for(var e=0,f=a.length;e<f;e++)if(a[e][c]===d)return a[e];return null},remove:function(a,c){var d,e,f,g=this[a];if(g instanceof Array&&c){f="layers"===a?"title":"name";d=0;for(e=g.length;d<e;d++)if(g[d][f]===c){g.splice(d,1);break}}},update:function(b){var c,d,e,f,g;if(!a.Map)return!1;b=b||[];for(c=0;c<this.layers.length;c++){g=!0;e=0;for(f=b.length;e<f;e++)if((new a.Map.LayerDescription(this.layers[c],a.Map)).getMID()===(new a.Map.LayerDescription(b[e],
a.Map)).getMID()){g=!1;break}g&&(this.layers.splice(c,1),c--)}c=0;for(d=b.length;c<d;c++){g=!0;e=0;for(f=this.layers.length;e<f;e++)if((new a.Map.LayerDescription(b[c],a.Map)).getMID()===(new a.Map.LayerDescription(this.layers[e],a.Map)).getMID()){g=!1;break}g?this.layers.push(b[c]):(this.layers[e].hidden=b[c].hidden,b[c].search&&(this.layers[e].search=b[c].search))}return!0}}})(window.M);
(function(a,b,c){var d=b=b||{},e;e=Math.round(865*Math.random());var f=Math.round(757*Math.random());e="&a="+e+"&b="+f+"&c="+(e+17-3*(f-2));var g,f=navigator.userAgent.toLowerCase();-1!==f.indexOf("android")?(f="android",g=!0):-1!==f.indexOf("iphone")?(f="iphone",g=!0):-1!==f.indexOf("ipod")?(f="ipod",g=!0):-1!==f.indexOf("ipad")?(f="ipad",g=!0):(f="normal",g=!1);d.Util={messages:[],abc:e,Cookie:{get:function(a){var a=a+"=",b=c.cookie.split(";"),d,e,f;d=0;for(e=b.length;d<e;d++){for(f=b[d];" "===
f.charAt(0);)f=f.substring(1,f.length);if(0===f.indexOf(a))return f.substring(a.length,f.length)}return null},remove:function(a){this.set(a,"",-1)},set:function(a,d,e){var f,g,m;f=new Date;e?(f.setTime(f.getTime()+864E5*e),e="; expires="+f.toGMTString()):e="";m=b.Config.general.rootUrl.substr(7,b.Config.general.rootUrl.length);g=m.indexOf("/");-1===g?(f=m,g="/"):(f=m.substr(0,g),g=m.substr(g,m.length));c.cookie=a+"="+d+e+"; domain="+f+"; path="+g}},device:{type:f,touch:g},escapable:/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
meta:{"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},sequence:0,_:function(a){if(void 0===b.i18n)return a;var c=b.i18n[a];return"string"===typeof c?c:a},$$:function(a,b){var b=b||"body",c=$(a,b);0===c.length&&(c="."===a.substring(0,1)?"class":"id",$(b).append("<div "+c+'="'+a.substring(1,a.length)+'"></div>'),c=$(a));return c},addClose:function(a,c){var d=b.Util.getId();a.append('<span id="'+d+'" class="close" title="'+b.Util._("close")+'"></span>');$("#"+d).click(function(b){$.isFunction(c)?
c(b):a.hide()})},clone:function(a){if("object"!==typeof a||null===a)return a;var b,c=a.constructor();for(b in a)c[b]=this.clone(a[b]);return c},getCapabilities:function(a,c){var d=null;if(200!==a.status||!c)return null;try{d=c.read(b.Util.textToXML(a.responseText))}catch(e){b.Util.message(b.Util._("Error reading Capabilities file"))}return d},getHashSize:function(a){var b,c=0;for(b in a)c++;return c},getTitle:function(a){a=a||{};return a.title?a.title:(a.type||"Unknown")+"#"+this.sequence++},getUserInfo:function(){var a=
b.Plugins.LayersManager;return a&&a._o&&a._o.userInfo?a._o.userInfo:{userid:-1}},extendUrl:function(a,b){var c,d,e,f,g,s={},t="",v=a.split("?")[0];try{g=a.split("?")[1].split("&")}catch(u){g=[]}e=0;for(f=g.length;e<f;e++)c=g[e].split("=")[0],d=g[e].split("=")[1],c&&d&&(s[c]=d);b=$.extend(s,b);for(c in b)null!==b[c]&&(t+=c+"="+b[c]+"&");return v+"?"+t},showPopupImage:function(c,d){var e=new b.Popup({modal:!0,resize:!1,autoSize:!0,noHeader:!0}),f=new Image;b.activity.show();e.hide();e.$m.show();f.src=
c;$(f).load(function(){var g=[f.width,f.height,0.8*a.innerWidth,0.8*a.innerHeight],m=g[0],r=g[1];r>g[3]&&(r=g[3],m=m*r/g[1]);m>g[2]&&(m=g[2],r=r*m/g[0]);e.$b.html('<div class="imageContent"><div class="padded"><img src="'+c+'" height="'+r+'" width="'+m+'"/><div class="innerTitle" style="width:'+m+'px;">'+d+"</div></div></div>");e.$d.css({left:(a.innerWidth-e.$d.width())/2,top:0});b.activity.hide();e.show()}).error(function(){b.activity.hide();e.hide();b.Util.message("Error loading image")})},showPopupVideo:function(c){var d,
e,f,g,m=new b.Popup({modal:!0,resize:!1,autoSize:!0,noHeader:!0}),c=c||{};if(!c.url)return this.message(this._("Error : url is not defined")),!1;e=c.w||640;f=c.h||264;g=c.img||"";(d=c.type)||(d=c.url.substring(c.url.length-3,c.url.length).toLowerCase());switch(d){case "ogg":d="video/ogg";break;case "webm":d="video/webm";break;default:d="video/mp4"}m.$m.show();c='<video width="'+e+'" height="'+f+'" controls><source src="'+c.url+'" type="'+d+'" /><object width="'+e+'" height="'+f+'" type="application/x-shockwave-flash" data="http://releases.flowplayer.org/swf/flowplayer-3.2.1.swf"><param name="movie" value="http://releases.flowplayer.org/swf/flowplayer-3.2.1.swf" /><param name="allowfullscreen" value="true" /><param name="flashvars" value="controlbar=over&amp;image='+
g+"&amp;file="+c.url+'" /><img src="'+g+'" width="'+e+'" height="'+f+'" alt="'+c.title+'" title="'+c.title+'"/></object></video><p class="vjs-no-video"><a href="'+c.url+'" target="_blank">'+this._("Download Video")+"</a></p></div>";m.$b.html('<div class="imageContent"><div class="padded">'+c+"</div></div>");m.$d.css({left:(a.innerWidth-m.$d.width())/2,top:(a.innerHeight-m.$d.height())/2});m.show();return!0},stringToRealType:function(a){return!a?a:$.isNumeric(a)?parseFloat(a):"true"===a.toLowerCase()?
!0:"false"===a.toLowerCase()?!1:a},getAttributes:function(a){var c,d,e={};if(a&&a.length){a=a[0].attributes;c=0;for(d=a.length;c<d;c++)e[b.Util.stripNS(a[c].nodeName)]=b.Util.stringToRealType(a[c].nodeValue)}return e},stripNS:function(a){if(!a)return null;a=a.split(":");return 2===a.length?a[1]:a[0]},stripTags:function(a){var b=c.createElement("DIV");b.innerHTML=a;return b.textContent||b.innerText},ajax:function(a,c){var d;if("object"!==typeof a)return null;if(c){var e=this.getId();a.complete=function(){b.mask.abort(e)};
d=$.ajax(a);b.mask.add({title:c.title||this._("Processing"),cancel:!0===c.cancel?c.cancel:!1,id:e,request:d})}else d=$.ajax(a);return d},askFor:function(a){var a=a||{},c,d,e=this,f=[],g=new b.Popup({modal:!0,autoSize:!0,centered:!0,header:a.title,body:a.content?a.content:""});if("list"===a.dataType){var r,s,t=0,v;for(v in a.value)c=this.getId(),r=a.value[v],s=r.icon?'<img class="middle" src="'+r.icon+'"/>&nbsp;':"",g.append('<a href="#" class="button marged" id="'+c+'">'+s+r.title+"</a>","body"),
function(a,b,c,d){b.click(function(){$.isFunction(c)&&c(d);a.remove();return!1})}(g,$("#"+c),a.callback,r.value),t++}else"complexData"===a.dataType?(c=this.getId(),b.DDZone&&new b.DDZone({parent:g.$b,maximumMegaBytes:a.maximumMegaBytes,supportedFormats:a.supportedFormats,file:a.file,fileUrl:a.fileUrl,success:function(a){g.center();d=a;$("#"+c).show()}}),g.append('<p class="big center padded"><br/><a href="#" class="button inline validate" id="'+c+'">'+b.Util._("Set")+"</a></p>","body"),$("#"+c).click(function(){a.upload&&
d.file?e.upload(d.file,{formats:a.supportedFormats,maximumMegabytes:a.maximumMegaBytes,callback:function(c){$.isArray(c)?($.isFunction(a.callback)&&a.callback({fileUrl:c[0].url}),g.remove()):b.Util.message("Error : cannot upload file on server")}}):($.isFunction(a.callback)&&a.callback(d),g.remove())}),!a.file&&!a.fileUrl&&$("#"+c).hide()):(c=this.getId(),g.append('<input id="'+c+'" type="text" size="'+(a.size||10)+'"/>',"body"),f=$("#"+c),a.value?f.val(this.stripTags(a.value)):a.hint&&f.attr("placeholder",
a.hint),f.focus(function(){this.select()}).keypress(function(b){var c=!1,d=e.stripTags($(this).val());27===b.keyCode&&g.remove();if(13===b.keyCode||9===b.keyCode){switch(a.dataType.toLowerCase()){case "date":e.isDateOrInterval(d)||e.isISO8601(d)?c=!0:e.message(e._("Expected format is YYYY-MM-DD for a single date or YYYY-MM-DD/YYYY-MM-DD for a date interval"));break;case "bbox":e.isBBOX(d)?c=!0:e.message(e._("Expected format is lonmin,latmin,lonmax,latmax"));break;case "integer":e.isInt(d)?c=!0:e.message(e._("Error : not a valid Integer"));
break;case "float":e.isFloat(d)?c=!0:e.message(e._("Error : not a valid Float"));break;case "double":e.isFloat(d)?c=!0:e.message(e._("Error : not a valid Double"));break;case "boolean":e.isBoolean(d)?c=!0:e.message(e._("Error : not a valid Boolean"));break;default:c=!0}c&&($.isFunction(a.callback)&&a.callback(d),g.remove());return!1}}));g.show();0<f.length&&f.focus();return g},crc32:function(b,c){var d=0;c===a.undefined&&(c=0);for(var c=c^-1,e=0,f=b.length;e<f;e++)d=(c^b.charCodeAt(e))&255,d="0x"+
"00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D".substr(9*
d,8),c=c>>>8^d;return"mid"+Math.abs(c^-1)},message:function(a,c){var d,e,f,g=this;e=g.getId();b.$container.append('<div id="'+e+'" class="message"><div class="content"></div></div>');d=$("#"+e);g.messages[e]=d;f=function(){var a,b,c=30;for(b in g.messages)a=g.messages[b],a.css({top:c}),c=a.position().top+a.height()+5};e=$(".content",d).html(a);g.addClose(e,function(){delete g.messages[d.attr("id")];d.remove();f()});c&&-1===c?(d.show(),f()):d.fadeIn("slow").delay(c||2E3).fadeOut("slow",function(){delete g.messages[d.attr("id")];
d.remove();f()});d.css({left:(b.$container.width()-d.width())/2,top:30});return d},encode:function(a){return!a?a:a.replace(/[',", ,\.,#,\:,\ ]/g,"_")},extractBaseUrl:function(a,b){var c;c=this.repareUrl(a);if(!c)return null;c=c.match(/.+\?/)[0];if(!b||0===b.length)return c;var d,e,f,g,s=this.extractKVP(a,!0);for(e in s){d=!0;f=0;for(g=b.length;f<g;f++)if(e===b[f]){d=!1;break}d&&(c+=encodeURIComponent(e)+"="+encodeURIComponent(s[e])+"&")}return c},extractKVP:function(a,b){var c={};(a||"").replace(/[?&]+([^=&]+)=([^&]*)/gi,
function(a,d,e){c[decodeURIComponent(b?d.toLowerCase():d)]=void 0===e?!0:decodeURIComponent(e)});return c},getAbsoluteUrl:function(a){return a&&b.Config.general.serverRootUrl?"object"===typeof a?a:this.isUrl(a)||"/"!==a.substr(0,1)?a:b.Config.general.serverRootUrl+a:a},getId:function(){return"mid"+this.sequence++},getImgUrl:function(a){return!a||"http:"===a.substr(0,5)||"https:"===a.substr(0,6)||"data:"===a.substr(0,5)?a:b.Config.general.rootUrl+b.Config.general.themePath+"/img/"+a},getPropertyValue:function(a,
b,c){return void 0===a||void 0===b?void 0:a.hasOwnProperty(b)?a[b]:c},getValidBBOX:function(a,b){if(void 0===a)return b;"string"===typeof a&&(a={bounds:a,srs:"EPSG:4326"});return a.hasOwnProperty("bounds")?a:b},isBoolean:function(a){return"boolean"===typeof a?!0:"true"===a||"false"===a?!0:!1},isInt:function(a){return!$.isNumeric(a)?!1:!(parseFloat(a)%1)},isFloat:function(a){return $.isNumeric(a)},isBBOX:function(a){if(!a||0===a.length)return!1;a=a.split(",");if(4!==a.length)return!1;for(var b=0;3>
b;b++)if(!$.isNumeric(a[b]))return!1;return parseFloat(a[0])>parseFloat(a[2])||parseFloat(a[1])>parseFloat(a[3])?!1:!0},isDate:function(a){if(!a||0===a.length)return!1;var b=[31,29,31,30,31,30,31,31,30,31,30,31],a=a.split("-");if(3!==a.length)return!1;var c=parseInt(a[0],10),d=parseInt(a[1],10),e=parseInt(a[2],10);return 4!==a[0].length||1900>c||2100<c||2!==a[1].length||1>d||12<d||2!==a[2].length||1>e||31<e||2===d&&e>(0===c%4&&(0!==c%100||0===c%400)?29:28)||e>b[d]?!1:!0},isDateOrInterval:function(a){if(void 0===
a||0===a.length)return!1;var a=a.split("/"),b=0,c,d;if(2<a.length)return!1;c=0;for(d=a.length;c<d;c++)if(!this.isDate(a[c]))if(""===a[c])b++;else return!1;return 1>a.length-b?!1:!0},isEmailAdress:function(a){return!a||0===a.length?!1:/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+.[a-zA-Z]{2,4}$/.test(a)},isSupportedMimeType:function(a,b){var a=a||[],c,d=a.length;if(0===d)return!0;for(c=0;c<d;c++)if(a[c].mimeType.toLowerCase()===b.toLowerCase())return!0;return!1},isISO8601:function(a){if(void 0===a||0===a.length)return!1;
a=a.split("/");if(2<a.length)return!1;for(var b,c=0,d=a.length;c<d;c++)if(b=a[c].split("T"),2!==b.length||!this.isDate(b[0])||!this.isTime(b[1]))return!1;return!0},isTime:function(a){if(!a||0===a.length)return!1;a.indexOf("Z")===a.length-1&&(a=a.substring(0,a.length-1));a=a.split(":");if(3!==a.length)return!1;var b=parseInt(a[0],10),c=parseInt(a[1],10),d=parseInt(a[2],10);return 2!==a[0].length||0>b||23<b||2!==a[1].length||0>c||59<c||2!==a[2].length||0>d||59<d?!1:!0},isUrl:function(a){if(a&&"string"===
typeof a){var b=a.substr(0,7);if("http://"===b||"https:/"===b||"ftp://"===b||"//"===a.substr(0,2))return!0}return!1},paginate:function(a,b){b&&(b.nextRecord&&(a=this.repareUrl(a)+b.nextRecord.name+"="+b.nextRecord.value),b.numRecordsPerPage&&(a=this.repareUrl(a)+b.numRecordsPerPage.name+"="+b.numRecordsPerPage.value));return a},proxify:function(a,c){return b.Config.general.proxyUrl&&""!==b.Config.general.proxyUrl?this.getAbsoluteUrl(b.Config.general.proxyUrl)+this.abc+(c?"&returntype="+c:"")+"&url="+
encodeURIComponent(a):a},randomColor:function(){var a="0123456789abcdef".split(""),b="",c="",d="",e;for(e=0;2>e;e++)b+=a[Math.round(15*Math.random())],c+=a[Math.round(15*Math.random())],d+=a[Math.round(15*Math.random())];return"#"+b+c+d},parseTemplate:function(a,b,c){b=b||{};c=c||{};return"string"===typeof a?a.replace(/\$+([^\$])+\$/g,function(a){var d,a=a.replace(/[\$\$]/g,""),e=b[a];for(d in c)if(a===d){if($.isFunction(c[d].transform))return c[d].transform(e);break}return null!=e?e:"$"+a+"$"}):
a},repareUrl:function(a){if(!a)return null;var b=a.indexOf("?");return-1===b?a+"?":b===a.length-1||-1!==a.indexOf("&",a.length-1)?a:a+"&"},shorten:function(a,b,d){if(!a)return null;var e=c.createElement("textarea");e.innerHTML=a.replace(/</g,"&lt;").replace(/>/g,"&gt;");if(a=e.value){e=a.length;if(e<=b)return a;if(d)return a.substring(0,b-3)+"...";b=Math.round(b/2);return a.substring(0,b-1)+"..."+a.substring(e-b+3)}return a},findAndShorten:function(a,c){$("[class^=shorten]",a).each(function(){var a,
d,e=30,f=$(this).attr("class").split(" ");a=0;for(d=f.length;a<d;a++)0===f[a].indexOf("shorten")&&(e=parseInt(f[a].split("_")[1]));$(this).html(b.Util.shorten($(this).text(),e,c))})},sortArray:function(a,b){if("object"===typeof a&&a.length&&b){var c=this;a.sort(function(a,d){var e=c._(a[b]).toLowerCase(),f=c._(d[b]).toLowerCase();return e<f?-1:e>f?1:0})}},textToXML:function(b){try{var c,d,e=null;if(a.DOMParser)return c=new DOMParser,e=c.parseFromString(b,"text/xml"),d=e.getElementsByTagName("parsererror"),
!d||!d.length||!d[0].childNodes.length?e:null;e=new ActiveXObject("Microsoft.XMLDOM");e.async=!1;e.loadXML(b);return e}catch(f){return null}},lowerFirstLetter:function(a){return a.charAt(0).toLowerCase()+a.slice(1)},upload:function(a,c){var d,e,f,g=[],r=this,c=c||{};$.isArray(a)||(a=[a]);b.mask.add({title:this._("Upload files")+"...",cancel:!1});$(a).each(function(a,d){if(!r.isSupportedMimeType(c.formats,d.type))return r.message(b.Util._("Error : mimeType is not supported")+" ["+d.type+"]"),!1;if(d.size/
1048576>c.maximumMegabytes)return r.message(b.Util._("Error : file is to big")+" ["+d.name+"]"),!1;g.push(d);return!0});if(0<g.length){$.get("./blank.html");var s=new XMLHttpRequest;s.onreadystatechange=function(){var a;if(4===s.readyState&&(200===s.status||0===s.status))b.mask.hide(),a=JSON.parse(s.responseText),a.error?b.Util.message(a.error.message):a.items&&$.isFunction(c.callback)&&c.callback(a.items)};if("undefined"!==typeof FormData){f=new FormData;f.append("path","/");d=0;for(e=a.length;d<
e;d++)f.append("file[]",a[d]);s.open("POST",b.Util.getAbsoluteUrl(b.Config.upload.serviceUrl)+b.Util.abc+"&magic=true");s.send(f)}else b.Util.message("Error : your browser does not support HTML5 Drag and Drop")}else b.Util.message("Error : this file type is not allowed"),b.mask.hide()}}})(window,window.M,window.document);
(function(a){a.Events=function(){if(a.Events._o)return a.Events._o;this.events={resizeend:[],signin:[],signout:[]};this.register=function(a,c,d){this.events[a]&&this.events[a].push({scope:c,handler:d})};this.unRegister=function(a){var c,d,e,f;for(e in this.events){c=this.events[e];d=0;for(f=c.length;d<f;d++)if(c[d].scope===a){c.splice(d,1);break}}};this.trigger=function(a,c){var d,e=this.events[a];if(e)for(d=e.length;d--;)e[d].handler(e[d].scope,c)};a.Events._o=this;return this}})(window.M);
(function(a){a.Activity=function(){if(a.Activity._o)return a.Activity._o;this.frame=this.timer=1;this.hide=function(){this.$a.hide()};this.init=function(){this.$c=a.$container;this.$a=a.Util.$$("#activity",this.$c).css({display:"none",position:"fixed",top:"50%",left:"50%",width:"40px",height:"40px","margin-top":"-20px","margin-left":"0px",overflow:"hidden","z-index":"38500"}).html("<div></div>");this.$a.children().css({position:"absolute",top:"0",left:"0",width:"40px",height:"480px","background-image":"url('"+
a.Util.getImgUrl("activity.png")+"')"});a.events.register("resizeend",this,function(a){a.$a.css({top:a.$c.offset().top+(a.$c.height()-a.$a.height())/2,left:a.$c.offset().left+(a.$c.width()-a.$a.width())/2})})};this.show=function(){var a=this;clearInterval(this.timer);this.$a.show();this.timer=setInterval(function(){a.$a.is(":visible")?($("div",a.$a).css("top",-40*a.frame+"px"),a.frame=(a.frame+1)%12):clearInterval(a.timer)},66)};this.init();a.Activity._o=this;return this}})(window.M);
(function(a){a.Toolbar=function(b){this.items=[];this.classes=b.classes;this.orientation=a.Util.getPropertyValue(b,"orientation",null);this.parent=a.Util.getPropertyValue(b,"parent",a.$map.parent());this.position=a.Util.getPropertyValue(b,"position",null);this.init=function(b){var d="tb",e="_o"+(this.position?this.position:a.Util.getId())+"tb";if(a.Toolbar[e])return a.Toolbar[e];a.Toolbar[e]=this;this.$d=a.Util.$$("#"+a.Util.getId(),this.parent);this.position&&this.$d.css({position:"absolute","z-index":"19500"});
this.orientation&&(d+=" tb"+this.orientation);this.position&&(d+=" tb"+this.position+(this.orientation?this.orientation:"h"));this.$d.addClass(d+(this.classes?" "+this.classes:""));if($.isArray(b.items)){d=0;for(e=b.items.length;d<e;d++)this.add(b.items[d])}return this};this.add=function(b){b=new a.Toolbar.Item(this,b);this.items.push(b);return b};this.activate=function(a,b){var e=this.get(a);e&&e.activate(b)};this.get=function(a){for(var b=0,e=this.items.length;b<e;b++)if(this.items[b].id===a)return this.items[b];
return null};this.remove=function(a){var b,e;b=0;for(e=this.items.length;b<e;b++)if(this.items[b].id===a){this.items[b].$d.remove();this.items.splice(b,1);break}};this.clear=function(){for(var a=0,b=this.items.length;a<b;a++)this.items[a].$d.remove();this.items=[]};return this.init(b)};a.Toolbar.Item=function(b,c){c=c||{};this.onoff=c.hasOwnProperty("onoff")?c.onoff:!0;this.onactivate=c.onactivate;this.ondeactivate=c.ondeactivate;this.e=c.e||{};this.first=a.Util.getPropertyValue(c,"first",!1);this.icon=
c.icon;this.id=c.id||a.Util.getId();this.nohover=c.nohover||!1;this.tb=b;this.title=c.title;this.tt=c.tt||"";this.scope=c.scope;this.init=function(){var b,c,f=this;if(!f.tb)return null;for(b in f.e)f.e.hasOwnProperty(b)&&(f[b]=f.e[b]);delete f.e;b=a.Util.getId();c='<div class="'+(f.nohover?"":"hover ")+'item" jtitle="'+(a.Util._(f.tt)||"")+'" id="'+b+'">'+(f.title?f.title:'<img class="middle" alt="" src="'+a.Util.getImgUrl(f.icon||"empty.png")+'"/>')+"</div>";f.first?f.tb.$d.prepend(c):f.tb.$d.append(c);
f.$d=$("#"+b);f.$d.click(function(){f.onoff?f.activate(!f.$d.hasClass("active")):f.activate(!0);return!1});f.tt&&(b=f.tb.orientation||"h",f.tb.position?a.tooltip.add(f.$d,"h"===b?f.tb.position.substr(0,1):f.tb.position.substr(1,2)):a.tooltip.add(f.$d,"h"===b?"n":"e"));return this};this.trigger=function(){this.$d.trigger("click")};this.activate=function(a){var b,c;if(a){a=0;for(b=this.tb.items.length;a<b;a++)if(c=this.tb.items[a],c.id!==this.id){if($.isFunction(c.ondeactivate))c.ondeactivate(c.scope,
c);c.$d.removeClass("active")}this.$d.addClass("active");if($.isFunction(this.onactivate))this.onactivate(this.scope,this)}else if(this.$d.removeClass("active"),$.isFunction(this.ondeactivate))this.ondeactivate(this.scope,this);return!0};return this.init()}})(window.M);
(function(a){a.Mask=function(){if(a.Mask._o)return a.Mask._o;this.activeRequests=[];this.init=function(){this.$m=a.Util.$$("#"+a.Util.getId(),a.$container).addClass("mask").css({position:"absolute",display:"none",left:"0",top:"0",width:"100%",height:"100%","z-index":"35000"}).html('<div class="content"><div class="loading"></div></div>');this.$l=$(".loading",this.$m)};this.abort=function(a){for(var c in this.activeRequests)if(a){if(c===a){this.activeRequests[c]&&this.activeRequests[c].abort();delete this.activeRequests[c];
$("#"+c).remove();break}}else this.activeRequests[c]&&this.activeRequests[c].abort(),delete this.activeRequests[c],$("#"+c).remove();$("#"+a).remove();0===this.$l.children().length&&this.hide()};this.add=function(b){var c=this;$.extend(b,{title:b.title||"",cancel:b.cancel||!1,layer:b.layer||null,id:b.id||a.Util.getId(),request:b.request||null});b.request&&(this.activeRequests[b.id]=b.request);b.cancel?(this.$l.append('<div id="'+b.id+'">'+b.title+'&nbsp;(<a href="#" id="aj'+b.id+'">'+a.Util._("Cancel")+
"</a>)</div>"),$("#aj"+b.id).click(function(){c.abort(b.id)})):this.$l.append('<div id="'+b.id+'">'+b.title+"</div>");b.layer&&a.Map.events.register("layersend",b,function(b,e,f){"remove"!=b&&e.id===f.layer.id&&(a.Map.events.unRegister(f),b=a.Plugins.LayersManager,e._tobedestroyed||b&&b._o&&b._o.show(b._o.get(e._M.MID)),c.abort(f.id))});this.show();return b.id};this.show=function(b){this.$m.show();b||a.activity.show()};this.hide=function(){this.$l.empty();this.$m.hide();a.activity.hide()};this.init();
a.Mask._o=this;return this}})(window.M);
(function(a){a.Tooltip=function(){if(a.Tooltip._o)return a.Tooltip._o;this.init=function(){this.$t=a.Util.$$("#mapshup-tooltip");this.c=null};this.add=function(b,c,d){var e=this,d=d||0;a.Util.device.touch||b.hover(function(){var a=$(this);if(a&&(e.c=e.c||[""],a[0]!==e.c[0])){e.c=a;e.$t.html('<div class="inner">'+a.attr("jtitle")+"</div>");var b=e.$t.width(),h=e.$t.height(),j=a.offset().top,n=a.offset().left,p=a.width(),a=a.height();switch(c){case "n":e.$t.css({top:j+a+5+d,left:n+p/2-b/2});break;case "s":e.$t.css({top:j-
h-20-d,left:n+p/2-b/2});break;case "e":e.$t.css({top:j+a/2-h/2,left:n-b-10-d});break;case "w":e.$t.css({top:j+a/2-h/2,left:n+p+10+d});break;case "nw":e.$t.css({top:j+a+5+d,left:n})}e.$t.show()}},function(){e.remove()})};this.remove=function(){this.$t.hide();this.c=null};this.init();a.Tooltip._o=this;return this}})(window.M);
(function(a){a.Menu=function(b){if(a.Menu._o)return a.Menu._o;this.lonLat=new OpenLayers.LonLat(0,0);this.isLoaded=!1;this.items=[];this.limit=b||0;this.isNull=!1;this.init=function(){if(this.isLoaded)return this;if(!a.Config.general.displayContextualMenu)return this.isNull=this.isLoaded=!0,this.$m=$(),this;a.$map.append('<div id="menu"><div class="cross"><img src="'+a.Util.getImgUrl("x.png")+'"</div></div>');this.$m=$("#menu");this.add([{id:a.Util.getId(),ic:"x.png",ti:"Close menu",cb:function(){}}]);
this.isLoaded=!0;return this};this.add=function(a){if(this.isNull)return!1;if($.isArray(a)){for(var b=0,e=a.length;b<e;b++)this.items.push(a[b]);this.refresh()}return!0};this.refresh=function(){var b,d,e,f,g=this,h=135,j=!0,n=g.items.length,p=180/n,q=40*Math.sqrt(n),m=1.3*q;$(".item",g.$m).remove();for(b=0;b<n;b++)(function(b,c){45<h&&135>h?(h=135+h,j=!0):225<h&&315>h&&(h=180-h+p,j=!1);f=h*Math.PI/180;j?(c.append('<div class="item right" id="'+b.id+'">'+a.Util._(b.ti)+'&nbsp;<img class="middle" src="'+
a.Util.getImgUrl(b.ic)+'"/></div>'),d=Math.cos(f)*q-200+80):(c.append('<div class="item left" id="'+b.id+'"><img class="middle" src="'+a.Util.getImgUrl(b.ic)+'"/>&nbsp;'+a.Util._(b.ti)+"</div>"),d=Math.cos(f)*q-80);e=Math.sin(f)*m-10;$("#"+b.id).click(function(){g.hide();b.cb(g);return!1}).css({left:Math.round(d),top:Math.round(e)});h+=p})(g.items[b],g.$m)};this.remove=function(a){for(var b=0,e=this.items.length;b<e;b++)if(this.items[b].id===a)return this.items.splice(b,1),this.refresh(),!0;return!1};
this.show=function(){var b,d;if(!this.isNull&&a.Map.mouseClick){b=a.Map.mouseClick.x;d=a.Map.mouseClick.y;if(d<this.limit||d>a.$map.height()-this.limit||b<this.limit||b>a.$map.width()-this.limit)return this.$m.hide(),!1;this.lonLat=a.Map.map.getLonLatFromPixel(a.Map.mouseClick)}else return!1;this.isLoaded||this.init();this.$m.css({left:b,top:d}).show();return!0};this.updatePosition=function(){if(this.isNull)return!1;var b=a.Map.map.getPixelFromLonLat(this.lonLat);this.$m.css({left:b.x,top:b.y});return!0};
this.hide=function(){if(this.isNull)return!1;this.$m.hide();return!0};this.init();a.Menu._o=this;return this}})(window.M);
(function(a){a.TabPaginator=function(b){this.target=b.target;this.$container=b.$container||a.$container;this.left=b.left||0;this.page=0;this.init=function(){var b=a.Util.getId(),d=a.Util.getId(),e=this;if(!e.target)return null;e.target.$d.append('<a id="'+b+'" class="tab ptab">&laquo;</a><a id="'+d+'" class="tab ptab">&raquo;</a>');e.$prev=$("#"+b).click(function(a){a.preventDefault();a.stopPropagation();e.goTo(e.page-1)}).css({left:e.left});e.$next=$("#"+d).click(function(a){a.preventDefault();a.stopPropagation();
e.goTo(e.page+1)}).css({left:e.$prev.offset().left+e.$prev.outerWidth()});a.events.register("resizeend",e,function(a){var b,c,d;a.refresh();if(a.target&&a.target.items){b=0;for(c=a.target.items.length;b<c;b++)d=a.target.items[b],$("ul",d.$d).css("left",0),a.updatePaginate(d)}});return this};this.nbOfPages=function(){return Math.ceil(this.target.items.length/this.nbOfTabsPerPage())-1};this.nbOfTabsPerPage=function(){return Math.round(2*this.$container.width()/3/200)};this.refresh=function(){var a,
b,e;if(this.target)if(e=this.target.$d,$(".tab",e).hide(),b=this.nbOfTabsPerPage(),a=this.nbOfPages(),this.page>a&&(this.page=a),0>this.page)this.page=0,$(".ptab",e).hide();else{0===a?$(".ptab",e).hide():$(".ptab",e).show();a=b*this.page;b=Math.min(a+b,this.target.items.length);this.target.items[a]&&this.target.items[a].$tab.css({left:this.$next.is(":visible")?this.$next.position().left+this.$next.outerWidth():this.left}).show();for(a+=1;a<b;a++)e=this.target.items[a-1].$tab,this.target.items[a].$tab.css({left:e.position().left+
e.outerWidth()+10}).show()}};this.getPageIdx=function(a){for(var b=0,e=this.target.items.length;b<e;b++)if(this.target.items[b].id===a.id)return b/this.nbOfTabsPerPage()|0;return-1};this.goTo=function(a){var b=this.nbOfPages();this.page=0>a?b:a>b?0:a;this.refresh()};this.updatePaginate=function(a){var b=$("ul",a.$d),e=$("#"+a.id+"p"),f=$("#"+a.id+"n");0<$("li",b).size()&&(0>$("li",b).first().offset().left?e.show():e.hide(),$("li",b).last().offset().left>$(".thumbsWrapper",a.$d).width()?f.show():f.hide())};
return this.init()}})(window.M);
(function(a){a.SouthPanel=function(b){b=b||{};this.active=null;this.h=a.Util.getPropertyValue(b,"h",300);this.w=a.Util.getPropertyValue(b,"w","70%");this.items=[];this.over=a.Util.getPropertyValue(b,"over",!0);this.padding={top:0,bottom:0,right:0};this.init=function(){if(a.SouthPanel._o)return a.SouthPanel._o;-1===this.h&&(this.h=Math.max(Math.round(2*a.$map.height()/5),300));this._offset=a.$container.offset().top;this.$d=a.Util.$$("#"+a.Util.getId(),this.over?a.$mcontainer:a.$container).addClass("pns").css({bottom:-this.h,
height:this.h,width:this.over?this.w:"100%"});a.events.register("resizeend",this,function(b){b.over||b.$d.width(a.$container.width())});this.paginator=new a.TabPaginator({target:this,$mcontainer:this.$d});a.SouthPanel._o=this;return this};this.add=function(b){if(!b||!b.id)return!1;var d,e,f=this;b.unremovable=a.Util.getPropertyValue(b,"unremovable",!0);(d=f.get(b.id))||(d={id:b.id,pn:f,$d:a.Util.$$("#"+b.id,f.$d).addClass("pnsi"+(f.over?"t":"")).css({margin:f.padding.top+"px "+(f.over?f.padding.right:
0)+"px "+f.padding.bottom+"px 0px"})},e=a.Util.getId(),f.$d.append('<a id="'+e+'t" class="tab vtab">'+(b.icon?'<img src="'+b.icon+'">&nbsp;':"")+a.Util._(b.title)+"</a>"),d.$tab=$("#"+e+"t"),d.$tab.click(function(a){a.preventDefault();!f.active||f.active.id!==d.id?f.show(d):f.hide(d)}),b.unremovable||a.Util.addClose(d.$tab,function(a){a.stopPropagation();f.remove(d)}),f.items.unshift(d));e=a.Util.getId();d.$d.html((b.mask?'<div id="'+e+'mask" class="mask" style="display:none;width:100%;height:'+f.h+
'px;"></div>':"")+'<div id="'+e+'" style="height:'+(f.h-f.padding.top-f.padding.bottom)+'px"'+(b.classes?' class="'+b.classes+'"':"")+">"+(b.html||"")+"</div>");$.extend(d,{$content:$("#"+e),$mask:$("#"+e+"mask"),onclose:b.onclose,onshow:b.onshow});f.paginator.refresh();return d};this.remove=function(a){var b,e;if(!a)return!1;b=0;for(e=this.items.length;b<e;b++)if(this.items[b].id===a.id)return this.hide(a),this.items[b].$content.remove(),this.items[b].$d.remove(),this.items[b].$tab.remove(),this.items.splice(b,
1),this.paginator.refresh(),!0;return!1};this.show=function(b){var d=this;if(!b)return!1;d.setActive(b);if(d.isVisible){if($.isFunction(b.onshow))b.onshow();return!1}d.$d.stop().animate({bottom:"0px"},{duration:200,queue:!0,step:function(b){d.over||a.$container.css("top",-b-d.h+d._offset)},complete:function(){a.Map.map.updateSize();if($.isFunction(b.onshow))b.onshow()}});return d.isVisible=!0};this.get=function(a){var b,e,f=null;b=0;for(e=this.items.length;b<e;b++)if(this.items[b].id===a){f=this.items[b];
break}return f};this.hide=function(b){var d=this;if(!d.active||d.active.id!==b.id)return!1;d.active=null;b.$tab.removeClass("active");d.isVisible=!1;d.$d.stop().animate({bottom:-d.h},{duration:200,queue:!0,step:function(b){d.over||a.$container.css("top",-b-d.h+d._offset)},complete:function(){a.Map.map.updateSize();if($.isFunction(b.onclose))b.onclose()}});return!0};this.setActive=function(a){$(".pnsi,.pnsit",this.$d).each(function(){var a=$(this);a.hasClass("nodisplaynone")?a.css({position:"absolute",
top:"-1000px",left:"-1000px"}):a.hide()});$(".tab",this.$d).removeClass("active");a.$d.hasClass("nodisplaynone")?a.$d.css({position:"static",top:"0px",left:"0px"}):a.$d.show();a.$tab.addClass("active");this.active=a};return this.init()}})(window.M);
(function(a){a.SidePanel=function(b){b=b||{};this.active=null;this.items=[];this.w=a.Util.getPropertyValue(b,"w",400);this.over=a.Util.getPropertyValue(b,"over",!0);this.padding={top:0,bottom:0,right:0};this.init=function(){if(a.SidePanel._o)return a.SidePanel._o;this.$d=a.Util.$$("#"+a.Util.getId(),this.over?a.$mcontainer:a.$container).addClass("spn").css({right:-this.w,height:"100%",width:this.w});a.SidePanel._o=this;return this};this.show=function(b){var d=this;d.setActive(b);if(d.isVisible)return!1;
if(d.over){var e=new a.Toolbar({position:"ne",orientation:"v"});d.$d.stop().animate({right:"0"},{duration:200,queue:!0,step:function(a){e.$d.css("right",d.w+a)}})}else d.$d.stop().animate({right:0},{duration:200,queue:!0,step:function(b){a.$mcontainer.css("left",-b-d.w)},complete:function(){a.Map.map.updateSize()}});return d.isVisible=!0};this.hide=function(b){var d=this;if(!d.isVisible||b&&d.active&&d.active.id!==b.id)return!1;d.isVisible=!1;if(d.over){var e=new a.Toolbar({position:"ne",orientation:"v"});
d.$d.stop().animate({right:-d.w},{duration:200,queue:!0,step:function(a){e.$d.css("right",d.w+a)}})}else d.$d.stop().animate({right:-d.w},{duration:200,queue:!0,step:function(b){a.$mcontainer.css("left",-b-d.w)},complete:function(){a.Map.map.updateSize()}});return!0};this.add=function(b){if(!b||!b.id)return!1;var d,e=a.Util.getId();(d=this.get(b.id))||(d={id:b.id,pn:this,$d:a.Util.$$("#"+b.id,this.$d).css({margin:this.padding.top+"px "+(this.over?this.padding.right:0)+"px "+this.padding.bottom+"px 0px"})},
this.items.unshift(d));d.$d.html('<div id="'+e+'"'+(b.classes?' class="'+b.classes+'"':"")+">"+(b.html||"")+"</div>");$.extend(d,{$content:$("#"+e),onclose:b.onclose,onshow:b.onshow});return d};this.remove=function(a){var b,e;if(!a)return!1;b=0;for(e=this.items.length;b<e;b++)if(this.items[b].id===a.id)return this.hide(a),this.items[b].$content.remove(),this.items[b].$d.remove(),this.items[b].$tab.remove(),this.items.splice(b,1),!0;return!1};this.get=function(a){var b,e,f=null;b=0;for(e=this.items.length;b<
e;b++)if(this.items[b].id===a){f=this.items[b];break}return f};this.setActive=function(a){var b,e;if(!a)return!1;b=0;for(e=this.items.length;b<e;b++)this.items[b].$d.hide();a.$d.show();this.active=a;return!0};return this.init()}})(window.M);
(function(a){a.Popup=function(b){b=b||{};this.autoSize=a.Util.getPropertyValue(b,"autoSize",!1);this.classes=b.classes;this.centered=a.Util.getPropertyValue(b,"centered",!0);this.addCloseButton=a.Util.getPropertyValue(b,"addCloseButton",!0);this.onClose=b.onClose;this.parent=b.parent||a.$mcontainer;this.generic=a.Util.getPropertyValue(b,"generic",!0);this.hideOnClose=a.Util.getPropertyValue(b,"hideOnClose",!1);this.modal=a.Util.getPropertyValue(b,"modal",!1);this.noHeader=a.Util.getPropertyValue(b,
"noHeader",!1);this.noFooter=a.Util.getPropertyValue(b,"noFooter",!0);this.resize=a.Util.getPropertyValue(b,"resize",!0);this.scope=b.scope||this;this.unbounded=a.Util.getPropertyValue(b,"unbounded",!1);this.followMap=a.Util.getPropertyValue(b,"followMap",!1);this.mapXY=b.mapXY;this.zIndex=a.Util.getPropertyValue(b,"zIndex",35900);this.init=function(b){var d=this,b=b||{};d.$m=$();d.$d=a.Util.$$("#"+a.Util.getId(),d.parent).addClass("po").html((d.noHeader?"":'<div class="header"></div>')+'<div class="body'+
(d.generic?" generic":"")+'"></div>'+(!d.noFooter?'<div class="footer"></div>':""));d.modal?(d.$d.css({"z-index":"38600"}),d.$m=a.Util.$$("#modmask",d.parent).addClass("mask").css({position:"absolute",display:"none",left:"0",top:"0",width:"100%",height:"100%","z-index":"36000"})):d.$d.css({"z-index":d.followMap?"19000":d.zIndex});d.$d.addClass(d.classes?d.classes:d.autoSize?"poa":"pona");d.$b=$(".body",d.$d);d.$h=$(".header",d.$d);d.$f=$(".footer",d.$d);b.header&&d.$h.html(b.header);b.body&&d.$b.html(b.body);
b.footer&&d.$f.html(b.footer);d.addCloseButton&&a.Util.addClose(d.$d,function(){d.hideOnClose?d.hide():d.remove()});a.events.register("resizeend",d,function(a){a.updatePosition(a)});b.followMap&&a.Map.map.events.register("move",a.Map.map,function(){d.$d.is(":visible")&&d.updatePosition(d)});d.mapXY&&this.setMapXY(d.mapXY);d.updatePosition(d);return d};this.append=function(a,b){("header"===b?this.$h:this.$b).append(a);this.updatePosition(this)};this.updatePosition=function(b){b=b||this;b.resize&&b.$b.css({"max-height":Math.round(1*
(a.$container.height()-b.$h.height())/2)});b.centered&&b.center(b);b.followMap&&b.mapXY&&b.setMapXY(b.mapXY)};this.center=function(b){b=b||this;b.$d.css({left:(a.$container.width()-b.$d.width())/2})};this.hide=function(a){this.$d.hide();this.$m.hide();if(!a&&$.isFunction(this.onClose))this.onClose(this.scope)};this.setMapXY=function(b){this.mapXY=b;b=a.Map.map.getPixelFromLonLat(this.mapXY);this.$d.hasClass("apo")?this.$d.css({left:b.x-31,top:b.y-this.$d.outerHeight()-12}):this.$d.css({left:b.x-this.$d.outerWidth()/
2,top:b.y-this.$d.outerHeight()/2})};this.moveTo=function(b){var d,e,f=this.$d;d=a.$map;var g=d.offset();if(!this.resize)return!1;e={x:b.x+g.left,y:b.y+g.top};!e||!e.x||!e.y?(b=g.left+(d.width()-f.width())/2,d=g.top+(d.height()-f.height())/2):this.unbounded?(b=e.x-f.width()/2,d=e.y-f.height()/2):(b=e.x-f.width()/2<g.left?g.left:e.x+f.width()/2>g.left+d.width()?g.left+d.width()-f.width():e.x-f.width()/2,d=e.y-f.height()/2<g.top?g.top:e.y+f.height()/2>g.top+d.height()?g.top+d.height()-f.height():e.y-
f.height()/2);f.css({top:d,left:b});return!0};this.remove=function(){this.hide();a.remove(this)};this.show=function(){this.$d.show();this.$m.show();if(this.followMap){var b=$(".lm").offset(),b=this.$d.offset().top-a.$map.offset().top-(b?b.top:0),d=a.$map.offset().left+a.$map.width()-this.$d.offset().left-this.$d.outerWidth(),e;0<d&&(d=0);0<b&&(b=0);if(0>d||0>b)e=a.Map.map.getPixelFromLonLat(a.Map.map.getCenter()),a.Map.map.setCenter(a.Map.map.getLonLatFromPixel(new OpenLayers.Pixel(e.x-d,e.y+b)))}};
this.init(b);return this}})(window.M);
(function(a){a=a||{};a.Map={$featureHilite:$(),doNotLog:!1,currentState:null,clusterOpts:{distance:30,threshold:3},pc:new OpenLayers.Projection("EPSG:4326"),sm:new OpenLayers.Projection("EPSG:900913"),layersGroups:[],layerTypes:[],map:null,mouseClick:new OpenLayers.Pixel(0,0),mousePosition:new OpenLayers.Pixel(0,0),predefined:{items:[],add:function(b){var c,d,e,f=!0;if(!b||!b.hasOwnProperty("type"))return!1;this.items[b.type]=this.items[b.type]||[];e=this.items[b.type];c=0;for(d=e.length;c<d;c++)if((new a.Map.LayerDescription(e[c],
a.Map)).getMID()===(new a.Map.LayerDescription(b,a.Map)).getMID()){f=!1;break}f&&e.push(b);return!0}},refreshCycle:0,selectableLayers:{items:[],add:function(b){b.events.on({featureselected:function(b){a.Map.featureInfo.select(b.feature)},featureunselected:function(b){a.Map.featureInfo.unselect(b.feature)}});this.items.push(b);b._M.hilitable&&a.Map.hilitableLayers.add(b);a.Map.resetControl()},remove:function(b){for(var c=0,d=this.items.length;c<d;c++)if(this.items[c].id===b.id){this.items.splice(c,
1);break}a.Map.hilitableLayers.remove(b)}},hilitableLayers:{items:[],add:function(a){this.items.push(a)},remove:function(a){for(var c=0,d=this.items.length;c<d;c++)if(this.items[c].id===a.id){this.items.splice(c,1);break}}},addToStuffLayer:function(a,c){if("object"!==typeof a)return null;c=c||{};this._stuffLayer||(this._stuffLayer=this.addLayer({type:"GeoJSON",title:"Stuff",clusterized:!1,editable:!0,unremovable:!0,ol:{styleMap:new OpenLayers.StyleMap({"default":{strokeColor:"white",strokeWidth:1,
fillColor:"red",fillOpacity:0.2,pointRadius:5}})}}));return this.layerTypes.GeoJSON.load({data:a,layer:this._stuffLayer,zoomOnNew:c.zoomOn||!1})},addLayer:function(b,c){var c=c||{},d=a.Util.getPropertyValue(c,"noDeletionCheck",!1),e=new this.LayerDescription(b,this);if(!e.isValid())return null;var f=e.getLayerType();if(!f)return null;var g=e.getMID(),h=this.Util.getLayerByMID(g);if(h){if(!d&&a.Config.general.confirmDeletion)return a.Util.askFor({title:a.Util._("Delete layer"),content:a.Util._("Do you really want to remove layer")+
" "+h.name,dataType:"list",value:[{title:a.Util._("Yes"),value:"y"},{title:a.Util._("No"),value:"n"}],callback:function(c){"y"===c&&(a.Map.removeLayer(h),a.Map.addLayer(b))}}),null;a.Map.removeLayer(h)}d=e.obj;d.url&&(d.url=a.Util.getAbsoluteUrl(d.url));var j={},n;for(n in d.ol)j[n]=d.ol[n];j._M={allowChangeOpacity:a.Util.getPropertyValue(d,"allowChangeOpacity",!1),clusterized:a.Util.getPropertyValue(d,"clusterized",a.Util.getPropertyValue(f,"clusterized",!1)),count:0,editable:a.Util.getPropertyValue(d,
"editable",!1),group:null,hilitable:a.Util.getPropertyValue(d,"hilitable",a.Util.getPropertyValue(f,"hilitable",!0)),icon:a.Util.getPropertyValue(d,"icon",a.Util.getImgUrl(a.Util.getPropertyValue(f,"icon",null))),initial:a.Util.getPropertyValue(d,"initial",!1),initialized:a.Util.getPropertyValue(c,"forceInitialized",!1),isLoaded:!0,isRaster:f.isRaster?!0:!1,MID:g,layerDescription:d,MLayer:a.Util.getPropertyValue(d,"MLayer",!1),noZoomOn:a.Util.getPropertyValue(d,"noZoomOn",!1),pagination:a.Util.getPropertyValue(d,
"pagination",null),qlToMap:a.Util.getPropertyValue(d,"qlToMap",!1),refreshable:a.Util.getPropertyValue(d,"refreshable",!1),refreshFactor:a.Util.getPropertyValue(d,"refreshFactor",1),selectable:a.Util.getPropertyValue(d,"selectable",a.Util.getPropertyValue(f,"selectable",!1)),unremovable:a.Util.getPropertyValue(d,"unremovable",!1),microInfoTemplate:a.Util.getPropertyValue(d,"microInfoTemplate",{})};a.Util.device.touch&&(j._M.microInfoTemplate.enable=!0);f.hasOwnProperty("projection")&&(j.projection=
f.projection);f.hasStyleMap&&!j.hasOwnProperty("styleMap")&&(j.styleMap=e.getStyleMap());if(h=f.add(d,j))h._M.layerDescription&&h._M.layerDescription.zoomOnNew&&this.zoomTo(h.getDataExtent()||h._M.bounds,"always"===h._M.layerDescription.zoomOnNew?!1:!0),(!h.events.listeners.hasOwnProperty("loadstart")||0===h.events.listeners.loadstart.length)&&h.events.register("loadstart",h,function(){a.Map.events.trigger("loadstart",h)}),(!h.events.listeners.hasOwnProperty("loadend")||0===h.events.listeners.loadend.length)&&
h.events.register("loadend",h,function(){a.Map.resetControl();a.Map.events.trigger("loadend",h);var b=a.Map.layerTypes[this._M.layerDescription.type];return b&&b.removeOnEmpty&&a.Map.Util.layerIsEmpty(this)?(a.Util.message(a.Util._("No result")),a.Map.removeLayer(this)):this._M.initialized=!0}),d&&!0===d.hidden&&this.Util.setVisibility(h,!1),this.map.addLayer(h),a.timeLine&&a.timeLine.add(h),h.isBaseLayer&&!this.hasNonEmptyBaseLayer&&(this.setBaseLayer(h),this.removeLayer(this.Util.getLayerByMID("EmptyBaseLayer"),
!1),this.hasNonEmptyBaseLayer=!0),f&&f.forceReload&&h.redraw(),h._M&&h._M.selectable&&this.selectableLayers.add(h),h._M.layerDescription&&h._M.layerDescription.groupName&&(e=this.layersGroups[h._M.layerDescription.groupName],e||(e=new this.LayersGroup(h._M.layerDescription.groupName,null),this.layersGroups[h._M.layerDescription.groupName]=e),h._M.group=e,e.add(h)),this.events.trigger("layersend",{action:"add",layer:h}),d.opacity&&h.setOpacity(d.opacity);return h},getState:function(){return{center:this.map.getCenter(),
resolution:this.map.getResolution(),projection:this.map.getProjectionObject(),units:this.map.getUnits()||this.map.units||this.map.baseLayer.units}},loadContext:function(b){var c,d,e,f,g,h,j,b=b||{};b.location&&this.map.setCenter(this.Util.d2p(new OpenLayers.LonLat(b.location.lon,b.location.lat)),Math.max(b.location.zoom,this.lowestZoomLevel));b.layers=b.layers||[];f=0;for(j=this.map.layers.length;f<j;f++)if(d=!0,(e=this.map.layers[f])&&e._M&&!e._M.MLayer){c=e._M.MID;g=0;for(h=b.layers.length;g<h;g++)if(c===
(new this.LayerDescription(b.layers[g],this)).getMID()){d=!1;break}d&&this.removeLayer(this.Util.getLayerByMID(c),!1)}f=0;for(j=b.layers.length;f<j;f++){c=(new this.LayerDescription(b.layers[f],this)).getMID();d=!0;g=0;for(h=this.map.layers.length;g<h;g++)if(e=this.map.layers[g],e._M&&!e._M.MLayer&&c===e._M.MID){d=!1;break}if(d)this.addLayer(b.layers[f],{noDeletionCheck:!0,forceInitialized:!0});else if(e.isBaseLayer||a.Map.Util.setVisibility(e,!b.layers[f].hidden),c=b.layers[f].search)e._M.searchContext.items=
c.items,e._M.searchContext.search({nextRecord:c.nextRecord})}b.location.bg&&(e=this.Util.getLayerByMID(b.location.bg))&&e.isBaseLayer&&this.setBaseLayer(e)},getContext:function(){var a,c,d,e,f,g;a=this.Util.p2d(this.map.getCenter());e={location:{bg:this.map.baseLayer._M.MID,lat:a.lat,lon:a.lon,zoom:this.map.getZoom()},layers:[]};a=0;for(c=this.map.layers.length;a<c;a++)if(d=this.map.layers[a],d._M&&d._M.layerDescription&&!d._M.MLayer){g={initial:!0};for(f in d._M.layerDescription)"layer"!==f&&"ol"!==
f&&(g[f]=d._M.layerDescription[f]);g.hidden=!d.getVisibility()&&!d.isBaseLayer?!0:!1;d._M.searchContext&&0<d._M.searchContext.items.length&&(g.search={MID:d._M.MID,items:d._M.searchContext.items,nextRecord:d._M.searchContext.nextRecord});e.layers.push(g)}return e},init:function(b){var c=this;OpenLayers.IMAGE_RELOAD_ATTEMPTS=2;OpenLayers.ProxyHost=a.Util.proxify("");OpenLayers.Handler.Feature=OpenLayers.Class(OpenLayers.Handler.Feature,{stopDown:!1});OpenLayers.Layer.Vector.prototype.renderers=["SVG",
"VML"];b.mapOptions.theme=null;c.initialLocation=b.general.location;if("auto"===a.$map.css("height")||"0px"===a.$map.css("height"))a.$map.css("height",window.innerHeight-a.$map.offset().top),a.$map.addClass("processHeightOnResize");var d={id:"__CONTROL_NAVIGATION__",documentDrag:!0,handleRightClicks:!0,zoomWheelEnabled:!0,mouseWheelOptions:{interval:50,cumulative:!1},dragPanOptions:{enableKinetic:!0,panMapStart:function(a){this.kinetic&&this.kinetic.begin();c._clk={x:a.x,y:a.y,d:(new Date).getTime()};
return!0},panMapUp:function(b){c._clk&&b.x===c._clk.x&&b.y===c._clk.y&&(200<(new Date).getTime()-c._clk.d?(c.mouseClick={x:b.x,y:b.y},a.menu.show()):a.Map.events.trigger("mapclicked",b));return!0}}};b.mapOptions.controls=a.Util.device.touch?[new OpenLayers.Control.TouchNavigation(d)]:[new OpenLayers.Control.Navigation(d)];c.map=new OpenLayers.Map(a.$map.attr("id"),b.mapOptions);c.map.addLayer(new OpenLayers.Layer("EmptyBaseLayer",{_M:{MID:"EmptyBaseLayer"},isBaseLayer:!0,displayInLayerSwitcher:!1}));
c.events=new c.Events(c);c.featureInfo=new c.FeatureInfo;c.map.events.register("move",c.map,function(){a.menu&&a.menu.updatePosition()});c.map.events.register("moveend",c,function(){a.Map.events.trigger("moveend");c.currentState=a.Map.getState();!c._bof&&a.Config.general.enableHistory&&(c.hash=a.Map.Util.Geohash.encode(c.Util.p2d(c.map.getCenter().clone()))+":"+c.map.getZoom(),window.location.hash=c.hash);c._bof=!1});setInterval(function(){if(c.hash&&window.location.hash!==c.hash){c.hash=window.location.hash;
c._bof=!0;var a=c.hash.split(":");c.map.setCenter(c.Util.d2p(c.Util.Geohash.decode(a[0])),parseInt(a[1]))}},100);a.Util.device.touch||(b.general.displayCoordinates&&(0===$("#coords").length&&a.Util.$$("#coords",a.$map),c.$coords=$("#coords")),b.general.featureHilite&&0===c.$featureHilite.length&&(c.$featureHilite=a.Util.$$("#"+a.Util.getId(),a.$map).addClass("featureHilite").hide()),c.map.events.register("mousemove",c.map,function(d){var e=a.$map.offset();a.Map.mousePosition=new OpenLayers.Pixel(d.pageX-
e.left,d.pageY-e.top);b.general.displayCoordinates&&a.Map.$coords.html(a.Map.Util.getFormattedLonLat(c.Util.p2d(a.Map.map.getLonLatFromPixel(a.Map.mousePosition)),a.Config.general.coordinatesFormat)).css({top:a.Map.mousePosition.y-20,left:a.Map.mousePosition.x}).show();c.$featureHilite.css({top:a.Map.mousePosition.y+30,left:a.Map.mousePosition.x+15});return!0}),c.map.events.register("mouseout",c.map,function(){a.Map.$coords&&a.Map.$coords.hide();c.$featureHilite.hide();return!0}));if(b.groups)for(var d=
0,e=b.groups.length;d<e;d++)c.layersGroup[b.groups.name]=new c.LayersGroup(c,b.groups.name,b.groups.icon);d=[];b.general.displayScale&&$.isFunction(OpenLayers.Control.ScaleLine)&&d.push(new OpenLayers.Control.ScaleLine({id:"__CONTROL_SCALELINE__",geodetic:"EPSG:4326"===c.map.getProjectionObject().projCode?!1:!0}));d.push(new OpenLayers.Control.SelectFeature(c.selectableLayers.items,{id:"__CONTROL_SELECT__",clickout:!1,toggle:!0,multiple:!1,hover:!1}));b.general.featureHilite&&d.push(new OpenLayers.Control.SelectFeature(c.hilitableLayers.items,
{id:"__CONTROL_HIGHLITE__",hover:!0,highlightOnly:!0,eventListeners:{beforefeaturehighlighted:function(b){if(a.menu&&a.menu.$m.is(":visible"))return!1;if(b.feature){b.feature.geometry&&$("#"+b.feature.geometry.id).css("cursor","pointer");if(a.Map.featureInfo.hilited)return c.$featureHilite.empty().hide(),!0;if(a.Map.featureInfo.selected&&a.Map.featureInfo.selected.id===b.feature.id)return c.$featureHilite.empty().hide(),!1;c.$featureHilite.html(a.Util.stripTags(a.Map.Util.Feature.getTitle(b.feature))).attr("hilited",
"hilited").show()}return!0},featureunhighlighted:function(){c.$featureHilite.empty().attr("hilited","").hide()}}}));d.push(new OpenLayers.Control.Attribution({id:"__CONTROL_ATTRIBUTION__"}));c.map.addControls(d);"none"!==b.general.overviewMap&&(d=new OpenLayers.Bounds(-180,-90,180,90),d=new OpenLayers.Control.OverviewMap({mapOptions:{theme:!1,projection:this.map.displayProjection,maxExtent:d,numZoomLevels:1,autoPan:!1,restrictedExtent:d},maximized:"opened"===b.general.overviewMap?!0:!1,size:new OpenLayers.Size("250",
"125"),layers:[new OpenLayers.Layer.Image("ImageLayer",a.Util.getImgUrl("overviewmap.png"),d,new OpenLayers.Size("250","125"))]}),c.map.addControl(d));c.map.restrictedExtent?c.map.zoomToExtent(c.map.restrictedExtent):c.setCenter(c.Util.d2p(new OpenLayers.LonLat(c.initialLocation.lon,c.initialLocation.lat)),c.initialLocation.zoom,!0);c.lowestZoomLevel=0;(function g(){a.Map.refreshCycle++;var b,c;for(b=a.Map.map.layers.length;b--;)c=a.Map.map.layers[b],!c.isBaseLayer&&c._M&&c._M.refresh&&0===a.Map.refreshCycle%
c._M.refreshFactor&&c.refresh({force:!0});window.setTimeout(g,a.Config.general.refreshInterval||1E3)})();c.resetControl(c.Util.getControlById("__CONTROL_NAVIGATION__"));a.events.register("resizeend",c,function(a){a.map.updateSize();a.events.trigger("resizeend")})},removeLayer:function(b,c){if(!b)return!1;if(c&&a.Config.general.confirmDeletion)return a.Util.askFor({title:a.Util._("Delete layer"),content:a.Util._("Do you really want to remove layer")+" "+b.name,dataType:"list",value:[{title:a.Util._("Yes"),
value:"y"},{title:a.Util._("No"),value:"n"}],callback:function(c){"y"===c&&a.Map.removeLayer(b)}}),!1;b._tobedestroyed=!0;this.events.trigger("layersend",{action:"remove",layer:b});this.selectableLayers.remove(b);b._M&&b._M.group&&b._M.group.remove(b);b._M&&b._M.SearchContext&&a.remove(b._M.SearchContext);a.timeLine&&a.timeLine.remove(b);b._M&&b._M.MLayer&&this.removedLayers.push({MID:b._M.MID,layerDescription:b._M.layerDescription});b.destroy();return!0},resetControl:function(a){a&&(a.deactivate(),
this.Util.getControlById("__CONTROL_NAVIGATION__").activate());var a=this.Util.getControlById("__CONTROL_SELECT__"),c=this.Util.getControlById("__CONTROL_HIGHLITE__");a&&(a.deactivate(),c&&c.deactivate(),0<this.selectableLayers.items.length&&(c&&c.activate(),a.activate()))},setCenter:function(b,c,d){this.doNotLog=d||!1;null!==c?this.map.setCenter(b,c):a.Util.device.touch||a.Config.general.teleport?this.map.setCenter(b):this.map.panTo(b)},zoomTo:function(b,c){if(b&&("boolean"!==$.type(c)&&(c=!0),!c||
!this.map.getExtent().containsBounds(b,!0))){var d=b.getWidth(),e=b.getHeight(),f=b.getCenterLonLat(),g=a.Util._("Cannot zoom : this feature is outside authorized extent");1>d&&1>e?this.map.restrictedExtent&&!this.map.restrictedExtent.containsBounds(b,!0)?a.Util.message(g):this.map.setCenter(f,Math.max(9,this.map.getZoom())):this.map.restrictedExtent&&!this.map.restrictedExtent.containsBounds(b,!0)?a.Util.message(g):this.map.zoomToExtent(b)}},setBaseLayer:function(a){var c,d,e;this.map.setBaseLayer(a);
this.map.baseLayer.wrapDateLine=!1;d=this.map.projection&&this.map.projection instanceof OpenLayers.Projection?this.map.projection:new OpenLayers.Projection(this.map.projection);e=a.projection;if(!e.equals(d)){this.map.projection=e;this.map.maxExtent=a.maxExtent;this.map.setCenter(this.map.getCenter().transform(d,e),this.map.getZoom(),!1,!0);for(a=0;a<this.map.layers.length;a++)if(!1===this.map.layers[a].isBaseLayer){this.map.layers[a].addOptions({projection:e},!0);if($.isArray(this.map.layers[a].features))for(c=
0;c<this.map.layers[a].features.length;c++)this.map.layers[a].features[c].geometry.transform(d,e);this.map.layers[a].redraw()}this.map.updateSize()}}}})(window.M);
(function(a,b){b.Util={};b.Util.Geohash={BITS:[16,8,4,2,1],BASE32:"0123456789bcdefghjkmnpqrstuvwxyz",refineInterval:function(a,b,e){b&e?a[0]=(a[0]+a[1])/2:a[1]=(a[0]+a[1])/2},decode:function(a){var b,e,f,g,h=1,j=[],n=[];j[0]=-90;j[1]=90;n[0]=-180;n[1]=180;a=a.replace("#","");for(f=0;f<a.length;f++){b=a.charAt(f);b=this.BASE32.indexOf(b);for(g=0;5>g;g++)e=this.BITS[g],h?this.refineInterval(n,b,e):this.refineInterval(j,b,e),h=!h}j[2]=(j[0]+j[1])/2;n[2]=(n[0]+n[1])/2;return new OpenLayers.LonLat(n[1],
j[1])},encode:function(a){var b,e=1,f=[],g=[],h=0,j=0,n="";f[0]=-90;f[1]=90;g[0]=-180;for(g[1]=180;12>n.length;)e?(b=(g[0]+g[1])/2,a.lon>b?(j|=this.BITS[h],g[0]=b):g[1]=b):(b=(f[0]+f[1])/2,a.lat>b?(j|=this.BITS[h],f[0]=b):f[1]=b),e=!e,4>h?h++:(n+=this.BASE32.charAt(j),j=h=0);return"#"+n}};b.Util.Feature={getIcon:function(c){var d,e;if(c){if(c.attributes.icon)return c.attributes.icon;if(c.attributes.thumbnail)return c.attributes.thumbnail;if(c.attributes.quicklook)return c.attributes.quicklook;if(c.attributes.imageUrl)return c.attributes.imageUrl;
if(c.layer&&(d=c.layer.styleMap.styles["default"],e=c.style||d.defaultStyle,e.externalGraphic))return b.Util.KML.resolveStyleAttribute(c,d,e.externalGraphic);if(c.geometry)switch(c.geometry.CLASS_NAME.replace("OpenLayers.Geometry.","")){case "MultiPolygon":case "Polygon":return a.Util.getImgUrl("polygon.png");case "MultiLineString":case "LineString":return a.Util.getImgUrl("line.png");case "MultiPoint":case "Point":return a.Util.getImgUrl("point.png")}}},getTitle:function(c){var d;if(!c)return null;
if(c.cluster&&0<c.cluster.length)return a.Util._(c.layer.name)+": "+c.cluster.length+" "+a.Util._("entities");if(c.layer&&c.layer._M.layerDescription.featureInfo&&c.layer._M.layerDescription.featureInfo.title)return c.layer._M.layerDescription.featureInfo.title.replace(/\$+([^\$])+\$/g,function(a){a=a.replace(/[\$\$]/g,"");return b.Util.Feature.getValue(c,a,c.attributes[a])});for(d in{name:1,title:1,identifier:1})if(c.attributes[d])return b.Util.Feature.getValue(c,d,c.attributes[d]);return c.fid?
b.Util.Feature.getValue(c,"identifier",c.fid):c.id||""},getValue:function(a,b,e){var f;if(!a||!b)return e;if(a.layer&&a.layer._M.layerDescription.hasOwnProperty("featureInfo"))for(f in a=a.layer._M.layerDescription.featureInfo.keys||[],a)if(b===f){if($.isFunction(a[f].transform))return a[f].transform(e);break}return e},translate:function(b,d){var e,f;if(!d||!b)return a.Util._(b);if(d.layer._M.layerDescription.hasOwnProperty("featureInfo"))for(e in f=d.layer._M.layerDescription.featureInfo.keys||[],
f)if(b===e){if(f[e].hasOwnProperty("v"))return a.Util._(f[e].v);break}return(e=d.layer._M.searchContext)&&e.connector?a.Util._("string"===typeof e.connector.metadataTranslator[b]?e.connector.metadataTranslator[b]:b):a.Util._(b)},toGeo:function(a,d){d=d||{};switch(b.Util.getGeoType(d.mimeType)){case "GML":return b.Util.GML.featureToGML(a,d.schema);case "WKT":return this.toWKT(a);default:return null}},toWKT:function(b){return b&&b.geometry?a.Map.Util.p2d(b.geometry.clone()).toString():""},zoomOn:function(b,
d){$.isArray(b)||(b=[b]);"boolean"!==$.type(d)&&(d=!0);var e,f,g=new OpenLayers.Bounds;e=0;for(f=b.length;e<f;e++)g.extend(b[e].geometry.getBounds());a.Map.zoomTo(g,d)}};b.Util.getGeoBounds=function(b){if(!b)return null;"string"===typeof b&&(b={bounds:b,srs:"EPSG:4326"});if(!b.bounds)return null;var d;d=[];var e=b.srs,f=b.crs||"EPSG:4326";$.isArray(b.bounds)?b=b.bounds:(b=b.bounds.split(","),b[0]=parseFloat(b[0]),b[1]=parseFloat(b[1]),b[2]=parseFloat(b[2]),b[3]=parseFloat(b[3]));"EPSG:4326"===e?(d[0]=
Math.max(-180,b[0]),d[1]=Math.max(-90,b[1]),d[2]=Math.min(180,b[2]),d[3]=Math.min(90,b[3]),b=d):"EPSG:4326"===f&&(d[0]=Math.max(-180,b[1]),d[1]=Math.max(-90,b[0]),d[2]=Math.min(180,b[3]),d[3]=Math.min(90,b[2]),b=d);d=new OpenLayers.Bounds(b[0],b[1],b[2],b[3]);return"EPSG:4326"===e||"EPSG:4326"===f?d:a.Map.Util.p2d(d)};b.Util.getProjectedBounds=function(a){if(!a)return null;"string"===typeof a&&(a={bounds:a,srs:"EPSG:4326"});if(!a.bounds)return null;var d=0,e=a.srs,f=a.crs;$.isArray(a.bounds)?a=a.bounds:
(a=a.bounds.split(","),a[0]=parseFloat(a[0]),a[1]=parseFloat(a[1]),a[2]=parseFloat(a[2]),a[3]=parseFloat(a[3]));if("EPSG:4326"===e){if(-180===a[0]||-90===a[1]||180===a[2]||90===a[3])d=1;d=b.Util.d2p(new OpenLayers.Bounds(a[0]+d,a[1]+d,a[2]-d,a[3]-d))}else if("EPSG:4326"===f){if(-180===a[0]||-90===a[1]||180===a[2]||90===a[3])d=1;d=b.Util.d2p(new OpenLayers.Bounds(a[1]+d,a[0]+d,a[3]-d,a[2]-d))}else d=new OpenLayers.Bounds(a[0],a[1],a[2],a[3]);return d};b.Util.getGeoType=function(a){if(!a)return null;
var b=[];b["text/xml; subtype=gml/3.1.1"]="GML";b["application/gml+xml"]="GML";b["text/gml"]="GML";b["application/geo+json"]="JSON";b["application/geojson"]="JSON";b["application/wkt"]="WKT";b["application/x-ogc-wms"]="WMS";return b[a.toLowerCase()]};b.Util.convert=function(a){if(a&&a.input instanceof OpenLayers.Bounds){var b,e,f,g;g=a.precision||-1;var h=a.hasOwnProperty("limit")?a.limit:!1;-1!==g?(b=a.input.left.toFixed(g),f=a.input.right.toFixed(g),e=a.input.bottom.toFixed(g),g=a.input.top.toFixed(g)):
(b=a.input.left,f=a.input.right,e=a.input.bottom,g=a.input.top);h&&(b=Math.max(b,-180),f=Math.min(f,180),e=Math.max(e,-90),g=Math.min(g,90));if("WKT"===a.format)return"POLYGON(("+b+" "+e+","+b+" "+g+","+f+" "+g+","+f+" "+e+","+b+" "+e+"))";if("EXTENT"===a.format)return b+","+e+","+f+","+g}return""};b.Util.getControlById=function(a){return b.map.getControlsBy("id",a)[0]};b.Util.getFeatures=function(b,d,e){var f,g,h,j,n,p=[],d=d||{};if(b&&b.features){g=0;for(j=b.features.length;g<j;g++)if(f=b.features[g],
f.cluster&&!e){h=0;for(n=f.cluster.length;h<n;h++)f.cluster[h].layer=f.cluster[h].layer||b,p.push(d.toDisplayProjection?f.cluster[h].clone():f.cluster[h])}else p.push(d.toDisplayProjection?f.clone():f)}if(d.toDisplayProjection){g=0;for(j=p.length;g<j;g++)if(p.components){h=0;for(n=p.components.length;h<n;h++)a.Map.Util.p2d(p.components[h].geometry)}else a.Map.Util.p2d(p[g].geometry)}d.attribute&&p.sort(function(a,b){var c,e;if(!a.hasOwnProperty("attributes")||!b.hasOwnProperty("attributes"))return 0;
"d"===d.order?(c=b.attributes[d.attribute],e=a.attributes[d.attribute]):(c=a.attributes[d.attribute],e=b.attributes[d.attribute]);"n"===d.type?(c=parseFloat(c),e=parseFloat(e)):"t"===d.type&&(c=c.toLowerCase(),e=e.toLowerCase());return c<e?-1:c>e?1:0});return p};b.Util.getFeature=function(a,d){if(!a||!d||!a.features)return null;for(var e=b.Util.getFeatures(a),f=0,g=e.length;f<g;f++)if(e[f].fid===d)return e[f];return null};b.Util.getFormattedLonLat=function(a,d){d||(d="dms");return-1!==d.indexOf("h")?
b.Util.getFormattedCoordinate(a.lon,"lon",d)+"&nbsp;::&nbsp;"+b.Util.getFormattedCoordinate(a.lat,"lat",d):b.Util.getFormattedCoordinate(a.lat,"lat",d)+"&nbsp;::&nbsp;"+b.Util.getFormattedCoordinate(a.lon,"lon",d)};b.Util.getFormattedCoordinate=function(a,b,e){var f,g,h,j="",n="\u00b0";e||(e="dms");"lon"===b?(a=(a+540)%360-180,h=0>a?"W":"E"):(a=(a+270)%180-90,h=0>a?"S":"N");-1!==e.indexOf("h")&&("lon"===b&&(a=24*((360-a)%360)/360,n="h"),h="",j=0>a?"-":"+");a=Math.abs(a);f=a|0;g=a=(a-f)/(1/60);a|=
0;g=Math.round(10*((g-a)/(1/60)))/10;60<=g&&(g-=60,a+=1,60<=a&&(a-=60,f+=1));b=("lat"===b?j:"")+(10>f?"0":"")+f+n;1<=e.indexOf("m")&&(b+=(10>a?"0":"")+a+"'",1<=e.indexOf("ms")&&(b+=(10>g?"0":"")+g+'"'));return b+h};b.Util.getLayerByMID=function(a){if(!a||""===a)return null;for(var d=0,e=b.map.layers.length;d<e;d++){var f=b.map.layers[d];if(f._M&&f._M.MID===a)return f}return null};b.Util.isRaster=function(a){return!a||!a._M?!1:a._M.isRaster};b.Util.layerIsEmpty=function(a){if(!a||!a.features||0===
a.features.length)return!0;var b=!0,e;for(e=a.features.length;e--;)if(a.features[e].geometry){b=!1;break}return b};b.Util.d2p=function(a){return a.transform(b.pc,b.map.getProjectionObject())};b.Util.p2d=function(a){return a.transform(b.map.getProjectionObject(),b.pc)};b.Util.setLayerOnTop=function(a){a&&b.map.setLayerIndex(a,b.map.layers.length)};b.Util.setVisibility=function(a,d){a.setVisibility(d);b.events.trigger("visibilitychanged",a)};b.Util.switchVisibility=function(a){(a=b.Util.getLayerByMID(a))&&
b.Util.setVisibility(a,!a.getVisibility())};b.Util.updateIndex=function(a){var d,e,f=b.map.getLayerIndex(a);if(!a||!a.features)return!1;for(d=b.map.layers.length;d--;)if(e=b.map.layers[d],a.id!==e.id&&a.features[0]&&a.features[0].geometry){if(!e.features){f=b.map.getLayerIndex(e);break}if("OpenLayers.Geometry.Point"===a.features[0].geometry.CLASS_NAME)break;if(e.features[0]&&e.features[0].geometry){if("OpenLayers.Geometry.Polygon"===e.features[0].geometry.CLASS_NAME){f=b.map.getLayerIndex(e);break}if("OpenLayers.Geometry.Line"===
a.features[0].geometry.CLASS_NAME&&"OpenLayers.Geometry.Line"===e.features[0].geometry.CLASS_NAME){f=b.map.getLayerIndex(e);break}}}b.map.getLayerIndex(a)!==f&&b.map.setLayerIndex(a,f+1);return!0};b.Util.zoomOn=function(b,d){var e;if(!b||!b._M)return!1;e=b.getDataExtent()||b._M.bounds;return d&&e||b._M.initialized&&e&&!a.Map.map.getExtent().intersectsBounds(e,!0)?(a.Map.zoomTo(e),!0):!1};b.Util.posListToGeoJsonGeometry=function(a){var b=[],e,f;if(a){f=a.split(" ");a=0;for(e=f.length;a<e;a+=2)b.push("["+
f[a]+","+f[a+1]+"]")}return b.join(",")};b.Util.elasticResultToGeoJSON=function(a){var b,e,f,g,h,j=[],n={point:"Point",linestring:"LineString",polygon:"Polygon"};b=0;for(h=a.hits.hits.length;b<h;b++)g=a.hits.hits[b],e=g._id,f=g._type,g=g._source,g.shape.type=n[g.shape.type]||g.shape.type,e={id:e,type:f},$.extend(e,g.tags),j.push({type:"Feature",geometry:g.shape,properties:e});return{type:"FeatureCollection",features:j}}})(window.M,window.M.Map);
(function(a,b){b.Util=b.Util||{};b.Util.GML={namespaces:'xmlns:gml="http://www.opengis.net/gml"',featureToGML:function(a,d){var e,f,g="";if(a&&a.geometry)if(e=a.geometry.CLASS_NAME,"OpenLayers.Geometry.Point"===e)g=this.geometryPointToGML(a.geometry);else if("OpenLayers.Geometry.MultiPoint"!==e)if("OpenLayers.Geometry.LineString"===e)g=this.geometryLineStringToGML(a.geometry);else if("OpenLayers.Geometry.MultiLineString"===e){if(a.geometry.components){e=0;for(f=a.geometry.components.length;e<f;e++)g+=
this.geometryLineStringToGML(a.geometry.components[e])}}else{if("OpenLayers.Geometry.Polygon"===e)return this.geometryPolygonToGML(a.geometry);if("OpenLayers.Geometry.MultiPolygon"===e&&a.geometry.components){e=0;for(f=a.geometry.components.length;e<f;e++)g+=this.geometryPolygonToGML(a.geometry.components[e])}}return"http://schemas.opengis.net/gml/3.1.1/base/feature.xsd"===d?"<gml:FeatureCollection "+b.Util.GML.namespaces+" ><gml:featureMember><gml:GeometryPropertyType>"+g+"</gml:GeometryPropertyType></gml:featureMember></gml:FeatureCollection>":
g},geometryPointToGML:function(a){a=b.Util.p2d(new OpenLayers.LonLat(a.x,a.y));return"<gml:Point "+b.Util.GML.namespaces+' srsName="'+b.map.displayProjection.projCode+'"><gml:pos>'+a.lon+" "+a.lat+"</gml:pos></gml:Point>"},geometryLineStringToGML:function(c){var d,e="";if(c.components)for(var f=0,g=c.components.length;f<g;f++)d=c.components[f],d=a.Map.Util.p2d(new OpenLayers.LonLat(d.x,d.y)),e+=d.lon+" "+d.lat+" ";return"<gml:LineString "+b.Util.GML.namespaces+' srsName="'+b.map.displayProjection.projCode+
'"><gml:posList>'+e.substring(0,e.length-1)+"</gml:posList></gml:LineString>"},geometryPolygonToGML:function(c){var d,e,f="";if(c.components)for(var g=0,h=c.components.length;g<h;g++){e=c.components[g];for(var j=0,n=e.components.length;j<n;j++)d=e.components[j],d=a.Map.Util.p2d(new OpenLayers.LonLat(d.x,d.y)),f+=d.lon+" "+d.lat+" "}return"<gml:Polygon "+b.Util.GML.namespaces+' srsName="'+b.map.displayProjection.projCode+'"><gml:exterior><gml:LinearRing><gml:posList>'+f.substring(0,f.length-1)+"</gml:posList></gml:LinearRing></gml:exterior></gml:Polygon>"},
toGeoJSON:function(b,d){var e={};if(b instanceof jQuery)switch(a.Util.stripNS(b[0].nodeName)){case "Point":e=this.pointToGeoJSON(b,d);break;case "LineString":e=this.lineStringToGeoJSON(b,d);break;case "Polygon":e=this.polygonToGeoJSON(b,d);break;case "MultiPolygon":e=this.multiPolygonToGeoJSON(b,d)}return e},pointToGeoJSON:function(c,d){d=d||{identifier:a.Util.getId()};return JSON.parse(a.Util.parseTemplate(this.geoJSONTemplate,{geometry:'{"type":"Point","coordinates":'+b.Util.posListToGeoJsonGeometry(c.children().text())+
"}",properties:JSON.stringify(d)}))},lineStringToGeoJSON:function(c,d){d=d||{identifier:a.Util.getId()};return JSON.parse(a.Util.parseTemplate(this.geoJSONTemplate,{geometry:'{"type":"LineString","coordinates":['+b.Util.posListToGeoJsonGeometry(c.children().text())+"]}",properties:JSON.stringify(d)}))},polygonToGeoJSON:function(c,d){var e=[],d=d||{identifier:a.Util.getId()};c.children().each(function(){$(this).children().each(function(){e.push("["+b.Util.posListToGeoJsonGeometry($(this).children().text())+
"]")})});return JSON.parse(a.Util.parseTemplate(this.geoJSONTemplate,{geometry:'{"type":"Polygon","coordinates":['+e.join(",")+"]}",properties:JSON.stringify(d)}))},multiPolygonToGeoJSON:function(c,d){var e=[],f=[],d=d||{identifier:a.Util.getId()};c.children().each(function(){$(this).children().each(function(){f=[];$(this).children().each(function(){f.push("["+b.Util.posListToGeoJsonGeometry($(this).children().text())+"]")});e.push("["+f.join(",")+"]")})});return JSON.parse(a.Util.parseTemplate(this.geoJSONTemplate,
{geometry:'{"type":"MultiPolygon","coordinates":['+e.join(",")+"]}",properties:JSON.stringify(d)}))},geoJSONTemplate:'{"type":"FeatureCollection","features":[{"type":"Feature","geometry":$geometry$,"properties":$properties$}]}'}})(window.M,window.M.Map);
(function(a,b){b.Util=b.Util||{};b.Util.KML={layerToKML:function(b,d){if(!b)return!1;if(b._M&&b._M.kml)return b._M.kml;var d=d||{},e="",f,g;if("OpenLayers.Layer.Image"===b.CLASS_NAME)e+=this.imageToKML(b);else if("OpenLayers.Layer.WMS"===b.CLASS_NAME&&d.synchronizeWMS)e+=this.wmsToKML(b);else if("OpenLayers.Layer.Vector"===b.CLASS_NAME){var h,j=[];f=0;for(g=b.features.length;f<g;f++)if(h=b.features[f],h.cluster)for(var n=0,p=h.cluster.length;n<p;n++)h.cluster[n].geometry&&j.push(h.cluster[n]);else h.geometry&&
j.push(h);if(0<j.length){d.color&&(e+='<Style id="normalState"><IconStyle><scale>1.1</scale><Icon><href>'+a.Util.getImgUrl("ylw-pushpin.png")+'</href></Icon><hotSpot x="20" y="2" xunits="pixels" yunits="pixels"/></IconStyle><PolyStyle><color>'+this.color2KML(d.color,d.opacity)+"</color></PolyStyle></Style>");f=0;for(g=j.length;f<g;f++)e+=this.featureToKML(j[f],d)}}""!==e&&(e='<?xml version="1.0" encoding="UTF-8"?><kml xmlns="http://www.opengis.net/kml/2.2" xmlns:kml="http://www.opengis.net/kml/2.2"><Document><name>'+
this.encode(a.Util._(b.name))+"</name><description></description>"+e+"</Document></kml>");return e},featureToKML:function(b,d){var e,f,g,h="",j="",d=d||{};if(b&&b.geometry){var n=null,p=b.geometry.CLASS_NAME;for(e in b.attributes)"name"===e?f=b.attributes[e]:"description"===e?j+=b.attributes[e]+"<br/>":(g=b.attributes[e],j="string"===typeof g&&a.Util.isUrl(g)?"thumbnail"===e?j+('<img src="'+g+'" class="center" width="250"/><br/>'):j+('<a target="_blank" href="'+g+'">'+e+"</a><br/>"):j+(e+" : "+g+
"<br/>")),"ele"===e&&(n=b.attributes[e],$.isNumeric(n)||(n=null));if(void 0===f||""===f)f=b.id;e="<name><![CDATA["+f+']]\></name><description><![CDATA[<table border="0" cellpadding="0" cellspacing="0" width="300" align="left"><tr><td>'+j+"</td></tr></table>]]\></description>";if("OpenLayers.Geometry.Point"===p)f=a.Map.Util.p2d(new OpenLayers.LonLat(b.geometry.x,b.geometry.y)),h="<Point><coordinates>"+f.lon+","+f.lat+(n?","+n:"")+"</coordinates></Point>";else if("OpenLayers.Geometry.MultiPoint"===
p){if(b.geometry.components){g=0;for(j=b.geometry.components.length;g<j;g++)f=b.geometry.components[g],f=a.Map.Util.p2d(new OpenLayers.LonLat(f.x,f.y)),h+="<Point><coordinates>"+f.lon+","+f.lat+(n?","+n:"")+"</coordinates></Point>"}}else if("OpenLayers.Geometry.LineString"===p){if(b.geometry.components){g=0;for(j=b.geometry.components.length;g<j;g++)f=b.geometry.components[g],f=a.Map.Util.p2d(new OpenLayers.LonLat(f.x,f.y)),h+=f.lon+","+f.lat+(n?","+n:"")+" "}h="<LineString><coordinates>"+h.substring(0,
h.length-1)+"</coordinates></LineString>"}else if("OpenLayers.Geometry.Polygon"===p){var q,m;if(b.geometry.components){g=0;for(j=b.geometry.components.length;g<j;g++){m=b.geometry.components[g];p=0;for(q=m.components.length;p<q;p++)f=m.components[p],f=a.Map.Util.p2d(new OpenLayers.LonLat(f.x,f.y)),h+=f.lon+","+f.lat+(n?","+n:"")+" "}}h="<Polygon><outerBoundaryIs><LinearRing><coordinates>"+h.substring(0,h.length-1)+"</coordinates></LinearRing></outerBoundaryIs></Polygon>"}}return""!==h?"<Placemark>"+
e+(d.color?"<styleUrl>#normalState</styleUrl>":this.featureToKMLStyle(b))+h+"</Placemark>":h},featureToKMLStyle:function(b){var d="",e,f,g;b&&b.layer&&(g=b.geometry.CLASS_NAME,e=b.layer.styleMap.styles["default"],f=b.style||e.defaultStyle,"OpenLayers.Geometry.Point"===g?(d=f.externalGraphic?this.resolveStyleAttribute(b,e,f.externalGraphic):a.Util.getImgUrl("ylw-pushpin.png"),"http:"!==d.substr(0,5)&&"/"!==d.substr(0,1)&&(d=a.Config.general.rootUrl+"/"+d),d="<Style><IconStyle><Icon><href>"+this.encode(a.Util.getAbsoluteUrl(d))+
"</href></Icon></IconStyle></Style>"):"OpenLayers.Geometry.LineString"===g?d="<LineStyle><color>"+this.color2KML(this.resolveStyleAttribute(b,e,f.strokeColor),1)+"</color><width>"+(f.strokeWidth||1)+"</width></LineStyle>":"OpenLayers.Geometry.Polygon"===g&&(d="<Style><PolyStyle><color>"+this.color2KML(this.resolveStyleAttribute(b,e,f.fillColor),f.fillOpacity)+"</color></PolyStyle></Style>"));return d},resolveStyleAttribute:function(a,b,e){var f=e;-1!==e.indexOf("${")&&(e=e.substring(2,e.length-1),
f=b.context&&$.isFunction(b.context[e])?b.context[e](a):a.attributes[e]);return f},color2KML:function(a,b){b=Math.round(16*(b||0.4)).toString(16);a=a?a.replace(/#/,"").toLowerCase():"ee9900";return b+b+a.substring(4,6)+a.substring(2,4)+a.substring(0,2)},imageToKML:function(b){var d=b._M&&b._M.bounds?a.Map.Util.p2d(b._M.bounds.clone()):a.Map.Util.p2d(b.bounds.clone());return b.url?"<GroundOverlay><name>"+this.encode(a.Util._(b.name))+"</name><description></description><drawOrder>0</drawOrder><Icon><href>"+
this.encode(b.url)+"</href></Icon><LatLonBox><north>"+d.top+"</north><south>"+d.bottom+"</south><east>"+d.left+"</east><west>"+d.right+"</west><rotation>0</rotation></LatLonBox></GroundOverlay>":""},wmsToKML:function(c){var d=b.Util.p2d(b.map.getExtent()),e=c._M.layerDescription.version||"1.1.0",e=c.url+"WIDTH=512&HEIGHT=256&FORMAT=image/png&TRANSPARENT=true&SERVICE=WMS&REQUEST=GetMap&LAYERS="+c._M.layerDescription.layers+"&VERSION="+e+("1.3.0"===e?"&CRS=EPSG:4326&BBOX="+d.bottom+","+d.left+","+d.top+
","+d.right:"&SRS=EPSG:4326&BBOX="+d.left+","+d.bottom+","+d.right+","+d.top);return c.url?"<GroundOverlay><name>"+this.encode(a.Util._(c.name))+"</name><description></description><drawOrder>0</drawOrder><Icon><href>"+this.encode(e)+"</href></Icon><LatLonBox><north>"+d.top+"</north><south>"+d.bottom+"</south><east>"+d.left+"</east><west>"+d.right+"</west><rotation>0</rotation></LatLonBox></GroundOverlay>":""},encode:function(a){return a.replace(/\&/g,"&amp;")}}})(window.M,window.M.Map);
(function(a){a.Map.Events=function(b){if(b.Events._o)return b.Events._o;this.map=b.map;this.events={featureselected:[],layersend:[],moveend:[],resizeend:[],visibilitychanged:[],mapclicked:[]};this.register=function(a,b,e){var f=a;if("loadstart"===a||"loadend"===a)f="layersend";this.events[f]&&this.events[f].push({scope:b,handler:e})};this.unRegister=function(a){var b,e,f,g;for(f in this.events){b=this.events[f];e=0;for(g=b.length;e<g;e++)if(b[e].scope===a){b.splice(e,1);break}}};this.trigger=function(c,
d){var e,f,g;if("layersend"===c){if(d){if(d.layer&&d.layer.features){e=0;var h=d.layer.features;f=0;for(g=h.length;f<g;f++)e+=h[f].cluster?h[f].cluster.length:1;d.layer._M.count=e}f=0;for(g=this.events.layersend.length;f<g;f++)e=this.events.layersend[f],d.layer&&"features"===d.action&&a.Map.Util.updateIndex(d.layer),e&&e.handler(d.action,d.layer,e.scope);if(!a.isLoaded){h=!1;f=0;for(g=this.map.layers.length;f<g;f++)if(e=this.map.layers[f],e.hasOwnProperty("_M")&&!e._M.MLayer&&!e._tobedestroyed&&!e._M.isLoaded){h=
!0;break}h||(a.isLoaded=!0,this.map.restrictedExtent?this.map.zoomToExtent(this.map.restrictedExtent):b.setCenter(b.Util.d2p(new OpenLayers.LonLat(b.initialLocation.lon,b.initialLocation.lat)),b.initialLocation.zoom,!0))}}}else if("loadstart"===c)d&&(d._M.isLoaded=!1,this.trigger("layersend",{action:"update",layer:d}));else if("loadend"===c)d&&(d._M.isLoaded=!0,this.trigger("layersend",{action:"update",layer:d}));else if("moveend"===c){f=0;for(g=this.events.moveend.length;f<g;f++)e=this.events.moveend[f],
e.handler(this.map,e.scope)}else if("resizeend"===c){f=0;for(g=this.events.resizeend.length;f<g;f++)e=this.events.resizeend[f],e.handler(e.scope)}else{f=0;for(g=this.events[c].length;f<g;f++)e=this.events[c][f],e.handler(d,e.scope)}};b.Events._o=this;return this}})(window.M);
(function(a){a.Map.LayersGroup=function(b,c,d){this.CLASS_NAME="M.Map.LayersGroup";this.map=b;this.name=c;this.id=a.Util.getId();this.icon=d||a.Util.getImgUrl("group.png");this.isLoaded=function(){for(var a=this.layers.length;a--;)if(!this.layers[a]._M.isLoaded)return!1;return!0};this.layers=[];this.layersManagerMenuItems=[];this.visibility=!0;this.add=function(a){for(var b=this.layers.length;b--;)if(this.layers[b]._M.MID===a._M.MID)return!1;this.layers.push(a);return!0};this.remove=function(a){for(var b=
this.layers.length,c=0;c<b;c++)if(this.layers[c]._M.MID===a._M.MID){this.layers.splice(c,1);break}return!0};this.zoomOn=function(){for(var a=null,b=null,c=this.layers.length;c--;)if((a=this.layers[c].getDataExtent())||(a=this.layers[c]._M.bounds))b?b.extend(a):b=a.clone();b&&this.map.zoomTo(b)};this.setVisibility=function(a){for(var b=this.layers.length;b--;)this.map.setVisibility(this.layers[b],a);this.visibility=a};this.getVisibility=function(){return this.visibility};this.getLayersManagerMenuItems=
function(){return this.layersManagerMenuItems}}})(window.M);
(function(a){a.Map.FeatureInfo=function(b){if(a.Map.FeatureInfo._o)return a.Map.FeatureInfo._o;this.hilited=this.selected=null;this.dimension={w:100,h:50};this.bypassCallback=null;this.init=function(){var b=this;b._p=new a.Popup({modal:!1,generic:!1,hideOnClose:!0,noHeader:!0,autoSize:!0,classes:"fipopup apo",followMap:!0,centered:!1,onClose:function(){b.clear()}});b._mip=new a.Popup({modal:!1,generic:!1,hideOnClose:!0,noHeader:!0,noFooter:!1,scope:b,classes:"mip",centered:!1,autoSize:!0,zIndex:3E4,
footer:'<div class="tools"></div>',onClose:function(){b.clear()}});b._mip.$b.addClass("padded");b.sidePanelItem=a.sidePanel.add({id:a.Util.getId()});a.Map.events.register("layersend",b,function(a,b,c){"remove"===a&&c.selected&&c.selected.layer&&c.selected.layer.id===b.id&&c.unselect(c.selected);return!0});a.Map.events.register("visibilitychanged",b,function(a,b){if(b.selected&&b.selected.layer===a)if(a.getVisibility()){var c=a._M.layerDescription.featureInfo;(!c||!c.noMenu)&&b.getPopup(a).show()}else b.hide()});
return b};this.getPopup=function(a){return!a?this._p:a._M.microInfoTemplate.enable?this._mip:this._p};this.clear=function(){var b=a.Map.Util.getControlById("__CONTROL_SELECT__");if(this.selected)try{b.unselect(this.selected)}catch(d){b.unselectAll()}else b.unselectAll();this.unselect(null)};this.setContent=function(b){var d,e;if(!b)return!1;d=b.layer._M.microInfoTemplate;d.enable?(e=a.Map.Util.Feature.getTitle(b),this._mip.$b.html(d.body?a.Util.parseTemplate(d.body,b.attributes):'<h2 class="shorten_30" title="'+
e+'">'+e+"</h2>"),a.Util.findAndShorten(this._mip.$d,!0),d=$(".tools",this._mip.$f)):(this._p.$b.html('<span class="title" style="white-space:nowrap;">'+a.Map.Util.Feature.getTitle(b)+'</span><br/><span class="tools"></span>'),d=$(".tools",this._p.$b));this.setTools(b,d);a.Map.$featureHilite.empty().hide();return!0};this.setTools=function(b,d){var e,f,g,h,j,n=this,p=[],q=b.layer._M.layerDescription.featureInfo;d.empty();p.push({id:a.Util.getId(),icon:"info.png",title:"Info",tt:"More info",callback:function(a,
b){n.showInfo(b);return!1}});p.push({id:a.Util.getId(),icon:"center.png",title:"Zoom",tt:"Zoom on feature",callback:function(){n.zoomOn();return!1}});b.layer.displayInLayerSwitcher&&p.push({id:a.Util.getId(),icon:"hide.png",title:"Hide the parent layer",callback:function(b,c){a.Map.Util.setVisibility(c.layer,!1)}});b.attributes.hasOwnProperty("services")&&(b.attributes.services.download&&p.push({id:a.Util.getId(),icon:"download.png",title:"Download",tt:"Download feature",sla:function(a,b){if(b&&b.attributes){var c=
b.attributes.services.download;a.attr("href",c.url);c.mimeType&&"text/html"===c.mimeType.toLowerCase()&&a.attr("target","_blank")}},callback:function(){return!0}}),(g=b.attributes.services.browse)&&p.push({id:a.Util.getId(),icon:"add.png",tt:g.title||"Add to map",title:"Add",callback:function(b,c){var d=a.Map.addLayer(c.attributes.services.browse.layer);d&&a.Map.zoomTo(d.getDataExtent()||d._M.bounds);return!1}}));for(e in a.plugins)if((g=a.plugins[e])&&$.isFunction(g.getFeatureActions))if(f=g.getFeatureActions(b))if(f instanceof
Array){g=0;for(h=f.length;g<h;g++)p.push(f[g])}else p.push(f);q&&q.action&&$.isFunction(q.action.callback)&&p.push({id:a.Util.getId(),icon:q.action.icon,title:q.action.title,tt:q.action.tt,callback:function(a,b){q.action.callback(a,b);return!1}});b.layer._M.searchContext&&(j=b.layer._M.searchContext.connector)&&j.action&&p.push({id:a.Util.getId(),icon:j.action.icon,title:j.action.title,tt:j.action.tt,sla:$.isFunction(j.action.sla)?j.action.sla:null,callback:function(a,b){return $.isFunction(j.action.callback)&&
"#"===a.attr("href")?(j.action.callback(a,b),!1):!0}});g=0;for(h=p.length;g<h;g++)e=p[g],d.append('<a class="item image" jtitle="'+a.Util._(e.tt||e.title)+'" id="'+e.id+'"><img class="middle" src="'+a.Util.getImgUrl(e.icon)+'"/></a>'),f=$("#"+e.id),a.tooltip.add(f,"n",10),function(a,b,c){a.click(function(){return b.callback(b,c)})}(f,e,b),e.sla&&e.sla(f,b)};this.select=function(b,d){var e,f,g;this._tse=(new Date).getTime();if(b.cluster&&(g=b.cluster.length,0<g)){b.layer||(b.layer=b.cluster[0].layer);
if(b.layer&&"Polygon"===b.layer._M.clusterType)this.selected=b,this.showCluster(b.cluster);else{f=b.cluster[0].geometry.getBounds().clone();for(e=1;e<g;e++)f.extend(b.cluster[e].geometry.getBounds());a.Map.map.zoomToExtent(f)}this.hide();return!1}this._p.setMapXY(this._triggered?a.Map.map.getCenter():"OpenLayers.Geometry.Point"===b.geometry.CLASS_NAME?b.geometry.getBounds().getCenterLonLat():a.Map.map.getLonLatFromPixel(a.Map.mousePosition));if(d){this._triggered=!0;e=a.Map.Util.getControlById("__CONTROL_SELECT__");
if(this.selected)try{e.unselect(this.selected)}catch(h){this.selected=null}return e.select(b)}this._triggered||a.Map.events.trigger("featureselected",b);this._triggered=!1;a.menu.hide();this.selected=b;if($.isFunction(this.bypassCallback)){this.bypassCallback(b);try{e.unselect(this.selected)}catch(j){this.selected=null}return!0}if(g=a.Map.layerTypes[b.layer._M.layerDescription.type].resolvedUrlAttributeName)e=a.Map.Util.Feature.getTitle(b),g=a.southPanel.add({id:a.Util.crc32(e+b.layer._M.layerDescription.type),
tt:e,title:e,unremovable:!1,html:'<iframe class="frame" src="'+b.attributes[g]+'" width="100%" height="100%"></iframe>',onclose:function(){b&&b.layer&&a.Map.Util.getControlById("__CONTROL_SELECT__").unselect(b);a.activity.hide()}}),a.southPanel.show(g),a.activity.show(),$(".frame",g.$d).load(function(){a.activity.hide()});else{g=b.layer._M.layerDescription.featureInfo;this.hide();if(!g||!g.noMenu)this.setContent(b),this.getPopup(b.layer).show();if(g&&$.isFunction(g.onSelect))g.onSelect(b)}return!0};
this.unselect=function(b){var d=this;d._tun=(new Date).getTime();b&&"Polygon"===b.layer._M.clusterType&&a.sidePanel.hide(d.sidePanelItem);if(b&&b.layer._M.layerDescription.featureInfo&&$.isFunction(b.layer._M.layerDescription.featureInfo.onUnselect))b.layer._M.layerDescription.featureInfo.onUnselect(b);a.Map.featureInfo.selected=null;a.Map.events.trigger("featureselected",null);setTimeout(function(){0<d._tun-d._tse&&(a.menu.hide(),d.hide())},10)};this.zoomOn=function(){a.Map.featureInfo.selected&&
a.Map.featureInfo.selected.geometry&&a.Map.zoomTo(a.Map.featureInfo.selected.geometry.getBounds())};this.hilite=function(b){var d=a.Map.Util.getControlById("__CONTROL_HIGHLITE__");if(d&&b)try{var e,f,g=a.Map.Util.getFeatures(b.layer);e=0;for(f=g.length;e<f;e++)d.unhighlight(g[e]);this.hilited=b;d.highlight(b)}catch(h){}};this.unhilite=function(b){var d=a.Map.Util.getControlById("__CONTROL_HIGHLITE__");if(d&&b)try{this.hilited=null,d.unhighlight(b)}catch(e){}};this.showInfo=function(b){if(!b)return!1;
var d,e,f,g,h,j,n,p;f=!0;e=a.Util.stripTags(a.Map.Util.Feature.getTitle(b));p=b.attributes.quicklook||b.attributes.imageUrl;d=a.Util.$$("#"+a.Util.getId(),$("#mapshup")).addClass("overall").append('<div class="fi"><div class="header"><div class="title"></div></div><div class="body"></div></div>');a.Util.addClose(d,function(){a.activity.hide();d.remove()});p?($(".body",d).append('<div class="ql" style="float:left;width:49%;"><img src="'+p+'"/></div><div class="info"></div>'),$(".ql img",d).css({"max-width":Math.round(4*
$("#mapshup").width()/10),"max-height":Math.round(9*$("#mapshup").height()/10)}),g=new Image,g.src=p,a.activity.show(),$(g).load(function(){a.activity.hide()}).error(function(){a.activity.hide()})):$(".body",d).append('<div class="info"></div>');$(".title",d).attr("title",b.layer.name+" | "+e).html(e);if((e=a.Map.layerTypes[b.layer._M.layerDescription.type])&&$.isFunction(e.setFeatureInfoBody))e.setFeatureInfoBody(b,$(".info",d)),f=!1;if(f)for(j in $(".info",d).html('<table style="width:'+(p?"45":
"95")+'%"></table>'),p=$(".info table",d),b.attributes)if(!("self"===j||"identifier"===j||"icon"===j||"thumbnail"===j||"quicklook"===j||"imageUrl"===j||"modified"===j||"color"===j))if(f=b.attributes[j])if(e=typeof f,"string"===e&&a.Util.isUrl(f))p.append("<tr><td>"+a.Map.Util.Feature.translate(j,b)+'</td><td>&nbsp;</td><td><a target="_blank" title="'+f+'" href="'+f+'">'+a.Util._("Download")+"</a></td></tr>");else if("object"===e){if("services"!==j)if("atom"===j)f.id&&p.append('<tr><td title="'+a.Util._("identifier")+
'">'+a.Util._("identifier")+"</td><td>&nbsp;</td><td>"+f.id+"<td></tr>"),f.updated&&p.append('<tr><td title="'+a.Util._("updated")+'">'+a.Util._("updated")+"</td><td>&nbsp;</td><td>"+f.updated+"<td></tr>");else for(n in f)if("object"===typeof f[n]){if("photos"===n){p.append('<tr><td></td><td>&nbsp;</td><td class="thumbs"><td></tr>');g=0;for(h=f[n].length;g<h;g++)e=a.Util.getId(),$(".thumbs",p).append('<img href="'+f[n][g].url+'" title="'+f[n][g].name+'" id="'+e+'" src="'+f[n][g].url+'"/>'),function(b){b.click(function(){a.Util.showPopupImage(b.attr("href"),
b.attr("title"));return!1})}($("#"+e))}}else e=a.Map.Util.Feature.translate(j,b),p.append('<tr><td title="'+e+'">'+e,"20 &rarr; "+a.Map.Util.Feature.translate(n,b)+"</td><td>&nbsp;</td><td>"+f[n]+"</td></tr>")}else e=a.Map.Util.Feature.translate(j,b),p.append('<tr><td title="'+e+'">'+e+"</td><td>&nbsp;</td><td>"+a.Map.Util.Feature.getValue(b,j,f)+"</td></tr>");d.show();return!0};this.showCluster=function(b){var d,e,f,g,h,j,n;n=this.sidePanelItem.$d.html('<div class="marged"></div>').children().first();
d=0;for(e=b.length;d<e;d++)f=b[d],f.layer&&(g=a.Util.encode(f.id)+"c",h=a.Map.Util.Feature.getIcon(f),j=a.Util.stripTags(a.Map.Util.Feature.getTitle(f)),n.append('<span class="thumbs" jtitle="'+j+'" id="'+g+'">'+(h?"":'<span class="title">'+j+"</span>")+'<img src="'+(h?h:a.Util.getImgUrl("nodata.png"))+'"></span>'),function(b,c){c.click(function(a){a.preventDefault();a.stopPropagation();return!1});a.tooltip.add(c,"e",10)}(f,$("#"+g)));a.sidePanel.show(this.sidePanelItem)};this.hide=function(){this._p.$d.is(":visible")&&
this._p.hide(!0);this._mip.$d.is(":visible")&&this._mip.hide(!0)};a.Map.FeatureInfo._o=this;return this.init(b)}})(window.M);
(function(a){a.Map.LayerDescription=function(b,c){this.obj=b;this.map=c;this.isValid=function(){var a,b,c;if(!this.obj||"object"!==typeof this.obj)return!1;a=this.getLayerType();if(!a)return!1;c=a.mandatories||[];a=0;for(b=c.length;a<b;a++)if(!this.obj.hasOwnProperty([c[a]]))return!1;return!0};this.getLayerType=function(){return!this.map||!this.obj?null:this.map.layerTypes[this.obj.type]};this.get=function(){return this.obj};this.getMID=function(){var b=this.obj,c=this.map.layerTypes[b.type];return b.MID?
b.MID:!c?null:$.isFunction(c.getMID)?c.getMID(b):b.replace&&b.hasOwnProperty("url")?a.Util.crc32(b.type+b.url.split("?")[0]):a.Util.crc32(b.type+(b.title||""))};this.getInfo=function(){var b=[];if(this.obj){var c=this.map.layerTypes[this.obj.type];c&&(b=[["Title",a.Util._(this.obj.title)],["Description",a.Util._(this.obj.description||"No description available")],["Type",a.Util._(this.obj.type)]],this.obj.preview&&b.push(["Preview",this.obj.preview]),$.isFunction(c.getInfo)&&(b=b.concat(c.getInfo(this.obj))))}return b};
this.getStyleMap=function(){var b=null,c=this.obj,f=c.hasOwnProperty("opacity")?c.opacity:0.2;c.hasIconAttribute&&(b="${icon}");b=new OpenLayers.Style(OpenLayers.Util.applyDefaults({pointRadius:b?10:"${scaledSize}",externalGraphic:b,fillOpacity:f,graphicOpacity:1,strokeColor:"#000",strokeWidth:1,label:"${label}",fontSize:"${fontSize}",fontColor:"${fontColor}",fontStrokeColor:"${fontColor}",fontStrokeWidth:0,fillColor:"${color}"},OpenLayers.Feature.Vector.style["default"]),{context:{icon:function(b){return b.cluster?
a.Util.getImgUrl("imgcluster.png"):b.attributes.icon},label:function(b){var c=b.layer._M.layerDescription.featureInfo;return b.cluster?b.cluster.length:c&&c.label&&c.label.value?c.label.value.replace(/\$+([^\$])+\$/g,function(c){c=c.replace(/[\$\$]/g,"");return a.Map.Util.Feature.getValue(b,c,b.attributes[c])}):""},fontSize:function(a){return(a=a.layer._M.layerDescription.featureInfo)&&a.label?a.label.size||10:20},fontColor:function(a){return(a=a.layer._M.layerDescription.featureInfo)&&a.label?a.label.color||
"#000":"#fff"},color:function(a){return a.cluster?"#666":a.attributes.color||a.layer._M.layerDescription.color||"darkgray"},scaledSize:function(a){if(a.cluster){if(a.attributes[c.filterOn]){for(var b,d,f,p=0,q=a.cluster.length;p<q;p++)b=a.cluster[p].attributes[c.filterOn],b>d&&(d=b,f=p);return 5*a.cluster[f].attributes[c.filterOn]}return 15+Math.min(2*a.cluster.length,40)}return a.attributes[c.filterOn]?5*a.attributes[c.filterOn]:15}}});return new OpenLayers.StyleMap({"default":b,select:{strokeColor:"#ffff00",
fillOpacity:0.9>=f?f+0.1:f-0.1}})}}})(window.M);
(function(a){a.Map.SearchContext=function(b,c,d){d=d||{};this.autoSearch=a.Util.getPropertyValue(d,"autoSearch",!1);this.connector=c;this.layer=b;this.nextRecord=a.Util.getPropertyValue(d,"nextRecord",1);this.nextRecordAlias=d.nextRecordAlias||"nextRecord";this.numRecordsPerPage=a.Util.getPropertyValue(d,"numRecordsPerPage",20);this.numRecordsPerPageAlias=d.numRecordsPerPageAlias||"numRecordsPerPage";this.totalResults=0;this.callback=d.callback;this.scope=d.scope;this.useGeo=!0;this.items=[];this.isDefined=
function(a){for(var b=0,c=this.items.length;b<c;b++){var d=this.items[b];if(a.id===d.id){if(void 0!==a.value)return!0;if(d.son&&a.son&&0<a.son.length)for(var j=0,n=d.son.length;j<n;j++)if(a.son[0].id===d.son[j].id)return!0}}return!1};this.add=function(a){for(var b=0,c=this.items.length;b<c;b++){var d=this.items[b];if(a.id===d.id){if(void 0!==a.value)d.value=a.value,d.title=a.title;else{b=0;for(c=d.son.length;b<c;b++)if(a.son[0].id===d.son[b].id)return d.son[b].value=a.son[0].value,d.son[b].title=
a.son[0].title,this.autoSearch&&"bbox"!==a.id&&this.search(),!0;d.son.push(a.son[0])}this.autoSearch&&"bbox"!==a.id&&this.search();return!0}}this.items.push(a);this.autoSearch&&"bbox"!==a.id&&this.search();return!0};this.clear=function(b){this.items=[];this.setGeo(this.useGeo);a.timeLine&&b&&this.setTime(a.timeLine.getInterval())};this.getSerializedParams=function(){for(var a=this.numRecordsPerPageAlias+"="+this.numRecordsPerPage,b=0,c=this.items.length;b<c;b++)if(a+="&"+encodeURIComponent(this.items[b].id)+
"=",void 0!==this.items[b].value)a+=encodeURIComponent(this.items[b].value);else for(var d=0,j=this.items[b].son.length;d<j;d++)0<d&&(a+="|"),a+=encodeURIComponent(this.items[b].son[d].value);return a};this.getValue=function(a){for(var b=0,c=this.items.length;b<c;b++)if(this.items[b].id===a)return this.items[b].value;return null};this.next=function(){var a=this.nextRecord+this.numRecordsPerPage;return a>this.totalResults?!1:this.search({nextRecord:a})};this.previous=function(){var a=this.nextRecord-
this.numRecordsPerPage;return 0>a?!1:this.search({nextRecord:a})};this.remove=function(a,b,c){var d,j,n,p;d=0;for(n=this.items.length;d<n;d++)if(null===b){if(a===this.items[d].id)return this.items.splice(d,1),c||this.autoSearch&&"bbox"!==b&&this.search(),!0}else if(b===this.items[d].id){j=0;for(p=this.items[d].son.length;j<p;j++)if(a===this.items[d].son[j].id)return this.items[d].son.splice(j,1),0===this.items[d].son.length&&this.items.splice(d,1),c||this.autoSearch&&"bbox"!==b&&this.search(),!0}return!1};
this.search=function(b){var c,d,h,j="",n=this.layer,p=this,b=b||{};d=b.nextRecord||1;h=$.isFunction(b.callback)?b.callback:null;if(n._M&&n._M.layerDescription.extras)for(c in n._M.layerDescription.extras)j+="&"+c+"="+n._M.layerDescription.extras[c];a.Util.ajax({url:a.Util.proxify(this.connector.searchUrl+this.getSerializedParams()+"&"+p.nextRecordAlias+"="+d+j),async:!0,dataType:"json",success:function(b){var c,e,f=a.Plugins.LayersManager;b?b.error?a.Util.message(n.name+" : "+b.error.message,-1):
(1===d&&n.destroyFeatures(),c=(new OpenLayers.Format.GeoJSON({internalProjection:a.Map.map.getProjectionObject(),externalProjection:a.Map.pc})).read(b),e=c.length,!c||0===e?(a.Util.message(a.Util._(n.name)+" : "+a.Util._("No result")),n._M.clusterized&&$.isFunction(n.strategies[0].recluster)&&(n.strategies[0].clearCache(),n.strategies[0].recluster())):(n._M.clusterized?(c=a.Map.Util.getFeatures(n).concat(c),n.addFeatures(c),$.isFunction(n.strategies[0].recluster)&&n.strategies[0].recluster()):n.addFeatures(c),
c=n._M.layerDescription.onSearch||{},c.zoom?a.Map.zoomTo(n.getDataExtent()):a.Map.Util.zoomOn(n),$.isFunction(c.callback)&&c.callback(n),f&&f._o&&f._o.show(f._o.get(n._M.MID)),h&&h(p.scope,n)),e>p.numRecordsPerPage&&(p.numRecordsPerPage=e),n._M.searchContext.nextRecord=d,n._M.searchContext.totalResults=b.hasOwnProperty("totalResults")?b.totalResults:e,a.Map.events.trigger("layersend",{action:1===d?"features":"featureskeep",layer:n}),p.callback&&p.callback(p.scope,n)):(1===d&&n.destroyFeatures(),a.Map.events.trigger("layersend",
{action:"features",layer:n}),a.Util.message(n.name+" : "+a.Util._("No resut")))}},{title:a.Util._("Searching")+" : "+a.Util._(this.layer.name),cancel:!0});return!0};this.setGeo=function(b){this.useGeo=b;this.setBBOX(this.useGeo?a.Map.map.getExtent():null);this.autoSearch&&this.search()};this.setBBOX=function(b){b?(b=a.Map.Util.p2d(b.clone()),b={id:"bbox",title:a.Util._("Search Area"),son:[{id:"geometry",title:"geometry",value:a.Map.Util.convert({input:b,format:"EXTENT",precision:5,limit:!0})}]},this.add(b)):
this.remove("geometry","bbox")};this.setFilter=function(a,b){for(var c=0,d=this.connector.filters.length;c<d;c++)if(this.connector.filters[c].id===a){"text"===this.connector.filters[c].type&&this.add({id:this.connector.filters[c].id,title:this.connector.filters[c].title,operator:this.connector.filters[c].operator,value:b});break}};this.setTime=function(b){var c,d;c=this.connector.startDateAlias;d=this.connector.completionDateAlias;b?(c&&this.add({id:c,title:a.Util._("Date"),value:b[0]}),d&&this.add({id:d,
title:a.Util._("Date"),value:b[1]})):(this.remove(c,null),this.remove(d,null))};this.setSearchTerms=function(b){var c=this.connector.searchKeyAlias?this.connector.searchKeyAlias:"q";b?this.add({id:c,title:a.Util._("searchTerms"),value:b}):this.remove(c,null)};return this}})(window.M);
(function(a,b){b.layerTypes.Atom={clusterized:!0,icon:"vector.png",isFile:!0,hasStyleMap:!0,selectable:!0,add:function(c,d){var e,f=this;c.title=a.Util.getTitle(c);d._M.clusterized&&!d.hasOwnProperty("strategies")&&(d.strategies=[new OpenLayers.Strategy.Cluster(new OpenLayers.Strategy.Cluster(b.clusterOpts))]);e=new OpenLayers.Layer.Vector(c.title,d);c.hasOwnProperty("data")?f.load(c.data,c,e)||a.Map.removeLayer(e,!1):(e._M.isLoaded=!1,e.events.register("featuresadded",e,function(){b.events.trigger("layersend",
{action:"features",layer:e})}),$.ajax({url:a.Util.proxify(a.Util.getAbsoluteUrl(c.url)),layer:e,async:!0,success:function(b){f.load(b,c,this.layer)||a.Map.removeLayer(this.layer,!1)}}));return e},load:function(c,d,e){var f;try{f="EPSG:3857"===d.srs||"EPSG:900913"===d.srs?(new OpenLayers.Format.Atom).read(c):(new OpenLayers.Format.Atom({internalProjection:b.map.getProjectionObject(),externalProjection:b.pc})).read(c)}catch(g){return a.Util.message(e.name+" : "+a.Util._("Error"),-1),!1}if(f){if(0===
f.length)return a.Util.message(a.Util._(e.name)+" : "+a.Util._("No result")),!1;a.Util.message(a.Util._("Added")+" : "+a.Util._(e.name));e._M.isLoaded=!0;e.addFeatures(f);b.Util.zoomOn(e)}return!0}}})(window.M,window.M.Map);
(function(a,b){b.layerTypes.Bing={isRaster:!0,add:function(b,d){$.extend(d,{isBaseLayer:!0,name:a.Util.getTitle(b),key:b.key,type:b.bingType,transitionEffect:"resize"});var e=new OpenLayers.Layer.Bing(d);e.projection=new OpenLayers.Projection("EPSG:3857");return e},getMID:function(b){return b.MID||a.Util.crc32(b.type+(b.bingType||""))}}})(window.M,window.M.Map);
(function(a,b){b.layerTypes.Generic={icon:"map.png",add:function(b,d){b.title=a.Util.getTitle(b);if(!b.layer)return new OpenLayers.Layer.Vector(b.title,d);b.layer._M=d._M;return b.layer}}})(window.M,window.M.Map);
(function(a,b){b.layerTypes.GeoJSON={clusterized:!0,icon:"vector.png",isFile:!0,hasStyleMap:!0,selectable:!0,add:function(c,d,e){var f;c.title=a.Util.getTitle(c);d._M.clusterized&&!d.hasOwnProperty("strategies")&&(d.strategies=[new OpenLayers.Strategy.Cluster(b.clusterOpts)]);f=new OpenLayers.Layer.Vector(c.title,d);f.events.register("featuresadded",f,function(){b.events.trigger("layersend",{action:"features",layer:f})});c.hasOwnProperty("data")?(f.destroyFeatures(),this.load({data:c.data,layerDescription:c,
layer:f,zoomOnNew:c.zoomOnNew})||(f._M.isLoaded=!0,b.events.trigger("layersend",{action:"features",layer:f}))):c.url&&(f._M.isLoaded=!1,this.refresh(f,e));return f},load:function(c){var d,e,c=c||{};if(!c.data||!c.data.features||c.data.error)return a.Util.message(c.layer.name+" : "+(c.data?c.data.error.message:"Error"),-1),null;d=c.data.features.length;e=c.layer._M.pagination||{};if(0===d)return a.Util.message(a.Util._(c.layer.name)+" : "+a.Util._("No result")),null;c.layer._M.isLoaded=!0;e.numRecordsPerPage&&
e.nextRecord&&(d>e.numRecordsPerPage.value&&(e.numRecordsPerPage.value=d),e.nextRecord.value+=d,e.totalResults=c.data.hasOwnProperty("totalResults")?c.data.totalResults:d);e=c.layerDescription&&("EPSG:3857"===c.layerDescription.srs||"EPSG:900913"===c.layerDescription.srs)?(new OpenLayers.Format.GeoJSON).read(c.data):(new OpenLayers.Format.GeoJSON({internalProjection:b.map.getProjectionObject(),externalProjection:b.pc})).read(c.data);if(c.layer._M.clusterized){var f=b.Util.getFeatures(c.layer),g=f.length,
h=0;for(d=e.length;h<d;h++)f[g+h]=e[h];c.layer.destroyFeatures();c.layer.addFeatures(f)}else c.layer.addFeatures(e);c.zoomOnNew?b.Util.Feature.zoomOn(e,"always"===c.zoomOnNew?!1:!0):b.Util.zoomOn(c.layer);return e},next:function(b){var d=this,e=b._M.pagination,f=b._M.layerDescription;if(!e||e.totalResults&&e.nextRecord.value>e.totalResults)return!1;a.Util.ajax({url:a.Util.proxify(a.Util.paginate(f.url,e)),layer:b,async:!0,dataType:"json",success:function(a){d.load({data:a,layerDescription:f,layer:this.layer})}},
{title:a.Util._("Retrieve features"),cancel:!0});return!0},refresh:function(c,d){var e,f,g=this;if(!c||!c._M)return!1;f=c._M.layerDescription;e=c._M.pagination||{};e.nextRecord&&(e.nextRecord.value=1);e=d?a.Util.getAbsoluteUrl(d+encodeURIComponent(f.url+a.Util.abc)):f.url;$.ajax({url:a.Util.proxify(a.Util.paginate(e,c._M.pagination)),layer:c,async:!0,dataType:"json",success:function(a){this.layer.destroyFeatures();g.load({data:a,layerDescription:f,layer:this.layer,zoomOnNew:f.zoomOnNew})||(this.layer._M.isLoaded=
!0,b.events.trigger("layersend",{action:"features",layer:this.layer}))}});return!0}}})(window.M,window.M.Map);
(function(a,b){b.layerTypes.Google={isRaster:!0,add:function(b,d){if("object"!==typeof google||void 0===google.maps)return null;if(/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)){var e;e=navigator.userAgent.indexOf("Version");if(-1!==e&&6>parseFloat(navigator.userAgent.substring(e+8).split(" ")[0]))return null}b.googleType=a.Util.getPropertyValue(b,"googleType","roadmap");b.title=a.Util.getTitle(b);$.extend(d,{isBaseLayer:!0,numZoomLevels:a.Util.getPropertyValue(b,"numZoomLevels",
a.Map.map.getNumZoomLevels()),transitionEffect:"resize",type:b.googleType});e=new OpenLayers.Layer.Google(b.title,d);e.projection=new OpenLayers.Projection("EPSG:3857");return e},getMID:function(b){return b.MID||a.Util.crc32(b.type+(b.googleType||"roadmap"))}}})(window.M,window.M.Map);
(function(a,b){b.layerTypes.WMS={isRaster:!0,icon:"wms.png",mandatories:["layers"],add:function(c,d){var e,f;$.extend(c,this.getLayerDescriptionFromUrl(c.url));c.url=a.Util.repareUrl(c.url);c.srs=a.Util.getPropertyValue(c,"srs",b.pc.projCode);e=c.version||"1.1.1";if(!(new b.LayerDescription(c,b)).isValid()||!c.hasOwnProperty("layers"))return c.initial||this.update(c),null;if(!d.projection||!c.isBaseLayer)if(f=a.Util.getPropertyValue(b.map,"projection",b.pc),c.srs!==f.projCode)return OpenLayers.Request.GET({url:a.Util.getAbsoluteUrl(a.Config.general.reprojectionServiceUrl)+
a.Util.abc+"&url="+encodeURIComponent(c.url)+"&layers="+encodeURIComponent(c.layers)+"&srs="+c.srs,callback:function(d){d=(new OpenLayers.Format.JSON).read(d.responseText);d.success?(c.projectedUrl=d.url,c.srs=b.map.getProjectionObject().projCode,b.addLayer(c)):a.Util.message(a.Util._("Error : cannot reproject this layer"))}}),null;$.extend(d._M,{selectable:!1,bounds:b.Util.getProjectedBounds(c.bbox||{bounds:"-170,-80,170,80",srs:"EPSG:4326"}),allowChangeOpacity:!0,legend:c.url+"service=WMS&version="+
e+"&format=image/png&request=GetLegendGraphic&layer="+c.layers,icon:this.getPreview(c)});$.extend(d,{buffer:0,wrapDateLine:!0,isBaseLayer:a.Util.getPropertyValue(c,"isBaseLayer",!1),attribution:c.attribution||null});c.time&&c.time.hasOwnProperty("default")&&(d.time=c.time["default"]);c.title=a.Util.getTitle(c);var g=new OpenLayers.Layer.WMS(c.title,a.Util.getPropertyValue(c,"projectedUrl",c.url),{layers:c.layers,format:"image/png",transitionEffect:"resize",transparent:"true",SLD:c.SLD,version:e},
d);c.hasOwnProperty("time")&&(g._M.setTime=function(a){a=$.isArray(a)?a[0]+(""!==a[1]?"/"+a[1]:""):"";this.layerDescription.time&&(this.layerDescription.time=this.layerDescription.time||{},this.layerDescription.time.value=a,g.mergeNewParams({time:a}))});return g},getLayerDescriptionFromUrl:function(b){var d={url:b};if(!b)return d;var e=a.Util.extractKVP(b,!0);if(!e.request||"getmap"!==e.request.toLowerCase())return d;$.extend(d,{url:a.Util.extractBaseUrl(b,"layers format transparent transitioneffect styles version request styles srs crs bbox width height".split(" ")),
preview:a.Util.extractBaseUrl(b,["width","height"])+"width=125&height=125",layers:e.layers,version:e.version,bbox:{bounds:e.bbox,srs:e.srs,crs:e.crs},srs:e.srs||e.crs});return d},update:function(c,d){var e,f,g,h,j=b.layerTypes.WMS,n=!d||!$.isFunction(d)?!1:!0;b.predefined.items.WMS=b.predefined.items.WMS||[];h=b.predefined.items.WMS;e=0;for(f=h.length;e<f;e++)if(g=h[e],g.url===c.url&&void 0!==g.capabilities)return c.capabilities=g.capabilities,n&&d(j.getLayerDescriptions(c)),!0;a.Util.ajax({url:a.Util.proxify(a.Util.repareUrl(c.url+
"request=GetCapabilities&service=WMS&version=1.1.1"),"XML"),async:!0,success:function(e,f,m){c.capabilities=a.Util.getCapabilities(m,new OpenLayers.Format.WMSCapabilities);c.title||(c.title=c.capabilities.service?c.capabilities.service.title:a.Util.getTitle(c));m=!1;e=0;for(f=h.length;e<f;e++)if(g=h[e],g.url===c.url&&void 0===g.layers){g.capabilities=c.capabilities;m=!0;break}m||b.predefined.add({type:"WMS",title:c.title,url:c.url,capabilities:c.capabilities});n&&d(j.getLayerDescriptions(c))},error:function(){a.Util.message(a.Util._("Error reading Capabilities file"))}},
{title:a.Util._("WMS")+" : "+a.Util._("Get capabilities"),cancel:!0});return!0},getLayerDescriptions:function(c){var d=[],e;if(!c||"object"!==typeof c)return d;e=c.capabilities;if(!e||!e.capability)d={type:"error",error:{message:"Error performing GetCapabilities operation"}};else for(var c=a.Util.repareUrl(c.url),f,g,h=e.capability.nestedLayers&&e.capability.nestedLayers[0]?e.capability.nestedLayers[0].title:null,j=0,n=e.capability.layers.length;j<n;j++){g=e.capability.layers[j];f={type:"WMS",title:g.title,
ptitle:h,url:c,layers:g.name,preview:this.getPreview({url:c,version:e.version,bbox:{bounds:g.llbbox,srs:"EPSG:4326"},layers:g.name}),version:e.version,bbox:{bounds:"-170,-80,170,80",srs:"EPSG:4326"}};g.llbbox&&4===g.llbbox.length&&(f.bbox.bounds=g.llbbox[0]+","+g.llbbox[1]+","+g.llbbox[2]+","+g.llbbox[3]);f.queryable=g.queryable?!0:!1;g.dimensions&&g.dimensions.time&&(f.time={"default":g.dimensions.time["default"],values:g.dimensions.time.values||[]});for(var p in g.srs)if(p===b.map.getProjectionObject().projCode)break;
p!==b.map.getProjectionObject().projCode&&(p=b.pc);f.srs=p;d.push(f)}return d},getPreview:function(b){var d,e,f,b=b||{};if(b.preview)return b.preview;e=b.version||"1.1.1";(f=a.Map.Util.getGeoBounds(b.bbox))||(f=new OpenLayers.Bounds(-180,-90,180,90));d=a.Util.repareUrl(b.url)+"WIDTH=150&HEIGHT=75&STYLES=&FORMAT=image/png&TRANSPARENT=false&SERVICE=WMS&REQUEST=GetMap&VERSION="+e;d="1.3.0"===e?d+("&CRS=EPSG:4326&BBOX="+f.bottom+","+f.left+","+f.top+","+f.right):d+("&SRS=EPSG:4326&BBOX="+f.left+","+f.bottom+
","+f.right+","+f.top);return d+"&LAYERS="+b.layers},getFeatureInfo:function(c,d){if(!c)return[];var d=d||{},e,f,g,h,j=[],n=b.map.getPixelFromLonLat(c);for(e=b.map.layers.length;e--;)if(f=b.map.layers[e],f._M&&(g=f._M.layerDescription)&&"WMS"===g.type&&g.queryable){g.version=g.version||"1.1.1";h=a.Util.repareUrl(g.url);h+="SERVICE=WMS";h+="&VERSION="+g.version;h+="&REQUEST=GetFeatureInfo";h+="&EXCEPTIONS=application/vnd.ogc.se_xml";h+="&X="+n.x;h+="&Y="+n.y;h+="&INFO_FORMAT="+(d.responseFormat?d.responseFormat:
"text/plain");h+="&QUERY_LAYERS="+g.layers;h+="&LAYERS="+g.layers;h+="&WIDTH="+b.map.size.w;h+="&HEIGHT="+b.map.size.h;if(g.projectedUrl){var p=b.map.p2d(map.getExtent().clone());h+="&BBOX="+p.toBBOX();h+="&SRS="+b.pc.projCode}else h+="&BBOX="+b.map.getExtent().toBBOX(),h+="&SRS="+g.srs;f={identifier:g.layers,name:f.name};j.push(f);(function(b,c){$.ajax({url:a.Util.proxify(c),async:!0,dataType:"text",success:function(a){"function"===typeof d.callback&&d.callback(b.identifier,a)},error:function(){"function"===
typeof d.callback&&d.callback(b.identifier,null)}})})(f,h)}return j},getMID:function(b){return b.MID||a.Util.crc32(b.type+(a.Util.repareUrl(b.url)||"")+(b.layers||""))}}})(window.M,window.M.Map);
(function(a,b){b.layerTypes.WMTS={isRaster:!0,icon:"wms.png",mandatories:["layer","matrixSet"],add:function(b,d){var e,f=b.matrixLength||22,g=Array(f);b.url=a.Util.repareUrl(b.url);for(e=0;e<=f;++e)g[e]=(b.prefixMatrix?b.prefixMatrix:"")+e;$.extend(d,{name:b.title,url:b.url,layer:b.layer,matrixSet:b.matrixSet,matrixIds:g,maxZoomLevel:f,format:b.format||"image/png",style:b.style||"normal",version:"1.0.0",wrapDateLine:!0,isBaseLayer:a.Util.getPropertyValue(b,"isBaseLayer",!1),attribution:b.attribution||
null});b.time&&b.time.hasOwnProperty("default")&&(d.time=b.time["default"]);var h=new OpenLayers.Layer.WMTS(d);b.hasOwnProperty("time")&&(h._M.setTime=function(a){a=$.isArray(a)?a[0]:"";a=a.split("T")[0];this.layerDescription.time&&(this.layerDescription.time=this.layerDescription.time||{},this.layerDescription.time.value=a,h.mergeNewParams({TIME:a}))});return h},getMID:function(b){return b.MID||a.Util.crc32(b.type+(a.Util.repareUrl(b.url)||"")+(b.layer||"")+(b.matrixSet||""))}}})(window.M,window.M.Map);
(function(a,b){b.layerTypes.XYZ={isRaster:!0,add:function(b,d){$.extend(d,{numZoomLevels:a.Util.getPropertyValue(b,"numZoomLevels",a.Map.map.getNumZoomLevels()),sphericalMercator:!0,wrapDateLine:!0,transitionEffect:"resize",buffer:0,isBaseLayer:a.Util.getPropertyValue(b,"isBaseLayer",!0)});d._M.selectable=!1;d._M.allowChangeOpacity=!0;var e=new OpenLayers.Layer.XYZ(b.title,b.url,d);e.projection=new OpenLayers.Projection("EPSG:3857");return e},getMID:function(b){if(b.MID)return b.MID;var d=b.url;"object"===
typeof b.url&&(d=b.url.toString());return a.Util.crc32(b.type+(d||""))}}})(window.M,window.M.Map);
(function(a){a.Plugins.Distance=function(){if(a.Plugins.Distance._o)return a.Plugins.Distance._o;this.result={title:"",elevations:[],plots:null};this.init=function(b){var c=this;c.options=b||{};$.extend(c.options,{elevationServiceUrl:a.Util.getPropertyValue(b,"elevationServiceUrl","http://maps.google.com/maps/api/elevation/json?sensor=false&"),samples:a.Util.getPropertyValue(b,"samples",30)});c.uid=a.Util.getId();b=new OpenLayers.Control.Measure(OpenLayers.Handler.Path,{id:"__CONTROL_MEASURE__",persist:!0,
handlerOptions:{layerOptions:{styleMap:new OpenLayers.StyleMap({"default":new OpenLayers.Style("default",{rules:[new OpenLayers.Rule({symbolizer:{Point:{pointRadius:6,graphicName:"circle",fillColor:"gray",fillOpacity:1,strokeWidth:1,strokeOpacity:1,strokeColor:"white"},Line:{pointRadius:6,strokeWidth:3,strokeOpacity:1,strokeColor:"#FFFFFF",strokeDashstyle:"dash"}}})]})})}},eventListeners:{measure:function(b){var e=b.units,f=b.measure,g="",g=1===b.order?g+(a.Util._("Distance")+" : "+f.toFixed(3)+" "+
e):g+(a.Util._("Area")+" : "+f.toFixed(3)+" "+e+"<sup>2</sup>");c.result.title=g;c.result.elevations=[];c.result.plots=null;c.display(b.geometry.getVertices());a.Map.resetControl(this)}}});c.layer=new OpenLayers.Layer.Vector("__LAYER_DISTANCE__",{projection:a.Map.pc,displayInLayerSwitcher:!1,styleMap:new OpenLayers.StyleMap({"default":new OpenLayers.Style("default",{rules:[new OpenLayers.Rule({symbolizer:{Point:{pointRadius:"${size}",graphicName:"circle",fillColor:"${color}",fillOpacity:1,strokeWidth:1,
strokeOpacity:1,strokeColor:"white",label:"${label}",fontColor:"white",fontSize:"12px",labelXOffset:"10",labelYOffset:"10",labelAlign:"rm"}}})]})})});a.Map.addLayer({type:"Generic",title:c.layer.name,unremovable:!0,MLayer:!0,layer:c.layer});a.Map.map.addControl(b);a.menu&&a.menu.add([{id:a.Util.getId(),ic:"distance.png",ti:"Measure distance",cb:function(){a.Map.Util.getControlById("__CONTROL_MEASURE__").activate()}}]);a.Map.events.register("layersend",c,function(b,c,f){a.Map.Util.setLayerOnTop(f.layer)});
a.Map.events.register("resizeend",c,function(a){a.refreshElevation()});return this};this.display=function(b){if(this.options.elevationServiceUrl&&$.isFunction($.jqplot)){var c,d,e=!0,f="",g=null,h=Number.MAX_VALUE,j=Number.MIN_VALUE,n=Number.MAX_VALUE,p=Number.MIN_VALUE,q=this;c=0;for(d=b.length;c<d;c++)g=a.Map.Util.p2d(b[c]),e||(f+="|"),e=!1,g.x<h&&(h=g.x),g.x>j&&(j=g.x),g.y<n&&(n=g.y),g.y>p&&(p=g.y),f+=g.y+","+g.x;a.Util.ajax({url:a.Util.proxify(a.Util.repareUrl(a.Util.getAbsoluteUrl(this.options.elevationServiceUrl))+
"path="+f+"&samples="+q.options.samples),async:!0,dataType:"json",success:function(b){var c,d,e,f,g=q.layer,h=[];a.Map.Util.setVisibility(g,!0);g.destroyFeatures();if(b&&0<b.results.length){d=b.results.length;for(c=1;c<=d;c++)f=b.results[c-1],e=a.Map.Util.d2p(new OpenLayers.LonLat(parseFloat(f.location.lng),parseFloat(f.location.lat))),e=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(e.lon,e.lat),{label:1===c||0===c%5?c:"",size:1===c||c===q.options.samples?6:4,color:1===c?"green":c===
q.options.samples?"red":0===c%5?"alt":"gray"}),g.addFeatures(e),h[c-1]=[c,parseFloat(f.elevation)],q.result.elevations.push({id:c,lat:f.location.lat,lng:f.location.lng,elevation:f.elevation});q.panelItem||(q.panelItem=a.southPanel.add({id:q.uid,title:"Elevation",onclose:function(){q.result.plots=[];a.Map.Util.setVisibility(q.layer,!1);q.panelItem=null},onshow:function(){a.Map.Util.setVisibility(q.layer,!0)}}),q.$e=q.panelItem.$content);q.result.plots=[h];q.fresh=!0;q.showElevation()}else a.Util.message(q.result.title)},
error:function(){a.Util.message(q.result.title)}},{title:a.Util._("Retrieve elevation data..."),cancel:!0})}else a.Util.message(this.result.title)};this.showElevation=function(){this.fresh&&a.southPanel.show(this.panelItem);this.fresh=!1;this.refreshElevation()};this.refreshElevation=function(){this.result.plots&&0!==this.result.plots.length&&(this.$e.empty(),$.jqplot(this.$e.attr("id"),this.result.plots,{axes:{xaxis:{min:1,max:this.samples,label:this.result.title,tickOptions:{formatString:"%d"}},
yaxis:{label:a.Util._("Elevation (m)"),labelRenderer:$.jqplot.CanvasAxisLabelRenderer}},cursor:{show:!0,showTooltip:!0,tooltipFormatString:"%d: %.1 m",tooltipLocation:"nw"},seriesDefaults:{fill:!0,fillToZero:!0,shadow:!1,color:"#000",fillColor:"#000"},negativeSeriesColors:["#555"]}))};a.Plugins.Distance._o=this;return this}})(window.M);
(function(a){a.Plugins.Geonames=function(){if(a.Plugins.Geonames._o)return a.Plugins.Geonames._o;this.currentWidth=0;this.justLaunched=!1;this.items=[];this.init=function(b){this.options=b||{};if(!this.options.findNearByUrl)return!1;this.options.featureClassString=this.options.featureClassString||"";this.$d=a.Util.$$("#gnm",a.$map).addClass("apo").html('<div class="content"><div class="header"></div></div>');var c=this;this.layer=new OpenLayers.Layer.Vector("__WHEREAMI__",{projection:a.Map.pc,displayInLayerSwitcher:!1,
popup:{move:function(){if(c.layer){var b=c.layer.features[0],e=b?a.Map.map.getPixelFromLonLat(b.geometry.getBounds().getCenterLonLat()):{x:(a.$map.width()-c.$d.width())/2,y:a.$map.height()/2-c.$d.height()};c.$d.css({left:e.x-31,top:e.y-c.$d.outerHeight()-9});c.justLaunched&&(c.currentWidth=c.$d.width(),c.justLaunched=!1);c.layer.getVisibility()&&b&&(c.$d.show(),(c.$d.offset().left<a.$map.offset().left||c.$d.offset().left+c.currentWidth>a.$map.offset().left+a.$map.width()||c.$d.offset().top<a.$map.offset().top||
c.$d.offset().top+c.$d.height()>a.$map.offset().top+a.$map.height())&&c.$d.hide())}},show:function(b){if(b&&b.geonames)if(b=b.geonames[0]){var e=[],f,g,h={xy:a.Map.Util.d2p(new OpenLayers.Geometry.Point(b.lng,b.lat)),zoomOn:function(b){var b=b||!1,c=new OpenLayers.LonLat(this.xy.x,this.xy.y);b?a.Map.map.setCenter(c,Math.max(a.Map.map.getZoom()-1,a.Map.lowestZoomLevel)):14>a.Map.map.getZoom()?a.Map.map.setCenter(c,14):a.Map.map.setCenter(c,a.Map.map.getZoom()+1)}},j=new OpenLayers.Feature.Vector(h.xy);
e.push({id:a.Util.getId(),ic:"plus.png",cb:function(){h.zoomOn(!1)}});e.push({id:a.Util.getId(),ic:"minus.png",cb:function(){h.zoomOn(!0)}});f=0;for(g=c.items.length;f<g;f++)e.push(c.items[f]);e.push({id:a.Util.getId(),ic:"x.png",cb:function(){c.$d.hide();a.Map.Util.setVisibility(c.layer,!1)}});f=a.Util._(b.fcodeName);var n=$(".header",c.$d).html('<span class="title" title="'+b.name+(f&&0<f.length?" - "+f.substr(0,1).toUpperCase()+f.substr(1,f.length-1):"")+'">'+a.Util.shorten(b.name+", "+b.countryName,
35)+"</span> | ");f=0;for(g=e.length;f<g;f++)(function(b,c){n.append('<a href="#" class="image item" id="'+b.id+'">'+(b.ic?'<img class="middle" src="'+a.Util.getImgUrl(b.ic)+'"/>':b.ti)+"</a>");$("#"+b.id).click(function(){b.cb(c);return!1})})(e[f],b);c.layer.destroyFeatures();c.layer.addFeatures(j);c.$d.hide();a.Map.Util.setVisibility(c.layer,!0);this.move();(!a.Map.map.getExtent().containsBounds(j.geometry.getBounds(),!0,!0)||!c.$d.is(":visible"))&&a.Map.setCenter(j.geometry.getBounds().getCenterLonLat())}else a.Util.message("&nbsp;"+
a.Util._("Location not found")+"&nbsp;")}},styleMap:new OpenLayers.StyleMap({"default":new OpenLayers.Style({externalGraphic:a.Util.getImgUrl("shadow.png"),graphicXOffset:-8,graphicYOffset:-30,graphicWidth:32,graphicHeight:32})})});this.layer.events.register("move",this.layer,function(){this.popup.move()});this.layer.events.register("moveend",this.layer,function(){c.currentWidth=c.$d.width();this.popup.move()});a.Map.addLayer({type:"Generic",title:"__WHEREAMI__",unremovable:!0,MLayer:!0,layer:this.layer});
a.menu&&a.menu.add([{id:a.Util.getId(),ic:"whereami.png",ti:"Where am I ?",cb:function(){c.whereAmI(a.Map.Util.p2d(a.menu.lonLat.clone()))}}]);return!0};this.whereAmI=function(b){var c=this.options.featureClassString||"",d=this;a.Util.ajax({url:a.Util.proxify(a.Util.getAbsoluteUrl(this.options.findNearByUrl)+c+"&lat="+b.lat+"&lng="+b.lon),async:!0,dataType:"json",success:function(a,b,c){200===c.status&&(d.justLaunched=!0,d.layer.popup.show(a))},error:function(){a.Util.message("&nbsp;"+a.Util._("Location not found")+
"&nbsp;")}},{title:a.Util._("Search for location name..."),cancel:!0})};this.add=function(a){if($.isArray(a))for(var c=0,d=a.length;c<d;c++)this.items.push(a[c])};a.Plugins.Geonames._o=this;return this}})(window.M);
(function(a){a.general.rootUrl="http://localhost/mapshup";a.general.serverRootUrl=a.general.rootUrl+"/s";a.general.indexPath="/index.html";a.general.confirmDeletion=!0;a.general.coordinatesFormat="dms";a.general.displayContextualMenu=!0;a.general.displayCoordinates=!0;a.general.displayScale=!0;a.general.enableHistory=!0;a.general.featureHilite=!0;a.general.location={lon:0,lat:40,zoom:2};a.general.overviewMap="closed";a.general.proxyUrl="/proxy.php?";a.general.getContextServiceUrl="/plugins/logger/getContext.php?uid=";
a.general.refreshInterval=1E3;a.general.reprojectionServiceUrl="/mapserver/getReprojectedWMS.php?";a.general.rssToGeoRSSServiceUrl="/utilities/rss2georss.php?url=";a.general.saveStreamServiceUrl="/utilities/saveStream.php?";a.general.shpToWMSServiceUrl="/mapserver/shp2wms.php?";a.general.mbtilesServiceUrl="/utilities/mbtsrv.php?zxy=${z}/${x}/${y}&t=";a.general.numRecordsPerPage=20;a.general.themePath="/js/mapshup/theme/default";a.general.teleport=!1;a.general.timeLine={enable:!0};a.i18n.langs=["en",
"fr","de","jp"];a.i18n.lang="auto";a.i18n.path="/js/mapshup/i18n";a.panels={south:{over:!0,h:250},side:{w:400}};a.upload.serviceUrl="/utilities/upload.php?";a.upload.allowedMaxSize=1E6;a.upload.allowedExtensions="gml gpx kml xml rss jpeg jpg gif png shp shx dbf json".split(" ");a.add("layers",{type:"Google",title:"Satellite",MID:"GoogleSatellite",googleType:"satellite",numZoomLevels:22,unremovable:!0});a.add("layers",{type:"Google",title:"Streets",MID:"GoogleStreets",numZoomLevels:22,unremovable:!0});
a.add("layers",{type:"Google",title:"Relief",MID:"GoogleRelief",googleType:"terrain",numZoomLevels:22,unremovable:!0});a.add("layers",{type:"XYZ",title:"MapQuest OSM",MID:"MapQuestOSM",url:["http://otile1.mqcdn.com/tiles/1.0.0/osm/${z}/${x}/${y}.png","http://otile2.mqcdn.com/tiles/1.0.0/osm/${z}/${x}/${y}.png","http://otile3.mqcdn.com/tiles/1.0.0/osm/${z}/${x}/${y}.png","http://otile4.mqcdn.com/tiles/1.0.0/osm/${z}/${x}/${y}.png"],ol:{attribution:'<p>Tiles Courtesy of <a href="http://www.mapquest.com/" target="_blank">MapQuest</a> <img src="http://developer.mapquest.com/content/osm/mq_logo.png"></p>'}});
a.add("layers",{type:"XYZ",title:"OpenStreetMap",MID:"OpenStreetMap",url:["http://a.tile.openstreetmap.org/${z}/${x}/${y}.png","http://b.tile.openstreetmap.org/${z}/${x}/${y}.png","http://c.tile.openstreetmap.org/${z}/${x}/${y}.png"],ol:{attribution:'Tiles from <a href="http://www.openstreetmap.org" target="_blank">OpenStreetMap</a>'}});a.add("plugins",{name:"UserManagement"});a.add("plugins",{name:"Export"});a.add("plugins",{name:"Navigation"});a.add("plugins",{name:"BackgroundsManager"});a.add("plugins",
{name:"RastersManager"});a.add("plugins",{name:"LayersManager"});a.add("plugins",{name:"LayerInfo"});a.add("plugins",{name:"AddLayer",options:{allowedLayerTypes:[{name:"Catalog"},{name:"Atom"},{name:"GeoJSON"},{name:"GeoRSS"},{name:"KML"},{name:"Pleiades"},{name:"WFS"},{name:"WMS"},{name:"WMTS"}]}});a.add("plugins",{name:"Search",options:{services:[{url:"/plugins/flickr/opensearch.xml",stype:"Flickr"},{url:"/plugins/youtube/opensearch.xml",stype:"Youtube"},{url:"/plugins/geonames/opensearch.xml"},
{url:"/plugins/wikipedia/opensearch.xml"}]}});a.add("plugins",{name:"GoogleEarth",options:{synchronizeWMS:!1,buildings:!1}});a.add("plugins",{name:"Distance"});a.add("plugins",{name:"GetFeatureInfo"});a.add("plugins",{name:"Geonames",options:{findNearByUrl:"http://ws.geonames.org/findNearbyJSON?"}});a.add("plugins",{name:"Wikipedia",options:{searchUrl:"http://ws.geonames.net/wikipediaBoundingBoxJSON?"}});a.add("plugins",{name:"Flickr"});a.add("plugins",{name:"Drawing"});a.add("plugins",{name:"Streetview"});
a.add("plugins",{name:"Routing",options:{method:"SPD",url:"/plugins/routing/getShortestPath2.php?"}});a.add("plugins",{name:"Catalog",options:{nextRecord:1,connectors:[{name:"CSWISO"},{name:"CSWEOCharter"},{name:"CSWEO"},{name:"CSWEOr5"},{name:"CSWEOr5ebRR"},{name:"SPOTRest"},{name:"OpenSearch"}]}});a.add("plugins",{name:"WorldGrid"});a.add("plugins",{name:"Share"});a.add("plugins",{name:"Help"});a.add("plugins",{name:"UTFGrid"});a.add("plugins",{name:"WPSClient"});a.add("plugins",{name:"FeatureEdition"});
a.add("plugins",{name:"API",options:{authorized:"*"}})})(window.M.Config);
